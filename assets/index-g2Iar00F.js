const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ClientsPage-NBQ77edb.js","assets/pdf-vendor-CqWdlgKa.js","assets/zustand-vendor-BohoUguQ.js","assets/react-vendor-DRPWudcR.js","assets/supabase-vendor-DWEVVlJw.js","assets/ClientDetailPage-Bcm8WR28.js","assets/contactStore-BpWu2S8M.js","assets/ActivityTimeline-CHQZ8kBB.js","assets/LogActivityModal-u6KFMmyd.js","assets/ContactForm-BGFBqtI4.js","assets/OpportunitiesPage-DjMwHt--.js","assets/charts-vendor-BbtJWQl0.js","assets/OpportunityDetailPage-DVpn6gnd.js","assets/RateCardPage-Bycbfa7y.js","assets/DashboardPage-CUJXXbu6.js","assets/trending-up-C9CHQZaA.js","assets/zap-Cn6_aFrH.js","assets/phone-B8GgQ6qA.js","assets/file-text-DQLibXAv.js","assets/activity-B4S4uuem.js","assets/chart-column-BINswcaq.js","assets/user-BrMvt9zE.js","assets/briefcase-D9q5pFcT.js","assets/dollar-sign-DTkfub5d.js","assets/chevron-down-BXhPJRBU.js","assets/chevron-up-SOSfKcCb.js","assets/QuotesPage-zxL6n72e.js","assets/SettingsPage-C1oqMs43.js","assets/calendarStore-CLIdM_k5.js","assets/ellipsis-vertical-D0o88_7l.js","assets/trash-2-BDmyaqdf.js","assets/copy-h2JdlwCb.js","assets/send-DHMMwT80.js","assets/eye-BetHXh0i.js","assets/message-square-Dl4ZrkmU.js","assets/circle-x-vTOhRkP3.js","assets/FSPage-CpnJqR-T.js","assets/CommercialTasksPage-DTlhN3he.js","assets/list-Csd3VtbD.js","assets/SOPPage-DjzoCv3R.js","assets/KnowledgePage-VQKKjN9Q.js","assets/timelineStore-Bt5C0_Hu.js","assets/KitListPage-DYyTlz-4.js","assets/ContactsPage-r-3_7XMq.js","assets/ProjectsPage-D6VyOyM4.js","assets/ProjectDetailPage-Dawz7OYa.js","assets/CrewPage-BZw1_fMn.js","assets/CrewDetailPage-B3YhcbJb.js","assets/KitBookingPage-D3nIJJLY.js","assets/CallSheetPage-DVBLcaTS.js","assets/CallSheetDetailPage-Bky4VI6K.js","assets/InvoicesPage-D6kFoN2C.js","assets/ExpensesPage-BuhHv0bH.js","assets/ProfitLossPage-B5HJopl1.js","assets/PurchaseOrdersPage-CQQDCh2H.js","assets/ContractsPage-U7vXwX-W.js","assets/EmailPage-u-8luTJc.js","assets/sanitize-C9cT1rJa.js","assets/star-64zWe-bS.js","assets/search-DWH6CPM6.js","assets/funnel-HqLKkiDs.js","assets/chevron-left-CW--kXsc.js","assets/link-2-CBhsYMIt.js","assets/EmailTemplatesPage-CmHiTgHX.js","assets/emailTemplateStore-DWf747KW.js","assets/chevron-right-RrUWg6io.js","assets/save-BUeowHib.js","assets/WorkflowsPage-C2JC5nDi.js","assets/grip-vertical-D1nzcPD5.js","assets/play-DJiO9swx.js","assets/pause-CwfNsWhN.js","assets/CalendarPage-C_R0rb65.js","assets/map-pin-CPxoac7W.js","assets/EmailSequencesPage-DuxvRSev.js","assets/TaskBoardPage-GMSCTpTp.js","assets/ellipsis-BXGtEPtg.js","assets/ResourcesPage-DUDxdrez.js","assets/LandingPage-DuIECx0M.js","assets/clapperboard-BXBNhZTj.js","assets/menu-Owk8P29X.js","assets/Home-01Dxp09G.js","assets/Layout-QHQHJaw-.js","assets/CrewMockup-DnbEcMkf.js","assets/EquipmentMockup-82CI_AB5.js","assets/index-BHSn7Jzn.js","assets/proxy-BCtTbg8K.js","assets/Pricing-Ceo2EGEP.js","assets/FeaturePage-CGN0epQO.js","assets/features-BNzAXX63.js","assets/UseCasePage-Bk59gDwE.js","assets/ComparePage-BHNv9T4N.js","assets/GoogleOAuthCallback-BGRCxx7g.js","assets/TermsPage-BAfhFLhW.js","assets/PrivacyPage-BauEXYk2.js","assets/GDPRPage-CPTG-Deq.js","assets/globe-CqFVWt-v.js","assets/ResetPasswordPage-hzODrbjt.js","assets/BlogPage-BxPkp2Nq.js","assets/BlogPostPage-DSTLTAGK.js","assets/AboutPage-BEAUvRTM.js","assets/ContactPage-B2ylvfJW.js"])))=>i.map(i=>d[i]);
var e,t,n=Object.defineProperty,a=(e,t,a)=>((e,t,a)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a)(e,"symbol"!=typeof t?t+"":t,a);import{j as r,P as o,S as i,V as s,T as l,D as c,I as d,p as u}from"./pdf-vendor-CqWdlgKa.js";import{r as m,R as p,c as h}from"./zustand-vendor-BohoUguQ.js";import{r as f,b as g,g as y}from"./react-vendor-DRPWudcR.js";import{c as b}from"./supabase-vendor-DWEVVlJw.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var v,x,w,_,k={exports:{}},S={},C={exports:{}},N={};function j(){return x||(x=1,C.exports=(v||(v=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var a=n-1>>>1,o=e[a];if(!(0<r(o,t)))break e;e[a]=t,e[n]=o,n=a}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,o=e.length,i=o>>>1;a<i;){var s=2*(a+1)-1,l=e[s],c=s+1,d=e[c];if(0>r(l,n))c<o&&0>r(d,l)?(e[a]=d,e[c]=n,a=c):(e[a]=l,e[s]=n,a=s);else{if(!(c<o&&0>r(d,n)))break e;e[a]=d,e[c]=n,a=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,s=i.now();e.unstable_now=function(){return i.now()-s}}var l=[],c=[],d=1,u=null,m=3,p=!1,h=!1,f=!1,g=!1,y="function"==typeof setTimeout?setTimeout:null,b="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function x(e){for(var r=n(c);null!==r;){if(null===r.callback)a(c);else{if(!(r.startTime<=e))break;a(c),r.sortIndex=r.expirationTime,t(l,r)}r=n(c)}}function w(e){if(f=!1,x(e),!h)if(null!==n(l))h=!0,k||(k=!0,_());else{var t=n(c);null!==t&&E(w,t.startTime-e)}}var _,k=!1,S=-1,C=5,N=-1;function j(){return!(!g&&e.unstable_now()-N<C)}function T(){if(g=!1,k){var t=e.unstable_now();N=t;var r=!0;try{e:{h=!1,f&&(f=!1,b(S),S=-1),p=!0;var o=m;try{t:{for(x(t),u=n(l);null!==u&&!(u.expirationTime>t&&j());){var i=u.callback;if("function"==typeof i){u.callback=null,m=u.priorityLevel;var s=i(u.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof s){u.callback=s,x(t),r=!0;break t}u===n(l)&&a(l),x(t)}else a(l);u=n(l)}if(null!==u)r=!0;else{var d=n(c);null!==d&&E(w,d.startTime-t),r=!1}}break e}finally{u=null,m=o,p=!1}r=void 0}}finally{r?_():k=!1}}}if("function"==typeof v)_=function(){v(T)};else if("undefined"!=typeof MessageChannel){var I=new MessageChannel,D=I.port2;I.port1.onmessage=T,_=function(){D.postMessage(null)}}else _=function(){y(T,0)};function E(t,n){S=y(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e||(C=0<e?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var n=m;m=t;try{return e()}finally{m=n}},e.unstable_requestPaint=function(){g=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=m;m=e;try{return t()}finally{m=n}},e.unstable_scheduleCallback=function(a,r,o){var i=e.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?i+o:i,a){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return a={id:d++,callback:r,priorityLevel:a,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>i?(a.sortIndex=o,t(c,a),null===n(l)&&a===n(c)&&(f?(b(S),S=-1):f=!0,E(w,o-i))):(a.sortIndex=s,t(l,a),h||p||(h=!0,k||(k=!0,_()))),a},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(e){var t=m;return function(){var n=m;m=t;try{return e.apply(this,arguments)}finally{m=n}}}}(N)),N)),C.exports}function T(){if(w)return S;w=1;var e=j(),t=f(),n=g();function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function o(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function i(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function s(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function l(e){if(o(e)!==e)throw Error(a(188))}function c(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=c(e)))return t;e=e.sibling}return null}var d=Object.assign,u=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),v=Symbol.for("react.consumer"),x=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),E=Symbol.iterator;function L(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=E&&e[E]||e["@@iterator"])?e:null}var A=Symbol.for("react.client.reference");function P(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===A?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case h:return"Fragment";case b:return"Profiler";case y:return"StrictMode";case k:return"Suspense";case C:return"SuspenseList";case I:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case p:return"Portal";case x:return e.displayName||"Context";case v:return(e._context.displayName||"Context")+".Consumer";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case N:return null!==(t=e.displayName||null)?t:P(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return P(e(t))}catch(n){}}return null}var R=Array.isArray,O=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q={pending:!1,data:null,method:null,action:null},z=[],F=-1;function B(e){return{current:e}}function U(e){0>F||(e.current=z[F],z[F]=null,F--)}function $(e,t){F++,z[F]=e.current,e.current=t}var V,H,W=B(null),G=B(null),K=B(null),Q=B(null);function Y(e,t){switch($(K,t),$(G,e),$(W,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?vu(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=xu(t=vu(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(W),$(W,e)}function J(){U(W),U(G),U(K)}function Z(e){null!==e.memoizedState&&$(Q,e);var t=W.current,n=xu(t,e.type);t!==n&&($(G,e),$(W,n))}function X(e){G.current===e&&(U(W),U(G)),Q.current===e&&(U(Q),mm._currentValue=q)}function ee(e){if(void 0===V)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);V=t&&t[1]||"",H=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+V+e+H}var te=!1;function ne(e,t){if(!e||te)return"";te=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var a={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(r){var a=r}Reflect.construct(e,[],n)}else{try{n.call()}catch(o){a=o}e.call(n.prototype)}}else{try{throw Error()}catch(i){a=i}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&a&&"string"==typeof s.stack)return[s.stack,a.stack]}return[null,null]}};a.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(a.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(a.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=a.DetermineComponentFrameRoot(),i=o[0],s=o[1];if(i&&s){var l=i.split("\n"),c=s.split("\n");for(r=a=0;a<l.length&&!l[a].includes("DetermineComponentFrameRoot");)a++;for(;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;if(a===l.length||r===c.length)for(a=l.length-1,r=c.length-1;1<=a&&0<=r&&l[a]!==c[r];)r--;for(;1<=a&&0<=r;a--,r--)if(l[a]!==c[r]){if(1!==a||1!==r)do{if(a--,0>--r||l[a]!==c[r]){var d="\n"+l[a].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=a&&0<=r);break}}}finally{te=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?ee(n):""}function ae(e,t){switch(e.tag){case 26:case 27:case 5:return ee(e.type);case 16:return ee("Lazy");case 13:return e.child!==t&&null!==t?ee("Suspense Fallback"):ee("Suspense");case 19:return ee("SuspenseList");case 0:case 15:return ne(e.type,!1);case 11:return ne(e.type.render,!1);case 1:return ne(e.type,!0);case 31:return ee("Activity");default:return""}}function re(e){try{var t="",n=null;do{t+=ae(e,n),n=e,e=e.return}while(e);return t}catch(a){return"\nError generating stack: "+a.message+"\n"+a.stack}}var oe=Object.prototype.hasOwnProperty,ie=e.unstable_scheduleCallback,se=e.unstable_cancelCallback,le=e.unstable_shouldYield,ce=e.unstable_requestPaint,de=e.unstable_now,ue=e.unstable_getCurrentPriorityLevel,me=e.unstable_ImmediatePriority,pe=e.unstable_UserBlockingPriority,he=e.unstable_NormalPriority,fe=e.unstable_LowPriority,ge=e.unstable_IdlePriority,ye=e.log,be=e.unstable_setDisableYieldValue,ve=null,xe=null;function we(e){if("function"==typeof ye&&be(e),xe&&"function"==typeof xe.setStrictMode)try{xe.setStrictMode(ve,e)}catch(t){}}var _e=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ke(e)/Se|0)|0},ke=Math.log,Se=Math.LN2;var Ce=256,Ne=262144,je=4194304;function Te(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ie(e,t,n){var a=e.pendingLanes;if(0===a)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var s=134217727&a;return 0!==s?0!==(a=s&~o)?r=Te(a):0!==(i&=s)?r=Te(i):n||0!==(n=s&~e)&&(r=Te(n)):0!==(s=a&~o)?r=Te(s):0!==i?r=Te(i):n||0!==(n=a&~e)&&(r=Te(n)),0===r?0:0!==t&&t!==r&&0===(t&o)&&((o=r&-r)>=(n=t&-t)||32===o&&4194048&n)?t:r}function De(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ee(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Le(){var e=je;return!(62914560&(je<<=1))&&(je=4194304),e}function Ae(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Pe(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Re(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var a=31-_e(t);e.entangledLanes|=t,e.entanglements[a]=1073741824|e.entanglements[a]|261930&n}function Oe(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var a=31-_e(n),r=1<<a;r&t|e[a]&t&&(e[a]|=t),n&=~r}}function Me(e,t){var n=t&-t;return 0!==((n=42&n?1:qe(n))&(e.suspendedLanes|t))?0:n}function qe(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ze(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Fe(){var e=M.p;return 0!==e?e:void 0===(e=window.event)?32:Tm(e.type)}function Be(e,t){var n=M.p;try{return M.p=e,t()}finally{M.p=n}}var Ue=Math.random().toString(36).slice(2),$e="__reactFiber$"+Ue,Ve="__reactProps$"+Ue,He="__reactContainer$"+Ue,We="__reactEvents$"+Ue,Ge="__reactListeners$"+Ue,Ke="__reactHandles$"+Ue,Qe="__reactResources$"+Ue,Ye="__reactMarker$"+Ue;function Je(e){delete e[$e],delete e[Ve],delete e[We],delete e[Ge],delete e[Ke]}function Ze(e){var t=e[$e];if(t)return t;for(var n=e.parentNode;n;){if(t=n[He]||n[$e]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=qu(e);null!==e;){if(n=e[$e])return n;e=qu(e)}return t}n=(e=n).parentNode}return null}function Xe(e){if(e=e[$e]||e[He]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function et(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function tt(e){var t=e[Qe];return t||(t=e[Qe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function nt(e){e[Ye]=!0}var at=new Set,rt={};function ot(e,t){it(e,t),it(e+"Capture",t)}function it(e,t){for(rt[e]=t,e=0;e<t.length;e++)at.add(t[e])}var st=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),lt={},ct={};function dt(e,t,n){if(r=t,oe.call(ct,r)||!oe.call(lt,r)&&(st.test(r)?ct[r]=!0:(lt[r]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var a=t.toLowerCase().slice(0,5);if("data-"!==a&&"aria-"!==a)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var r}function ut(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function mt(e,t,n,a){if(null===a)e.removeAttribute(n);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+a)}}function pt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ft(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,n){var a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&void 0!==a&&"function"==typeof a.get&&"function"==typeof a.set){var r=a.get,o=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function gt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),a="";return e&&(a=ht(e)?e.checked?"true":"false":e.value),(e=a)!==n&&(t.setValue(e),!0)}function yt(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var bt=/[\n"\\]/g;function vt(e){return e.replace(bt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function xt(e,t,n,a,r,o,i,s){e.name="",null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+pt(t)):e.value!==""+pt(t)&&(e.value=""+pt(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?_t(e,i,pt(t)):null!=n?_t(e,i,pt(n)):null!=a&&e.removeAttribute("value"),null==r&&null!=o&&(e.defaultChecked=!!o),null!=r&&(e.checked=r&&"function"!=typeof r&&"symbol"!=typeof r),null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s?e.name=""+pt(s):e.removeAttribute("name")}function wt(e,t,n,a,r,o,i,s){if(null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o&&(e.type=o),null!=t||null!=n){if(("submit"===o||"reset"===o)&&null==t)return void ft(e);n=null!=n?""+pt(n):"",t=null!=t?""+pt(t):n,s||t===e.value||(e.value=t),e.defaultValue=t}a="function"!=typeof(a=null!=a?a:r)&&"symbol"!=typeof a&&!!a,e.checked=s?e.checked:!!a,e.defaultChecked=!!a,null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i&&(e.name=i),ft(e)}function _t(e,t,n){"number"===t&&yt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function kt(e,t,n,a){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&a&&(e[n].defaultSelected=!0)}else{for(n=""+pt(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(a&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function St(e,t,n){null==t||((t=""+pt(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+pt(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Ct(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(a(92));if(R(r)){if(1<r.length)throw Error(a(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=pt(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r),ft(e)}function Nt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var jt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tt(e,t,n){var a=0===t.indexOf("--");null==n||"boolean"==typeof n||""===n?a?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":a?e.setProperty(t,n):"number"!=typeof n||0===n||jt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function It(e,t,n){if(null!=t&&"object"!=typeof t)throw Error(a(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var o in t)r=t[o],t.hasOwnProperty(o)&&n[o]!==r&&Tt(e,o,r)}else for(var i in t)t.hasOwnProperty(i)&&Tt(e,i,t[i])}function Dt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Et=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Lt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function At(e){return Lt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Pt(){}var Rt=null;function Ot(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Mt=null,qt=null;function zt(e){var t=Xe(e);if(t&&(e=t.stateNode)){var n=e[Ve]||null;e:switch(e=t.stateNode,t.type){case"input":if(xt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+vt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=r[Ve]||null;if(!o)throw Error(a(90));xt(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&gt(r)}break e;case"textarea":St(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&kt(e,!!n.multiple,t,!1)}}}var Ft=!1;function Bt(e,t,n){if(Ft)return e(t,n);Ft=!0;try{return e(t)}finally{if(Ft=!1,(null!==Mt||null!==qt)&&(td(),Mt&&(t=Mt,e=qt,qt=Mt=null,zt(t),e)))for(t=0;t<e.length;t++)zt(e[t])}}function Ut(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Ve]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}var $t=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Vt=!1;if($t)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){Vt=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch(Xm){Vt=!1}var Wt=null,Gt=null,Kt=null;function Qt(){if(Kt)return Kt;var e,t,n=Gt,a=n.length,r="value"in Wt?Wt.value:Wt.textContent,o=r.length;for(e=0;e<a&&n[e]===r[e];e++);var i=a-e;for(t=1;t<=i&&n[a-t]===r[o-t];t++);return Kt=r.slice(e,1<t?1-t:void 0)}function Yt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Jt(){return!0}function Zt(){return!1}function Xt(e){function t(t,n,a,r,o){for(var i in this._reactName=t,this._targetInst=a,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(r):r[i]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?Jt:Zt,this.isPropagationStopped=Zt,this}return d(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Jt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Jt)},persist:function(){},isPersistent:Jt}),t}var en,tn,nn,an={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rn=Xt(an),on=d({},an,{view:0,detail:0}),sn=Xt(on),ln=d({},on,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==nn&&(nn&&"mousemove"===e.type?(en=e.screenX-nn.screenX,tn=e.screenY-nn.screenY):tn=en=0,nn=e),en)},movementY:function(e){return"movementY"in e?e.movementY:tn}}),cn=Xt(ln),dn=Xt(d({},ln,{dataTransfer:0})),un=Xt(d({},on,{relatedTarget:0})),mn=Xt(d({},an,{animationName:0,elapsedTime:0,pseudoElement:0})),pn=Xt(d({},an,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),hn=Xt(d({},an,{data:0})),fn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=yn[e])&&!!t[e]}function vn(){return bn}var xn=Xt(d({},on,{key:function(e){if(e.key){var t=fn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Yt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?gn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vn,charCode:function(e){return"keypress"===e.type?Yt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Yt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),wn=Xt(d({},ln,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_n=Xt(d({},on,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vn})),kn=Xt(d({},an,{propertyName:0,elapsedTime:0,pseudoElement:0})),Sn=Xt(d({},ln,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Cn=Xt(d({},an,{newState:0,oldState:0})),Nn=[9,13,27,32],jn=$t&&"CompositionEvent"in window,Tn=null;$t&&"documentMode"in document&&(Tn=document.documentMode);var In=$t&&"TextEvent"in window&&!Tn,Dn=$t&&(!jn||Tn&&8<Tn&&11>=Tn),En=String.fromCharCode(32),Ln=!1;function An(e,t){switch(e){case"keyup":return-1!==Nn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Rn=!1;var On={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!On[e.type]:"textarea"===t}function qn(e,t,n,a){Mt?qt?qt.push(a):qt=[a]:Mt=a,0<(t=ou(t,"onChange")).length&&(n=new rn("onChange","change",null,n,a),e.push({event:n,listeners:t}))}var zn=null,Fn=null;function Bn(e){Jd(e,0)}function Un(e){if(gt(et(e)))return e}function $n(e,t){if("change"===e)return t}var Vn=!1;if($t){var Hn;if($t){var Wn="oninput"in document;if(!Wn){var Gn=document.createElement("div");Gn.setAttribute("oninput","return;"),Wn="function"==typeof Gn.oninput}Hn=Wn}else Hn=!1;Vn=Hn&&(!document.documentMode||9<document.documentMode)}function Kn(){zn&&(zn.detachEvent("onpropertychange",Qn),Fn=zn=null)}function Qn(e){if("value"===e.propertyName&&Un(Fn)){var t=[];qn(t,Fn,e,Ot(e)),Bt(Bn,t)}}function Yn(e,t,n){"focusin"===e?(Kn(),Fn=n,(zn=t).attachEvent("onpropertychange",Qn)):"focusout"===e&&Kn()}function Jn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Un(Fn)}function Zn(e,t){if("click"===e)return Un(t)}function Xn(e,t){if("input"===e||"change"===e)return Un(t)}var ea="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function ta(e,t){if(ea(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(a=0;a<n.length;a++){var r=n[a];if(!oe.call(t,r)||!ea(e[r],t[r]))return!1}return!0}function na(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function aa(e,t){var n,a=na(e);for(e=0;a;){if(3===a.nodeType){if(n=e+a.textContent.length,e<=t&&n>=t)return{node:a,offset:t-e};e=n}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=na(a)}}function ra(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ra(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function oa(e){for(var t=yt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(a){n=!1}if(!n)break;t=yt((e=t.contentWindow).document)}return t}function ia(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var sa=$t&&"documentMode"in document&&11>=document.documentMode,la=null,ca=null,da=null,ua=!1;function ma(e,t,n){var a=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ua||null==la||la!==yt(a)||("selectionStart"in(a=la)&&ia(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},da&&ta(da,a)||(da=a,0<(a=ou(ca,"onSelect")).length&&(t=new rn("onSelect","select",null,t,n),e.push({event:t,listeners:a}),t.target=la)))}function pa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var ha={animationend:pa("Animation","AnimationEnd"),animationiteration:pa("Animation","AnimationIteration"),animationstart:pa("Animation","AnimationStart"),transitionrun:pa("Transition","TransitionRun"),transitionstart:pa("Transition","TransitionStart"),transitioncancel:pa("Transition","TransitionCancel"),transitionend:pa("Transition","TransitionEnd")},fa={},ga={};function ya(e){if(fa[e])return fa[e];if(!ha[e])return e;var t,n=ha[e];for(t in n)if(n.hasOwnProperty(t)&&t in ga)return fa[e]=n[t];return e}$t&&(ga=document.createElement("div").style,"AnimationEvent"in window||(delete ha.animationend.animation,delete ha.animationiteration.animation,delete ha.animationstart.animation),"TransitionEvent"in window||delete ha.transitionend.transition);var ba=ya("animationend"),va=ya("animationiteration"),xa=ya("animationstart"),wa=ya("transitionrun"),_a=ya("transitionstart"),ka=ya("transitioncancel"),Sa=ya("transitionend"),Ca=new Map,Na="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ja(e,t){Ca.set(e,t),ot(t,[e])}Na.push("scrollEnd");var Ta="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e)},Ia=[],Da=0,Ea=0;function La(){for(var e=Da,t=Ea=Da=0;t<e;){var n=Ia[t];Ia[t++]=null;var a=Ia[t];Ia[t++]=null;var r=Ia[t];Ia[t++]=null;var o=Ia[t];if(Ia[t++]=null,null!==a&&null!==r){var i=a.pending;null===i?r.next=r:(r.next=i.next,i.next=r),a.pending=r}0!==o&&Oa(n,r,o)}}function Aa(e,t,n,a){Ia[Da++]=e,Ia[Da++]=t,Ia[Da++]=n,Ia[Da++]=a,Ea|=a,e.lanes|=a,null!==(e=e.alternate)&&(e.lanes|=a)}function Pa(e,t,n,a){return Aa(e,t,n,a),Ma(e)}function Ra(e,t){return Aa(e,null,null,t),Ma(e)}function Oa(e,t,n){e.lanes|=n;var a=e.alternate;null!==a&&(a.lanes|=n);for(var r=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(a=o.alternate)&&(a.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(r=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,r&&null!==t&&(r=31-_e(n),null===(a=(e=o.hiddenUpdates)[r])?e[r]=[t]:a.push(t),t.lane=536870912|n),o):null}function Ma(e){if(50<Wc)throw Wc=0,Gc=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var qa={};function za(e,t,n,a){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fa(e,t,n,a){return new za(e,t,n,a)}function Ba(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ua(e,t){var n=e.alternate;return null===n?((n=Fa(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function $a(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Va(e,t,n,r,o,i){var s=0;if(r=e,"function"==typeof e)Ba(e)&&(s=1);else if("string"==typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,n,W.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case I:return(e=Fa(31,n,t,o)).elementType=I,e.lanes=i,e;case h:return Ha(n.children,o,i,t);case y:s=8,o|=24;break;case b:return(e=Fa(12,n,t,2|o)).elementType=b,e.lanes=i,e;case k:return(e=Fa(13,n,t,o)).elementType=k,e.lanes=i,e;case C:return(e=Fa(19,n,t,o)).elementType=C,e.lanes=i,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case x:s=10;break e;case v:s=9;break e;case _:s=11;break e;case N:s=14;break e;case T:s=16,r=null;break e}s=29,n=Error(a(130,null===e?"null":typeof e,"")),r=null}return(t=Fa(s,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function Ha(e,t,n,a){return(e=Fa(7,e,a,t)).lanes=n,e}function Wa(e,t,n){return(e=Fa(6,e,null,t)).lanes=n,e}function Ga(e){var t=Fa(18,null,null,0);return t.stateNode=e,t}function Ka(e,t,n){return(t=Fa(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Qa=new WeakMap;function Ya(e,t){if("object"==typeof e&&null!==e){var n=Qa.get(e);return void 0!==n?n:(t={value:e,source:t,stack:re(t)},Qa.set(e,t),t)}return{value:e,source:t,stack:re(t)}}var Ja=[],Za=0,Xa=null,er=0,tr=[],nr=0,ar=null,rr=1,or="";function ir(e,t){Ja[Za++]=er,Ja[Za++]=Xa,Xa=e,er=t}function sr(e,t,n){tr[nr++]=rr,tr[nr++]=or,tr[nr++]=ar,ar=e;var a=rr;e=or;var r=32-_e(a)-1;a&=~(1<<r),n+=1;var o=32-_e(t)+r;if(30<o){var i=r-r%5;o=(a&(1<<i)-1).toString(32),a>>=i,r-=i,rr=1<<32-_e(t)+r|n<<r|a,or=o+e}else rr=1<<o|n<<r|a,or=e}function lr(e){null!==e.return&&(ir(e,1),sr(e,1,0))}function cr(e){for(;e===Xa;)Xa=Ja[--Za],Ja[Za]=null,er=Ja[--Za],Ja[Za]=null;for(;e===ar;)ar=tr[--nr],tr[nr]=null,or=tr[--nr],tr[nr]=null,rr=tr[--nr],tr[nr]=null}function dr(e,t){tr[nr++]=rr,tr[nr++]=or,tr[nr++]=ar,rr=t.id,or=t.overflow,ar=e}var ur=null,mr=null,pr=!1,hr=null,fr=!1,gr=Error(a(519));function yr(e){throw kr(Ya(Error(a(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),gr}function br(e){var t=e.stateNode,n=e.type,a=e.memoizedProps;switch(t[$e]=e,t[Ve]=a,n){case"dialog":Zd("cancel",t),Zd("close",t);break;case"iframe":case"object":case"embed":Zd("load",t);break;case"video":case"audio":for(n=0;n<Qd.length;n++)Zd(Qd[n],t);break;case"source":Zd("error",t);break;case"img":case"image":case"link":Zd("error",t),Zd("load",t);break;case"details":Zd("toggle",t);break;case"input":Zd("invalid",t),wt(t,a.value,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name,!0);break;case"select":Zd("invalid",t);break;case"textarea":Zd("invalid",t),Ct(t,a.value,a.defaultValue,a.children)}"string"!=typeof(n=a.children)&&"number"!=typeof n&&"bigint"!=typeof n||t.textContent===""+n||!0===a.suppressHydrationWarning||uu(t.textContent,n)?(null!=a.popover&&(Zd("beforetoggle",t),Zd("toggle",t)),null!=a.onScroll&&Zd("scroll",t),null!=a.onScrollEnd&&Zd("scrollend",t),null!=a.onClick&&(t.onclick=Pt),t=!0):t=!1,t||yr(e,!0)}function vr(e){for(ur=e.return;ur;)switch(ur.tag){case 5:case 31:case 13:return void(fr=!1);case 27:case 3:return void(fr=!0);default:ur=ur.return}}function xr(e){if(e!==ur)return!1;if(!pr)return vr(e),pr=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||wu(e.type,e.memoizedProps)),t=!t),t&&mr&&yr(e),vr(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));mr=Mu(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));mr=Mu(e)}else 27===n?(n=mr,Tu(e.type)?(e=Ou,Ou=null,mr=e):mr=n):mr=ur?Ru(e.stateNode.nextSibling):null;return!0}function wr(){mr=ur=null,pr=!1}function _r(){var e=hr;return null!==e&&(null===Lc?Lc=e:Lc.push.apply(Lc,e),hr=null),e}function kr(e){null===hr?hr=[e]:hr.push(e)}var Sr=B(null),Cr=null,Nr=null;function jr(e,t,n){$(Sr,t._currentValue),t._currentValue=n}function Tr(e){e._currentValue=Sr.current,U(Sr)}function Ir(e,t,n){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===n)break;e=e.return}}function Dr(e,t,n,r){var o=e.child;for(null!==o&&(o.return=e);null!==o;){var i=o.dependencies;if(null!==i){var s=o.child;i=i.firstContext;e:for(;null!==i;){var l=i;i=o;for(var c=0;c<t.length;c++)if(l.context===t[c]){i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Ir(i.return,n,e),r||(s=null);break e}i=l.next}}else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(i=s.alternate)&&(i.lanes|=n),Ir(s,n,e),s=null}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===e){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}}function Er(e,t,n,r){e=null;for(var o=t,i=!1;null!==o;){if(!i)if(524288&o.flags)i=!0;else if(262144&o.flags)break;if(10===o.tag){var s=o.alternate;if(null===s)throw Error(a(387));if(null!==(s=s.memoizedProps)){var l=o.type;ea(o.pendingProps.value,s.value)||(null!==e?e.push(l):e=[l])}}else if(o===Q.current){if(null===(s=o.alternate))throw Error(a(387));s.memoizedState.memoizedState!==o.memoizedState.memoizedState&&(null!==e?e.push(mm):e=[mm])}o=o.return}null!==e&&Dr(t,e,n,r),t.flags|=262144}function Lr(e){for(e=e.firstContext;null!==e;){if(!ea(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ar(e){Cr=e,Nr=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Pr(e){return Or(Cr,e)}function Rr(e,t){return null===Cr&&Ar(e),Or(e,t)}function Or(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Nr){if(null===e)throw Error(a(308));Nr=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Nr=Nr.next=t;return n}var Mr="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},qr=e.unstable_scheduleCallback,zr=e.unstable_NormalPriority,Fr={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Br(){return{controller:new Mr,data:new Map,refCount:0}}function Ur(e){e.refCount--,0===e.refCount&&qr(zr,function(){e.controller.abort()})}var $r=null,Vr=0,Hr=0,Wr=null;function Gr(){if(0===--Vr&&null!==$r){null!==Wr&&(Wr.status="fulfilled");var e=$r;$r=null,Hr=0,Wr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Kr=O.S;O.S=function(e,t){Rc=de(),"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===$r){var n=$r=[];Vr=0,Hr=Vd(),Wr={status:"pending",value:void 0,then:function(e){n.push(e)}}}Vr++,t.then(Gr,Gr)}(0,t),null!==Kr&&Kr(e,t)};var Qr=B(null);function Yr(){var e=Qr.current;return null!==e?e:gc.pooledCache}function Jr(e,t){$(Qr,null===t?Qr.current:t.pool)}function Zr(){var e=Yr();return null===e?null:{parent:Fr._currentValue,pool:e}}var Xr=Error(a(460)),eo=Error(a(474)),to=Error(a(542)),no={then:function(){}};function ao(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ro(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Pt,Pt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw lo(e=t.reason),e;default:if("string"==typeof t.status)t.then(Pt,Pt);else{if(null!==(e=gc)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw lo(e=t.reason),e}throw io=t,Xr}}function oo(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"==typeof t&&"function"==typeof t.then)throw io=t,Xr;throw t}}var io=null;function so(){if(null===io)throw Error(a(459));var e=io;return io=null,e}function lo(e){if(e===Xr||e===to)throw Error(a(483))}var co=null,uo=0;function mo(e){var t=uo;return uo+=1,null===co&&(co=[]),ro(co,e,t)}function po(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function ho(e,t){if(t.$$typeof===u)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function fo(e){function t(t,n){if(e){var a=t.deletions;null===a?(t.deletions=[n],t.flags|=16):a.push(n)}}function n(n,a){if(!e)return null;for(;null!==a;)t(n,a),a=a.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function o(e,t){return(e=Ua(e,t)).index=0,e.sibling=null,e}function i(t,n,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<n?(t.flags|=67108866,n):a:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,a){return null===t||6!==t.tag?((t=Wa(n,e.mode,a)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,a){var r=n.type;return r===h?u(e,t,n.props.children,a,n.key):null!==t&&(t.elementType===r||"object"==typeof r&&null!==r&&r.$$typeof===T&&oo(r)===t.type)?(po(t=o(t,n.props),n),t.return=e,t):(po(t=Va(n.type,n.key,n.props,null,e.mode,a),n),t.return=e,t)}function d(e,t,n,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ka(n,e.mode,a)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function u(e,t,n,a,r){return null===t||7!==t.tag?((t=Ha(n,e.mode,a,r)).return=e,t):((t=o(t,n)).return=e,t)}function f(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=Wa(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case m:return po(n=Va(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case p:return(t=Ka(t,e.mode,n)).return=e,t;case T:return f(e,t=oo(t),n)}if(R(t)||L(t))return(t=Ha(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return f(e,mo(t),n);if(t.$$typeof===x)return f(e,Rr(e,t),n);ho(e,t)}return null}function g(e,t,n,a){var r=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==r?null:l(e,t,""+n,a);if("object"==typeof n&&null!==n){switch(n.$$typeof){case m:return n.key===r?c(e,t,n,a):null;case p:return n.key===r?d(e,t,n,a):null;case T:return g(e,t,n=oo(n),a)}if(R(n)||L(n))return null!==r?null:u(e,t,n,a,null);if("function"==typeof n.then)return g(e,t,mo(n),a);if(n.$$typeof===x)return g(e,t,Rr(e,n),a);ho(e,n)}return null}function y(e,t,n,a,r){if("string"==typeof a&&""!==a||"number"==typeof a||"bigint"==typeof a)return l(t,e=e.get(n)||null,""+a,r);if("object"==typeof a&&null!==a){switch(a.$$typeof){case m:return c(t,e=e.get(null===a.key?n:a.key)||null,a,r);case p:return d(t,e=e.get(null===a.key?n:a.key)||null,a,r);case T:return y(e,t,n,a=oo(a),r)}if(R(a)||L(a))return u(t,e=e.get(n)||null,a,r,null);if("function"==typeof a.then)return y(e,t,n,mo(a),r);if(a.$$typeof===x)return y(e,t,n,Rr(t,a),r);ho(t,a)}return null}function b(l,c,d,u){if("object"==typeof d&&null!==d&&d.type===h&&null===d.key&&(d=d.props.children),"object"==typeof d&&null!==d){switch(d.$$typeof){case m:e:{for(var v=d.key;null!==c;){if(c.key===v){if((v=d.type)===h){if(7===c.tag){n(l,c.sibling),(u=o(c,d.props.children)).return=l,l=u;break e}}else if(c.elementType===v||"object"==typeof v&&null!==v&&v.$$typeof===T&&oo(v)===c.type){n(l,c.sibling),po(u=o(c,d.props),d),u.return=l,l=u;break e}n(l,c);break}t(l,c),c=c.sibling}d.type===h?((u=Ha(d.props.children,l.mode,u,d.key)).return=l,l=u):(po(u=Va(d.type,d.key,d.props,null,l.mode,u),d),u.return=l,l=u)}return s(l);case p:e:{for(v=d.key;null!==c;){if(c.key===v){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){n(l,c.sibling),(u=o(c,d.children||[])).return=l,l=u;break e}n(l,c);break}t(l,c),c=c.sibling}(u=Ka(d,l.mode,u)).return=l,l=u}return s(l);case T:return b(l,c,d=oo(d),u)}if(R(d))return function(a,o,s,l){for(var c=null,d=null,u=o,m=o=0,p=null;null!==u&&m<s.length;m++){u.index>m?(p=u,u=null):p=u.sibling;var h=g(a,u,s[m],l);if(null===h){null===u&&(u=p);break}e&&u&&null===h.alternate&&t(a,u),o=i(h,o,m),null===d?c=h:d.sibling=h,d=h,u=p}if(m===s.length)return n(a,u),pr&&ir(a,m),c;if(null===u){for(;m<s.length;m++)null!==(u=f(a,s[m],l))&&(o=i(u,o,m),null===d?c=u:d.sibling=u,d=u);return pr&&ir(a,m),c}for(u=r(u);m<s.length;m++)null!==(p=y(u,a,m,s[m],l))&&(e&&null!==p.alternate&&u.delete(null===p.key?m:p.key),o=i(p,o,m),null===d?c=p:d.sibling=p,d=p);return e&&u.forEach(function(e){return t(a,e)}),pr&&ir(a,m),c}(l,c,d,u);if(L(d)){if("function"!=typeof(v=L(d)))throw Error(a(150));return function(o,s,l,c){if(null==l)throw Error(a(151));for(var d=null,u=null,m=s,p=s=0,h=null,b=l.next();null!==m&&!b.done;p++,b=l.next()){m.index>p?(h=m,m=null):h=m.sibling;var v=g(o,m,b.value,c);if(null===v){null===m&&(m=h);break}e&&m&&null===v.alternate&&t(o,m),s=i(v,s,p),null===u?d=v:u.sibling=v,u=v,m=h}if(b.done)return n(o,m),pr&&ir(o,p),d;if(null===m){for(;!b.done;p++,b=l.next())null!==(b=f(o,b.value,c))&&(s=i(b,s,p),null===u?d=b:u.sibling=b,u=b);return pr&&ir(o,p),d}for(m=r(m);!b.done;p++,b=l.next())null!==(b=y(m,o,p,b.value,c))&&(e&&null!==b.alternate&&m.delete(null===b.key?p:b.key),s=i(b,s,p),null===u?d=b:u.sibling=b,u=b);return e&&m.forEach(function(e){return t(o,e)}),pr&&ir(o,p),d}(l,c,d=v.call(d),u)}if("function"==typeof d.then)return b(l,c,mo(d),u);if(d.$$typeof===x)return b(l,c,Rr(l,d),u);ho(l,d)}return"string"==typeof d&&""!==d||"number"==typeof d||"bigint"==typeof d?(d=""+d,null!==c&&6===c.tag?(n(l,c.sibling),(u=o(c,d)).return=l,l=u):(n(l,c),(u=Wa(d,l.mode,u)).return=l,l=u),s(l)):n(l,c)}return function(e,t,n,a){try{uo=0;var r=b(e,t,n,a);return co=null,r}catch(i){if(i===Xr||i===to)throw i;var o=Fa(29,i,null,e.mode);return o.lanes=a,o.return=e,o}}}var go=fo(!0),yo=fo(!1),bo=!1;function vo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function xo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function wo(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function _o(e,t,n){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,2&fc){var r=a.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),a.pending=t,t=Ma(e),Oa(e,null,n),t}return Aa(e,a,t,n),Ma(e)}function ko(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&n)){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,Oe(e,n)}}function So(e,t){var n=e.updateQueue,a=e.alternate;if(null!==a&&n===(a=a.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var i={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?r=o=i:o=o.next=i,n=n.next}while(null!==n);null===o?r=o=t:o=o.next=t}else r=o=t;return n={baseState:a.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:a.shared,callbacks:a.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Co=!1;function No(){if(Co){if(null!==Wr)throw Wr}}function jo(e,t,n,a){Co=!1;var r=e.updateQueue;bo=!1;var o=r.firstBaseUpdate,i=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var l=s,c=l.next;l.next=null,null===i?o=c:i.next=c,i=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==o){var m=r.baseState;for(i=0,u=c=l=null,s=o;;){var p=-536870913&s.lane,h=p!==s.lane;if(h?(bc&p)===p:(a&p)===p){0!==p&&p===Hr&&(Co=!0),null!==u&&(u=u.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var f=e,g=s;p=t;var y=n;switch(g.tag){case 1:if("function"==typeof(f=g.payload)){m=f.call(y,m,p);break e}m=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(p="function"==typeof(f=g.payload)?f.call(y,m,p):f))break e;m=d({},m,p);break e;case 2:bo=!0}}null!==(p=s.callback)&&(e.flags|=64,h&&(e.flags|=8192),null===(h=r.callbacks)?r.callbacks=[p]:h.push(p))}else h={lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=h,l=m):u=u.next=h,i|=p;if(null===(s=s.next)){if(null===(s=r.shared.pending))break;s=(h=s).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}null===u&&(l=m),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null===o&&(r.shared.lanes=0),Nc|=i,e.lanes=i,e.memoizedState=m}}function To(e,t){if("function"!=typeof e)throw Error(a(191,e));e.call(t)}function Io(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)To(n[e],t)}var Do=B(null),Eo=B(0);function Lo(e,t){$(Eo,e=Sc),$(Do,t),Sc=e|t.baseLanes}function Ao(){$(Eo,Sc),$(Do,Do.current)}function Po(){Sc=Eo.current,U(Do),U(Eo)}var Ro=B(null),Oo=null;function Mo(e){var t=e.alternate;$(Uo,1&Uo.current),$(Ro,e),null===Oo&&(null===t||null!==Do.current||null!==t.memoizedState)&&(Oo=e)}function qo(e){$(Uo,Uo.current),$(Ro,e),null===Oo&&(Oo=e)}function zo(e){22===e.tag?($(Uo,Uo.current),$(Ro,e),null===Oo&&(Oo=e)):Fo()}function Fo(){$(Uo,Uo.current),$(Ro,Ro.current)}function Bo(e){U(Ro),Oo===e&&(Oo=null),U(Uo)}var Uo=B(0);function $o(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Au(n)||Pu(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(128&t.flags)return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vo=0,Ho=null,Wo=null,Go=null,Ko=!1,Qo=!1,Yo=!1,Jo=0,Zo=0,Xo=null,ei=0;function ti(){throw Error(a(321))}function ni(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ea(e[n],t[n]))return!1;return!0}function ai(e,t,n,a,r,o){return Vo=o,Ho=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,O.H=null===e||null===e.memoizedState?bs:vs,Yo=!1,o=n(a,r),Yo=!1,Qo&&(o=oi(t,n,a,r)),ri(e),o}function ri(e){O.H=ys;var t=null!==Wo&&null!==Wo.next;if(Vo=0,Go=Wo=Ho=null,Ko=!1,Zo=0,Xo=null,t)throw Error(a(300));null===e||Rs||null!==(e=e.dependencies)&&Lr(e)&&(Rs=!0)}function oi(e,t,n,r){Ho=e;var o=0;do{if(Qo&&(Xo=null),Zo=0,Qo=!1,25<=o)throw Error(a(301));if(o+=1,Go=Wo=null,null!=e.updateQueue){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,null!=i.memoCache&&(i.memoCache.index=0)}O.H=xs,i=t(n,r)}while(Qo);return i}function ii(){var e=O.H,t=e.useState()[0];return t="function"==typeof t.then?mi(t):t,e=e.useState()[0],(null!==Wo?Wo.memoizedState:null)!==e&&(Ho.flags|=1024),t}function si(){var e=0!==Jo;return Jo=0,e}function li(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function ci(e){if(Ko){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Ko=!1}Vo=0,Go=Wo=Ho=null,Qo=!1,Zo=Jo=0,Xo=null}function di(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Go?Ho.memoizedState=Go=e:Go=Go.next=e,Go}function ui(){if(null===Wo){var e=Ho.alternate;e=null!==e?e.memoizedState:null}else e=Wo.next;var t=null===Go?Ho.memoizedState:Go.next;if(null!==t)Go=t,Wo=e;else{if(null===e){if(null===Ho.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(Wo=e).memoizedState,baseState:Wo.baseState,baseQueue:Wo.baseQueue,queue:Wo.queue,next:null},null===Go?Ho.memoizedState=Go=e:Go=Go.next=e}return Go}function mi(e){var t=Zo;return Zo+=1,null===Xo&&(Xo=[]),e=ro(Xo,e,t),t=Ho,null===(null===Go?t.memoizedState:Go.next)&&(t=t.alternate,O.H=null===t||null===t.memoizedState?bs:vs),e}function pi(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return mi(e);if(e.$$typeof===x)return Pr(e)}throw Error(a(438,String(e)))}function hi(e){var t=null,n=Ho.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var a=Ho.alternate;null!==a&&(null!==(a=a.updateQueue)&&(null!=(a=a.memoCache)&&(t={data:a.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Ho.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),a=0;a<e;a++)n[a]=D;return t.index++,n}function fi(e,t){return"function"==typeof t?t(e):t}function gi(e){return yi(ui(),Wo,e)}function yi(e,t,n){var r=e.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=n;var o=e.baseQueue,i=r.pending;if(null!==i){if(null!==o){var s=o.next;o.next=i.next,i.next=s}t.baseQueue=o=i,r.pending=null}if(i=e.baseState,null===o)e.memoizedState=i;else{var l=s=null,c=null,d=t=o.next,u=!1;do{var m=-536870913&d.lane;if(m!==d.lane?(bc&m)===m:(Vo&m)===m){var p=d.revertLane;if(0===p)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),m===Hr&&(u=!0);else{if((Vo&p)===p){d=d.next,p===Hr&&(u=!0);continue}m={lane:0,revertLane:d.revertLane,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=m,s=i):c=c.next=m,Ho.lanes|=p,Nc|=p}m=d.action,Yo&&n(i,m),i=d.hasEagerState?d.eagerState:n(i,m)}else p={lane:m,revertLane:d.revertLane,gesture:d.gesture,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=p,s=i):c=c.next=p,Ho.lanes|=m,Nc|=m;d=d.next}while(null!==d&&d!==t);if(null===c?s=i:c.next=l,!ea(i,e.memoizedState)&&(Rs=!0,u&&null!==(n=Wr)))throw n;e.memoizedState=i,e.baseState=s,e.baseQueue=c,r.lastRenderedState=i}return null===o&&(r.lanes=0),[e.memoizedState,r.dispatch]}function bi(e){var t=ui(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{i=e(i,s.action),s=s.next}while(s!==o);ea(i,t.memoizedState)||(Rs=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function vi(e,t,n){var r=Ho,o=ui(),i=pr;if(i){if(void 0===n)throw Error(a(407));n=n()}else n=t();var s=!ea((Wo||o).memoizedState,n);if(s&&(o.memoizedState=n,Rs=!0),o=o.queue,Vi(_i.bind(null,r,o,e),[e]),o.getSnapshot!==t||s||null!==Go&&1&Go.memoizedState.tag){if(r.flags|=2048,zi(9,{destroy:void 0},wi.bind(null,r,o,n,t),null),null===gc)throw Error(a(349));i||127&Vo||xi(r,t,n)}return n}function xi(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Ho.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Ho.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function wi(e,t,n,a){t.value=n,t.getSnapshot=a,ki(t)&&Si(e)}function _i(e,t,n){return n(function(){ki(t)&&Si(e)})}function ki(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ea(e,n)}catch(a){return!0}}function Si(e){var t=Ra(e,2);null!==t&&Yc(t,e,2)}function Ci(e){var t=di();if("function"==typeof e){var n=e;if(e=n(),Yo){we(!0);try{n()}finally{we(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fi,lastRenderedState:e},t}function Ni(e,t,n,a){return e.baseState=n,yi(e,Wo,"function"==typeof a?a:fi)}function ji(e,t,n,r,o){if(hs(e))throw Error(a(485));if(null!==(e=t.action)){var i={payload:o,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){i.listeners.push(e)}};null!==O.T?n(!0):i.isTransition=!1,r(i),null===(n=t.pending)?(i.next=t.pending=i,Ti(t,i)):(i.next=n.next,t.pending=n.next=i)}}function Ti(e,t){var n=t.action,a=t.payload,r=e.state;if(t.isTransition){var o=O.T,i={};O.T=i;try{var s=n(r,a),l=O.S;null!==l&&l(i,s),Ii(e,t,s)}catch(c){Ei(e,t,c)}finally{null!==o&&null!==i.types&&(o.types=i.types),O.T=o}}else try{Ii(e,t,o=n(r,a))}catch(d){Ei(e,t,d)}}function Ii(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){Di(e,t,n)},function(n){return Ei(e,t,n)}):Di(e,t,n)}function Di(e,t,n){t.status="fulfilled",t.value=n,Li(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Ti(e,n)))}function Ei(e,t,n){var a=e.pending;if(e.pending=null,null!==a){a=a.next;do{t.status="rejected",t.reason=n,Li(t),t=t.next}while(t!==a)}e.action=null}function Li(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ai(e,t){return t}function Pi(e,t){if(pr){var n=gc.formState;if(null!==n){e:{var a=Ho;if(pr){if(mr){t:{for(var r=mr,o=fr;8!==r.nodeType;){if(!o){r=null;break t}if(null===(r=Ru(r.nextSibling))){r=null;break t}}r="F!"===(o=r.data)||"F"===o?r:null}if(r){mr=Ru(r.nextSibling),a="F!"===r.data;break e}}yr(a)}a=!1}a&&(t=n[0])}}return(n=di()).memoizedState=n.baseState=t,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ai,lastRenderedState:t},n.queue=a,n=us.bind(null,Ho,a),a.dispatch=n,a=Ci(!1),o=ps.bind(null,Ho,!1,a.queue),r={state:t,dispatch:null,action:e,pending:null},(a=di()).queue=r,n=ji.bind(null,Ho,r,o,n),r.dispatch=n,a.memoizedState=e,[t,n,!1]}function Ri(e){return Oi(ui(),Wo,e)}function Oi(e,t,n){if(t=yi(e,t,Ai)[0],e=gi(fi)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var a=mi(t)}catch(i){if(i===Xr)throw to;throw i}else a=t;var r=(t=ui()).queue,o=r.dispatch;return n!==t.memoizedState&&(Ho.flags|=2048,zi(9,{destroy:void 0},Mi.bind(null,r,n),null)),[a,o,e]}function Mi(e,t){e.action=t}function qi(e){var t=ui(),n=Wo;if(null!==n)return Oi(t,n,e);ui(),t=t.memoizedState;var a=(n=ui()).queue.dispatch;return n.memoizedState=e,[t,a,!1]}function zi(e,t,n,a){return e={tag:e,create:n,deps:a,inst:t,next:null},null===(t=Ho.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Ho.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(a=n.next,n.next=e,e.next=a,t.lastEffect=e),e}function Fi(){return ui().memoizedState}function Bi(e,t,n,a){var r=di();Ho.flags|=e,r.memoizedState=zi(1|t,{destroy:void 0},n,void 0===a?null:a)}function Ui(e,t,n,a){var r=ui();a=void 0===a?null:a;var o=r.memoizedState.inst;null!==Wo&&null!==a&&ni(a,Wo.memoizedState.deps)?r.memoizedState=zi(t,o,n,a):(Ho.flags|=e,r.memoizedState=zi(1|t,o,n,a))}function $i(e,t){Bi(8390656,8,e,t)}function Vi(e,t){Ui(2048,8,e,t)}function Hi(e){var t=ui().memoizedState;return function(e){Ho.flags|=4;var t=Ho.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Ho.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(2&fc)throw Error(a(440));return t.impl.apply(void 0,arguments)}}function Wi(e,t){return Ui(4,2,e,t)}function Gi(e,t){return Ui(4,4,e,t)}function Ki(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Qi(e,t,n){n=null!=n?n.concat([e]):null,Ui(4,4,Ki.bind(null,t,e),n)}function Yi(){}function Ji(e,t){var n=ui();t=void 0===t?null:t;var a=n.memoizedState;return null!==t&&ni(t,a[1])?a[0]:(n.memoizedState=[e,t],e)}function Zi(e,t){var n=ui();t=void 0===t?null:t;var a=n.memoizedState;if(null!==t&&ni(t,a[1]))return a[0];if(a=e(),Yo){we(!0);try{e()}finally{we(!1)}}return n.memoizedState=[a,t],a}function Xi(e,t,n){return void 0===n||1073741824&Vo&&!(261930&bc)?e.memoizedState=t:(e.memoizedState=n,e=Qc(),Ho.lanes|=e,Nc|=e,n)}function es(e,t,n,a){return ea(n,t)?n:null!==Do.current?(e=Xi(e,n,a),ea(e,t)||(Rs=!0),e):42&Vo&&(!(1073741824&Vo)||261930&bc)?(e=Qc(),Ho.lanes|=e,Nc|=e,t):(Rs=!0,e.memoizedState=n)}function ts(e,t,n,a,r){var o=M.p;M.p=0!==o&&8>o?o:8;var i,s,l,c=O.T,d={};O.T=d,ps(e,!1,t,n);try{var u=r(),m=O.S;if(null!==m&&m(d,u),null!==u&&"object"==typeof u&&"function"==typeof u.then)ms(e,t,(i=a,s=[],l={status:"pending",value:null,reason:null,then:function(e){s.push(e)}},u.then(function(){l.status="fulfilled",l.value=i;for(var e=0;e<s.length;e++)(0,s[e])(i)},function(e){for(l.status="rejected",l.reason=e,e=0;e<s.length;e++)(0,s[e])(void 0)}),l),Kc());else ms(e,t,a,Kc())}catch(p){ms(e,t,{then:function(){},status:"rejected",reason:p},Kc())}finally{M.p=o,null!==c&&null!==d.types&&(c.types=d.types),O.T=c}}function ns(){}function as(e,t,n,r){if(5!==e.tag)throw Error(a(476));var o=rs(e).queue;ts(e,o,t,q,null===n?ns:function(){return os(e),n(r)})}function rs(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:q,baseState:q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fi,lastRenderedState:q},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fi,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function os(e){var t=rs(e);null===t.next&&(t=e.alternate.memoizedState),ms(e,t.next.queue,{},Kc())}function is(){return Pr(mm)}function ss(){return ui().memoizedState}function ls(){return ui().memoizedState}function cs(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Kc(),a=_o(t,e=wo(n),n);return null!==a&&(Yc(a,t,n),ko(a,t,n)),t={cache:Br()},void(e.payload=t)}t=t.return}}function ds(e,t,n){var a=Kc();n={lane:a,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},hs(e)?fs(t,n):null!==(n=Pa(e,t,n,a))&&(Yc(n,e,a),gs(n,t,a))}function us(e,t,n){ms(e,t,n,Kc())}function ms(e,t,n,a){var r={lane:a,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(hs(e))fs(t,r);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var i=t.lastRenderedState,s=o(i,n);if(r.hasEagerState=!0,r.eagerState=s,ea(s,i))return Aa(e,t,r,0),null===gc&&La(),!1}catch(l){}if(null!==(n=Pa(e,t,r,a)))return Yc(n,e,a),gs(n,t,a),!0}return!1}function ps(e,t,n,r){if(r={lane:2,revertLane:Vd(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},hs(e)){if(t)throw Error(a(479))}else null!==(t=Pa(e,n,r,2))&&Yc(t,e,2)}function hs(e){var t=e.alternate;return e===Ho||null!==t&&t===Ho}function fs(e,t){Qo=Ko=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function gs(e,t,n){if(4194048&n){var a=t.lanes;n|=a&=e.pendingLanes,t.lanes=n,Oe(e,n)}}var ys={readContext:Pr,use:pi,useCallback:ti,useContext:ti,useEffect:ti,useImperativeHandle:ti,useLayoutEffect:ti,useInsertionEffect:ti,useMemo:ti,useReducer:ti,useRef:ti,useState:ti,useDebugValue:ti,useDeferredValue:ti,useTransition:ti,useSyncExternalStore:ti,useId:ti,useHostTransitionStatus:ti,useFormState:ti,useActionState:ti,useOptimistic:ti,useMemoCache:ti,useCacheRefresh:ti};ys.useEffectEvent=ti;var bs={readContext:Pr,use:pi,useCallback:function(e,t){return di().memoizedState=[e,void 0===t?null:t],e},useContext:Pr,useEffect:$i,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,Bi(4194308,4,Ki.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Bi(4194308,4,e,t)},useInsertionEffect:function(e,t){Bi(4,2,e,t)},useMemo:function(e,t){var n=di();t=void 0===t?null:t;var a=e();if(Yo){we(!0);try{e()}finally{we(!1)}}return n.memoizedState=[a,t],a},useReducer:function(e,t,n){var a=di();if(void 0!==n){var r=n(t);if(Yo){we(!0);try{n(t)}finally{we(!1)}}}else r=t;return a.memoizedState=a.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},a.queue=e,e=e.dispatch=ds.bind(null,Ho,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},di().memoizedState=e},useState:function(e){var t=(e=Ci(e)).queue,n=us.bind(null,Ho,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Yi,useDeferredValue:function(e,t){return Xi(di(),e,t)},useTransition:function(){var e=Ci(!1);return e=ts.bind(null,Ho,e.queue,!0,!1),di().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Ho,o=di();if(pr){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===gc)throw Error(a(349));127&bc||xi(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,$i(_i.bind(null,r,i,e),[e]),r.flags|=2048,zi(9,{destroy:void 0},wi.bind(null,r,i,n,t),null),n},useId:function(){var e=di(),t=gc.identifierPrefix;if(pr){var n=or;t="_"+t+"R_"+(n=(rr&~(1<<32-_e(rr)-1)).toString(32)+n),0<(n=Jo++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=ei++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:is,useFormState:Pi,useActionState:Pi,useOptimistic:function(e){var t=di();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ps.bind(null,Ho,!0,n),n.dispatch=t,[e,t]},useMemoCache:hi,useCacheRefresh:function(){return di().memoizedState=cs.bind(null,Ho)},useEffectEvent:function(e){var t=di(),n={impl:e};return t.memoizedState=n,function(){if(2&fc)throw Error(a(440));return n.impl.apply(void 0,arguments)}}},vs={readContext:Pr,use:pi,useCallback:Ji,useContext:Pr,useEffect:Vi,useImperativeHandle:Qi,useInsertionEffect:Wi,useLayoutEffect:Gi,useMemo:Zi,useReducer:gi,useRef:Fi,useState:function(){return gi(fi)},useDebugValue:Yi,useDeferredValue:function(e,t){return es(ui(),Wo.memoizedState,e,t)},useTransition:function(){var e=gi(fi)[0],t=ui().memoizedState;return["boolean"==typeof e?e:mi(e),t]},useSyncExternalStore:vi,useId:ss,useHostTransitionStatus:is,useFormState:Ri,useActionState:Ri,useOptimistic:function(e,t){return Ni(ui(),0,e,t)},useMemoCache:hi,useCacheRefresh:ls};vs.useEffectEvent=Hi;var xs={readContext:Pr,use:pi,useCallback:Ji,useContext:Pr,useEffect:Vi,useImperativeHandle:Qi,useInsertionEffect:Wi,useLayoutEffect:Gi,useMemo:Zi,useReducer:bi,useRef:Fi,useState:function(){return bi(fi)},useDebugValue:Yi,useDeferredValue:function(e,t){var n=ui();return null===Wo?Xi(n,e,t):es(n,Wo.memoizedState,e,t)},useTransition:function(){var e=bi(fi)[0],t=ui().memoizedState;return["boolean"==typeof e?e:mi(e),t]},useSyncExternalStore:vi,useId:ss,useHostTransitionStatus:is,useFormState:qi,useActionState:qi,useOptimistic:function(e,t){var n=ui();return null!==Wo?Ni(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:hi,useCacheRefresh:ls};function ws(e,t,n,a){n=null==(n=n(a,t=e.memoizedState))?t:d({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}xs.useEffectEvent=Hi;var _s={enqueueSetState:function(e,t,n){e=e._reactInternals;var a=Kc(),r=wo(a);r.payload=t,null!=n&&(r.callback=n),null!==(t=_o(e,r,a))&&(Yc(t,e,a),ko(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var a=Kc(),r=wo(a);r.tag=1,r.payload=t,null!=n&&(r.callback=n),null!==(t=_o(e,r,a))&&(Yc(t,e,a),ko(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Kc(),a=wo(n);a.tag=2,null!=t&&(a.callback=t),null!==(t=_o(e,a,n))&&(Yc(t,e,n),ko(t,e,n))}};function ks(e,t,n,a,r,o,i){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,o,i):!t.prototype||!t.prototype.isPureReactComponent||(!ta(n,a)||!ta(r,o))}function Ss(e,t,n,a){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,a),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,a),t.state!==e&&_s.enqueueReplaceState(t,t.state,null)}function Cs(e,t){var n=t;if("ref"in t)for(var a in n={},t)"ref"!==a&&(n[a]=t[a]);if(e=e.defaultProps)for(var r in n===t&&(n=d({},n)),e)void 0===n[r]&&(n[r]=e[r]);return n}function Ns(e){Ta(e)}function js(e){}function Ts(e){Ta(e)}function Is(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Ds(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(a){setTimeout(function(){throw a})}}function Es(e,t,n){return(n=wo(n)).tag=3,n.payload={element:null},n.callback=function(){Is(e,t)},n}function Ls(e){return(e=wo(e)).tag=3,e}function As(e,t,n,a){var r=n.type.getDerivedStateFromError;if("function"==typeof r){var o=a.value;e.payload=function(){return r(o)},e.callback=function(){Ds(t,n,a)}}var i=n.stateNode;null!==i&&"function"==typeof i.componentDidCatch&&(e.callback=function(){Ds(t,n,a),"function"!=typeof r&&(null===qc?qc=new Set([this]):qc.add(this));var e=a.stack;this.componentDidCatch(a.value,{componentStack:null!==e?e:""})})}var Ps=Error(a(461)),Rs=!1;function Os(e,t,n,a){t.child=null===e?yo(t,null,n,a):go(t,e.child,n,a)}function Ms(e,t,n,a,r){n=n.render;var o=t.ref;if("ref"in a){var i={};for(var s in a)"ref"!==s&&(i[s]=a[s])}else i=a;return Ar(t),a=ai(e,t,n,i,o,r),s=si(),null===e||Rs?(pr&&s&&lr(t),t.flags|=1,Os(e,t,a,r),t.child):(li(e,t,r),il(e,t,r))}function qs(e,t,n,a,r){if(null===e){var o=n.type;return"function"!=typeof o||Ba(o)||void 0!==o.defaultProps||null!==n.compare?((e=Va(n.type,null,a,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,zs(e,t,o,a,r))}if(o=e.child,!sl(e,r)){var i=o.memoizedProps;if((n=null!==(n=n.compare)?n:ta)(i,a)&&e.ref===t.ref)return il(e,t,r)}return t.flags|=1,(e=Ua(o,a)).ref=t.ref,e.return=t,t.child=e}function zs(e,t,n,a,r){if(null!==e){var o=e.memoizedProps;if(ta(o,a)&&e.ref===t.ref){if(Rs=!1,t.pendingProps=a=o,!sl(e,r))return t.lanes=e.lanes,il(e,t,r);131072&e.flags&&(Rs=!0)}}return Ws(e,t,n,a,r)}function Fs(e,t,n,a){var r=a.children,o=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===a.mode){if(128&t.flags){if(o=null!==o?o.baseLanes|n:n,null!==e){for(a=t.child=e.child,r=0;null!==a;)r=r|a.lanes|a.childLanes,a=a.sibling;a=r&~o}else a=0,t.child=null;return Us(e,t,o,n,a)}if(!(536870912&n))return a=t.lanes=536870912,Us(e,t,null!==o?o.baseLanes|n:n,n,a);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Jr(0,null!==o?o.cachePool:null),null!==o?Lo(t,o):Ao(),zo(t)}else null!==o?(Jr(0,o.cachePool),Lo(t,o),Fo(),t.memoizedState=null):(null!==e&&Jr(0,null),Ao(),Fo());return Os(e,t,r,n),t.child}function Bs(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Us(e,t,n,a,r){var o=Yr();return o=null===o?null:{parent:Fr._currentValue,pool:o},t.memoizedState={baseLanes:n,cachePool:o},null!==e&&Jr(0,null),Ao(),zo(t),null!==e&&Er(e,t,a,!0),t.childLanes=r,null}function $s(e,t){return(t=tl({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Vs(e,t,n){return go(t,e.child,null,n),(e=$s(t,t.pendingProps)).flags|=2,Bo(t),t.memoizedState=null,e}function Hs(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof n&&"object"!=typeof n)throw Error(a(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Ws(e,t,n,a,r){return Ar(t),n=ai(e,t,n,a,void 0,r),a=si(),null===e||Rs?(pr&&a&&lr(t),t.flags|=1,Os(e,t,n,r),t.child):(li(e,t,r),il(e,t,r))}function Gs(e,t,n,a,r,o){return Ar(t),t.updateQueue=null,n=oi(t,a,n,r),ri(e),a=si(),null===e||Rs?(pr&&a&&lr(t),t.flags|=1,Os(e,t,n,o),t.child):(li(e,t,o),il(e,t,o))}function Ks(e,t,n,a,r){if(Ar(t),null===t.stateNode){var o=qa,i=n.contextType;"object"==typeof i&&null!==i&&(o=Pr(i)),o=new n(a,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=_s,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=a,o.state=t.memoizedState,o.refs={},vo(t),i=n.contextType,o.context="object"==typeof i&&null!==i?Pr(i):qa,o.state=t.memoizedState,"function"==typeof(i=n.getDerivedStateFromProps)&&(ws(t,n,i,a),o.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(i=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),i!==o.state&&_s.enqueueReplaceState(o,o.state,null),jo(t,a,o,r),No(),o.state=t.memoizedState),"function"==typeof o.componentDidMount&&(t.flags|=4194308),a=!0}else if(null===e){o=t.stateNode;var s=t.memoizedProps,l=Cs(n,s);o.props=l;var c=o.context,d=n.contextType;i=qa,"object"==typeof d&&null!==d&&(i=Pr(d));var u=n.getDerivedStateFromProps;d="function"==typeof u||"function"==typeof o.getSnapshotBeforeUpdate,s=t.pendingProps!==s,d||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s||c!==i)&&Ss(t,o,a,i),bo=!1;var m=t.memoizedState;o.state=m,jo(t,a,o,r),No(),c=t.memoizedState,s||m!==c||bo?("function"==typeof u&&(ws(t,n,u,a),c=t.memoizedState),(l=bo||ks(t,n,l,a,m,c,i))?(d||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),o.props=a,o.state=c,o.context=i,a=l):("function"==typeof o.componentDidMount&&(t.flags|=4194308),a=!1)}else{o=t.stateNode,xo(e,t),d=Cs(n,i=t.memoizedProps),o.props=d,u=t.pendingProps,m=o.context,c=n.contextType,l=qa,"object"==typeof c&&null!==c&&(l=Pr(c)),(c="function"==typeof(s=n.getDerivedStateFromProps)||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(i!==u||m!==l)&&Ss(t,o,a,l),bo=!1,m=t.memoizedState,o.state=m,jo(t,a,o,r),No();var p=t.memoizedState;i!==u||m!==p||bo||null!==e&&null!==e.dependencies&&Lr(e.dependencies)?("function"==typeof s&&(ws(t,n,s,a),p=t.memoizedState),(d=bo||ks(t,n,d,a,m,p,l)||null!==e&&null!==e.dependencies&&Lr(e.dependencies))?(c||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(a,p,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(a,p,l)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=p),o.props=a,o.state=p,o.context=l,a=d):("function"!=typeof o.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),a=!1)}return o=a,Hs(e,t),a=!!(128&t.flags),o||a?(o=t.stateNode,n=a&&"function"!=typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&a?(t.child=go(t,e.child,null,r),t.child=go(t,null,n,r)):Os(e,t,n,r),t.memoizedState=o.state,e=t.child):e=il(e,t,r),e}function Qs(e,t,n,a){return wr(),t.flags|=256,Os(e,t,n,a),t.child}var Ys={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Js(e){return{baseLanes:e,cachePool:Zr()}}function Zs(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Ic),e}function Xs(e,t,n){var r,o=t.pendingProps,i=!1,s=!!(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&!!(2&Uo.current)),r&&(i=!0,t.flags&=-129),r=!!(32&t.flags),t.flags&=-33,null===e){if(pr){if(i?Mo(t):Fo(),(e=mr)?null!==(e=null!==(e=Lu(e,fr))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ar?{id:rr,overflow:or}:null,retryLane:536870912,hydrationErrors:null},(n=Ga(e)).return=t,t.child=n,ur=t,mr=null):e=null,null===e)throw yr(t);return Pu(e)?t.lanes=32:t.lanes=536870912,null}var l=o.children;return o=o.fallback,i?(Fo(),l=tl({mode:"hidden",children:l},i=t.mode),o=Ha(o,i,n,null),l.return=t,o.return=t,l.sibling=o,t.child=l,(o=t.child).memoizedState=Js(n),o.childLanes=Zs(e,r,n),t.memoizedState=Ys,Bs(null,o)):(Mo(t),el(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(s)256&t.flags?(Mo(t),t.flags&=-257,t=nl(e,t,n)):null!==t.memoizedState?(Fo(),t.child=e.child,t.flags|=128,t=null):(Fo(),l=o.fallback,i=t.mode,o=tl({mode:"visible",children:o.children},i),(l=Ha(l,i,n,null)).flags|=2,o.return=t,l.return=t,o.sibling=l,t.child=o,go(t,e.child,null,n),(o=t.child).memoizedState=Js(n),o.childLanes=Zs(e,r,n),t.memoizedState=Ys,t=Bs(null,o));else if(Mo(t),Pu(l)){if(r=l.nextSibling&&l.nextSibling.dataset)var d=r.dgst;r=d,(o=Error(a(419))).stack="",o.digest=r,kr({value:o,source:null,stack:null}),t=nl(e,t,n)}else if(Rs||Er(e,t,n,!1),r=0!==(n&e.childLanes),Rs||r){if(null!==(r=gc)&&(0!==(o=Me(r,n))&&o!==c.retryLane))throw c.retryLane=o,Ra(e,o),Yc(r,e,o),Ps;Au(l)||ld(),t=nl(e,t,n)}else Au(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,mr=Ru(l.nextSibling),ur=t,pr=!0,hr=null,fr=!1,null!==e&&dr(t,e),(t=el(t,o.children)).flags|=4096);return t}return i?(Fo(),l=o.fallback,i=t.mode,d=(c=e.child).sibling,(o=Ua(c,{mode:"hidden",children:o.children})).subtreeFlags=65011712&c.subtreeFlags,null!==d?l=Ua(d,l):(l=Ha(l,i,n,null)).flags|=2,l.return=t,o.return=t,o.sibling=l,t.child=o,Bs(null,o),o=t.child,null===(l=e.child.memoizedState)?l=Js(n):(null!==(i=l.cachePool)?(c=Fr._currentValue,i=i.parent!==c?{parent:c,pool:c}:i):i=Zr(),l={baseLanes:l.baseLanes|n,cachePool:i}),o.memoizedState=l,o.childLanes=Zs(e,r,n),t.memoizedState=Ys,Bs(e.child,o)):(Mo(t),e=(n=e.child).sibling,(n=Ua(n,{mode:"visible",children:o.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function el(e,t){return(t=tl({mode:"visible",children:t},e.mode)).return=e,e.child=t}function tl(e,t){return(e=Fa(22,e,null,t)).lanes=0,e}function nl(e,t,n){return go(t,e.child,null,n),(e=el(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function al(e,t,n){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),Ir(e.return,t,n)}function rl(e,t,n,a,r,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:n,tailMode:r,treeForkCount:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=a,i.tail=n,i.tailMode=r,i.treeForkCount=o)}function ol(e,t,n){var a=t.pendingProps,r=a.revealOrder,o=a.tail;a=a.children;var i=Uo.current,s=!!(2&i);if(s?(i=1&i|2,t.flags|=128):i&=1,$(Uo,i),Os(e,t,a,n),a=pr?er:0,!s&&null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&al(e,n,t);else if(19===e.tag)al(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===$o(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),rl(t,!1,r,n,o,a);break;case"backwards":case"unstable_legacy-backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===$o(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}rl(t,!0,n,null,o,a);break;case"together":rl(t,!1,null,null,void 0,a);break;default:t.memoizedState=null}return t.child}function il(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Nc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Er(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Ua(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ua(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function sl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Lr(e))}function ll(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Rs=!0;else{if(!(sl(e,n)||128&t.flags))return Rs=!1,function(e,t,n){switch(t.tag){case 3:Y(t,t.stateNode.containerInfo),jr(0,Fr,e.memoizedState.cache),wr();break;case 27:case 5:Z(t);break;case 4:Y(t,t.stateNode.containerInfo);break;case 10:jr(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,qo(t),null;break;case 13:var a=t.memoizedState;if(null!==a)return null!==a.dehydrated?(Mo(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Xs(e,t,n):(Mo(t),null!==(e=il(e,t,n))?e.sibling:null);Mo(t);break;case 19:var r=!!(128&e.flags);if((a=0!==(n&t.childLanes))||(Er(e,t,n,!1),a=0!==(n&t.childLanes)),r){if(a)return ol(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),$(Uo,Uo.current),a)break;return null;case 22:return t.lanes=0,Fs(e,t,n,t.pendingProps);case 24:jr(0,Fr,e.memoizedState.cache)}return il(e,t,n)}(e,t,n);Rs=!!(131072&e.flags)}else Rs=!1,pr&&1048576&t.flags&&sr(t,er,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=oo(t.elementType),t.type=e,"function"!=typeof e){if(null!=e){var o=e.$$typeof;if(o===_){t.tag=11,t=Ms(null,t,e,r,n);break e}if(o===N){t.tag=14,t=qs(null,t,e,r,n);break e}}throw t=P(e)||e,Error(a(306,t,""))}Ba(e)?(r=Cs(e,r),t.tag=1,t=Ks(null,t,e,r,n)):(t.tag=0,t=Ws(null,t,e,r,n))}return t;case 0:return Ws(e,t,t.type,t.pendingProps,n);case 1:return Ks(e,t,r=t.type,o=Cs(r,t.pendingProps),n);case 3:e:{if(Y(t,t.stateNode.containerInfo),null===e)throw Error(a(387));r=t.pendingProps;var i=t.memoizedState;o=i.element,xo(e,t),jo(t,r,null,n);var s=t.memoizedState;if(r=s.cache,jr(0,Fr,r),r!==i.cache&&Dr(t,[Fr],n,!0),No(),r=s.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Qs(e,t,r,n);break e}if(r!==o){kr(o=Ya(Error(a(424)),t)),t=Qs(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(mr=Ru(e.firstChild),ur=t,pr=!0,hr=null,fr=!0,n=yo(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(wr(),r===o){t=il(e,t,n);break e}Os(e,t,r,n)}t=t.child}return t;case 26:return Hs(e,t),null===e?(n=Gu(t.type,null,t.pendingProps,null))?t.memoizedState=n:pr||(n=t.type,e=t.pendingProps,(r=bu(K.current).createElement(n))[$e]=t,r[Ve]=e,hu(r,n,e),nt(r),t.stateNode=r):t.memoizedState=Gu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Z(t),null===e&&pr&&(r=t.stateNode=zu(t.type,t.pendingProps,K.current),ur=t,fr=!0,o=mr,Tu(t.type)?(Ou=o,mr=Ru(r.firstChild)):mr=o),Os(e,t,t.pendingProps.children,n),Hs(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&pr&&((o=r=mr)&&(null!==(r=function(e,t,n,a){for(;1===e.nodeType;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!a&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(a){if(!e[Ye])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==r.rel||e.getAttribute("href")!==(null==r.href||""===r.href?null:r.href)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin)||e.getAttribute("title")!==(null==r.title?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==r.src?null:r.src)||e.getAttribute("type")!==(null==r.type?null:r.type)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==r.name?null:""+r.name;if("hidden"===r.type&&e.getAttribute("name")===o)return e}if(null===(e=Ru(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,fr))?(t.stateNode=r,ur=t,mr=Ru(r.firstChild),fr=!1,o=!0):o=!1),o||yr(t)),Z(t),o=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,r=i.children,wu(o,i)?r=null:null!==s&&wu(o,s)&&(t.flags|=32),null!==t.memoizedState&&(o=ai(e,t,ii,null,null,n),mm._currentValue=o),Hs(e,t),Os(e,t,r,n),t.child;case 6:return null===e&&pr&&((e=n=mr)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Ru(e.nextSibling)))return null}return e}(n,t.pendingProps,fr))?(t.stateNode=n,ur=t,mr=null,e=!0):e=!1),e||yr(t)),null;case 13:return Xs(e,t,n);case 4:return Y(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=go(t,null,r,n):Os(e,t,r,n),t.child;case 11:return Ms(e,t,t.type,t.pendingProps,n);case 7:return Os(e,t,t.pendingProps,n),t.child;case 8:case 12:return Os(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,jr(0,t.type,r.value),Os(e,t,r.children,n),t.child;case 9:return o=t.type._context,r=t.pendingProps.children,Ar(t),r=r(o=Pr(o)),t.flags|=1,Os(e,t,r,n),t.child;case 14:return qs(e,t,t.type,t.pendingProps,n);case 15:return zs(e,t,t.type,t.pendingProps,n);case 19:return ol(e,t,n);case 31:return function(e,t,n){var r=t.pendingProps,o=!!(128&t.flags);if(t.flags&=-129,null===e){if(pr){if("hidden"===r.mode)return e=$s(t,r),t.lanes=536870912,Bs(null,e);if(qo(t),(e=mr)?null!==(e=null!==(e=Lu(e,fr))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ar?{id:rr,overflow:or}:null,retryLane:536870912,hydrationErrors:null},(n=Ga(e)).return=t,t.child=n,ur=t,mr=null):e=null,null===e)throw yr(t);return t.lanes=536870912,null}return $s(t,r)}var i=e.memoizedState;if(null!==i){var s=i.dehydrated;if(qo(t),o)if(256&t.flags)t.flags&=-257,t=Vs(e,t,n);else{if(null===t.memoizedState)throw Error(a(558));t.child=e.child,t.flags|=128,t=null}else if(Rs||Er(e,t,n,!1),o=0!==(n&e.childLanes),Rs||o){if(null!==(r=gc)&&0!==(s=Me(r,n))&&s!==i.retryLane)throw i.retryLane=s,Ra(e,s),Yc(r,e,s),Ps;ld(),t=Vs(e,t,n)}else e=i.treeContext,mr=Ru(s.nextSibling),ur=t,pr=!0,hr=null,fr=!1,null!==e&&dr(t,e),(t=$s(t,r)).flags|=4096;return t}return(e=Ua(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Fs(e,t,n,t.pendingProps);case 24:return Ar(t),r=Pr(Fr),null===e?(null===(o=Yr())&&(o=gc,i=Br(),o.pooledCache=i,i.refCount++,null!==i&&(o.pooledCacheLanes|=n),o=i),t.memoizedState={parent:r,cache:o},vo(t),jr(0,Fr,o)):(0!==(e.lanes&n)&&(xo(e,t),jo(t,null,null,n),No()),o=e.memoizedState,i=t.memoizedState,o.parent!==r?(o={parent:r,cache:r},t.memoizedState=o,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=o),jr(0,Fr,r)):(r=i.cache,jr(0,Fr,r),r!==o.cache&&Dr(t,[Fr],n,!0))),Os(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function cl(e){e.flags|=4}function dl(e,t,n,a,r){if((t=!!(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&r)===r)if(e.stateNode.complete)e.flags|=8192;else{if(!od())throw io=no,eo;e.flags|=8192}}else e.flags&=-16777217}function ul(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!im(t)){if(!od())throw io=no,eo;e.flags|=8192}}function ml(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Le():536870912,e.lanes|=t,Dc|=t)}function pl(e,t){if(!pr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var a=null;null!==n;)null!==n.alternate&&(a=n),n=n.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function hl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,a=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,a|=65011712&r.subtreeFlags,a|=65011712&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,a|=r.subtreeFlags,a|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=a,e.childLanes=n,t}function fl(e,t,n){var r=t.pendingProps;switch(cr(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return hl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Tr(Fr),J(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(xr(t)?cl(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,_r())),hl(t),null;case 26:var o=t.type,i=t.memoizedState;return null===e?(cl(t),null!==i?(hl(t),ul(t,i)):(hl(t),dl(t,o,0,0,n))):i?i!==e.memoizedState?(cl(t),hl(t),ul(t,i)):(hl(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&cl(t),hl(t),dl(t,o,0,0,n)),null;case 27:if(X(t),n=K.current,o=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&cl(t);else{if(!r){if(null===t.stateNode)throw Error(a(166));return hl(t),null}e=W.current,xr(t)?br(t):(e=zu(o,r,n),t.stateNode=e,cl(t))}return hl(t),null;case 5:if(X(t),o=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&cl(t);else{if(!r){if(null===t.stateNode)throw Error(a(166));return hl(t),null}if(i=W.current,xr(t))br(t);else{var s=bu(K.current);switch(i){case 1:i=s.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:i=s.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":i=s.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":i=s.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":(i=s.createElement("div")).innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i="string"==typeof r.is?s.createElement("select",{is:r.is}):s.createElement("select"),r.multiple?i.multiple=!0:r.size&&(i.size=r.size);break;default:i="string"==typeof r.is?s.createElement(o,{is:r.is}):s.createElement(o)}}i[$e]=t,i[Ve]=r;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)i.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=i;e:switch(hu(i,o,r),o){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&cl(t)}}return hl(t),dl(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&cl(t);else{if("string"!=typeof r&&null===t.stateNode)throw Error(a(166));if(e=K.current,xr(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(o=ur))switch(o.tag){case 27:case 5:r=o.memoizedProps}e[$e]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||uu(e.nodeValue,n)))||yr(t,!0)}else(e=bu(e).createTextNode(r))[$e]=t,t.stateNode=e}return hl(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(r=xr(t),null!==n){if(null===e){if(!r)throw Error(a(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(557));e[$e]=t}else wr(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),e=!1}else n=_r(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(Bo(t),t):(Bo(t),null);if(128&t.flags)throw Error(a(558))}return hl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(o=xr(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[$e]=t}else wr(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),o=!1}else o=_r(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=o),o=!0;if(!o)return 256&t.flags?(Bo(t),t):(Bo(t),null)}return Bo(t),128&t.flags?(t.lanes=n,t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(o=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(o=r.alternate.memoizedState.cachePool.pool),i=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(i=r.memoizedState.cachePool.pool),i!==o&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),ml(t,t.updateQueue),hl(t),null);case 4:return J(),null===e&&tu(t.stateNode.containerInfo),hl(t),null;case 10:return Tr(t.type),hl(t),null;case 19:if(U(Uo),null===(r=t.memoizedState))return hl(t),null;if(o=!!(128&t.flags),null===(i=r.rendering))if(o)pl(r,!1);else{if(0!==Cc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(i=$o(e))){for(t.flags|=128,pl(r,!1),e=i.updateQueue,t.updateQueue=e,ml(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)$a(n,e),n=n.sibling;return $(Uo,1&Uo.current|2),pr&&ir(t,r.treeForkCount),t.child}e=e.sibling}null!==r.tail&&de()>Oc&&(t.flags|=128,o=!0,pl(r,!1),t.lanes=4194304)}else{if(!o)if(null!==(e=$o(i))){if(t.flags|=128,o=!0,e=e.updateQueue,t.updateQueue=e,ml(t,e),pl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!i.alternate&&!pr)return hl(t),null}else 2*de()-r.renderingStartTime>Oc&&536870912!==n&&(t.flags|=128,o=!0,pl(r,!1),t.lanes=4194304);r.isBackwards?(i.sibling=t.child,t.child=i):(null!==(e=r.last)?e.sibling=i:t.child=i,r.last=i)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=de(),e.sibling=null,n=Uo.current,$(Uo,o?1&n|2:1&n),pr&&ir(t,r.treeForkCount),e):(hl(t),null);case 22:case 23:return Bo(t),Po(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?!!(536870912&n)&&!(128&t.flags)&&(hl(t),6&t.subtreeFlags&&(t.flags|=8192)):hl(t),null!==(n=t.updateQueue)&&ml(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&U(Qr),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Tr(Fr),hl(t),null;case 25:case 30:return null}throw Error(a(156,t.tag))}function gl(e,t){switch(cr(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Tr(Fr),J(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return X(t),null;case 31:if(null!==t.memoizedState){if(Bo(t),null===t.alternate)throw Error(a(340));wr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Bo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));wr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return U(Uo),null;case 4:return J(),null;case 10:return Tr(t.type),null;case 22:case 23:return Bo(t),Po(),null!==e&&U(Qr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Tr(Fr),null;default:return null}}function yl(e,t){switch(cr(t),t.tag){case 3:Tr(Fr),J();break;case 26:case 27:case 5:X(t);break;case 4:J();break;case 31:null!==t.memoizedState&&Bo(t);break;case 13:Bo(t);break;case 19:U(Uo);break;case 10:Tr(t.type);break;case 22:case 23:Bo(t),Po(),null!==e&&U(Qr);break;case 24:Tr(Fr)}}function bl(e,t){try{var n=t.updateQueue,a=null!==n?n.lastEffect:null;if(null!==a){var r=a.next;n=r;do{if((n.tag&e)===e){a=void 0;var o=n.create,i=n.inst;a=o(),i.destroy=a}n=n.next}while(n!==r)}}catch(s){Cd(t,t.return,s)}}function vl(e,t,n){try{var a=t.updateQueue,r=null!==a?a.lastEffect:null;if(null!==r){var o=r.next;a=o;do{if((a.tag&e)===e){var i=a.inst,s=i.destroy;if(void 0!==s){i.destroy=void 0,r=t;var l=n,c=s;try{c()}catch(d){Cd(r,l,d)}}}a=a.next}while(a!==o)}}catch(d){Cd(t,t.return,d)}}function xl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Io(t,n)}catch(a){Cd(e,e.return,a)}}}function wl(e,t,n){n.props=Cs(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(a){Cd(e,t,a)}}function _l(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var a=e.stateNode;break;default:a=e.stateNode}"function"==typeof n?e.refCleanup=n(a):n.current=a}}catch(r){Cd(e,t,r)}}function kl(e,t){var n=e.ref,a=e.refCleanup;if(null!==n)if("function"==typeof a)try{a()}catch(r){Cd(e,t,r)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{n(null)}catch(o){Cd(e,t,o)}else n.current=null}function Sl(e){var t=e.type,n=e.memoizedProps,a=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&a.focus();break e;case"img":n.src?a.src=n.src:n.srcSet&&(a.srcset=n.srcSet)}}catch(r){Cd(e,e.return,r)}}function Cl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var o=null,i=null,s=null,l=null,c=null,d=null,u=null;for(h in n){var m=n[h];if(n.hasOwnProperty(h)&&null!=m)switch(h){case"checked":case"value":break;case"defaultValue":c=m;default:r.hasOwnProperty(h)||mu(e,t,h,null,r,m)}}for(var p in r){var h=r[p];if(m=n[p],r.hasOwnProperty(p)&&(null!=h||null!=m))switch(p){case"type":i=h;break;case"name":o=h;break;case"checked":d=h;break;case"defaultChecked":u=h;break;case"value":s=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(a(137,t));break;default:h!==m&&mu(e,t,p,h,r,m)}}return void xt(e,s,l,c,d,u,i,o);case"select":for(i in h=s=l=p=null,n)if(c=n[i],n.hasOwnProperty(i)&&null!=c)switch(i){case"value":break;case"multiple":h=c;default:r.hasOwnProperty(i)||mu(e,t,i,null,r,c)}for(o in r)if(i=r[o],c=n[o],r.hasOwnProperty(o)&&(null!=i||null!=c))switch(o){case"value":p=i;break;case"defaultValue":l=i;break;case"multiple":s=i;default:i!==c&&mu(e,t,o,i,r,c)}return t=l,n=s,r=h,void(null!=p?kt(e,!!n,p,!1):!!r!=!!n&&(null!=t?kt(e,!!n,t,!0):kt(e,!!n,n?[]:"",!1)));case"textarea":for(l in h=p=null,n)if(o=n[l],n.hasOwnProperty(l)&&null!=o&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:mu(e,t,l,null,r,o)}for(s in r)if(o=r[s],i=n[s],r.hasOwnProperty(s)&&(null!=o||null!=i))switch(s){case"value":p=o;break;case"defaultValue":h=o;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=o)throw Error(a(91));break;default:o!==i&&mu(e,t,s,o,r,i)}return void St(e,p,h);case"option":for(var f in n)if(p=n[f],n.hasOwnProperty(f)&&null!=p&&!r.hasOwnProperty(f))if("selected"===f)e.selected=!1;else mu(e,t,f,null,r,p);for(c in r)if(p=r[c],h=n[c],r.hasOwnProperty(c)&&p!==h&&(null!=p||null!=h))if("selected"===c)e.selected=p&&"function"!=typeof p&&"symbol"!=typeof p;else mu(e,t,c,p,r,h);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)p=n[g],n.hasOwnProperty(g)&&null!=p&&!r.hasOwnProperty(g)&&mu(e,t,g,null,r,p);for(d in r)if(p=r[d],h=n[d],r.hasOwnProperty(d)&&p!==h&&(null!=p||null!=h))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(a(137,t));break;default:mu(e,t,d,p,r,h)}return;default:if(Dt(t)){for(var y in n)p=n[y],n.hasOwnProperty(y)&&void 0!==p&&!r.hasOwnProperty(y)&&pu(e,t,y,void 0,r,p);for(u in r)p=r[u],h=n[u],!r.hasOwnProperty(u)||p===h||void 0===p&&void 0===h||pu(e,t,u,p,r,h);return}}for(var b in n)p=n[b],n.hasOwnProperty(b)&&null!=p&&!r.hasOwnProperty(b)&&mu(e,t,b,null,r,p);for(m in r)p=r[m],h=n[m],!r.hasOwnProperty(m)||p===h||null==p&&null==h||mu(e,t,m,p,r,h)}(r,e.type,n,t),r[Ve]=t}catch(o){Cd(e,e.return,o)}}function Nl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Tu(e.type)||4===e.tag}function jl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Nl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Tu(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Tl(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Pt));else if(4!==a&&(27===a&&Tu(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Tl(e,t,n),e=e.sibling;null!==e;)Tl(e,t,n),e=e.sibling}function Il(e,t,n){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==a&&(27===a&&Tu(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Il(e,t,n),e=e.sibling;null!==e;)Il(e,t,n),e=e.sibling}function Dl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var a=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);hu(t,a,n),t[$e]=e,t[Ve]=n}catch(o){Cd(e,e.return,o)}}var El=!1,Ll=!1,Al=!1,Pl="function"==typeof WeakSet?WeakSet:Set,Rl=null;function Ol(e,t,n){var a=n.flags;switch(n.tag){case 0:case 11:case 15:Yl(e,n),4&a&&bl(5,n);break;case 1:if(Yl(e,n),4&a)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(i){Cd(n,n.return,i)}else{var r=Cs(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){Cd(n,n.return,s)}}64&a&&xl(n),512&a&&_l(n,n.return);break;case 3:if(Yl(e,n),64&a&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Io(e,t)}catch(i){Cd(n,n.return,i)}}break;case 27:null===t&&4&a&&Dl(n);case 26:case 5:Yl(e,n),null===t&&4&a&&Sl(n),512&a&&_l(n,n.return);break;case 12:Yl(e,n);break;case 31:Yl(e,n),4&a&&Ul(e,n);break;case 13:Yl(e,n),4&a&&$l(e,n),64&a&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var a=function(){t(),n.removeEventListener("DOMContentLoaded",a)};n.addEventListener("DOMContentLoaded",a),e._reactRetry=a}}(e,n=Id.bind(null,n))));break;case 22:if(!(a=null!==n.memoizedState||El)){t=null!==t&&null!==t.memoizedState||Ll,r=El;var o=Ll;El=a,(Ll=t)&&!o?Zl(e,n,!!(8772&n.subtreeFlags)):Yl(e,n),El=r,Ll=o}break;case 30:break;default:Yl(e,n)}}function Ml(e){var t=e.alternate;null!==t&&(e.alternate=null,Ml(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Je(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var ql=null,zl=!1;function Fl(e,t,n){for(n=n.child;null!==n;)Bl(e,t,n),n=n.sibling}function Bl(e,t,n){if(xe&&"function"==typeof xe.onCommitFiberUnmount)try{xe.onCommitFiberUnmount(ve,n)}catch(o){}switch(n.tag){case 26:Ll||kl(n,t),Fl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Ll||kl(n,t);var a=ql,r=zl;Tu(n.type)&&(ql=n.stateNode,zl=!1),Fl(e,t,n),Fu(n.stateNode),ql=a,zl=r;break;case 5:Ll||kl(n,t);case 6:if(a=ql,r=zl,ql=null,Fl(e,t,n),zl=r,null!==(ql=a))if(zl)try{(9===ql.nodeType?ql.body:"HTML"===ql.nodeName?ql.ownerDocument.body:ql).removeChild(n.stateNode)}catch(i){Cd(n,t,i)}else try{ql.removeChild(n.stateNode)}catch(i){Cd(n,t,i)}break;case 18:null!==ql&&(zl?(Iu(9===(e=ql).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Wm(e)):Iu(ql,n.stateNode));break;case 4:a=ql,r=zl,ql=n.stateNode.containerInfo,zl=!0,Fl(e,t,n),ql=a,zl=r;break;case 0:case 11:case 14:case 15:vl(2,n,t),Ll||vl(4,n,t),Fl(e,t,n);break;case 1:Ll||(kl(n,t),"function"==typeof(a=n.stateNode).componentWillUnmount&&wl(n,t,a)),Fl(e,t,n);break;case 21:Fl(e,t,n);break;case 22:Ll=(a=Ll)||null!==n.memoizedState,Fl(e,t,n),Ll=a;break;default:Fl(e,t,n)}}function Ul(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Wm(e)}catch(n){Cd(t,t.return,n)}}}function $l(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Wm(e)}catch(n){Cd(t,t.return,n)}}function Vl(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Pl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Pl),t;default:throw Error(a(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var a=Dd.bind(null,e,t);t.then(a,a)}})}function Hl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r],i=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 27:if(Tu(l.type)){ql=l.stateNode,zl=!1;break e}break;case 5:ql=l.stateNode,zl=!1;break e;case 3:case 4:ql=l.stateNode.containerInfo,zl=!0;break e}l=l.return}if(null===ql)throw Error(a(160));Bl(i,s,o),ql=null,zl=!1,null!==(i=o.alternate)&&(i.return=null),o.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Gl(t,e),t=t.sibling}var Wl=null;function Gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Hl(t,e),Kl(e),4&r&&(vl(3,e,e.return),bl(3,e),vl(5,e,e.return));break;case 1:Hl(t,e),Kl(e),512&r&&(Ll||null===n||kl(n,n.return)),64&r&&El&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var o=Wl;if(Hl(t,e),Kl(e),512&r&&(Ll||null===n||kl(n,n.return)),4&r){var i=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,o=o.ownerDocument||o;t:switch(r){case"title":(!(i=o.getElementsByTagName("title")[0])||i[Ye]||i[$e]||"http://www.w3.org/2000/svg"===i.namespaceURI||i.hasAttribute("itemprop"))&&(i=o.createElement(r),o.head.insertBefore(i,o.querySelector("head > title"))),hu(i,r,n),i[$e]=e,nt(i),r=i;break e;case"link":var s=rm("link","href",o).get(r+(n.href||""));if(s)for(var l=0;l<s.length;l++)if((i=s[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&i.getAttribute("rel")===(null==n.rel?null:n.rel)&&i.getAttribute("title")===(null==n.title?null:n.title)&&i.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(l,1);break t}hu(i=o.createElement(r),r,n),o.head.appendChild(i);break;case"meta":if(s=rm("meta","content",o).get(r+(n.content||"")))for(l=0;l<s.length;l++)if((i=s[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&i.getAttribute("name")===(null==n.name?null:n.name)&&i.getAttribute("property")===(null==n.property?null:n.property)&&i.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&i.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(l,1);break t}hu(i=o.createElement(r),r,n),o.head.appendChild(i);break;default:throw Error(a(468,r))}i[$e]=e,nt(i),r=i}e.stateNode=r}else om(o,e.type,e.stateNode);else e.stateNode=Xu(o,r,e.memoizedProps);else i!==r?(null===i?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):i.count--,null===r?om(o,e.type,e.stateNode):Xu(o,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Cl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Hl(t,e),Kl(e),512&r&&(Ll||null===n||kl(n,n.return)),null!==n&&4&r&&Cl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Hl(t,e),Kl(e),512&r&&(Ll||null===n||kl(n,n.return)),32&e.flags){o=e.stateNode;try{Nt(o,"")}catch(f){Cd(e,e.return,f)}}4&r&&null!=e.stateNode&&Cl(e,o=e.memoizedProps,null!==n?n.memoizedProps:o),1024&r&&(Al=!0);break;case 6:if(Hl(t,e),Kl(e),4&r){if(null===e.stateNode)throw Error(a(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(f){Cd(e,e.return,f)}}break;case 3:if(am=null,o=Wl,Wl=$u(t.containerInfo),Hl(t,e),Wl=o,Kl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Wm(t.containerInfo)}catch(f){Cd(e,e.return,f)}Al&&(Al=!1,Ql(e));break;case 4:r=Wl,Wl=$u(e.stateNode.containerInfo),Hl(t,e),Kl(e),Wl=r;break;case 12:default:Hl(t,e),Kl(e);break;case 31:case 19:Hl(t,e),Kl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Vl(e,r)));break;case 13:Hl(t,e),Kl(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(Pc=de()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Vl(e,r)));break;case 22:o=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,d=El,u=Ll;if(El=d||o,Ll=u||c,Hl(t,e),Ll=u,El=d,Kl(e),8192&r)e:for(t=e.stateNode,t._visibility=o?-2&t._visibility:1|t._visibility,o&&(null===n||c||El||Ll||Jl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(i=c.stateNode,o)"function"==typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{l=c.stateNode;var m=c.memoizedProps.style,p=null!=m&&m.hasOwnProperty("display")?m.display:null;l.style.display=null==p||"boolean"==typeof p?"":(""+p).trim()}}catch(f){Cd(c,c.return,f)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=o?"":c.memoizedProps}catch(f){Cd(c,c.return,f)}}}else if(18===t.tag){if(null===n){c=t;try{var h=c.stateNode;o?Du(h,!0):Du(c.stateNode,!1)}catch(f){Cd(c,c.return,f)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Vl(e,n))));case 30:case 21:}}function Kl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(Nl(r)){n=r;break}r=r.return}if(null==n)throw Error(a(160));switch(n.tag){case 27:var o=n.stateNode;Il(e,jl(e),o);break;case 5:var i=n.stateNode;32&n.flags&&(Nt(i,""),n.flags&=-33),Il(e,jl(e),i);break;case 3:case 4:var s=n.stateNode.containerInfo;Tl(e,jl(e),s);break;default:throw Error(a(161))}}catch(l){Cd(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ql(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ql(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Yl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Ol(e,t.alternate,t),t=t.sibling}function Jl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:vl(4,t,t.return),Jl(t);break;case 1:kl(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&wl(t,t.return,n),Jl(t);break;case 27:Fu(t.stateNode);case 26:case 5:kl(t,t.return),Jl(t);break;case 22:null===t.memoizedState&&Jl(t);break;default:Jl(t)}e=e.sibling}}function Zl(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var a=t.alternate,r=e,o=t,i=o.flags;switch(o.tag){case 0:case 11:case 15:Zl(r,o,n),bl(4,o);break;case 1:if(Zl(r,o,n),"function"==typeof(r=(a=o).stateNode).componentDidMount)try{r.componentDidMount()}catch(c){Cd(a,a.return,c)}if(null!==(r=(a=o).updateQueue)){var s=a.stateNode;try{var l=r.shared.hiddenCallbacks;if(null!==l)for(r.shared.hiddenCallbacks=null,r=0;r<l.length;r++)To(l[r],s)}catch(c){Cd(a,a.return,c)}}n&&64&i&&xl(o),_l(o,o.return);break;case 27:Dl(o);case 26:case 5:Zl(r,o,n),n&&null===a&&4&i&&Sl(o),_l(o,o.return);break;case 12:Zl(r,o,n);break;case 31:Zl(r,o,n),n&&4&i&&Ul(r,o);break;case 13:Zl(r,o,n),n&&4&i&&$l(r,o);break;case 22:null===o.memoizedState&&Zl(r,o,n),_l(o,o.return);break;case 30:break;default:Zl(r,o,n)}t=t.sibling}}function Xl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Ur(n))}function ec(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ur(e))}function tc(e,t,n,a){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)nc(e,t,n,a),t=t.sibling}function nc(e,t,n,a){var r=t.flags;switch(t.tag){case 0:case 11:case 15:tc(e,t,n,a),2048&r&&bl(9,t);break;case 1:case 31:case 13:default:tc(e,t,n,a);break;case 3:tc(e,t,n,a),2048&r&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ur(e)));break;case 12:if(2048&r){tc(e,t,n,a),e=t.stateNode;try{var o=t.memoizedProps,i=o.id,s=o.onPostCommit;"function"==typeof s&&s(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Cd(t,t.return,l)}}else tc(e,t,n,a);break;case 23:break;case 22:o=t.stateNode,i=t.alternate,null!==t.memoizedState?2&o._visibility?tc(e,t,n,a):rc(e,t):2&o._visibility?tc(e,t,n,a):(o._visibility|=2,ac(e,t,n,a,!!(10256&t.subtreeFlags)||!1)),2048&r&&Xl(i,t);break;case 24:tc(e,t,n,a),2048&r&&ec(t.alternate,t)}}function ac(e,t,n,a,r){for(r=r&&(!!(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var o=e,i=t,s=n,l=a,c=i.flags;switch(i.tag){case 0:case 11:case 15:ac(o,i,s,l,r),bl(8,i);break;case 23:break;case 22:var d=i.stateNode;null!==i.memoizedState?2&d._visibility?ac(o,i,s,l,r):rc(o,i):(d._visibility|=2,ac(o,i,s,l,r)),r&&2048&c&&Xl(i.alternate,i);break;case 24:ac(o,i,s,l,r),r&&2048&c&&ec(i.alternate,i);break;default:ac(o,i,s,l,r)}t=t.sibling}}function rc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,a=t,r=a.flags;switch(a.tag){case 22:rc(n,a),2048&r&&Xl(a.alternate,a);break;case 24:rc(n,a),2048&r&&ec(a.alternate,a);break;default:rc(n,a)}t=t.sibling}}var oc=8192;function ic(e,t,n){if(e.subtreeFlags&oc)for(e=e.child;null!==e;)sc(e,t,n),e=e.sibling}function sc(e,t,n){switch(e.tag){case 26:ic(e,t,n),e.flags&oc&&null!==e.memoizedState&&function(e,t,n,a){if(!("stylesheet"!==n.type||"string"==typeof a.media&&!1===matchMedia(a.media).matches||4&n.state.loading)){if(null===n.instance){var r=Ku(a.href),o=t.querySelector(Qu(r));if(o)return null!==(t=o._p)&&"object"==typeof t&&"function"==typeof t.then&&(e.count++,e=lm.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=o,void nt(o);o=t.ownerDocument||t,a=Yu(a),(r=Bu.get(r))&&tm(a,r),nt(o=o.createElement("link"));var i=o;i._p=new Promise(function(e,t){i.onload=e,i.onerror=t}),hu(o,"link",a),n.instance=o}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&!(3&n.state.loading)&&(e.count++,n=lm.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Wl,e.memoizedState,e.memoizedProps);break;case 5:default:ic(e,t,n);break;case 3:case 4:var a=Wl;Wl=$u(e.stateNode.containerInfo),ic(e,t,n),Wl=a;break;case 22:null===e.memoizedState&&(null!==(a=e.alternate)&&null!==a.memoizedState?(a=oc,oc=16777216,ic(e,t,n),oc=a):ic(e,t,n))}}function lc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function cc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var a=t[n];Rl=a,mc(a,e)}lc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)dc(e),e=e.sibling}function dc(e){switch(e.tag){case 0:case 11:case 15:cc(e),2048&e.flags&&vl(9,e,e.return);break;case 3:case 12:default:cc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,uc(e)):cc(e)}}function uc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var a=t[n];Rl=a,mc(a,e)}lc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:vl(8,t,t.return),uc(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,uc(t));break;default:uc(t)}e=e.sibling}}function mc(e,t){for(;null!==Rl;){var n=Rl;switch(n.tag){case 0:case 11:case 15:vl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var a=n.memoizedState.cachePool.pool;null!=a&&a.refCount++}break;case 24:Ur(n.memoizedState.cache)}if(null!==(a=n.child))a.return=n,Rl=a;else e:for(n=e;null!==Rl;){var r=(a=Rl).sibling,o=a.return;if(Ml(a),a===n){Rl=null;break e}if(null!==r){r.return=o,Rl=r;break e}Rl=o}}}var pc={getCacheForType:function(e){var t=Pr(Fr),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Pr(Fr).controller.signal}},hc="function"==typeof WeakMap?WeakMap:Map,fc=0,gc=null,yc=null,bc=0,vc=0,xc=null,wc=!1,_c=!1,kc=!1,Sc=0,Cc=0,Nc=0,jc=0,Tc=0,Ic=0,Dc=0,Ec=null,Lc=null,Ac=!1,Pc=0,Rc=0,Oc=1/0,Mc=null,qc=null,zc=0,Fc=null,Bc=null,Uc=0,$c=0,Vc=null,Hc=null,Wc=0,Gc=null;function Kc(){return 2&fc&&0!==bc?bc&-bc:null!==O.T?Vd():Fe()}function Qc(){if(0===Ic)if(536870912&bc&&!pr)Ic=536870912;else{var e=Ne;!(3932160&(Ne<<=1))&&(Ne=262144),Ic=e}return null!==(e=Ro.current)&&(e.flags|=32),Ic}function Yc(e,t,n){(e!==gc||2!==vc&&9!==vc)&&null===e.cancelPendingCommit||(ad(e,0),ed(e,bc,Ic,!1)),Pe(e,n),2&fc&&e===gc||(e===gc&&(!(2&fc)&&(jc|=n),4===Cc&&ed(e,bc,Ic,!1)),Md(e))}function Jc(e,t,n){if(6&fc)throw Error(a(327));for(var r=!n&&!(127&t)&&0===(t&e.expiredLanes)||De(e,t),o=r?function(e,t){var n=fc;fc|=2;var r=id(),o=sd();gc!==e||bc!==t?(Mc=null,Oc=de()+500,ad(e,t)):_c=De(e,t);e:for(;;)try{if(0!==vc&&null!==yc){t=yc;var i=xc;t:switch(vc){case 1:vc=0,xc=null,hd(e,t,i,1);break;case 2:case 9:if(ao(i)){vc=0,xc=null,pd(t);break}t=function(){2!==vc&&9!==vc||gc!==e||(vc=7),Md(e)},i.then(t,t);break e;case 3:vc=7;break e;case 4:vc=5;break e;case 7:ao(i)?(vc=0,xc=null,pd(t)):(vc=0,xc=null,hd(e,t,i,7));break;case 5:var s=null;switch(yc.tag){case 26:s=yc.memoizedState;case 5:case 27:var l=yc;if(s?im(s):l.stateNode.complete){vc=0,xc=null;var c=l.sibling;if(null!==c)yc=c;else{var d=l.return;null!==d?(yc=d,fd(d)):yc=null}break t}}vc=0,xc=null,hd(e,t,i,5);break;case 6:vc=0,xc=null,hd(e,t,i,6);break;case 8:nd(),Cc=6;break e;default:throw Error(a(462))}}ud();break}catch(u){rd(e,u)}return Nr=Cr=null,O.H=r,O.A=o,fc=n,null!==yc?0:(gc=null,bc=0,La(),Cc)}(e,t):cd(e,t,!0),i=r;;){if(0===o){_c&&!r&&ed(e,t,0,!1);break}if(n=e.current.alternate,!i||Xc(n)){if(2===o){if(i=t,e.errorRecoveryDisabledLanes&i)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var l=e;o=Ec;var c=l.current.memoizedState.isDehydrated;if(c&&(ad(l,s).flags|=256),2!==(s=cd(l,s,!1))){if(kc&&!c){l.errorRecoveryDisabledLanes|=i,jc|=i,o=4;break e}i=Lc,Lc=o,null!==i&&(null===Lc?Lc=i:Lc.push.apply(Lc,i))}o=s}if(i=!1,2!==o)continue}}if(1===o){ad(e,0),ed(e,t,0,!0);break}e:{switch(r=e,i=o){case 0:case 1:throw Error(a(345));case 4:if((4194048&t)!==t)break;case 6:ed(r,t,Ic,!wc);break e;case 2:Lc=null;break;case 3:case 5:break;default:throw Error(a(329))}if((62914560&t)===t&&10<(o=Pc+300-de())){if(ed(r,t,Ic,!wc),0!==Ie(r,0,!0))break e;Uc=t,r.timeoutHandle=ku(Zc.bind(null,r,n,Lc,Mc,Ac,t,Ic,jc,Dc,wc,i,"Throttled",-0,0),o)}else Zc(r,n,Lc,Mc,Ac,t,Ic,jc,Dc,wc,i,null,-0,0)}break}o=cd(e,t,!1),i=!1}Md(e)}function Zc(e,t,n,a,r,o,i,s,l,c,d,u,m,p){if(e.timeoutHandle=-1,8192&(u=t.subtreeFlags)||!(16785408&~u)){sc(t,o,u={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pt});var h=(62914560&o)===o?Pc-de():(4194048&o)===o?Rc-de():0;if(null!==(h=function(e,t){return e.stylesheets&&0===e.count&&dm(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var a=setTimeout(function(){if(e.stylesheets&&dm(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sm&&(sm=62500*function(){if("function"==typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),a=0;a<n.length;a++){var r=n[a],o=r.transferSize,i=r.initiatorType,s=r.duration;if(o&&s&&fu(i)){for(i=0,s=r.responseEnd,a+=1;a<n.length;a++){var l=n[a],c=l.startTime;if(c>s)break;var d=l.transferSize,u=l.initiatorType;d&&fu(u)&&(i+=d*((l=l.responseEnd)<s?1:(s-c)/(l-c)))}if(--a,t+=8*(o+i)/(r.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"==typeof(e=navigator.connection.downlink)?e:5}());var r=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&dm(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sm?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(a),clearTimeout(r)}}:null}(u,h)))return Uc=o,e.cancelPendingCommit=h(yd.bind(null,e,t,o,n,a,r,i,s,l,d,u,null,m,p)),void ed(e,o,i,!c)}yd(e,t,o,n,a,r,i,s,l)}function Xc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var a=0;a<n.length;a++){var r=n[a],o=r.getSnapshot;r=r.value;try{if(!ea(o(),r))return!1}catch(i){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ed(e,t,n,a){t&=~Tc,t&=~jc,e.suspendedLanes|=t,e.pingedLanes&=~t,a&&(e.warmLanes|=t),a=e.expirationTimes;for(var r=t;0<r;){var o=31-_e(r),i=1<<o;a[o]=-1,r&=~i}0!==n&&Re(e,n,t)}function td(){return!!(6&fc)||(qd(0),!1)}function nd(){if(null!==yc){if(0===vc)var e=yc.return;else Nr=Cr=null,ci(e=yc),co=null,uo=0,e=yc;for(;null!==e;)yl(e.alternate,e),e=e.return;yc=null}}function ad(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,Su(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Uc=0,nd(),gc=e,yc=n=Ua(e.current,null),bc=t,vc=0,xc=null,wc=!1,_c=De(e,t),kc=!1,Dc=Ic=Tc=jc=Nc=Cc=0,Lc=Ec=null,Ac=!1,8&t&&(t|=32&t);var a=e.entangledLanes;if(0!==a)for(e=e.entanglements,a&=t;0<a;){var r=31-_e(a),o=1<<r;t|=e[r],a&=~o}return Sc=t,La(),n}function rd(e,t){Ho=null,O.H=ys,t===Xr||t===to?(t=so(),vc=3):t===eo?(t=so(),vc=4):vc=t===Ps?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,xc=t,null===yc&&(Cc=1,Is(e,Ya(t,e.current)))}function od(){var e=Ro.current;return null===e||((4194048&bc)===bc?null===Oo:!!((62914560&bc)===bc||536870912&bc)&&e===Oo)}function id(){var e=O.H;return O.H=ys,null===e?ys:e}function sd(){var e=O.A;return O.A=pc,e}function ld(){Cc=4,wc||(4194048&bc)!==bc&&null!==Ro.current||(_c=!0),!(134217727&Nc)&&!(134217727&jc)||null===gc||ed(gc,bc,Ic,!1)}function cd(e,t,n){var a=fc;fc|=2;var r=id(),o=sd();gc===e&&bc===t||(Mc=null,ad(e,t)),t=!1;var i=Cc;e:for(;;)try{if(0!==vc&&null!==yc){var s=yc,l=xc;switch(vc){case 8:nd(),i=6;break e;case 3:case 2:case 9:case 6:null===Ro.current&&(t=!0);var c=vc;if(vc=0,xc=null,hd(e,s,l,c),n&&_c){i=0;break e}break;default:c=vc,vc=0,xc=null,hd(e,s,l,c)}}dd(),i=Cc;break}catch(d){rd(e,d)}return t&&e.shellSuspendCounter++,Nr=Cr=null,fc=a,O.H=r,O.A=o,null===yc&&(gc=null,bc=0,La()),i}function dd(){for(;null!==yc;)md(yc)}function ud(){for(;null!==yc&&!le();)md(yc)}function md(e){var t=ll(e.alternate,e,Sc);e.memoizedProps=e.pendingProps,null===t?fd(e):yc=t}function pd(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Gs(n,t,t.pendingProps,t.type,void 0,bc);break;case 11:t=Gs(n,t,t.pendingProps,t.type.render,t.ref,bc);break;case 5:ci(t);default:yl(n,t),t=ll(n,t=yc=$a(t,Sc),Sc)}e.memoizedProps=e.pendingProps,null===t?fd(e):yc=t}function hd(e,t,n,r){Nr=Cr=null,ci(t),co=null,uo=0;var o=t.return;try{if(function(e,t,n,r,o){if(n.flags|=32768,null!==r&&"object"==typeof r&&"function"==typeof r.then){if(null!==(t=n.alternate)&&Er(t,n,o,!0),null!==(n=Ro.current)){switch(n.tag){case 31:case 13:return null===Oo?ld():null===n.alternate&&0===Cc&&(Cc=3),n.flags&=-257,n.flags|=65536,n.lanes=o,r===no?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),Nd(e,r,o)),!1;case 22:return n.flags|=65536,r===no?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),Nd(e,r,o)),!1}throw Error(a(435,n.tag))}return Nd(e,r,o),ld(),!1}if(pr)return null!==(t=Ro.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=o,r!==gr&&kr(Ya(e=Error(a(422),{cause:r}),n))):(r!==gr&&kr(Ya(t=Error(a(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,o&=-o,e.lanes|=o,r=Ya(r,n),So(e,o=Es(e.stateNode,r,o)),4!==Cc&&(Cc=2)),!1;var i=Error(a(520),{cause:r});if(i=Ya(i,n),null===Ec?Ec=[i]:Ec.push(i),4!==Cc&&(Cc=2),null===t)return!0;r=Ya(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=o&-o,n.lanes|=e,So(n,e=Es(n.stateNode,r,e)),!1;case 1:if(t=n.type,i=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===i||"function"!=typeof i.componentDidCatch||null!==qc&&qc.has(i))))return n.flags|=65536,o&=-o,n.lanes|=o,As(o=Ls(o),e,n,r),So(n,o),!1}n=n.return}while(null!==n);return!1}(e,o,t,n,bc))return Cc=1,Is(e,Ya(n,e.current)),void(yc=null)}catch(i){if(null!==o)throw yc=o,i;return Cc=1,Is(e,Ya(n,e.current)),void(yc=null)}32768&t.flags?(pr||1===r?e=!0:_c||536870912&bc?e=!1:(wc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=Ro.current)&&13===r.tag&&(r.flags|=16384))),gd(t,e)):fd(t)}function fd(e){var t=e;do{if(32768&t.flags)return void gd(t,wc);e=t.return;var n=fl(t.alternate,t,Sc);if(null!==n)return void(yc=n);if(null!==(t=t.sibling))return void(yc=t);yc=t=e}while(null!==t);0===Cc&&(Cc=5)}function gd(e,t){do{var n=gl(e.alternate,e);if(null!==n)return n.flags&=32767,void(yc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(yc=e);yc=e=n}while(null!==e);Cc=6,yc=null}function yd(e,t,n,r,o,i,s,l,c){e.cancelPendingCommit=null;do{_d()}while(0!==zc);if(6&fc)throw Error(a(327));if(null!==t){if(t===e.current)throw Error(a(177));if(i=t.lanes|t.childLanes,function(e,t,n,a,r,o){var i=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=i&~n;0<n;){var d=31-_e(n),u=1<<d;s[d]=0,l[d]=-1;var m=c[d];if(null!==m)for(c[d]=null,d=0;d<m.length;d++){var p=m[d];null!==p&&(p.lane&=-536870913)}n&=~u}0!==a&&Re(e,a,0),0!==o&&0===r&&0!==e.tag&&(e.suspendedLanes|=o&~(i&~t))}(e,n,i|=Ea,s,l,c),e===gc&&(yc=gc=null,bc=0),Bc=t,Fc=e,Uc=n,$c=i,Vc=o,Hc=r,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,ie(he,function(){return kd(),null})):(e.callbackNode=null,e.callbackPriority=0),r=!!(13878&t.flags),13878&t.subtreeFlags||r){r=O.T,O.T=null,o=M.p,M.p=2,s=fc,fc|=4;try{!function(e,t){if(e=e.containerInfo,gu=wm,ia(e=oa(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(g){n=null;break e}var s=0,l=-1,c=-1,d=0,u=0,m=e,p=null;t:for(;;){for(var h;m!==n||0!==o&&3!==m.nodeType||(l=s+o),m!==i||0!==r&&3!==m.nodeType||(c=s+r),3===m.nodeType&&(s+=m.nodeValue.length),null!==(h=m.firstChild);)p=m,m=h;for(;;){if(m===e)break t;if(p===n&&++d===o&&(l=s),p===i&&++u===r&&(c=s),null!==(h=m.nextSibling))break;p=(m=p).parentNode}m=h}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(yu={focusedElem:e,selectionRange:n},wm=!1,Rl=t;null!==Rl;)if(e=(t=Rl).child,1028&t.subtreeFlags&&null!==e)e.return=t,Rl=e;else for(;null!==Rl;){switch(i=(t=Rl).alternate,e=t.flags,t.tag){case 0:if(4&e&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(o=e[n]).ref.impl=o.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==i){e=void 0,n=t,o=i.memoizedProps,i=i.memoizedState,r=n.stateNode;try{var f=Cs(n.type,o);e=r.getSnapshotBeforeUpdate(f,i),r.__reactInternalSnapshotBeforeUpdate=e}catch(y){Cd(n,n.return,y)}}break;case 3:if(1024&e)if(9===(n=(e=t.stateNode.containerInfo).nodeType))Eu(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Eu(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,Rl=e;break}Rl=t.return}}(e,t)}finally{fc=s,M.p=o,O.T=r}}zc=1,bd(),vd(),xd()}}function bd(){if(1===zc){zc=0;var e=Fc,t=Bc,n=!!(13878&t.flags);if(13878&t.subtreeFlags||n){n=O.T,O.T=null;var a=M.p;M.p=2;var r=fc;fc|=4;try{Gl(t,e);var o=yu,i=oa(e.containerInfo),s=o.focusedElem,l=o.selectionRange;if(i!==s&&s&&s.ownerDocument&&ra(s.ownerDocument.documentElement,s)){if(null!==l&&ia(s)){var c=l.start,d=l.end;if(void 0===d&&(d=c),"selectionStart"in s)s.selectionStart=c,s.selectionEnd=Math.min(d,s.value.length);else{var u=s.ownerDocument||document,m=u&&u.defaultView||window;if(m.getSelection){var p=m.getSelection(),h=s.textContent.length,f=Math.min(l.start,h),g=void 0===l.end?f:Math.min(l.end,h);!p.extend&&f>g&&(i=g,g=f,f=i);var y=aa(s,f),b=aa(s,g);if(y&&b&&(1!==p.rangeCount||p.anchorNode!==y.node||p.anchorOffset!==y.offset||p.focusNode!==b.node||p.focusOffset!==b.offset)){var v=u.createRange();v.setStart(y.node,y.offset),p.removeAllRanges(),f>g?(p.addRange(v),p.extend(b.node,b.offset)):(v.setEnd(b.node,b.offset),p.addRange(v))}}}}for(u=[],p=s;p=p.parentNode;)1===p.nodeType&&u.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"==typeof s.focus&&s.focus(),s=0;s<u.length;s++){var x=u[s];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}wm=!!gu,yu=gu=null}finally{fc=r,M.p=a,O.T=n}}e.current=t,zc=2}}function vd(){if(2===zc){zc=0;var e=Fc,t=Bc,n=!!(8772&t.flags);if(8772&t.subtreeFlags||n){n=O.T,O.T=null;var a=M.p;M.p=2;var r=fc;fc|=4;try{Ol(e,t.alternate,t)}finally{fc=r,M.p=a,O.T=n}}zc=3}}function xd(){if(4===zc||3===zc){zc=0,ce();var e=Fc,t=Bc,n=Uc,a=Hc;10256&t.subtreeFlags||10256&t.flags?zc=5:(zc=0,Bc=Fc=null,wd(e,e.pendingLanes));var r=e.pendingLanes;if(0===r&&(qc=null),ze(n),t=t.stateNode,xe&&"function"==typeof xe.onCommitFiberRoot)try{xe.onCommitFiberRoot(ve,t,void 0,!(128&~t.current.flags))}catch(l){}if(null!==a){t=O.T,r=M.p,M.p=2,O.T=null;try{for(var o=e.onRecoverableError,i=0;i<a.length;i++){var s=a[i];o(s.value,{componentStack:s.stack})}}finally{O.T=t,M.p=r}}3&Uc&&_d(),Md(e),r=e.pendingLanes,261930&n&&42&r?e===Gc?Wc++:(Wc=0,Gc=e):Wc=0,qd(0)}}function wd(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ur(t)))}function _d(){return bd(),vd(),xd(),kd()}function kd(){if(5!==zc)return!1;var e=Fc,t=$c;$c=0;var n=ze(Uc),r=O.T,o=M.p;try{M.p=32>n?32:n,O.T=null,n=Vc,Vc=null;var i=Fc,s=Uc;if(zc=0,Bc=Fc=null,Uc=0,6&fc)throw Error(a(331));var l=fc;if(fc|=4,dc(i.current),nc(i,i.current,s,n),fc=l,qd(0,!1),xe&&"function"==typeof xe.onPostCommitFiberRoot)try{xe.onPostCommitFiberRoot(ve,i)}catch(c){}return!0}finally{M.p=o,O.T=r,wd(e,t)}}function Sd(e,t,n){t=Ya(n,t),null!==(e=_o(e,t=Es(e.stateNode,t,2),2))&&(Pe(e,2),Md(e))}function Cd(e,t,n){if(3===e.tag)Sd(e,e,n);else for(;null!==t;){if(3===t.tag){Sd(t,e,n);break}if(1===t.tag){var a=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof a.componentDidCatch&&(null===qc||!qc.has(a))){e=Ya(n,e),null!==(a=_o(t,n=Ls(2),2))&&(As(n,a,t,e),Pe(a,2),Md(a));break}}t=t.return}}function Nd(e,t,n){var a=e.pingCache;if(null===a){a=e.pingCache=new hc;var r=new Set;a.set(t,r)}else void 0===(r=a.get(t))&&(r=new Set,a.set(t,r));r.has(n)||(kc=!0,r.add(n),e=jd.bind(null,e,t,n),t.then(e,e))}function jd(e,t,n){var a=e.pingCache;null!==a&&a.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,gc===e&&(bc&n)===n&&(4===Cc||3===Cc&&(62914560&bc)===bc&&300>de()-Pc?!(2&fc)&&ad(e,0):Tc|=n,Dc===bc&&(Dc=0)),Md(e)}function Td(e,t){0===t&&(t=Le()),null!==(e=Ra(e,t))&&(Pe(e,t),Md(e))}function Id(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Td(e,n)}function Dd(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==r&&r.delete(t),Td(e,n)}var Ed=null,Ld=null,Ad=!1,Pd=!1,Rd=!1,Od=0;function Md(e){e!==Ld&&null===e.next&&(null===Ld?Ed=Ld=e:Ld=Ld.next=e),Pd=!0,Ad||(Ad=!0,Nu(function(){6&fc?ie(me,zd):Fd()}))}function qd(e,t){if(!Rd&&Pd){Rd=!0;do{for(var n=!1,a=Ed;null!==a;){if(0!==e){var r=a.pendingLanes;if(0===r)var o=0;else{var i=a.suspendedLanes,s=a.pingedLanes;o=(1<<31-_e(42|e)+1)-1,o=201326741&(o&=r&~(i&~s))?201326741&o|1:o?2|o:0}0!==o&&(n=!0,$d(a,o))}else o=bc,!(3&(o=Ie(a,a===gc?o:0,null!==a.cancelPendingCommit||-1!==a.timeoutHandle)))||De(a,o)||(n=!0,$d(a,o));a=a.next}}while(n);Rd=!1}}function zd(){Fd()}function Fd(){Pd=Ad=!1;var e=0;0!==Od&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==_u&&(_u=e,!0);return _u=null,!1}()&&(e=Od);for(var t=de(),n=null,a=Ed;null!==a;){var r=a.next,o=Bd(a,t);0===o?(a.next=null,null===n?Ed=r:n.next=r,null===r&&(Ld=n)):(n=a,(0!==e||3&o)&&(Pd=!0)),a=r}0!==zc&&5!==zc||qd(e),0!==Od&&(Od=0)}function Bd(e,t){for(var n=e.suspendedLanes,a=e.pingedLanes,r=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var i=31-_e(o),s=1<<i,l=r[i];-1===l?0!==(s&n)&&0===(s&a)||(r[i]=Ee(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}if(n=bc,n=Ie(e,e===(t=gc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),a=e.callbackNode,0===n||e===t&&(2===vc||9===vc)||null!==e.cancelPendingCommit)return null!==a&&null!==a&&se(a),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||De(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==a&&se(a),ze(n)){case 2:case 8:n=pe;break;case 32:default:n=he;break;case 268435456:n=ge}return a=Ud.bind(null,e),n=ie(n,a),e.callbackPriority=t,e.callbackNode=n,t}return null!==a&&null!==a&&se(a),e.callbackPriority=2,e.callbackNode=null,2}function Ud(e,t){if(0!==zc&&5!==zc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(_d()&&e.callbackNode!==n)return null;var a=bc;return 0===(a=Ie(e,e===gc?a:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Jc(e,a,t),Bd(e,de()),null!=e.callbackNode&&e.callbackNode===n?Ud.bind(null,e):null)}function $d(e,t){if(_d())return null;Jc(e,t,!0)}function Vd(){if(0===Od){var e=Hr;0===e&&(e=Ce,!(261888&(Ce<<=1))&&(Ce=256)),Od=e}return Od}function Hd(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:At(""+e)}function Wd(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Gd=0;Gd<Na.length;Gd++){var Kd=Na[Gd];ja(Kd.toLowerCase(),"on"+(Kd[0].toUpperCase()+Kd.slice(1)))}ja(ba,"onAnimationEnd"),ja(va,"onAnimationIteration"),ja(xa,"onAnimationStart"),ja("dblclick","onDoubleClick"),ja("focusin","onFocus"),ja("focusout","onBlur"),ja(wa,"onTransitionRun"),ja(_a,"onTransitionStart"),ja(ka,"onTransitionCancel"),ja(Sa,"onTransitionEnd"),it("onMouseEnter",["mouseout","mouseover"]),it("onMouseLeave",["mouseout","mouseover"]),it("onPointerEnter",["pointerout","pointerover"]),it("onPointerLeave",["pointerout","pointerover"]),ot("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ot("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ot("onBeforeInput",["compositionend","keypress","textInput","paste"]),ot("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ot("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ot("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Qd));function Jd(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var a=e[n],r=a.event;a=a.listeners;e:{var o=void 0;if(t)for(var i=a.length-1;0<=i;i--){var s=a[i],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&r.isPropagationStopped())break e;o=s,r.currentTarget=c;try{o(r)}catch(d){Ta(d)}r.currentTarget=null,o=l}else for(i=0;i<a.length;i++){if(l=(s=a[i]).instance,c=s.currentTarget,s=s.listener,l!==o&&r.isPropagationStopped())break e;o=s,r.currentTarget=c;try{o(r)}catch(d){Ta(d)}r.currentTarget=null,o=l}}}}function Zd(e,t){var n=t[We];void 0===n&&(n=t[We]=new Set);var a=e+"__bubble";n.has(a)||(nu(t,e,2,!1),n.add(a))}function Xd(e,t,n){var a=0;t&&(a|=4),nu(n,e,a,t)}var eu="_reactListening"+Math.random().toString(36).slice(2);function tu(e){if(!e[eu]){e[eu]=!0,at.forEach(function(t){"selectionchange"!==t&&(Yd.has(t)||Xd(t,!1,e),Xd(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[eu]||(t[eu]=!0,Xd("selectionchange",!1,t))}}function nu(e,t,n,a){switch(Tm(t)){case 2:var r=_m;break;case 8:r=km;break;default:r=Sm}n=r.bind(null,t,n,e),r=void 0,!Vt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),a?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function au(e,t,n,a,r){var i=a;if(!(1&t||2&t||null===a))e:for(;;){if(null===a)return;var s=a.tag;if(3===s||4===s){var l=a.stateNode.containerInfo;if(l===r)break;if(4===s)for(s=a.return;null!==s;){var c=s.tag;if((3===c||4===c)&&s.stateNode.containerInfo===r)return;s=s.return}for(;null!==l;){if(null===(s=Ze(l)))return;if(5===(c=s.tag)||6===c||26===c||27===c){a=i=s;continue e}l=l.parentNode}}a=a.return}Bt(function(){var a=i,r=Ot(n),s=[];e:{var l=Ca.get(e);if(void 0!==l){var c=rn,d=e;switch(e){case"keypress":if(0===Yt(n))break e;case"keydown":case"keyup":c=xn;break;case"focusin":d="focus",c=un;break;case"focusout":d="blur",c=un;break;case"beforeblur":case"afterblur":c=un;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=cn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=dn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=_n;break;case ba:case va:case xa:c=mn;break;case Sa:c=kn;break;case"scroll":case"scrollend":c=sn;break;case"wheel":c=Sn;break;case"copy":case"cut":case"paste":c=pn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=wn;break;case"toggle":case"beforetoggle":c=Cn}var u=!!(4&t),m=!u&&("scroll"===e||"scrollend"===e),p=u?null!==l?l+"Capture":null:l;u=[];for(var h,f=a;null!==f;){var g=f;if(h=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===h||null===p||null!=(g=Ut(f,p))&&u.push(ru(f,g,h)),m)break;f=f.return}0<u.length&&(l=new c(l,d,null,n,r),s.push({event:l,listeners:u}))}}if(!(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||n===Rt||!(d=n.relatedTarget||n.fromElement)||!Ze(d)&&!d[He])&&(c||l)&&(l=r.window===r?r:(l=r.ownerDocument)?l.defaultView||l.parentWindow:window,c?(c=a,null!==(d=(d=n.relatedTarget||n.toElement)?Ze(d):null)&&(m=o(d),u=d.tag,d!==m||5!==u&&27!==u&&6!==u)&&(d=null)):(c=null,d=a),c!==d)){if(u=cn,g="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=wn,g="onPointerLeave",p="onPointerEnter",f="pointer"),m=null==c?l:et(c),h=null==d?l:et(d),(l=new u(g,f+"leave",c,n,r)).target=m,l.relatedTarget=h,g=null,Ze(r)===a&&((u=new u(p,f+"enter",d,n,r)).target=h,u.relatedTarget=m,g=u),m=g,c&&d)e:{for(u=iu,f=d,h=0,g=p=c;g;g=u(g))h++;g=0;for(var y=f;y;y=u(y))g++;for(;0<h-g;)p=u(p),h--;for(;0<g-h;)f=u(f),g--;for(;h--;){if(p===f||null!==f&&p===f.alternate){u=p;break e}p=u(p),f=u(f)}u=null}else u=null;null!==c&&su(s,l,c,u,!1),null!==d&&null!==m&&su(s,m,d,u,!0)}if("select"===(c=(l=a?et(a):window).nodeName&&l.nodeName.toLowerCase())||"input"===c&&"file"===l.type)var b=$n;else if(Mn(l))if(Vn)b=Xn;else{b=Jn;var v=Yn}else!(c=l.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==l.type&&"radio"!==l.type?a&&Dt(a.elementType)&&(b=$n):b=Zn;switch(b&&(b=b(e,a))?qn(s,b,n,r):(v&&v(e,l,a),"focusout"===e&&a&&"number"===l.type&&null!=a.memoizedProps.value&&_t(l,"number",l.value)),v=a?et(a):window,e){case"focusin":(Mn(v)||"true"===v.contentEditable)&&(la=v,ca=a,da=null);break;case"focusout":da=ca=la=null;break;case"mousedown":ua=!0;break;case"contextmenu":case"mouseup":case"dragend":ua=!1,ma(s,n,r);break;case"selectionchange":if(sa)break;case"keydown":case"keyup":ma(s,n,r)}var x;if(jn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Rn?An(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(Dn&&"ko"!==n.locale&&(Rn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Rn&&(x=Qt()):(Gt="value"in(Wt=r)?Wt.value:Wt.textContent,Rn=!0)),0<(v=ou(a,w)).length&&(w=new hn(w,e,null,n,r),s.push({event:w,listeners:v}),x?w.data=x:null!==(x=Pn(n))&&(w.data=x))),(x=In?function(e,t){switch(e){case"compositionend":return Pn(t);case"keypress":return 32!==t.which?null:(Ln=!0,En);case"textInput":return(e=t.data)===En&&Ln?null:e;default:return null}}(e,n):function(e,t){if(Rn)return"compositionend"===e||!jn&&An(e,t)?(e=Qt(),Kt=Gt=Wt=null,Rn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Dn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(w=ou(a,"onBeforeInput")).length&&(v=new hn("onBeforeInput","beforeinput",null,n,r),s.push({event:v,listeners:w}),v.data=x)),function(e,t,n,a,r){if("submit"===t&&n&&n.stateNode===r){var o=Hd((r[Ve]||null).action),i=a.submitter;i&&null!==(t=(t=i[Ve]||null)?Hd(t.formAction):i.getAttribute("formAction"))&&(o=t,i=null);var s=new rn("action","action",null,a,r);e.push({event:s,listeners:[{instance:null,listener:function(){if(a.defaultPrevented){if(0!==Od){var e=i?Wd(r,i):new FormData(r);as(n,{pending:!0,data:e,method:r.method,action:o},null,e)}}else"function"==typeof o&&(s.preventDefault(),e=i?Wd(r,i):new FormData(r),as(n,{pending:!0,data:e,method:r.method,action:o},o,e))},currentTarget:r}]})}}(s,e,a,n,r)}Jd(s,t)})}function ru(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ou(e,t){for(var n=t+"Capture",a=[];null!==e;){var r=e,o=r.stateNode;if(5!==(r=r.tag)&&26!==r&&27!==r||null===o||(null!=(r=Ut(e,n))&&a.unshift(ru(e,r,o)),null!=(r=Ut(e,t))&&a.push(ru(e,r,o))),3===e.tag)return a;e=e.return}return[]}function iu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function su(e,t,n,a,r){for(var o=t._reactName,i=[];null!==n&&n!==a;){var s=n,l=s.alternate,c=s.stateNode;if(s=s.tag,null!==l&&l===a)break;5!==s&&26!==s&&27!==s||null===c||(l=c,r?null!=(c=Ut(n,o))&&i.unshift(ru(n,c,l)):r||null!=(c=Ut(n,o))&&i.push(ru(n,c,l))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var lu=/\r\n?/g,cu=/\u0000|\uFFFD/g;function du(e){return("string"==typeof e?e:""+e).replace(lu,"\n").replace(cu,"")}function uu(e,t){return t=du(t),du(e)===t}function mu(e,t,n,r,o,i){switch(n){case"children":"string"==typeof r?"body"===t||"textarea"===t&&""===r||Nt(e,r):("number"==typeof r||"bigint"==typeof r)&&"body"!==t&&Nt(e,""+r);break;case"className":ut(e,"class",r);break;case"tabIndex":ut(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":ut(e,n,r);break;case"style":It(e,r,i);break;case"data":if("object"!==t){ut(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"==typeof r||"symbol"==typeof r||"boolean"==typeof r){e.removeAttribute(n);break}r=At(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"==typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof i&&("formAction"===n?("input"!==t&&mu(e,t,"name",o.name,o,null),mu(e,t,"formEncType",o.formEncType,o,null),mu(e,t,"formMethod",o.formMethod,o,null),mu(e,t,"formTarget",o.formTarget,o,null)):(mu(e,t,"encType",o.encType,o,null),mu(e,t,"method",o.method,o,null),mu(e,t,"target",o.target,o,null))),null==r||"symbol"==typeof r||"boolean"==typeof r){e.removeAttribute(n);break}r=At(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Pt);break;case"onScroll":null!=r&&Zd("scroll",e);break;case"onScrollEnd":null!=r&&Zd("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!=typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=o.children)throw Error(a(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!=typeof r&&"symbol"!=typeof r;break;case"muted":e.muted=r&&"function"!=typeof r&&"symbol"!=typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"==typeof r||"boolean"==typeof r||"symbol"==typeof r){e.removeAttribute("xlink:href");break}n=At(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!=typeof r&&"symbol"!=typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!=typeof r&&"symbol"!=typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!=typeof r&&"symbol"!=typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!=typeof r&&"symbol"!=typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"==typeof r||"symbol"==typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Zd("beforetoggle",e),Zd("toggle",e),dt(e,"popover",r);break;case"xlinkActuate":mt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":mt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":mt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":mt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":mt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":mt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":mt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":mt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":mt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":dt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&dt(e,n=Et.get(n)||n,r)}}function pu(e,t,n,r,o,i){switch(n){case"style":It(e,r,i);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!=typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=o.children)throw Error(a(60));e.innerHTML=n}}break;case"children":"string"==typeof r?Nt(e,r):("number"==typeof r||"bigint"==typeof r)&&Nt(e,""+r);break;case"onScroll":null!=r&&Zd("scroll",e);break;case"onScrollEnd":null!=r&&Zd("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Pt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:rt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(o=n.endsWith("Capture"),t=n.slice(2,o?n.length-7:void 0),"function"==typeof(i=null!=(i=e[Ve]||null)?i[n]:null)&&e.removeEventListener(t,i,o),"function"!=typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):dt(e,n,r):("function"!=typeof i&&null!==i&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,o)))}}function hu(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Zd("error",e),Zd("load",e);var r,o=!1,i=!1;for(r in n)if(n.hasOwnProperty(r)){var s=n[r];if(null!=s)switch(r){case"src":o=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:mu(e,t,r,s,n,null)}}return i&&mu(e,t,"srcSet",n.srcSet,n,null),void(o&&mu(e,t,"src",n.src,n,null));case"input":Zd("invalid",e);var l=r=s=i=null,c=null,d=null;for(o in n)if(n.hasOwnProperty(o)){var u=n[o];if(null!=u)switch(o){case"name":i=u;break;case"type":s=u;break;case"checked":c=u;break;case"defaultChecked":d=u;break;case"value":r=u;break;case"defaultValue":l=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(a(137,t));break;default:mu(e,t,o,u,n,null)}}return void wt(e,r,l,c,d,s,i,!1);case"select":for(i in Zd("invalid",e),o=s=r=null,n)if(n.hasOwnProperty(i)&&null!=(l=n[i]))switch(i){case"value":r=l;break;case"defaultValue":s=l;break;case"multiple":o=l;default:mu(e,t,i,l,n,null)}return t=r,n=s,e.multiple=!!o,void(null!=t?kt(e,!!o,t,!1):null!=n&&kt(e,!!o,n,!0));case"textarea":for(s in Zd("invalid",e),r=i=o=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":o=l;break;case"defaultValue":i=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(a(91));break;default:mu(e,t,s,l,n,null)}return void Ct(e,o,i,r);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(o=n[c]))if("selected"===c)e.selected=o&&"function"!=typeof o&&"symbol"!=typeof o;else mu(e,t,c,o,n,null);return;case"dialog":Zd("beforetoggle",e),Zd("toggle",e),Zd("cancel",e),Zd("close",e);break;case"iframe":case"object":Zd("load",e);break;case"video":case"audio":for(o=0;o<Qd.length;o++)Zd(Qd[o],e);break;case"image":Zd("error",e),Zd("load",e);break;case"details":Zd("toggle",e);break;case"embed":case"source":case"link":Zd("error",e),Zd("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in n)if(n.hasOwnProperty(d)&&null!=(o=n[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:mu(e,t,d,o,n,null)}return;default:if(Dt(t)){for(u in n)n.hasOwnProperty(u)&&(void 0!==(o=n[u])&&pu(e,t,u,o,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(o=n[l])&&mu(e,t,l,o,n,null))}function fu(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var gu=null,yu=null;function bu(e){return 9===e.nodeType?e:e.ownerDocument}function vu(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function xu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function wu(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var _u=null;var ku="function"==typeof setTimeout?setTimeout:void 0,Su="function"==typeof clearTimeout?clearTimeout:void 0,Cu="function"==typeof Promise?Promise:void 0,Nu="function"==typeof queueMicrotask?queueMicrotask:void 0!==Cu?function(e){return Cu.resolve(null).then(e).catch(ju)}:ku;function ju(e){setTimeout(function(){throw e})}function Tu(e){return"head"===e}function Iu(e,t){var n=t,a=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)||"/&"===n){if(0===a)return e.removeChild(r),void Wm(t);a--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)a++;else if("html"===n)Fu(e.ownerDocument.documentElement);else if("head"===n){Fu(n=e.ownerDocument.head);for(var o=n.firstChild;o;){var i=o.nextSibling,s=o.nodeName;o[Ye]||"SCRIPT"===s||"STYLE"===s||"LINK"===s&&"stylesheet"===o.rel.toLowerCase()||n.removeChild(o),o=i}}else"body"===n&&Fu(e.ownerDocument.body);n=r}while(n);Wm(t)}function Du(e,t){var n=e;e=0;do{var a=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=a}while(n)}function Eu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Eu(n),Je(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Lu(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Ru(e.nextSibling)))return null}return e}function Au(e){return"$?"===e.data||"$~"===e.data}function Pu(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Ru(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Ou=null;function Mu(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Ru(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function qu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function zu(e,t,n){switch(t=bu(n),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}function Fu(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Je(e)}var Bu=new Map,Uu=new Set;function $u(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Vu=M.d;M.d={f:function(){var e=Vu.f(),t=td();return e||t},r:function(e){var t=Xe(e);null!==t&&5===t.tag&&"form"===t.type?os(t):Vu.r(e)},D:function(e){Vu.D(e),Wu("dns-prefetch",e,null)},C:function(e,t){Vu.C(e,t),Wu("preconnect",e,t)},L:function(e,t,n){Vu.L(e,t,n);var a=Hu;if(a&&e&&t){var r='link[rel="preload"][as="'+vt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(r+='[imagesrcset="'+vt(n.imageSrcSet)+'"]',"string"==typeof n.imageSizes&&(r+='[imagesizes="'+vt(n.imageSizes)+'"]')):r+='[href="'+vt(e)+'"]';var o=r;switch(t){case"style":o=Ku(e);break;case"script":o=Ju(e)}Bu.has(o)||(e=d({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Bu.set(o,e),null!==a.querySelector(r)||"style"===t&&a.querySelector(Qu(o))||"script"===t&&a.querySelector(Zu(o))||(hu(t=a.createElement("link"),"link",e),nt(t),a.head.appendChild(t)))}},m:function(e,t){Vu.m(e,t);var n=Hu;if(n&&e){var a=t&&"string"==typeof t.as?t.as:"script",r='link[rel="modulepreload"][as="'+vt(a)+'"][href="'+vt(e)+'"]',o=r;switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=Ju(e)}if(!Bu.has(o)&&(e=d({rel:"modulepreload",href:e},t),Bu.set(o,e),null===n.querySelector(r))){switch(a){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Zu(o)))return}hu(a=n.createElement("link"),"link",e),nt(a),n.head.appendChild(a)}}},X:function(e,t){Vu.X(e,t);var n=Hu;if(n&&e){var a=tt(n).hoistableScripts,r=Ju(e),o=a.get(r);o||((o=n.querySelector(Zu(r)))||(e=d({src:e,async:!0},t),(t=Bu.get(r))&&nm(e,t),nt(o=n.createElement("script")),hu(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},a.set(r,o))}},S:function(e,t,n){Vu.S(e,t,n);var a=Hu;if(a&&e){var r=tt(a).hoistableStyles,o=Ku(e);t=t||"default";var i=r.get(o);if(!i){var s={loading:0,preload:null};if(i=a.querySelector(Qu(o)))s.loading=5;else{e=d({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Bu.get(o))&&tm(e,n);var l=i=a.createElement("link");nt(l),hu(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){s.loading|=1}),l.addEventListener("error",function(){s.loading|=2}),s.loading|=4,em(i,t,a)}i={type:"stylesheet",instance:i,count:1,state:s},r.set(o,i)}}},M:function(e,t){Vu.M(e,t);var n=Hu;if(n&&e){var a=tt(n).hoistableScripts,r=Ju(e),o=a.get(r);o||((o=n.querySelector(Zu(r)))||(e=d({src:e,async:!0,type:"module"},t),(t=Bu.get(r))&&nm(e,t),nt(o=n.createElement("script")),hu(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},a.set(r,o))}}};var Hu="undefined"==typeof document?null:document;function Wu(e,t,n){var a=Hu;if(a&&"string"==typeof t&&t){var r=vt(t);r='link[rel="'+e+'"][href="'+r+'"]',"string"==typeof n&&(r+='[crossorigin="'+n+'"]'),Uu.has(r)||(Uu.add(r),e={rel:e,crossOrigin:n,href:t},null===a.querySelector(r)&&(hu(t=a.createElement("link"),"link",e),nt(t),a.head.appendChild(t)))}}function Gu(e,t,n,r){var o,i,s,l,c=(c=K.current)?$u(c):null;if(!c)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof n.precedence&&"string"==typeof n.href?(t=Ku(n.href),(r=(n=tt(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"==typeof n.href&&"string"==typeof n.precedence){e=Ku(n.href);var d=tt(c).hoistableStyles,u=d.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=c.querySelector(Qu(e)))&&!d._p&&(u.instance=d,u.state.loading=5),Bu.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Bu.set(e,n),d||(o=c,i=e,s=n,l=u.state,o.querySelector('link[rel="preload"][as="style"]['+i+"]")?l.loading=1:(i=o.createElement("link"),l.preload=i,i.addEventListener("load",function(){return l.loading|=1}),i.addEventListener("error",function(){return l.loading|=2}),hu(i,"link",s),nt(i),o.head.appendChild(i))))),t&&null===r)throw Error(a(528,""));return u}if(t&&null!==r)throw Error(a(529,""));return null;case"script":return t=n.async,"string"==typeof(n=n.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Ju(n),(r=(n=tt(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Ku(e){return'href="'+vt(e)+'"'}function Qu(e){return'link[rel="stylesheet"]['+e+"]"}function Yu(e){return d({},e,{"data-precedence":e.precedence,precedence:null})}function Ju(e){return'[src="'+vt(e)+'"]'}function Zu(e){return"script[async]"+e}function Xu(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+vt(n.href)+'"]');if(r)return t.instance=r,nt(r),r;var o=d({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return nt(r=(e.ownerDocument||e).createElement("style")),hu(r,"style",o),em(r,n.precedence,e),t.instance=r;case"stylesheet":o=Ku(n.href);var i=e.querySelector(Qu(o));if(i)return t.state.loading|=4,t.instance=i,nt(i),i;r=Yu(n),(o=Bu.get(o))&&tm(r,o),nt(i=(e.ownerDocument||e).createElement("link"));var s=i;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),hu(i,"link",r),t.state.loading|=4,em(i,n.precedence,e),t.instance=i;case"script":return i=Ju(n.src),(o=e.querySelector(Zu(i)))?(t.instance=o,nt(o),o):(r=n,(o=Bu.get(i))&&nm(r=d({},n),o),nt(o=(e=e.ownerDocument||e).createElement("script")),hu(o,"link",r),e.head.appendChild(o),t.instance=o);case"void":return null;default:throw Error(a(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,em(r,n.precedence,e));return t.instance}function em(e,t,n){for(var a=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=a.length?a[a.length-1]:null,o=r,i=0;i<a.length;i++){var s=a[i];if(s.dataset.precedence===t)o=s;else if(o!==r)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function tm(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function nm(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var am=null;function rm(e,t,n){if(null===am){var a=new Map,r=am=new Map;r.set(n,a)}else(a=(r=am).get(n))||(a=new Map,r.set(n,a));if(a.has(e))return a;for(a.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var o=n[r];if(!(o[Ye]||o[$e]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var i=o.getAttribute(t)||"";i=e+i;var s=a.get(i);s?s.push(o):a.set(i,[o])}}return a}function om(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function im(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var sm=0;function lm(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)dm(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var cm=null;function dm(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,cm=new Map,t.forEach(um,e),cm=null,lm.call(e))}function um(e,t){if(!(4&t.state.loading)){var n=cm.get(e);if(n)var a=n.get(null);else{n=new Map,cm.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<r.length;o++){var i=r[o];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(n.set(i.dataset.precedence,i),a=i)}a&&n.set(null,a)}i=(r=t.instance).getAttribute("data-precedence"),(o=n.get(i)||a)===a&&n.set(null,r),n.set(i,r),this.count++,a=lm.bind(this),r.addEventListener("load",a),r.addEventListener("error",a),o?o.parentNode.insertBefore(r,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(r,e.firstChild),t.state.loading|=4}}var mm={$$typeof:x,Provider:null,Consumer:null,_currentValue:q,_currentValue2:q,_threadCount:0};function pm(e,t,n,a,r,o,i,s,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.hiddenUpdates=Ae(null),this.identifierPrefix=a,this.onUncaughtError=r,this.onCaughtError=o,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function hm(e,t,n,a,r,o,i,s,l,c,d,u){return e=new pm(e,t,n,i,l,c,d,u,s),t=1,!0===o&&(t|=24),o=Fa(3,null,null,t),e.current=o,o.stateNode=e,(t=Br()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:a,isDehydrated:n,cache:t},vo(o),e}function fm(e){return e?e=qa:qa}function gm(e,t,n,a,r,o){r=fm(r),null===a.context?a.context=r:a.pendingContext=r,(a=wo(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(a.callback=o),null!==(n=_o(e,a,t))&&(Yc(n,0,t),ko(n,e,t))}function ym(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function bm(e,t){ym(e,t),(e=e.alternate)&&ym(e,t)}function vm(e){if(13===e.tag||31===e.tag){var t=Ra(e,67108864);null!==t&&Yc(t,0,67108864),bm(e,67108864)}}function xm(e){if(13===e.tag||31===e.tag){var t=Kc(),n=Ra(e,t=qe(t));null!==n&&Yc(n,0,t),bm(e,t)}}var wm=!0;function _m(e,t,n,a){var r=O.T;O.T=null;var o=M.p;try{M.p=2,Sm(e,t,n,a)}finally{M.p=o,O.T=r}}function km(e,t,n,a){var r=O.T;O.T=null;var o=M.p;try{M.p=8,Sm(e,t,n,a)}finally{M.p=o,O.T=r}}function Sm(e,t,n,a){if(wm){var r=Cm(a);if(null===r)au(e,t,a,Nm,n),Mm(e,a);else if(function(e,t,n,a,r){switch(t){case"focusin":return Dm=qm(Dm,e,t,n,a,r),!0;case"dragenter":return Em=qm(Em,e,t,n,a,r),!0;case"mouseover":return Lm=qm(Lm,e,t,n,a,r),!0;case"pointerover":var o=r.pointerId;return Am.set(o,qm(Am.get(o)||null,e,t,n,a,r)),!0;case"gotpointercapture":return o=r.pointerId,Pm.set(o,qm(Pm.get(o)||null,e,t,n,a,r)),!0}return!1}(r,e,t,n,a))a.stopPropagation();else if(Mm(e,a),4&t&&-1<Om.indexOf(e)){for(;null!==r;){var o=Xe(r);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var i=Te(o.pendingLanes);if(0!==i){var s=o;for(s.pendingLanes|=2,s.entangledLanes|=2;i;){var l=1<<31-_e(i);s.entanglements[1]|=l,i&=~l}Md(o),!(6&fc)&&(Oc=de()+500,qd(0))}}break;case 31:case 13:null!==(s=Ra(o,2))&&Yc(s,0,2),td(),bm(o,2)}if(null===(o=Cm(a))&&au(e,t,a,Nm,n),o===r)break;r=o}null!==r&&a.stopPropagation()}else au(e,t,a,null,n)}}function Cm(e){return jm(e=Ot(e))}var Nm=null;function jm(e){if(Nm=null,null!==(e=Ze(e))){var t=o(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=i(t)))return e;e=null}else if(31===n){if(null!==(e=s(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Nm=e,null}function Tm(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ue()){case me:return 2;case pe:return 8;case he:case fe:return 32;case ge:return 268435456;default:return 32}default:return 32}}var Im=!1,Dm=null,Em=null,Lm=null,Am=new Map,Pm=new Map,Rm=[],Om="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Mm(e,t){switch(e){case"focusin":case"focusout":Dm=null;break;case"dragenter":case"dragleave":Em=null;break;case"mouseover":case"mouseout":Lm=null;break;case"pointerover":case"pointerout":Am.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pm.delete(t.pointerId)}}function qm(e,t,n,a,r,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:a,nativeEvent:o,targetContainers:[r]},null!==t&&(null!==(t=Xe(t))&&vm(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function zm(e){var t=Ze(e.target);if(null!==t){var n=o(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=i(n)))return e.blockedOn=t,void Be(e.priority,function(){xm(n)})}else if(31===t){if(null!==(t=s(n)))return e.blockedOn=t,void Be(e.priority,function(){xm(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Fm(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Cm(e.nativeEvent);if(null!==n)return null!==(t=Xe(n))&&vm(t),e.blockedOn=n,!1;var a=new(n=e.nativeEvent).constructor(n.type,n);Rt=a,n.target.dispatchEvent(a),Rt=null,t.shift()}return!0}function Bm(e,t,n){Fm(e)&&n.delete(t)}function Um(){Im=!1,null!==Dm&&Fm(Dm)&&(Dm=null),null!==Em&&Fm(Em)&&(Em=null),null!==Lm&&Fm(Lm)&&(Lm=null),Am.forEach(Bm),Pm.forEach(Bm)}function $m(t,n){t.blockedOn===n&&(t.blockedOn=null,Im||(Im=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Um)))}var Vm=null;function Hm(t){Vm!==t&&(Vm=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Vm===t&&(Vm=null);for(var e=0;e<t.length;e+=3){var n=t[e],a=t[e+1],r=t[e+2];if("function"!=typeof a){if(null===jm(a||n))continue;break}var o=Xe(n);null!==o&&(t.splice(e,3),e-=3,as(o,{pending:!0,data:r,method:n.method,action:a},a,r))}}))}function Wm(e){function t(t){return $m(t,e)}null!==Dm&&$m(Dm,e),null!==Em&&$m(Em,e),null!==Lm&&$m(Lm,e),Am.forEach(t),Pm.forEach(t);for(var n=0;n<Rm.length;n++){var a=Rm[n];a.blockedOn===e&&(a.blockedOn=null)}for(;0<Rm.length&&null===(n=Rm[0]).blockedOn;)zm(n),null===n.blockedOn&&Rm.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(a=0;a<n.length;a+=3){var r=n[a],o=n[a+1],i=r[Ve]||null;if("function"==typeof o)i||Hm(n);else if(i){var s=null;if(o&&o.hasAttribute("formAction")){if(r=o,i=o[Ve]||null)s=i.formAction;else if(null!==jm(r))continue}else s=i.action;"function"==typeof s?n[a+1]=s:(n.splice(a,3),a-=3),Hm(n)}}}function Gm(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return r=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==r&&(r(),r=null),a||setTimeout(n,20)}function n(){if(!a&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"==typeof navigation){var a=!1,r=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){a=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==r&&(r(),r=null)}}}function Km(e){this._internalRoot=e}function Qm(e){this._internalRoot=e}Qm.prototype.render=Km.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));gm(t.current,Kc(),e,t,null,null)},Qm.prototype.unmount=Km.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;gm(e.current,2,null,e,null,null),td(),t[He]=null}},Qm.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rm.length&&0!==t&&t<Rm[n].priority;n++);Rm.splice(n,0,e),0===n&&zm(e)}};var Ym=t.version;if("19.2.3"!==Ym)throw Error(a(527,Ym,"19.2.3"));M.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=o(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return l(i),e;if(s===r)return l(i),t;s=s.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=s;else{for(var c=!1,d=i.child;d;){if(d===n){c=!0,n=i,r=s;break}if(d===r){c=!0,r=i,n=s;break}d=d.sibling}if(!c){for(d=s.child;d;){if(d===n){c=!0,n=s,r=i;break}if(d===r){c=!0,r=s,n=i;break}d=d.sibling}if(!c)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?c(e):null)?null:e.stateNode};var Jm={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.3"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Zm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zm.isDisabled&&Zm.supportsFiber)try{ve=Zm.inject(Jm),xe=Zm}catch(ep){}}return S.createRoot=function(e,t){if(!r(e))throw Error(a(299));var n=!1,o="",i=Ns,s=js,l=Ts;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(o=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=hm(e,1,!1,null,0,n,o,null,i,s,l,Gm),e[He]=t.current,tu(e),new Km(t)},S.hydrateRoot=function(e,t,n){if(!r(e))throw Error(a(299));var o=!1,i="",s=Ns,l=js,c=Ts,d=null;return null!=n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.formState&&(d=n.formState)),(t=hm(e,1,!0,t,0,o,i,d,s,l,c,Gm)).context=fm(null),n=t.current,(i=wo(o=qe(o=Kc()))).callback=null,_o(n,i,o),n=o,t.current.lanes=n,Pe(t,n),Md(t),e[He]=t.current,tu(e),new Qm(t)},S.version="19.2.3",S}var I=(_||(_=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){}}(),k.exports=T()),k.exports);const D={},E=function(e,t,n){let a=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),r=n?.nonce||n?.getAttribute("nonce");a=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in D)return;D[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,r&&a.setAttribute("nonce",r),document.head.appendChild(a),t?new Promise((t,n)=>{a.addEventListener("load",t),a.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})};var L="popstate";function A(e={}){return function(e,t,n,a={}){let{window:r=document.defaultView,v5Compat:o=!1}=a,i=r.history,s="POP",l=null,c=d();null==c&&(c=0,i.replaceState({...i.state,idx:c},""));function d(){return(i.state||{idx:null}).idx}function u(){s="POP";let e=d(),t=null==e?null:e-c;c=e,l&&l({action:s,location:f.location,delta:t})}function m(e,t){s="PUSH";let n=M(f.location,e,t);c=d()+1;let a=O(n,c),u=f.createHref(n);try{i.pushState(a,"",u)}catch(m){if(m instanceof DOMException&&"DataCloneError"===m.name)throw m;r.location.assign(u)}o&&l&&l({action:s,location:f.location,delta:1})}function p(e,t){s="REPLACE";let n=M(f.location,e,t);c=d();let a=O(n,c),r=f.createHref(n);i.replaceState(a,"",r),o&&l&&l({action:s,location:f.location,delta:0})}function h(e){return function(e,t=!1){let n="http://localhost";"undefined"!=typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href);P(n,"No window.location.(origin|href) available to create URL");let a="string"==typeof e?e:q(e);a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=n+a);return new URL(a,n)}(e)}let f={get action(){return s},get location(){return e(r,i)},listen(e){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(L,u),l=e,()=>{r.removeEventListener(L,u),l=null}},createHref:e=>t(r,e),createURL:h,encodeLocation(e){let t=h(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:m,replace:p,go:e=>i.go(e)};return f}(function(e,t){let{pathname:n,search:a,hash:r}=e.location;return M("",{pathname:n,search:a,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"==typeof t?t:q(t)},0,e)}function P(e,t){if(!1===e||null==e)throw new Error(t)}function R(e,t){if(!e)try{throw new Error(t)}catch(n){}}function O(e,t){return{usr:e.state,key:e.key,idx:t}}function M(e,t,n=null,a){return{pathname:"string"==typeof e?e:e.pathname,search:"",hash:"",..."string"==typeof t?z(t):t,state:n,key:t&&t.key||a||Math.random().toString(36).substring(2,10)}}function q({pathname:e="/",search:t="",hash:n=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),n&&"#"!==n&&(e+="#"===n.charAt(0)?n:"#"+n),e}function z(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function F(e,t,n="/"){return function(e,t,n,a){let r="string"==typeof t?z(t):t,o=ee(r.pathname||"/",n);if(null==o)return null;let i=B(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(i);let s=null;for(let l=0;null==s&&l<i.length;++l){let e=X(o);s=J(i[l],e,a)}return s}(e,t,n,!1)}function B(e,t=[],n=[],a="",r=!1){let o=(e,o,i=r,s)=>{let l={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(a)&&i)return;P(l.relativePath.startsWith(a),`Absolute route path "${l.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(a.length)}let c=se([a,l.relativePath]),d=n.concat(l);e.children&&e.children.length>0&&(P(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),B(e.children,t,d,c,i)),(null!=e.path||e.index)&&t.push({path:c,score:Y(c,e.index),routesMeta:d})};return e.forEach((e,t)=>{if(""!==e.path&&e.path?.includes("?"))for(let n of U(e.path))o(e,t,!0,n);else o(e,t)}),t}function U(e){let t=e.split("/");if(0===t.length)return[];let[n,...a]=t,r=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===a.length)return r?[o,""]:[o];let i=U(a.join("/")),s=[];return s.push(...i.map(e=>""===e?o:[o,e].join("/"))),r&&s.push(...i),s.map(t=>e.startsWith("/")&&""===t?"/":t)}var $=/^:[\w-]+$/,V=3,H=2,W=1,G=10,K=-2,Q=e=>"*"===e;function Y(e,t){let n=e.split("/"),a=n.length;return n.some(Q)&&(a+=K),t&&(a+=H),n.filter(e=>!Q(e)).reduce((e,t)=>e+($.test(t)?V:""===t?W:G),a)}function J(e,t,n=!1){let{routesMeta:a}=e,r={},o="/",i=[];for(let s=0;s<a.length;++s){let e=a[s],l=s===a.length-1,c="/"===o?t:t.slice(o.length)||"/",d=Z({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&n&&!a[a.length-1].route.index&&(d=Z({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(r,d.params),i.push({params:r,pathname:se([o,d.pathname]),pathnameBase:le(se([o,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(o=se([o,d.pathnameBase]))}return i}function Z(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,a]=function(e,t=!1,n=!0){R("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(a.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");e.endsWith("*")?(a.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))");let o=new RegExp(r,t?void 0:"i");return[o,a]}(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let o=r[0],i=o.replace(/(.)\/+$/,"$1"),s=r.slice(1);return{params:a.reduce((e,{paramName:t,isOptional:n},a)=>{if("*"===t){let e=s[a]||"";i=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const r=s[a];return e[t]=n&&!r?void 0:(r||"").replace(/%2F/g,"/"),e},{}),pathname:o,pathnameBase:i,pattern:e}}function X(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return R(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function ee(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,a=e.charAt(n);return a&&"/"!==a?null:e.slice(n)||"/"}var te=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function ne(e,t="/"){let n,{pathname:a,search:r="",hash:o=""}="string"==typeof e?z(e):e;if(a)if(i=a,te.test(i))n=a;else{if(a.includes("//")){let e=a;a=a.replace(/\/\/+/g,"/"),R(!1,`Pathnames cannot have embedded double slashes - normalizing ${e} -> ${a}`)}n=a.startsWith("/")?ae(a.substring(1),"/"):ae(a,t)}else n=t;var i;return{pathname:n,search:ce(r),hash:de(o)}}function ae(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}function re(e,t,n,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function oe(e){let t=function(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function ie(e,t,n,a=!1){let r;"string"==typeof e?r=z(e):(r={...e},P(!r.pathname||!r.pathname.includes("?"),re("?","pathname","search",r)),P(!r.pathname||!r.pathname.includes("#"),re("#","pathname","hash",r)),P(!r.search||!r.search.includes("#"),re("#","search","hash",r)));let o,i=""===e||""===r.pathname,s=i?"/":r.pathname;if(null==s)o=n;else{let e=t.length-1;if(!a&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}o=e>=0?t[e]:"/"}let l=ne(r,o),c=s&&"/"!==s&&s.endsWith("/"),d=(i||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!d||(l.pathname+="/"),l}var se=e=>e.join("/").replace(/\/\/+/g,"/"),le=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ce=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",de=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"",ue=class{constructor(e,t,n,a=!1){this.status=e,this.statusText=t||"",this.internal=a,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function me(e){return e.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var pe="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function he(e,t){let n=e;if("string"!=typeof n||!te.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let a=n,r=!1;if(pe)try{let e=new URL(window.location.href),a=n.startsWith("//")?new URL(e.protocol+n):new URL(n),o=ee(a.pathname,t);a.origin===e.origin&&null!=o?n=o+a.search+a.hash:r=!0}catch(o){R(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:a,isExternal:r,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var fe=["POST","PUT","PATCH","DELETE"];new Set(fe);var ge=["GET",...fe];new Set(ge);var ye=m.createContext(null);ye.displayName="DataRouter";var be=m.createContext(null);be.displayName="DataRouterState";var ve=m.createContext(!1),xe=m.createContext({isTransitioning:!1});xe.displayName="ViewTransition",m.createContext(new Map).displayName="Fetchers",m.createContext(null).displayName="Await";var we=m.createContext(null);we.displayName="Navigation";var _e=m.createContext(null);_e.displayName="Location";var ke=m.createContext({outlet:null,matches:[],isDataRoute:!1});ke.displayName="Route";var Se=m.createContext(null);Se.displayName="RouteError";var Ce="REACT_ROUTER_ERROR";function Ne(){return null!=m.useContext(_e)}function je(){return P(Ne(),"useLocation() may be used only in the context of a <Router> component."),m.useContext(_e).location}var Te="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ie(e){m.useContext(we).static||m.useLayoutEffect(e)}function De(){let{isDataRoute:e}=m.useContext(ke);return e?function(){let{router:e}=function(e){let t=m.useContext(ye);return P(t,Fe(e)),t}("useNavigate"),t=Be("useNavigate"),n=m.useRef(!1);return Ie(()=>{n.current=!0}),m.useCallback(async(a,r={})=>{R(n.current,Te),n.current&&("number"==typeof a?await e.navigate(a):await e.navigate(a,{fromRouteId:t,...r}))},[e,t])}():function(){P(Ne(),"useNavigate() may be used only in the context of a <Router> component.");let e=m.useContext(ye),{basename:t,navigator:n}=m.useContext(we),{matches:a}=m.useContext(ke),{pathname:r}=je(),o=JSON.stringify(oe(a)),i=m.useRef(!1);return Ie(()=>{i.current=!0}),m.useCallback((a,s={})=>{if(R(i.current,Te),!i.current)return;if("number"==typeof a)return void n.go(a);let l=ie(a,JSON.parse(o),r,"path"===s.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:se([t,l.pathname])),(s.replace?n.replace:n.push)(l,s.state,s)},[t,n,o,r,e])}()}function Ee(){let{matches:e}=m.useContext(ke),t=e[e.length-1];return t?t.params:{}}function Le(e,{relative:t}={}){let{matches:n}=m.useContext(ke),{pathname:a}=je(),r=JSON.stringify(oe(n));return m.useMemo(()=>ie(e,JSON.parse(r),a,"path"===t),[e,r,a,t])}function Ae(e,t,n,a,r){P(Ne(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=m.useContext(we),{matches:i}=m.useContext(ke),s=i[i.length-1],l=s?s.params:{},c=s?s.pathname:"/",d=s?s.pathnameBase:"/",u=s&&s.route;{let e=u&&u.path||"";$e(c,!u||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let p,h=je();if(t){let e="string"==typeof t?z(t):t;P("/"===d||e.pathname?.startsWith(d),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${e.pathname}" was given in the \`location\` prop.`),p=e}else p=h;let f=p.pathname||"/",g=f;if("/"!==d){let e=d.replace(/^\//,"").split("/");g="/"+f.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=F(e,{pathname:g});R(u||null!=y,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),R(null==y||void 0!==y[y.length-1].route.element||void 0!==y[y.length-1].route.Component||void 0!==y[y.length-1].route.lazy,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=function(e,t=[],n=null,a=null){if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let r=e,o=n?.errors;if(null!=o){let e=r.findIndex(e=>e.route.id&&void 0!==o?.[e.route.id]);P(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),r=r.slice(0,Math.min(r.length,e+1))}let i=!1,s=-1;if(n)for(let c=0;c<r.length;c++){let e=r[c];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(s=c),e.route.id){let{loaderData:t,errors:a}=n,o=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!a||void 0===a[e.route.id]);if(e.route.lazy||o){i=!0,r=s>=0?r.slice(0,s+1):[r[0]];break}}}let l=n&&a?(e,t)=>{a(e,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:me(n.matches),errorInfo:t})}:void 0;return r.reduceRight((e,a,c)=>{let d,u=!1,p=null,h=null;n&&(d=o&&a.route.id?o[a.route.id]:void 0,p=a.route.errorElement||Re,i&&(s<0&&0===c?($e("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),u=!0,h=null):s===c&&(u=!0,h=a.route.hydrateFallbackElement||null)));let f=t.concat(r.slice(0,c+1)),g=()=>{let t;return t=d?p:u?h:a.route.Component?m.createElement(a.route.Component,null):a.route.element?a.route.element:e,m.createElement(ze,{match:a,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(a.route.ErrorBoundary||a.route.errorElement||0===c)?m.createElement(Oe,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:g(),routeContext:{outlet:null,matches:f,isDataRoute:!0},onError:l}):g()},null)}(y&&y.map(e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:se([d,o.encodeLocation?o.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:se([d,o.encodeLocation?o.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),i,n,a,r);return t&&b?m.createElement(_e.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...p},navigationType:"POP"}},b):b}function Pe(){let e=function(){let e=m.useContext(Se),t=function(e){let t=m.useContext(be);return P(t,Fe(e)),t}("useRouteError"),n=Be("useRouteError");if(void 0!==e)return e;return t.errors?.[n]}(),t=function(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:a},o={padding:"2px 4px",backgroundColor:a},i=null;return i=m.createElement(m.Fragment,null,m.createElement("p",null," Hey developer "),m.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",m.createElement("code",{style:o},"ErrorBoundary")," or"," ",m.createElement("code",{style:o},"errorElement")," prop on your route.")),m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},t),n?m.createElement("pre",{style:r},n):null,i)}m.createContext(null);var Re=m.createElement(Pe,null),Oe=class extends m.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError&&this.props.onError(e,t)}render(){let e=this.state.error;if(this.context&&"object"==typeof e&&e&&"digest"in e&&"string"==typeof e.digest){const t=function(e){if(e.startsWith(`${Ce}:ROUTE_ERROR_RESPONSE:{`))try{let t=JSON.parse(e.slice(40));if("object"==typeof t&&t&&"number"==typeof t.status&&"string"==typeof t.statusText)return new ue(t.status,t.statusText,t.data)}catch{}}(e.digest);t&&(e=t)}let t=void 0!==e?m.createElement(ke.Provider,{value:this.props.routeContext},m.createElement(Se.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?m.createElement(qe,{error:e},t):t}};Oe.contextType=ve;var Me=new WeakMap;function qe({children:e,error:t}){let{basename:n}=m.useContext(we);if("object"==typeof t&&t&&"digest"in t&&"string"==typeof t.digest){let e=function(e){if(e.startsWith(`${Ce}:REDIRECT:{`))try{let t=JSON.parse(e.slice(28));if("object"==typeof t&&t&&"number"==typeof t.status&&"string"==typeof t.statusText&&"string"==typeof t.location&&"boolean"==typeof t.reloadDocument&&"boolean"==typeof t.replace)return t}catch{}}(t.digest);if(e){let a=Me.get(t);if(a)throw a;let r=he(e.location,n);if(pe&&!Me.get(t)){if(!r.isExternal&&!e.reloadDocument){const n=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(r.to,{replace:e.replace}));throw Me.set(t,n),n}window.location.href=r.absoluteURL||r.to}return m.createElement("meta",{httpEquiv:"refresh",content:`0;url=${r.absoluteURL||r.to}`})}}return e}function ze({routeContext:e,match:t,children:n}){let a=m.useContext(ye);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),m.createElement(ke.Provider,{value:e},n)}function Fe(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Be(e){let t=function(e){let t=m.useContext(ke);return P(t,Fe(e)),t}(e),n=t.matches[t.matches.length-1];return P(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}var Ue={};function $e(e,t,n){t||Ue[e]||(Ue[e]=!0,R(!1,n))}function Ve({to:e,replace:t,state:n,relative:a}){P(Ne(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=m.useContext(we);R(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=m.useContext(ke),{pathname:i}=je(),s=De(),l=ie(e,oe(o),i,"path"===a),c=JSON.stringify(l);return m.useEffect(()=>{s(JSON.parse(c),{replace:t,state:n,relative:a})},[s,c,a,t,n]),null}function He(e){P(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function We({basename:e="/",children:t=null,location:n,navigationType:a="POP",navigator:r,static:o=!1,unstable_useTransitions:i}){P(!Ne(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=e.replace(/^\/*/,"/"),l=m.useMemo(()=>({basename:s,navigator:r,static:o,unstable_useTransitions:i,future:{}}),[s,r,o,i]);"string"==typeof n&&(n=z(n));let{pathname:c="/",search:d="",hash:u="",state:p=null,key:h="default"}=n,f=m.useMemo(()=>{let e=ee(c,s);return null==e?null:{location:{pathname:e,search:d,hash:u,state:p,key:h},navigationType:a}},[s,c,d,u,p,h,a]);return R(null!=f,`<Router basename="${s}"> is not able to match the URL "${c}${d}${u}" because it does not start with the basename, so the <Router> won't render anything.`),null==f?null:m.createElement(we.Provider,{value:l},m.createElement(_e.Provider,{children:t,value:f}))}function Ge({children:e,location:t}){return Ae(Ke(e),t)}function Ke(e,t=[]){let n=[];return m.Children.forEach(e,(e,a)=>{if(!m.isValidElement(e))return;let r=[...t,a];if(e.type===m.Fragment)return void n.push.apply(n,Ke(e.props.children,r));P(e.type===He,`[${"string"==typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),P(!e.props.index||!e.props.children,"An index route cannot have child routes.");let o={id:e.props.id||r.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=Ke(e.props.children,r)),n.push(o)}),n}m.memo(function({routes:e,future:t,state:n,onError:a}){return Ae(e,void 0,n,a,t)});var Qe="get",Ye="application/x-www-form-urlencoded";function Je(e){return"undefined"!=typeof HTMLElement&&e instanceof HTMLElement}function Ze(e=""){return new URLSearchParams("string"==typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let a=e[n];return t.concat(Array.isArray(a)?a.map(e=>[n,e]):[[n,a]])},[]))}var Xe=null;var et=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function tt(e){return null==e||et.has(e)?e:(R(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ye}"`),null)}function nt(e,t){let n,a,r,o,i;if(Je(s=e)&&"form"===s.tagName.toLowerCase()){let i=e.getAttribute("action");a=i?ee(i,t):null,n=e.getAttribute("method")||Qe,r=tt(e.getAttribute("enctype"))||Ye,o=new FormData(e)}else if(function(e){return Je(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Je(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let i=e.form;if(null==i)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||i.getAttribute("action");if(a=s?ee(s,t):null,n=e.getAttribute("formmethod")||i.getAttribute("method")||Qe,r=tt(e.getAttribute("formenctype"))||tt(i.getAttribute("enctype"))||Ye,o=new FormData(i,e),!function(){if(null===Xe)try{new FormData(document.createElement("form"),0),Xe=!1}catch(e){Xe=!0}return Xe}()){let{name:t,type:n,value:a}=e;if("image"===n){let e=t?`${t}.`:"";o.append(`${e}x`,"0"),o.append(`${e}y`,"0")}else t&&o.append(t,a)}}else{if(Je(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Qe,a=null,r=Ye,i=e}var s;return o&&"text/plain"===r&&(i=o,o=void 0),{action:a,method:n.toLowerCase(),encType:r,formData:o,body:i}}function at(e,t){if(!1===e||null==e)throw new Error(t)}function rt(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}async function ot(e,t,n){return function(e,t){let n=new Set;return new Set(t),e.reduce((e,t)=>{let a=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let a of n)t[a]=e[a];return t}(t));return n.has(a)||(n.add(a),e.push({key:a,link:t})),e},[])}((await Promise.all(e.map(async e=>{let a=t.routes[e.route.id];if(a){let e=await async function(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}(a,n);return e.links?e.links():[]}return[]}))).flat(1).filter(rt).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"}))}function it(e,t,n,a,r,o){let i=(e,t)=>!n[t]||e.route.id!==n[t].route.id,s=(e,t)=>n[t].pathname!==e.pathname||n[t].route.path?.endsWith("*")&&n[t].params["*"]!==e.params["*"];return"assets"===o?t.filter((e,t)=>i(e,t)||s(e,t)):"data"===o?t.filter((t,o)=>{let l=a.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(i(t,o)||s(t,o))return!0;if(t.route.shouldRevalidate){let a=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof a)return a}return!0}):[]}function st(e,t,{includeHydrateFallback:n}={}){return a=e.map(e=>{let a=t.routes[e.route.id];if(!a)return[];let r=[a.module];return a.clientActionModule&&(r=r.concat(a.clientActionModule)),a.clientLoaderModule&&(r=r.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(r=r.concat(a.hydrateFallbackModule)),a.imports&&(r=r.concat(a.imports)),r}).flat(1),[...new Set(a)];var a}function lt(){let e=m.useContext(ye);return at(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var ct=m.createContext(void 0);function dt(){let e=m.useContext(ct);return at(e,"You must render this element inside a <HydratedRouter> element"),e}function ut(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function mt({page:e,...t}){let{router:n}=lt(),a=m.useMemo(()=>F(n.routes,e,n.basename),[n.routes,e,n.basename]);return a?m.createElement(pt,{page:e,matches:a,...t}):null}function pt({page:e,matches:t,...n}){let a=je(),{manifest:r,routeModules:o}=dt(),{basename:i}=lt(),{loaderData:s,matches:l}=function(){let e=m.useContext(be);return at(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}(),c=m.useMemo(()=>it(e,t,l,r,a,"data"),[e,t,l,r,a]),d=m.useMemo(()=>it(e,t,l,r,a,"assets"),[e,t,l,r,a]),u=m.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let n=new Set,l=!1;if(t.forEach(e=>{let t=r.routes[e.route.id];t&&t.hasLoader&&(!c.some(t=>t.route.id===e.route.id)&&e.route.id in s&&o[e.route.id]?.shouldRevalidate||t.hasClientLoader?l=!0:n.add(e.route.id))}),0===n.size)return[];let d=function(e,t,n){let a="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===a.pathname?a.pathname=`_root.${n}`:t&&"/"===ee(a.pathname,t)?a.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${n}`,a}(e,i,"data");return l&&n.size>0&&d.searchParams.set("_routes",t.filter(e=>n.has(e.route.id)).map(e=>e.route.id).join(",")),[d.pathname+d.search]},[i,s,a,r,c,t,e,o]),p=m.useMemo(()=>st(d,r),[d,r]),h=function(e){let{manifest:t,routeModules:n}=dt(),[a,r]=m.useState([]);return m.useEffect(()=>{let a=!1;return ot(e,t,n).then(e=>{a||r(e)}),()=>{a=!0}},[e,t,n]),a}(d);return m.createElement(m.Fragment,null,u.map(e=>m.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...n})),p.map(e=>m.createElement("link",{key:e,rel:"modulepreload",href:e,...n})),h.map(({key:e,link:t})=>m.createElement("link",{key:e,nonce:n.nonce,...t})))}function ht(...e){return t=>{e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}}ct.displayName="FrameworkContext";var ft="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{ft&&(window.__reactRouterVersion="7.11.0")}catch(Pc){}function gt({basename:e,children:t,unstable_useTransitions:n,window:a}){let r=m.useRef();null==r.current&&(r.current=A({window:a,v5Compat:!0}));let o=r.current,[i,s]=m.useState({action:o.action,location:o.location}),l=m.useCallback(e=>{!1===n?s(e):m.startTransition(()=>s(e))},[n]);return m.useLayoutEffect(()=>o.listen(l),[o,l]),m.createElement(We,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:o,unstable_useTransitions:n})}var yt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bt=m.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:a,reloadDocument:r,replace:o,state:i,target:s,to:l,preventScrollReset:c,viewTransition:d,unstable_defaultShouldRevalidate:u,...p},h){let{basename:f,unstable_useTransitions:g}=m.useContext(we),y="string"==typeof l&&yt.test(l),b=he(l,f),v=function(e,{relative:t}={}){P(Ne(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:a}=m.useContext(we),{hash:r,pathname:o,search:i}=Le(e,{relative:t}),s=o;return"/"!==n&&(s="/"===o?n:se([n,o])),a.createHref({pathname:s,search:i,hash:r})}(l=b.to,{relative:a}),[x,w,_]=function(e,t){let n=m.useContext(ct),[a,r]=m.useState(!1),[o,i]=m.useState(!1),{onFocus:s,onBlur:l,onMouseEnter:c,onMouseLeave:d,onTouchStart:u}=t,p=m.useRef(null);m.useEffect(()=>{if("render"===e&&i(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{i(e.isIntersecting)})},{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}},[e]),m.useEffect(()=>{if(a){let e=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(e)}}},[a]);let h=()=>{r(!0)},f=()=>{r(!1),i(!1)};return n?"intent"!==e?[o,p,{}]:[o,p,{onFocus:ut(s,h),onBlur:ut(l,f),onMouseEnter:ut(c,h),onMouseLeave:ut(d,f),onTouchStart:ut(u,h)}]:[!1,p,{}]}(n,p),k=function(e,{target:t,replace:n,state:a,preventScrollReset:r,relative:o,viewTransition:i,unstable_defaultShouldRevalidate:s,unstable_useTransitions:l}={}){let c=De(),d=je(),u=Le(e,{relative:o});return m.useCallback(p=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(p,t)){p.preventDefault();let t=void 0!==n?n:q(d)===q(u),h=()=>c(e,{replace:t,state:a,preventScrollReset:r,relative:o,viewTransition:i,unstable_defaultShouldRevalidate:s});l?m.startTransition(()=>h()):h()}},[d,c,u,n,a,t,e,r,o,i,s,l])}(l,{replace:o,state:i,target:s,preventScrollReset:c,relative:a,viewTransition:d,unstable_defaultShouldRevalidate:u,unstable_useTransitions:g});let S=m.createElement("a",{...p,..._,href:b.absoluteURL||v,onClick:b.isExternal||r?e:function(t){e&&e(t),t.defaultPrevented||k(t)},ref:ht(h,w),target:s,"data-discover":y||"render"!==t?void 0:"true"});return x&&!y?m.createElement(m.Fragment,null,S,m.createElement(mt,{page:v})):S});function vt(e){let t=m.useContext(ye);return P(t,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(e)),t}function xt(e){R("undefined"!=typeof URLSearchParams,"You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=m.useRef(Ze(e)),n=m.useRef(!1),a=je(),r=m.useMemo(()=>function(e,t){let n=Ze(e);return t&&t.forEach((e,a)=>{n.has(a)||t.getAll(a).forEach(e=>{n.append(a,e)})}),n}(a.search,n.current?null:t.current),[a.search]),o=De(),i=m.useCallback((e,t)=>{const a=Ze("function"==typeof e?e(new URLSearchParams(r)):e);n.current=!0,o("?"+a,t)},[o,r]);return[r,i]}bt.displayName="Link",m.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:a=!1,style:r,to:o,viewTransition:i,children:s,...l},c){let d=Le(o,{relative:l.relative}),u=je(),p=m.useContext(be),{navigator:h,basename:f}=m.useContext(we),g=null!=p&&function(e,{relative:t}={}){let n=m.useContext(xe);P(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=vt("useViewTransitionState"),r=Le(e,{relative:t});if(!n.isTransitioning)return!1;let o=ee(n.currentLocation.pathname,a)||n.currentLocation.pathname,i=ee(n.nextLocation.pathname,a)||n.nextLocation.pathname;return null!=Z(r.pathname,i)||null!=Z(r.pathname,o)}(d)&&!0===i,y=h.encodeLocation?h.encodeLocation(d).pathname:d.pathname,b=u.pathname,v=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;t||(b=b.toLowerCase(),v=v?v.toLowerCase():null,y=y.toLowerCase()),v&&f&&(v=ee(v,f)||v);const x="/"!==y&&y.endsWith("/")?y.length-1:y.length;let w,_=b===y||!a&&b.startsWith(y)&&"/"===b.charAt(x),k=null!=v&&(v===y||!a&&v.startsWith(y)&&"/"===v.charAt(y.length)),S={isActive:_,isPending:k,isTransitioning:g},C=_?e:void 0;w="function"==typeof n?n(S):[n,_?"active":null,k?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let N="function"==typeof r?r(S):r;return m.createElement(bt,{...l,"aria-current":C,className:w,ref:c,style:N,to:o,viewTransition:i},"function"==typeof s?s(S):s)}).displayName="NavLink",m.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:a,replace:r,state:o,method:i=Qe,action:s,onSubmit:l,relative:c,preventScrollReset:d,viewTransition:u,unstable_defaultShouldRevalidate:p,...h},f)=>{let{unstable_useTransitions:g}=m.useContext(we),y=function(){let{router:e}=vt("useSubmit"),{basename:t}=m.useContext(we),n=Be("useRouteId"),a=e.fetch,r=e.navigate;return m.useCallback(async(e,o={})=>{let{action:i,method:s,encType:l,formData:c,body:d}=nt(e,t);if(!1===o.navigate){let e=o.fetcherKey||St();await a(e,n,o.action||i,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:c,body:d,formMethod:o.method||s,formEncType:o.encType||l,flushSync:o.flushSync})}else await r(o.action||i,{unstable_defaultShouldRevalidate:o.unstable_defaultShouldRevalidate,preventScrollReset:o.preventScrollReset,formData:c,body:d,formMethod:o.method||s,formEncType:o.encType||l,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[a,r,t,n])}(),b=function(e,{relative:t}={}){let{basename:n}=m.useContext(we),a=m.useContext(ke);P(a,"useFormAction must be used inside a RouteContext");let[r]=a.matches.slice(-1),o={...Le(e||".",{relative:t})},i=je();if(null==e){o.search=i.search;let e=new URLSearchParams(o.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();o.search=n?`?${n}`:""}}e&&"."!==e||!r.route.index||(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(o.pathname="/"===o.pathname?n:se([n,o.pathname]));return q(o)}(s,{relative:c}),v="get"===i.toLowerCase()?"get":"post",x="string"==typeof s&&yt.test(s);return m.createElement("form",{ref:f,method:v,action:b,onSubmit:a?l:e=>{if(l&&l(e),e.defaultPrevented)return;e.preventDefault();let a=e.nativeEvent.submitter,s=a?.getAttribute("formmethod")||i,h=()=>y(a||e.currentTarget,{fetcherKey:t,method:s,navigate:n,replace:r,state:o,relative:c,preventScrollReset:d,viewTransition:u,unstable_defaultShouldRevalidate:p});g&&!1!==n?m.startTransition(()=>h()):h()},...h,"data-discover":x||"render"!==e?void 0:"true"})}).displayName="Form";var wt,_t,kt=0,St=()=>`__${String(++kt)}__`;const Ct=y(function(){if(_t)return wt;_t=1;var e="undefined"!=typeof Element,t="function"==typeof Map,n="function"==typeof Set,a="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function r(o,i){if(o===i)return!0;if(o&&i&&"object"==typeof o&&"object"==typeof i){if(o.constructor!==i.constructor)return!1;var s,l,c,d;if(Array.isArray(o)){if((s=o.length)!=i.length)return!1;for(l=s;0!==l--;)if(!r(o[l],i[l]))return!1;return!0}if(t&&o instanceof Map&&i instanceof Map){if(o.size!==i.size)return!1;for(d=o.entries();!(l=d.next()).done;)if(!i.has(l.value[0]))return!1;for(d=o.entries();!(l=d.next()).done;)if(!r(l.value[1],i.get(l.value[0])))return!1;return!0}if(n&&o instanceof Set&&i instanceof Set){if(o.size!==i.size)return!1;for(d=o.entries();!(l=d.next()).done;)if(!i.has(l.value[0]))return!1;return!0}if(a&&ArrayBuffer.isView(o)&&ArrayBuffer.isView(i)){if((s=o.length)!=i.length)return!1;for(l=s;0!==l--;)if(o[l]!==i[l])return!1;return!0}if(o.constructor===RegExp)return o.source===i.source&&o.flags===i.flags;if(o.valueOf!==Object.prototype.valueOf&&"function"==typeof o.valueOf&&"function"==typeof i.valueOf)return o.valueOf()===i.valueOf();if(o.toString!==Object.prototype.toString&&"function"==typeof o.toString&&"function"==typeof i.toString)return o.toString()===i.toString();if((s=(c=Object.keys(o)).length)!==Object.keys(i).length)return!1;for(l=s;0!==l--;)if(!Object.prototype.hasOwnProperty.call(i,c[l]))return!1;if(e&&o instanceof Element)return!1;for(l=s;0!==l--;)if(("_owner"!==c[l]&&"__v"!==c[l]&&"__o"!==c[l]||!o.$$typeof)&&!r(o[c[l]],i[c[l]]))return!1;return!0}return o!=o&&i!=i}return wt=function(e,t){try{return r(e,t)}catch(n){if((n.message||"").match(/stack|recursion/i))return!1;throw n}}}());var Nt,jt;const Tt=y(jt?Nt:(jt=1,Nt=function(e,t,n,a,r,o,i,s){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,a,r,o,i,s],d=0;(l=new Error(t.replace(/%s/g,function(){return c[d++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}));var It,Dt;const Et=y(Dt?It:(Dt=1,It=function(e,t,n,a){var r=n?n.call(a,e,t):void 0;if(void 0!==r)return!!r;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),l=0;l<o.length;l++){var c=o[l];if(!s(c))return!1;var d=e[c],u=t[c];if(!1===(r=n?n.call(a,d,u,c):void 0)||void 0===r&&d!==u)return!1}return!0}));var Lt=(e=>(e.BASE="base",e.BODY="body",e.HEAD="head",e.HTML="html",e.LINK="link",e.META="meta",e.NOSCRIPT="noscript",e.SCRIPT="script",e.STYLE="style",e.TITLE="title",e.FRAGMENT="Symbol(react.fragment)",e))(Lt||{}),At={rel:["amphtml","canonical","alternate"]},Pt={type:["application/ld+json"]},Rt={charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]},Ot=Object.values(Lt),Mt={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},qt=Object.entries(Mt).reduce((e,[t,n])=>(e[n]=t,e),{}),zt="data-rh",Ft="defaultTitle",Bt="defer",Ut="encodeSpecialCharacters",$t="onChangeClientState",Vt="titleTemplate",Ht="prioritizeSeoTags",Wt=(e,t)=>{for(let n=e.length-1;n>=0;n-=1){const a=e[n];if(Object.prototype.hasOwnProperty.call(a,t))return a[t]}return null},Gt=e=>{let t=Wt(e,"title");const n=Wt(e,Vt);if(Array.isArray(t)&&(t=t.join("")),n&&t)return n.replace(/%s/g,()=>t);const a=Wt(e,Ft);return t||a||void 0},Kt=e=>Wt(e,$t)||(()=>{}),Qt=(e,t)=>t.filter(t=>void 0!==t[e]).map(t=>t[e]).reduce((e,t)=>({...e,...t}),{}),Yt=(e,t)=>t.filter(e=>void 0!==e.base).map(e=>e.base).reverse().reduce((t,n)=>{if(!t.length){const a=Object.keys(n);for(let r=0;r<a.length;r+=1){const o=a[r].toLowerCase();if(-1!==e.indexOf(o)&&n[o])return t.concat(n)}}return t},[]),Jt=(e,t,n)=>{const a={};return n.filter(t=>!!Array.isArray(t[e])||(void 0!==t[e]&&(t[e],console&&console.warn),!1)).map(t=>t[e]).reverse().reduce((e,n)=>{const r={};n.filter(e=>{let n;const o=Object.keys(e);for(let a=0;a<o.length;a+=1){const r=o[a],i=r.toLowerCase();-1===t.indexOf(i)||"rel"===n&&"canonical"===e[n].toLowerCase()||"rel"===i&&"stylesheet"===e[i].toLowerCase()||(n=i),-1===t.indexOf(r)||"innerHTML"!==r&&"cssText"!==r&&"itemprop"!==r||(n=r)}if(!n||!e[n])return!1;const i=e[n].toLowerCase();return a[n]||(a[n]={}),r[n]||(r[n]={}),!a[n][i]&&(r[n][i]=!0,!0)}).reverse().forEach(t=>e.push(t));const o=Object.keys(r);for(let t=0;t<o.length;t+=1){const e=o[t],n={...a[e],...r[e]};a[e]=n}return e},[]).reverse()},Zt=(e,t)=>{if(Array.isArray(e)&&e.length)for(let n=0;n<e.length;n+=1){if(e[n][t])return!0}return!1},Xt=e=>Array.isArray(e)?e.join(""):e,en=(e,t)=>Array.isArray(e)?e.reduce((e,n)=>(((e,t)=>{const n=Object.keys(e);for(let a=0;a<n.length;a+=1)if(t[n[a]]&&t[n[a]].includes(e[n[a]]))return!0;return!1})(n,t)?e.priority.push(n):e.default.push(n),e),{priority:[],default:[]}):{default:e,priority:[]},tn=(e,t)=>({...e,[t]:void 0}),nn=["noscript","script","style"],an=(e,t=!0)=>!1===t?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),rn=e=>Object.keys(e).reduce((t,n)=>{const a=void 0!==e[n]?`${n}="${e[n]}"`:`${n}`;return t?`${t} ${a}`:a},""),on=(e,t={})=>Object.keys(e).reduce((t,n)=>(t[Mt[n]||n]=e[n],t),t),sn=(e,t)=>t.map((t,n)=>{const a={key:n,[zt]:!0};return Object.keys(t).forEach(e=>{const n=Mt[e]||e;if("innerHTML"===n||"cssText"===n){const e=t.innerHTML||t.cssText;a.dangerouslySetInnerHTML={__html:e}}else a[n]=t[e]}),p.createElement(e,a)}),ln=(e,t,n=!0)=>{switch(e){case"title":return{toComponent:()=>((e,t,n)=>{const a=on(n,{key:t,[zt]:!0});return[p.createElement("title",a,t)]})(0,t.title,t.titleAttributes),toString:()=>((e,t,n,a)=>{const r=rn(n),o=Xt(t);return r?`<${e} ${zt}="true" ${r}>${an(o,a)}</${e}>`:`<${e} ${zt}="true">${an(o,a)}</${e}>`})(e,t.title,t.titleAttributes,n)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>on(t),toString:()=>rn(t)};default:return{toComponent:()=>sn(e,t),toString:()=>((e,t,n=!0)=>t.reduce((t,a)=>{const r=a,o=Object.keys(r).filter(e=>!("innerHTML"===e||"cssText"===e)).reduce((e,t)=>{const a=void 0===r[t]?t:`${t}="${an(r[t],n)}"`;return e?`${e} ${a}`:a},""),i=r.innerHTML||r.cssText||"",s=-1===nn.indexOf(e);return`${t}<${e} ${zt}="true" ${o}${s?"/>":`>${i}</${e}>`}`},""))(e,t,n)}}},cn=e=>{const{baseTag:t,bodyAttributes:n,encode:a=!0,htmlAttributes:r,noscriptTags:o,styleTags:i,title:s="",titleAttributes:l,prioritizeSeoTags:c}=e;let{linkTags:d,metaTags:u,scriptTags:m}=e,p={toComponent:()=>{},toString:()=>""};return c&&({priorityMethods:p,linkTags:d,metaTags:u,scriptTags:m}=(({metaTags:e,linkTags:t,scriptTags:n,encode:a})=>{const r=en(e,Rt),o=en(t,At),i=en(n,Pt);return{priorityMethods:{toComponent:()=>[...sn("meta",r.priority),...sn("link",o.priority),...sn("script",i.priority)],toString:()=>`${ln("meta",r.priority,a)} ${ln("link",o.priority,a)} ${ln("script",i.priority,a)}`},metaTags:r.default,linkTags:o.default,scriptTags:i.default}})(e)),{priority:p,base:ln("base",t,a),bodyAttributes:ln("bodyAttributes",n,a),htmlAttributes:ln("htmlAttributes",r,a),link:ln("link",d,a),meta:ln("meta",u,a),noscript:ln("noscript",o,a),script:ln("script",m,a),style:ln("style",i,a),title:ln("title",{title:s,titleAttributes:l},a)}},dn=[],un=!("undefined"==typeof window||!window.document||!window.document.createElement),mn=class{constructor(e,t){a(this,"instances",[]),a(this,"canUseDOM",un),a(this,"context"),a(this,"value",{setHelmet:e=>{this.context.helmet=e},helmetInstances:{get:()=>this.canUseDOM?dn:this.instances,add:e=>{(this.canUseDOM?dn:this.instances).push(e)},remove:e=>{const t=(this.canUseDOM?dn:this.instances).indexOf(e);(this.canUseDOM?dn:this.instances).splice(t,1)}}}),this.context=e,this.canUseDOM=t||!1,t||(e.helmet=cn({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},pn=p.createContext({}),hn=(e=class extends m.Component{constructor(t){super(t),a(this,"helmetData"),this.helmetData=new mn(this.props.context||{},e.canUseDOM)}render(){return p.createElement(pn.Provider,{value:this.helmetData.value},this.props.children)}},a(e,"canUseDOM",un),e),fn=(e,t)=>{const n=document.head||document.querySelector("head"),a=n.querySelectorAll(`${e}[${zt}]`),r=[].slice.call(a),o=[];let i;return t&&t.length&&t.forEach(t=>{const n=document.createElement(e);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))if("innerHTML"===e)n.innerHTML=t.innerHTML;else if("cssText"===e)n.styleSheet?n.styleSheet.cssText=t.cssText:n.appendChild(document.createTextNode(t.cssText));else{const a=e,r=void 0===t[a]?"":t[a];n.setAttribute(e,r)}n.setAttribute(zt,"true"),r.some((e,t)=>(i=t,n.isEqualNode(e)))?r.splice(i,1):o.push(n)}),r.forEach(e=>e.parentNode?.removeChild(e)),o.forEach(e=>n.appendChild(e)),{oldTags:r,newTags:o}},gn=(e,t)=>{const n=document.getElementsByTagName(e)[0];if(!n)return;const a=n.getAttribute(zt),r=a?a.split(","):[],o=[...r],i=Object.keys(t);for(const s of i){const e=t[s]||"";n.getAttribute(s)!==e&&n.setAttribute(s,e),-1===r.indexOf(s)&&r.push(s);const a=o.indexOf(s);-1!==a&&o.splice(a,1)}for(let s=o.length-1;s>=0;s-=1)n.removeAttribute(o[s]);r.length===o.length?n.removeAttribute(zt):n.getAttribute(zt)!==i.join(",")&&n.setAttribute(zt,i.join(","))},yn=(e,t)=>{const{baseTag:n,bodyAttributes:a,htmlAttributes:r,linkTags:o,metaTags:i,noscriptTags:s,onChangeClientState:l,scriptTags:c,styleTags:d,title:u,titleAttributes:m}=e;gn("body",a),gn("html",r),((e,t)=>{void 0!==e&&document.title!==e&&(document.title=Xt(e)),gn("title",t)})(u,m);const p={baseTag:fn("base",n),linkTags:fn("link",o),metaTags:fn("meta",i),noscriptTags:fn("noscript",s),scriptTags:fn("script",c),styleTags:fn("style",d)},h={},f={};Object.keys(p).forEach(e=>{const{newTags:t,oldTags:n}=p[e];t.length&&(h[e]=t),n.length&&(f[e]=p[e].oldTags)}),t&&t(),l(e,h,f)},bn=null,vn=e=>{bn&&cancelAnimationFrame(bn),e.defer?bn=requestAnimationFrame(()=>{yn(e,()=>{bn=null})}):(yn(e),bn=null)},xn=class extends m.Component{constructor(){super(...arguments),a(this,"rendered",!1)}shouldComponentUpdate(e){return!Et(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:t}=this.props.context;let n=null;const a=(r=e.get().map(e=>{const t={...e.props};return delete t.context,t}),{baseTag:Yt(["href"],r),bodyAttributes:Qt("bodyAttributes",r),defer:Wt(r,Bt),encode:Wt(r,Ut),htmlAttributes:Qt("htmlAttributes",r),linkTags:Jt("link",["rel","href"],r),metaTags:Jt("meta",["name","charset","http-equiv","property","itemprop"],r),noscriptTags:Jt("noscript",["innerHTML"],r),onChangeClientState:Kt(r),scriptTags:Jt("script",["src","innerHTML"],r),styleTags:Jt("style",["cssText"],r),title:Gt(r),titleAttributes:Qt("titleAttributes",r),prioritizeSeoTags:Zt(r,Ht)});var r;hn.canUseDOM?vn(a):cn&&(n=cn(a)),t(n)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}},wn=(t=class extends m.Component{shouldComponentUpdate(e){return!Ct(tn(this.props,"helmetData"),tn(e,"helmetData"))}mapNestedChildrenToProps(e,t){if(!t)return null;switch(e.type){case"script":case"noscript":return{innerHTML:t};case"style":return{cssText:t};default:throw new Error(`<${e.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(e,t,n,a){return{...t,[e.type]:[...t[e.type]||[],{...n,...this.mapNestedChildrenToProps(e,a)}]}}mapObjectTypeChildren(e,t,n,a){switch(e.type){case"title":return{...t,[e.type]:a,titleAttributes:{...n}};case"body":return{...t,bodyAttributes:{...n}};case"html":return{...t,htmlAttributes:{...n}};default:return{...t,[e.type]:{...n}}}}mapArrayTypeChildrenToProps(e,t){let n={...t};return Object.keys(e).forEach(t=>{n={...n,[t]:e[t]}}),n}warnOnInvalidChildren(e,t){return Tt(Ot.some(t=>e.type===t),"function"==typeof e.type?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${Ot.join(", ")} are allowed. Helmet does not support rendering <${e.type}> elements. Refer to our API for more information.`),Tt(!t||"string"==typeof t||Array.isArray(t)&&!t.some(e=>"string"!=typeof e),`Helmet expects a string as a child of <${e.type}>. Did you forget to wrap your children in braces? ( <${e.type}>{\`\`}</${e.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(e,t){let n={};return p.Children.forEach(e,e=>{if(!e||!e.props)return;const{children:a,...r}=e.props,o=Object.keys(r).reduce((e,t)=>(e[qt[t]||t]=r[t],e),{});let{type:i}=e;switch("symbol"==typeof i?i=i.toString():this.warnOnInvalidChildren(e,a),i){case"Symbol(react.fragment)":t=this.mapChildrenToProps(a,t);break;case"link":case"meta":case"noscript":case"script":case"style":n=this.flattenArrayTypeChildren(e,n,o,a);break;default:t=this.mapObjectTypeChildren(e,t,o,a)}}),this.mapArrayTypeChildrenToProps(n,t)}render(){const{children:e,...t}=this.props;let n={...t},{helmetData:a}=t;if(e&&(n=this.mapChildrenToProps(e,n)),a&&!(a instanceof mn)){a=new mn(a.context,!0),delete n.helmetData}return a?p.createElement(xn,{...n,context:a.value}):p.createElement(pn.Consumer,null,e=>p.createElement(xn,{...n,context:e}))}},a(t,"defaultProps",{defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1}),t);const _n=b("https://deitlnfumugxcbxqqivk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRlaXRsbmZ1bXVneGNieHFxaXZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU1NDgxMzMsImV4cCI6MjA4MTEyNDEzM30.unFRnnjTCuxoaAyjfWK1UNjgubq9MYjElXbTN77mjEc",{auth:{storage:window.localStorage,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"x-application-name":"productionos"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}}}),kn=()=>!!_n,Sn="kit-images";function Cn(){return[navigator.userAgent,navigator.language,screen.colorDepth,screen.width,screen.height,(new Date).getTimezoneOffset()].join("|")}async function Nn(e){const t=(new TextEncoder).encode(e);if(window.crypto&&window.crypto.subtle)try{const e=await window.crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(e))}catch(Pc){}return function(e){const t=[];for(let n=0;n<32;n++){let a=0;for(let t=0;t<e.length;t++)a=(a<<5)-a+e.charCodeAt(t)+n,a&=a;t.push(Math.abs(a)%256)}return t}(e)}async function jn(e){if(!e)return"";try{const t=Cn(),n=await Nn(t),a=(new TextEncoder).encode(e),r=new Uint8Array(a.length);for(let e=0;e<a.length;e++)r[e]=a[e]^n[e%n.length];return btoa(String.fromCharCode(...r))}catch(Pc){return e}}async function Tn(e){if(!e)return"";try{const t=Cn(),n=await Nn(t),a=new Uint8Array(atob(e).split("").map(e=>e.charCodeAt(0))),r=new Uint8Array(a.length);for(let e=0;e<a.length;e++)r[e]=a[e]^n[e%n.length];return(new TextDecoder).decode(r)}catch(Pc){return e}}async function In(e,t){const n={...e};for(const a of t)n[a]&&(n[a]=await jn(String(n[a])));return n}async function Dn(e,t){const n={...e};for(const a of t)n[a]&&(n[a]=await Tn(n[a]));return n}function En(e,t=""){if(!e)return!1;const n=/^[a-zA-Z0-9_-]+$/.test(e);return!(t&&!e.startsWith(t))&&(n&&e.length>=20&&e.length<=200)}function Ln(e,t={}){(new Date).toISOString()}const An="tell_auth_session",Pn="tell_auth_attempts",Rn=864e5;function On(){try{const e=localStorage.getItem(An);if(!e)return null;const t=JSON.parse(e);return t.expiresAt&&new Date(t.expiresAt)<new Date?(localStorage.removeItem(An),Ln(0,{email:t.email}),null):t}catch(Pc){return null}}function Mn(e){try{e?(localStorage.setItem(An,JSON.stringify(e)),Ln(0,{email:e.email,expiresAt:e.expiresAt})):localStorage.removeItem(An)}catch(Pc){}}function qn(){try{const e=localStorage.getItem(Pn);return e?JSON.parse(e):{attempts:0,lockedUntil:null}}catch{return{attempts:0,lockedUntil:null}}}function zn(e){try{localStorage.setItem(Pn,JSON.stringify(e))}catch(Pc){}}function Fn(e){const t=qn();if(e)zn({attempts:0,lockedUntil:null}),Ln();else{const e=t.attempts+1,n={attempts:e,lockedUntil:null};e>=5?(n.lockedUntil=new Date(Date.now()+9e5).toISOString(),Ln(0,{attempts:e,lockedUntil:n.lockedUntil})):Ln(0,{attempts:e,remaining:5-e}),zn(n)}}async function Bn(e){if(!kn())return null;try{const{data:t,error:n}=await _n.from("user_profiles").select("*").eq("auth_user_id",e).single();return n?null:{id:t.id,authUserId:t.auth_user_id,name:t.name,email:t.email,role:t.role,status:t.status||"active",tabPermissions:t.tab_permissions||[]}}catch(Pc){return null}}const Un=h((e,t)=>({isAuthenticated:!!On(),user:On(),error:null,isLoading:!1,rateLimited:!1,lockoutTimeRemaining:0,initialize:async()=>{if(kn())try{const{data:{session:t}}=await _n.auth.getSession();if(t){const n=await Bn(t.user.id),a={email:t.user.email,userId:t.user.id,expiresAt:new Date(Date.now()+Rn).toISOString(),provider:"supabase",profile:n};Mn(a),e({isAuthenticated:!0,user:a,error:null}),Ln(0,{email:t.user.email})}_n.auth.onAuthStateChange(async(t,n)=>{if("SIGNED_IN"===t&&n){if("google"===n.user.app_metadata?.provider&&n.provider_token)try{await _n.from("google_connections").upsert({user_id:n.user.id,google_email:n.user.email,google_user_id:n.user.user_metadata?.sub,google_name:n.user.user_metadata?.full_name||n.user.user_metadata?.name,google_picture:n.user.user_metadata?.avatar_url,access_token:n.provider_token,refresh_token:n.provider_refresh_token,token_expires_at:new Date(Date.now()+36e5).toISOString(),status:"active",sync_enabled:!0},{onConflict:"user_id,google_email"})}catch(Pc){}let t=await Bn(n.user.id);if(!t){const e=n.user.user_metadata?.full_name||n.user.user_metadata?.name||n.user.email?.split("@")[0]||"User",{data:a,error:r}=await _n.from("user_profiles").insert({auth_user_id:n.user.id,name:e,email:n.user.email,role:"user",status:"pending",tab_permissions:[]}).select().single();!r&&a&&(t={id:a.id,authUserId:a.auth_user_id,name:a.name,email:a.email,role:a.role,status:a.status,tabPermissions:a.tab_permissions||[]},Ln(0,{email:n.user.email}))}if("pending"===t?.status)return await _n.auth.signOut(),Mn(null),void e({isAuthenticated:!1,user:null,error:"Your account is pending approval. Please wait for an administrator to activate your account.",isLoading:!1});if("suspended"===t?.status)return await _n.auth.signOut(),Mn(null),void e({isAuthenticated:!1,user:null,error:"Your account has been suspended. Please contact an administrator.",isLoading:!1});const a={email:n.user.email,userId:n.user.id,expiresAt:new Date(Date.now()+Rn).toISOString(),provider:"supabase",profile:t};Mn(a),e({isAuthenticated:!0,user:a,error:null,isLoading:!1})}else"SIGNED_OUT"===t&&(Mn(null),e({isAuthenticated:!1,user:null,error:null}))})}catch(Pc){}},signup:async(t,n,a)=>{e({isLoading:!0,error:null});try{const{data:r,error:o}=await _n.auth.signUp({email:n,password:a,options:{data:{name:t}}});if(o)return e({error:o.message||"Signup failed",isLoading:!1}),!1;if(r.user){const{error:a}=await _n.from("user_profiles").insert({auth_user_id:r.user.id,name:t,email:n,role:"user",status:"pending",tab_permissions:[]});return await _n.auth.signOut(),e({isLoading:!1}),Ln(0,{email:n}),!0}return!1}catch(Pc){return e({error:"An error occurred during signup",isLoading:!1}),!1}},loginWithSupabase:async(t,n)=>{if(function(){const e=qn();return!!(e.lockedUntil&&new Date(e.lockedUntil)>new Date)||(e.lockedUntil&&new Date(e.lockedUntil)<=new Date?(zn({attempts:0,lockedUntil:null}),!1):e.attempts>=5)}()){const t=function(){const e=qn();if(!e.lockedUntil)return 0;const t=new Date(e.lockedUntil)-new Date;return Math.max(0,Math.ceil(t/1e3))}();return e({error:`Too many failed attempts. Account locked for ${Math.ceil(t/60)} minutes.`,rateLimited:!0,lockoutTimeRemaining:t}),!1}e({isLoading:!0,error:null});try{const{data:a,error:r}=await _n.auth.signInWithPassword({email:t,password:n});if(r)return Fn(!1),e({error:r.message||"Login failed",isLoading:!1}),!1;if(a.session){const t=await Bn(a.user.id);if(t){if("pending"===t.status)return await _n.auth.signOut(),e({error:"Your account is pending approval. Please wait for an administrator to activate your account.",isLoading:!1}),!1;if("suspended"===t.status)return await _n.auth.signOut(),e({error:"Your account has been suspended. Please contact an administrator.",isLoading:!1}),!1}Fn(!0);const n={email:a.user.email,userId:a.user.id,expiresAt:new Date(Date.now()+Rn).toISOString(),provider:"supabase",profile:t};return Mn(n),e({isAuthenticated:!0,user:n,error:null,isLoading:!1}),!0}return!1}catch(Pc){return Fn(!1),e({error:"An error occurred during login",isLoading:!1}),!1}},loginWithPassword:async t=>(e({error:"Password authentication not configured. Please set VITE_APP_PASSWORD environment variable or use Supabase Auth.",isLoading:!1}),!1),login:async(e,n=null)=>kn()&&n?t().loginWithSupabase(e,n):t().loginWithPassword(e),loginWithGoogle:async()=>{if(!kn())return e({error:"Google login requires Supabase configuration"}),!1;e({isLoading:!0,error:null});try{const{data:t,error:n}=await _n.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin,queryParams:{access_type:"offline",prompt:"consent"},scopes:"email profile https://www.googleapis.com/auth/gmail.readonly https://www.googleapis.com/auth/gmail.send https://www.googleapis.com/auth/gmail.modify"}});return!n||(e({error:n.message||"Google login failed",isLoading:!1}),!1)}catch(Pc){return e({error:"An error occurred during Google login",isLoading:!1}),!1}},resetPassword:async t=>{if(!kn())return{success:!1,error:"Password reset requires Supabase configuration"};e({isLoading:!0,error:null});try{const{error:n}=await _n.auth.resetPasswordForEmail(t,{redirectTo:`${window.location.origin}/reset-password`});return n?(e({isLoading:!1}),{success:!1,error:n.message}):(Ln(0,{email:t}),e({isLoading:!1}),{success:!0})}catch(Pc){return e({isLoading:!1}),{success:!1,error:"An error occurred. Please try again."}}},updatePassword:async t=>{if(!kn())return{success:!1,error:"Password update requires Supabase configuration"};e({isLoading:!0,error:null});try{const{error:n}=await _n.auth.updateUser({password:t});return n?(e({isLoading:!1}),{success:!1,error:n.message}):(Ln(),e({isLoading:!1}),{success:!0})}catch(Pc){return e({isLoading:!1}),{success:!1,error:"An error occurred. Please try again."}}},logout:async()=>{if(kn())try{await _n.auth.signOut()}catch(Pc){}Mn(null),e({isAuthenticated:!1,user:null,error:null}),Ln()},validateSession:()=>{const t=On();return t?!(t.expiresAt&&new Date(t.expiresAt)<new Date)||(Mn(null),e({isAuthenticated:!1,user:null,error:"Session expired. Please login again."}),!1):(e({isAuthenticated:!1,user:null}),!1)},extendSession:()=>{const t=On();if(!t)return;const n={...t,expiresAt:new Date(Date.now()+Rn).toISOString()};Mn(n),e({user:n})},clearError:()=>{e({error:null})},getRemainingAttempts:()=>{const e=qn();return Math.max(0,5-e.attempts)},isSupabaseAuth:()=>kn(),hasPermission:e=>{const{user:n}=t();return n?.profile?"admin"===n.profile.role||(n.profile.tabPermissions?.includes(e)??!1):"password"===n?.provider},isAdmin:()=>{const{user:e}=t();return"admin"===e?.profile?.role||"password"===e?.provider},getCurrentUserProfile:()=>{const{user:e}=t();return e?.profile||null},refreshProfile:async()=>{const{user:n}=t();if(!n?.userId||"password"===n.provider)return;const a=await Bn(n.userId);if(a){const t={...n,profile:a};Mn(t),e({user:t})}}}));if("undefined"!=typeof window){let e;Un.getState().validateSession();const t=()=>{clearTimeout(e),e=setTimeout(()=>{Un.getState().isAuthenticated&&Un.getState().extendSession()},6e4)};window.addEventListener("mousemove",t),window.addEventListener("keydown",t)}const $n=e=>(t,n,a)=>{const r=a.subscribe;a.subscribe=(e,t,n)=>{let o=e;if(t){const r=(null==n?void 0:n.equalityFn)||Object.is;let i=e(a.getState());o=n=>{const a=e(n);if(!r(i,a)){const e=i;t(i=a,e)}},(null==n?void 0:n.fireImmediately)&&t(i,i)}return r(o)};return e(t,n,a)},Vn="tell_settings",Hn=["anthropicKey","openaiKey"],Wn=["accountNumber","swiftCode","iban","sortCode","routingNumber"],Gn=[{code:"USD",name:"US Dollar",symbol:"$"},{code:"EUR",name:"Euro",symbol:""},{code:"GBP",name:"British Pound",symbol:""},{code:"JPY",name:"Japanese Yen",symbol:""},{code:"CNY",name:"Chinese Yuan",symbol:""},{code:"AUD",name:"Australian Dollar",symbol:"A$"},{code:"CAD",name:"Canadian Dollar",symbol:"C$"},{code:"CHF",name:"Swiss Franc",symbol:"CHF"},{code:"HKD",name:"Hong Kong Dollar",symbol:"HK$"},{code:"SGD",name:"Singapore Dollar",symbol:"S$"},{code:"MYR",name:"Malaysian Ringgit",symbol:"RM"},{code:"THB",name:"Thai Baht",symbol:""},{code:"IDR",name:"Indonesian Rupiah",symbol:"Rp"},{code:"PHP",name:"Philippine Peso",symbol:""},{code:"VND",name:"Vietnamese Dong",symbol:""},{code:"INR",name:"Indian Rupee",symbol:""},{code:"PKR",name:"Pakistani Rupee",symbol:""},{code:"BDT",name:"Bangladeshi Taka",symbol:""},{code:"LKR",name:"Sri Lankan Rupee",symbol:"Rs"},{code:"NPR",name:"Nepalese Rupee",symbol:"Rs"},{code:"KRW",name:"South Korean Won",symbol:""},{code:"TWD",name:"Taiwan Dollar",symbol:"NT$"},{code:"NZD",name:"New Zealand Dollar",symbol:"NZ$"},{code:"AED",name:"UAE Dirham",symbol:"."},{code:"SAR",name:"Saudi Riyal",symbol:""},{code:"QAR",name:"Qatari Riyal",symbol:"."},{code:"KWD",name:"Kuwaiti Dinar",symbol:"."},{code:"BHD",name:"Bahraini Dinar",symbol:".."},{code:"OMR",name:"Omani Rial",symbol:".."},{code:"JOD",name:"Jordanian Dinar",symbol:"."},{code:"ILS",name:"Israeli Shekel",symbol:""},{code:"TRY",name:"Turkish Lira",symbol:""},{code:"EGP",name:"Egyptian Pound",symbol:"E"},{code:"ZAR",name:"South African Rand",symbol:"R"},{code:"NGN",name:"Nigerian Naira",symbol:""},{code:"KES",name:"Kenyan Shilling",symbol:"KSh"},{code:"GHS",name:"Ghanaian Cedi",symbol:"GH"},{code:"MAD",name:"Moroccan Dirham",symbol:".."},{code:"BRL",name:"Brazilian Real",symbol:"R$"},{code:"MXN",name:"Mexican Peso",symbol:"MX$"},{code:"ARS",name:"Argentine Peso",symbol:"AR$"},{code:"CLP",name:"Chilean Peso",symbol:"CLP$"},{code:"COP",name:"Colombian Peso",symbol:"COL$"},{code:"PEN",name:"Peruvian Sol",symbol:"S/"},{code:"SEK",name:"Swedish Krona",symbol:"kr"},{code:"NOK",name:"Norwegian Krone",symbol:"kr"},{code:"DKK",name:"Danish Krone",symbol:"kr"},{code:"PLN",name:"Polish Zloty",symbol:"z"},{code:"CZK",name:"Czech Koruna",symbol:"K"},{code:"HUF",name:"Hungarian Forint",symbol:"Ft"},{code:"RON",name:"Romanian Leu",symbol:"lei"},{code:"BGN",name:"Bulgarian Lev",symbol:""},{code:"HRK",name:"Croatian Kuna",symbol:"kn"},{code:"RUB",name:"Russian Ruble",symbol:""},{code:"UAH",name:"Ukrainian Hryvnia",symbol:""},{code:"KZT",name:"Kazakhstani Tenge",symbol:""},{code:"UZS",name:"Uzbekistani Som",symbol:""},{code:"MMK",name:"Myanmar Kyat",symbol:"K"},{code:"KHR",name:"Cambodian Riel",symbol:""},{code:"LAK",name:"Laotian Kip",symbol:""},{code:"BND",name:"Brunei Dollar",symbol:"B$"},{code:"IQD",name:"Iraqi Dinar",symbol:"."},{code:"LBP",name:"Lebanese Pound",symbol:"."},{code:"GTQ",name:"Guatemalan Quetzal",symbol:"Q"},{code:"CRC",name:"Costa Rican Coln",symbol:""},{code:"PAB",name:"Panamanian Balboa",symbol:"B/."},{code:"DOP",name:"Dominican Peso",symbol:"RD$"},{code:"JMD",name:"Jamaican Dollar",symbol:"J$"},{code:"TTD",name:"Trinidad Dollar",symbol:"TT$"},{code:"BSD",name:"Bahamian Dollar",symbol:"B$"},{code:"BBD",name:"Barbadian Dollar",symbol:"Bds$"},{code:"XCD",name:"East Caribbean Dollar",symbol:"EC$"},{code:"VES",name:"Venezuelan Bolvar",symbol:"Bs.S"},{code:"BOB",name:"Bolivian Boliviano",symbol:"Bs."},{code:"PYG",name:"Paraguayan Guaran",symbol:""},{code:"UYU",name:"Uruguayan Peso",symbol:"$U"},{code:"GYD",name:"Guyanese Dollar",symbol:"G$"},{code:"SRD",name:"Surinamese Dollar",symbol:"Sr$"},{code:"HNL",name:"Honduran Lempira",symbol:"L"},{code:"NIO",name:"Nicaraguan Crdoba",symbol:"C$"},{code:"ISK",name:"Icelandic Krna",symbol:"kr"},{code:"RSD",name:"Serbian Dinar",symbol:"."},{code:"MKD",name:"Macedonian Denar",symbol:""},{code:"ALL",name:"Albanian Lek",symbol:"L"},{code:"BAM",name:"Bosnia Mark",symbol:"KM"},{code:"GEL",name:"Georgian Lari",symbol:""},{code:"AMD",name:"Armenian Dram",symbol:""},{code:"AZN",name:"Azerbaijani Manat",symbol:""},{code:"MDL",name:"Moldovan Leu",symbol:"L"},{code:"BYN",name:"Belarusian Ruble",symbol:"Br"},{code:"TJS",name:"Tajikistani Somoni",symbol:"SM"},{code:"TMT",name:"Turkmenistani Manat",symbol:"m"},{code:"KGS",name:"Kyrgyzstani Som",symbol:""},{code:"MNT",name:"Mongolian Tugrik",symbol:""},{code:"SYP",name:"Syrian Pound",symbol:"S"},{code:"YER",name:"Yemeni Rial",symbol:""},{code:"IRR",name:"Iranian Rial",symbol:""},{code:"AFN",name:"Afghan Afghani",symbol:""},{code:"TND",name:"Tunisian Dinar",symbol:"."},{code:"DZD",name:"Algerian Dinar",symbol:"."},{code:"LYD",name:"Libyan Dinar",symbol:"."},{code:"SDG",name:"Sudanese Pound",symbol:".."},{code:"ETB",name:"Ethiopian Birr",symbol:"Br"},{code:"TZS",name:"Tanzanian Shilling",symbol:"TSh"},{code:"UGX",name:"Ugandan Shilling",symbol:"USh"},{code:"RWF",name:"Rwandan Franc",symbol:"FRw"},{code:"XOF",name:"West African CFA Franc",symbol:"CFA"},{code:"XAF",name:"Central African CFA Franc",symbol:"FCFA"},{code:"MUR",name:"Mauritian Rupee",symbol:""},{code:"SCR",name:"Seychellois Rupee",symbol:"SR"},{code:"MZN",name:"Mozambican Metical",symbol:"MT"},{code:"AOA",name:"Angolan Kwanza",symbol:"Kz"},{code:"ZMW",name:"Zambian Kwacha",symbol:"ZK"},{code:"BWP",name:"Botswana Pula",symbol:"P"},{code:"NAD",name:"Namibian Dollar",symbol:"N$"},{code:"MWK",name:"Malawian Kwacha",symbol:"MK"},{code:"ZWL",name:"Zimbabwean Dollar",symbol:"Z$"},{code:"SZL",name:"Eswatini Lilangeni",symbol:"E"},{code:"LSL",name:"Lesotho Loti",symbol:"M"},{code:"GMD",name:"Gambian Dalasi",symbol:"D"},{code:"SLL",name:"Sierra Leonean Leone",symbol:"Le"},{code:"LRD",name:"Liberian Dollar",symbol:"L$"},{code:"CVE",name:"Cape Verdean Escudo",symbol:"$"},{code:"MRU",name:"Mauritanian Ouguiya",symbol:"UM"},{code:"DJF",name:"Djiboutian Franc",symbol:"Fdj"},{code:"ERN",name:"Eritrean Nakfa",symbol:"Nfk"},{code:"SOS",name:"Somali Shilling",symbol:"Sh.So."},{code:"FJD",name:"Fiji Dollar",symbol:"FJ$"},{code:"PGK",name:"Papua New Guinean Kina",symbol:"K"},{code:"XPF",name:"CFP Franc",symbol:""},{code:"WST",name:"Samoan Tala",symbol:"WS$"},{code:"TOP",name:"Tongan Paanga",symbol:"T$"},{code:"VUV",name:"Vanuatu Vatu",symbol:"VT"},{code:"SBD",name:"Solomon Islands Dollar",symbol:"SI$"},{code:"BTN",name:"Bhutanese Ngultrum",symbol:"Nu."},{code:"MVR",name:"Maldivian Rufiyaa",symbol:"Rf"}],Kn={US:{name:"United States",taxName:"Sales Tax",rate:0,taxIdLabel:"EIN",reverseCharge:!1},CA:{name:"Canada",taxName:"GST/HST",rate:5,taxIdLabel:"GST/HST Number",reverseCharge:!1},MX:{name:"Mexico",taxName:"IVA",rate:16,taxIdLabel:"RFC",reverseCharge:!1},GT:{name:"Guatemala",taxName:"IVA",rate:12,taxIdLabel:"NIT",reverseCharge:!1},BZ:{name:"Belize",taxName:"GST",rate:12.5,taxIdLabel:"TIN",reverseCharge:!1},SV:{name:"El Salvador",taxName:"IVA",rate:13,taxIdLabel:"NIT",reverseCharge:!1},HN:{name:"Honduras",taxName:"ISV",rate:15,taxIdLabel:"RTN",reverseCharge:!1},NI:{name:"Nicaragua",taxName:"IVA",rate:15,taxIdLabel:"RUC",reverseCharge:!1},CR:{name:"Costa Rica",taxName:"IVA",rate:13,taxIdLabel:"Cedula Juridica",reverseCharge:!1},PA:{name:"Panama",taxName:"ITBMS",rate:7,taxIdLabel:"RUC",reverseCharge:!1},CU:{name:"Cuba",taxName:"Sales Tax",rate:10,taxIdLabel:"NIT",reverseCharge:!1},JM:{name:"Jamaica",taxName:"GCT",rate:15,taxIdLabel:"TRN",reverseCharge:!1},HT:{name:"Haiti",taxName:"TCA",rate:10,taxIdLabel:"NIF",reverseCharge:!1},DO:{name:"Dominican Republic",taxName:"ITBIS",rate:18,taxIdLabel:"RNC",reverseCharge:!1},PR:{name:"Puerto Rico",taxName:"IVU",rate:11.5,taxIdLabel:"EIN",reverseCharge:!1},TT:{name:"Trinidad and Tobago",taxName:"VAT",rate:12.5,taxIdLabel:"BIR",reverseCharge:!1},BB:{name:"Barbados",taxName:"VAT",rate:17.5,taxIdLabel:"TIN",reverseCharge:!1},BS:{name:"Bahamas",taxName:"VAT",rate:12,taxIdLabel:"TIN",reverseCharge:!1},LC:{name:"Saint Lucia",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},GD:{name:"Grenada",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},VC:{name:"Saint Vincent",taxName:"VAT",rate:16,taxIdLabel:"TIN",reverseCharge:!1},AG:{name:"Antigua and Barbuda",taxName:"ABST",rate:15,taxIdLabel:"TIN",reverseCharge:!1},DM:{name:"Dominica",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},KN:{name:"Saint Kitts and Nevis",taxName:"VAT",rate:17,taxIdLabel:"TIN",reverseCharge:!1},BR:{name:"Brazil",taxName:"ICMS",rate:18,taxIdLabel:"CNPJ",reverseCharge:!1},AR:{name:"Argentina",taxName:"IVA",rate:21,taxIdLabel:"CUIT",reverseCharge:!1},CO:{name:"Colombia",taxName:"IVA",rate:19,taxIdLabel:"NIT",reverseCharge:!1},PE:{name:"Peru",taxName:"IGV",rate:18,taxIdLabel:"RUC",reverseCharge:!1},VE:{name:"Venezuela",taxName:"IVA",rate:16,taxIdLabel:"RIF",reverseCharge:!1},CL:{name:"Chile",taxName:"IVA",rate:19,taxIdLabel:"RUT",reverseCharge:!1},EC:{name:"Ecuador",taxName:"IVA",rate:12,taxIdLabel:"RUC",reverseCharge:!1},BO:{name:"Bolivia",taxName:"IVA",rate:13,taxIdLabel:"NIT",reverseCharge:!1},PY:{name:"Paraguay",taxName:"IVA",rate:10,taxIdLabel:"RUC",reverseCharge:!1},UY:{name:"Uruguay",taxName:"IVA",rate:22,taxIdLabel:"RUT",reverseCharge:!1},GY:{name:"Guyana",taxName:"VAT",rate:14,taxIdLabel:"TIN",reverseCharge:!1},SR:{name:"Suriname",taxName:"BTW",rate:10,taxIdLabel:"TIN",reverseCharge:!1},GB:{name:"United Kingdom",taxName:"VAT",rate:20,taxIdLabel:"VAT Number",reverseCharge:!0},IE:{name:"Ireland",taxName:"VAT",rate:23,taxIdLabel:"VAT Number",reverseCharge:!0},FR:{name:"France",taxName:"TVA",rate:20,taxIdLabel:"TVA Intracommunautaire",reverseCharge:!0},DE:{name:"Germany",taxName:"MwSt",rate:19,taxIdLabel:"USt-IdNr",reverseCharge:!0},NL:{name:"Netherlands",taxName:"BTW",rate:21,taxIdLabel:"BTW-nummer",reverseCharge:!0},BE:{name:"Belgium",taxName:"BTW/TVA",rate:21,taxIdLabel:"BTW nummer",reverseCharge:!0},LU:{name:"Luxembourg",taxName:"TVA",rate:17,taxIdLabel:"TVA Number",reverseCharge:!0},CH:{name:"Switzerland",taxName:"MwSt",rate:8.1,taxIdLabel:"MwSt-Nr",reverseCharge:!1},AT:{name:"Austria",taxName:"USt",rate:20,taxIdLabel:"UID-Nummer",reverseCharge:!0},LI:{name:"Liechtenstein",taxName:"MWST",rate:8.1,taxIdLabel:"MWST-Nr",reverseCharge:!1},ES:{name:"Spain",taxName:"IVA",rate:21,taxIdLabel:"NIF/CIF",reverseCharge:!0},PT:{name:"Portugal",taxName:"IVA",rate:23,taxIdLabel:"NIF",reverseCharge:!0},IT:{name:"Italy",taxName:"IVA",rate:22,taxIdLabel:"Partita IVA",reverseCharge:!0},GR:{name:"Greece",taxName:"FPA",rate:24,taxIdLabel:"AFM",reverseCharge:!0},MT:{name:"Malta",taxName:"VAT",rate:18,taxIdLabel:"VAT Number",reverseCharge:!0},CY:{name:"Cyprus",taxName:"VAT",rate:19,taxIdLabel:"VAT Number",reverseCharge:!0},AD:{name:"Andorra",taxName:"IGI",rate:4.5,taxIdLabel:"NRT",reverseCharge:!1},SM:{name:"San Marino",taxName:"IGC",rate:17,taxIdLabel:"COE",reverseCharge:!1},MC:{name:"Monaco",taxName:"TVA",rate:20,taxIdLabel:"TVA Number",reverseCharge:!1},VA:{name:"Vatican City",taxName:"None",rate:0,taxIdLabel:"None",reverseCharge:!1},SE:{name:"Sweden",taxName:"Moms",rate:25,taxIdLabel:"Momsreg.nummer",reverseCharge:!0},NO:{name:"Norway",taxName:"MVA",rate:25,taxIdLabel:"MVA-nummer",reverseCharge:!1},DK:{name:"Denmark",taxName:"Moms",rate:25,taxIdLabel:"CVR-nummer",reverseCharge:!0},FI:{name:"Finland",taxName:"ALV",rate:25.5,taxIdLabel:"ALV-numero",reverseCharge:!0},IS:{name:"Iceland",taxName:"VSK",rate:24,taxIdLabel:"VSK Number",reverseCharge:!1},EE:{name:"Estonia",taxName:"KM",rate:22,taxIdLabel:"KMKR",reverseCharge:!0},LV:{name:"Latvia",taxName:"PVN",rate:21,taxIdLabel:"PVN Number",reverseCharge:!0},LT:{name:"Lithuania",taxName:"PVM",rate:21,taxIdLabel:"PVM Code",reverseCharge:!0},PL:{name:"Poland",taxName:"VAT",rate:23,taxIdLabel:"NIP",reverseCharge:!0},CZ:{name:"Czech Republic",taxName:"DPH",rate:21,taxIdLabel:"DIC",reverseCharge:!0},SK:{name:"Slovakia",taxName:"DPH",rate:20,taxIdLabel:"IC DPH",reverseCharge:!0},HU:{name:"Hungary",taxName:"AFA",rate:27,taxIdLabel:"EU VAT",reverseCharge:!0},RO:{name:"Romania",taxName:"TVA",rate:19,taxIdLabel:"CIF",reverseCharge:!0},BG:{name:"Bulgaria",taxName:"DDS",rate:20,taxIdLabel:"EIK",reverseCharge:!0},UA:{name:"Ukraine",taxName:"PDV",rate:20,taxIdLabel:"EDRPOU",reverseCharge:!1},BY:{name:"Belarus",taxName:"VAT",rate:20,taxIdLabel:"UNP",reverseCharge:!1},MD:{name:"Moldova",taxName:"TVA",rate:20,taxIdLabel:"IDNO",reverseCharge:!1},RU:{name:"Russia",taxName:"NDS",rate:20,taxIdLabel:"INN",reverseCharge:!1},HR:{name:"Croatia",taxName:"PDV",rate:25,taxIdLabel:"OIB",reverseCharge:!0},SI:{name:"Slovenia",taxName:"DDV",rate:22,taxIdLabel:"ID za DDV",reverseCharge:!0},RS:{name:"Serbia",taxName:"PDV",rate:20,taxIdLabel:"PIB",reverseCharge:!1},BA:{name:"Bosnia and Herzegovina",taxName:"PDV",rate:17,taxIdLabel:"ID",reverseCharge:!1},ME:{name:"Montenegro",taxName:"PDV",rate:21,taxIdLabel:"PIB",reverseCharge:!1},MK:{name:"North Macedonia",taxName:"DDV",rate:18,taxIdLabel:"EDB",reverseCharge:!1},AL:{name:"Albania",taxName:"TVSH",rate:20,taxIdLabel:"NUIS",reverseCharge:!1},XK:{name:"Kosovo",taxName:"VAT",rate:18,taxIdLabel:"Fiscal Number",reverseCharge:!1},AE:{name:"UAE",taxName:"VAT",rate:5,taxIdLabel:"TRN",reverseCharge:!1},SA:{name:"Saudi Arabia",taxName:"VAT",rate:15,taxIdLabel:"VAT Registration No",reverseCharge:!1},QA:{name:"Qatar",taxName:"None",rate:0,taxIdLabel:"QID",reverseCharge:!1},KW:{name:"Kuwait",taxName:"None",rate:0,taxIdLabel:"Civil ID",reverseCharge:!1},BH:{name:"Bahrain",taxName:"VAT",rate:10,taxIdLabel:"VAT Registration No",reverseCharge:!1},OM:{name:"Oman",taxName:"VAT",rate:5,taxIdLabel:"VAT Registration No",reverseCharge:!1},JO:{name:"Jordan",taxName:"GST",rate:16,taxIdLabel:"Tax Number",reverseCharge:!1},LB:{name:"Lebanon",taxName:"VAT",rate:11,taxIdLabel:"VAT Number",reverseCharge:!1},SY:{name:"Syria",taxName:"VAT",rate:10,taxIdLabel:"Tax ID",reverseCharge:!1},IQ:{name:"Iraq",taxName:"Sales Tax",rate:15,taxIdLabel:"Tax ID",reverseCharge:!1},IR:{name:"Iran",taxName:"VAT",rate:9,taxIdLabel:"Economic Code",reverseCharge:!1},YE:{name:"Yemen",taxName:"GST",rate:5,taxIdLabel:"Tax ID",reverseCharge:!1},IL:{name:"Israel",taxName:"VAT",rate:17,taxIdLabel:"Osek Murshe",reverseCharge:!1},PS:{name:"Palestine",taxName:"VAT",rate:16,taxIdLabel:"Tax ID",reverseCharge:!1},TR:{name:"Turkey",taxName:"KDV",rate:20,taxIdLabel:"Vergi No",reverseCharge:!1},KZ:{name:"Kazakhstan",taxName:"VAT",rate:12,taxIdLabel:"BIN",reverseCharge:!1},UZ:{name:"Uzbekistan",taxName:"VAT",rate:12,taxIdLabel:"TIN",reverseCharge:!1},TM:{name:"Turkmenistan",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},TJ:{name:"Tajikistan",taxName:"VAT",rate:18,taxIdLabel:"TIN",reverseCharge:!1},KG:{name:"Kyrgyzstan",taxName:"VAT",rate:12,taxIdLabel:"TIN",reverseCharge:!1},AF:{name:"Afghanistan",taxName:"BRT",rate:4,taxIdLabel:"TIN",reverseCharge:!1},IN:{name:"India",taxName:"GST",rate:18,taxIdLabel:"GSTIN",reverseCharge:!1},PK:{name:"Pakistan",taxName:"GST",rate:18,taxIdLabel:"NTN",reverseCharge:!1},BD:{name:"Bangladesh",taxName:"VAT",rate:15,taxIdLabel:"BIN",reverseCharge:!1},LK:{name:"Sri Lanka",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},NP:{name:"Nepal",taxName:"VAT",rate:13,taxIdLabel:"PAN",reverseCharge:!1},BT:{name:"Bhutan",taxName:"Sales Tax",rate:0,taxIdLabel:"TIN",reverseCharge:!1},MV:{name:"Maldives",taxName:"GST",rate:16,taxIdLabel:"TIN",reverseCharge:!1},SG:{name:"Singapore",taxName:"GST",rate:9,taxIdLabel:"GST Registration No",reverseCharge:!1},MY:{name:"Malaysia",taxName:"SST",rate:6,taxIdLabel:"SST Registration No",reverseCharge:!1},TH:{name:"Thailand",taxName:"VAT",rate:7,taxIdLabel:"Tax ID",reverseCharge:!1},ID:{name:"Indonesia",taxName:"PPN",rate:11,taxIdLabel:"NPWP",reverseCharge:!1},PH:{name:"Philippines",taxName:"VAT",rate:12,taxIdLabel:"TIN",reverseCharge:!1},VN:{name:"Vietnam",taxName:"VAT",rate:10,taxIdLabel:"Tax Code",reverseCharge:!1},MM:{name:"Myanmar",taxName:"CT",rate:5,taxIdLabel:"TIN",reverseCharge:!1},KH:{name:"Cambodia",taxName:"VAT",rate:10,taxIdLabel:"TIN",reverseCharge:!1},LA:{name:"Laos",taxName:"VAT",rate:10,taxIdLabel:"TIN",reverseCharge:!1},BN:{name:"Brunei",taxName:"None",rate:0,taxIdLabel:"BRN",reverseCharge:!1},TL:{name:"Timor-Leste",taxName:"Sales Tax",rate:2.5,taxIdLabel:"TIN",reverseCharge:!1},CN:{name:"China",taxName:"VAT",rate:13,taxIdLabel:"Tax Registration No",reverseCharge:!1},JP:{name:"Japan",taxName:"JCT",rate:10,taxIdLabel:"Corporate Number",reverseCharge:!1},KR:{name:"South Korea",taxName:"VAT",rate:10,taxIdLabel:"Business Reg No",reverseCharge:!1},TW:{name:"Taiwan",taxName:"VAT",rate:5,taxIdLabel:"Unified Business No",reverseCharge:!1},HK:{name:"Hong Kong",taxName:"None",rate:0,taxIdLabel:"BR Number",reverseCharge:!1},MO:{name:"Macau",taxName:"None",rate:0,taxIdLabel:"BRN",reverseCharge:!1},MN:{name:"Mongolia",taxName:"VAT",rate:10,taxIdLabel:"TIN",reverseCharge:!1},AU:{name:"Australia",taxName:"GST",rate:10,taxIdLabel:"ABN",reverseCharge:!1},NZ:{name:"New Zealand",taxName:"GST",rate:15,taxIdLabel:"GST Number",reverseCharge:!1},FJ:{name:"Fiji",taxName:"VAT",rate:9,taxIdLabel:"TIN",reverseCharge:!1},PG:{name:"Papua New Guinea",taxName:"GST",rate:10,taxIdLabel:"TIN",reverseCharge:!1},WS:{name:"Samoa",taxName:"VAGST",rate:15,taxIdLabel:"TIN",reverseCharge:!1},TO:{name:"Tonga",taxName:"CT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},VU:{name:"Vanuatu",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},SB:{name:"Solomon Islands",taxName:"GST",rate:15,taxIdLabel:"TIN",reverseCharge:!1},NC:{name:"New Caledonia",taxName:"TGC",rate:11,taxIdLabel:"RIDET",reverseCharge:!1},PF:{name:"French Polynesia",taxName:"TVA",rate:16,taxIdLabel:"TAHITI",reverseCharge:!1},GU:{name:"Guam",taxName:"GRT",rate:4,taxIdLabel:"TIN",reverseCharge:!1},EG:{name:"Egypt",taxName:"VAT",rate:14,taxIdLabel:"Tax Reg No",reverseCharge:!1},MA:{name:"Morocco",taxName:"TVA",rate:20,taxIdLabel:"IF",reverseCharge:!1},DZ:{name:"Algeria",taxName:"TVA",rate:19,taxIdLabel:"NIF",reverseCharge:!1},TN:{name:"Tunisia",taxName:"TVA",rate:19,taxIdLabel:"MF",reverseCharge:!1},LY:{name:"Libya",taxName:"None",rate:0,taxIdLabel:"TIN",reverseCharge:!1},SD:{name:"Sudan",taxName:"VAT",rate:17,taxIdLabel:"TIN",reverseCharge:!1},NG:{name:"Nigeria",taxName:"VAT",rate:7.5,taxIdLabel:"TIN",reverseCharge:!1},GH:{name:"Ghana",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},SN:{name:"Senegal",taxName:"TVA",rate:18,taxIdLabel:"NINEA",reverseCharge:!1},CI:{name:"Cote d'Ivoire",taxName:"TVA",rate:18,taxIdLabel:"CC",reverseCharge:!1},ML:{name:"Mali",taxName:"TVA",rate:18,taxIdLabel:"NIF",reverseCharge:!1},BF:{name:"Burkina Faso",taxName:"TVA",rate:18,taxIdLabel:"IFU",reverseCharge:!1},NE:{name:"Niger",taxName:"TVA",rate:19,taxIdLabel:"NIF",reverseCharge:!1},GN:{name:"Guinea",taxName:"TVA",rate:18,taxIdLabel:"NIF",reverseCharge:!1},BJ:{name:"Benin",taxName:"TVA",rate:18,taxIdLabel:"IFU",reverseCharge:!1},TG:{name:"Togo",taxName:"TVA",rate:18,taxIdLabel:"NIF",reverseCharge:!1},SL:{name:"Sierra Leone",taxName:"GST",rate:15,taxIdLabel:"TIN",reverseCharge:!1},LR:{name:"Liberia",taxName:"GST",rate:10,taxIdLabel:"TIN",reverseCharge:!1},MR:{name:"Mauritania",taxName:"TVA",rate:16,taxIdLabel:"NIF",reverseCharge:!1},GM:{name:"Gambia",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},GW:{name:"Guinea-Bissau",taxName:"IGV",rate:17,taxIdLabel:"NIF",reverseCharge:!1},CV:{name:"Cape Verde",taxName:"IVA",rate:15,taxIdLabel:"NIF",reverseCharge:!1},KE:{name:"Kenya",taxName:"VAT",rate:16,taxIdLabel:"KRA PIN",reverseCharge:!1},TZ:{name:"Tanzania",taxName:"VAT",rate:18,taxIdLabel:"TIN",reverseCharge:!1},UG:{name:"Uganda",taxName:"VAT",rate:18,taxIdLabel:"TIN",reverseCharge:!1},ET:{name:"Ethiopia",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},RW:{name:"Rwanda",taxName:"VAT",rate:18,taxIdLabel:"TIN",reverseCharge:!1},BI:{name:"Burundi",taxName:"TVA",rate:18,taxIdLabel:"NIF",reverseCharge:!1},SO:{name:"Somalia",taxName:"Sales Tax",rate:5,taxIdLabel:"TIN",reverseCharge:!1},DJ:{name:"Djibouti",taxName:"TVA",rate:10,taxIdLabel:"NIF",reverseCharge:!1},ER:{name:"Eritrea",taxName:"Sales Tax",rate:5,taxIdLabel:"TIN",reverseCharge:!1},SS:{name:"South Sudan",taxName:"VAT",rate:18,taxIdLabel:"TIN",reverseCharge:!1},MU:{name:"Mauritius",taxName:"VAT",rate:15,taxIdLabel:"VAT Number",reverseCharge:!1},SC:{name:"Seychelles",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},MG:{name:"Madagascar",taxName:"TVA",rate:20,taxIdLabel:"NIF",reverseCharge:!1},KM:{name:"Comoros",taxName:"TVA",rate:10,taxIdLabel:"NIF",reverseCharge:!1},RE:{name:"Reunion",taxName:"TVA",rate:8.5,taxIdLabel:"SIRET",reverseCharge:!1},CD:{name:"DR Congo",taxName:"TVA",rate:16,taxIdLabel:"NIF",reverseCharge:!1},CG:{name:"Congo",taxName:"TVA",rate:18,taxIdLabel:"NIF",reverseCharge:!1},CF:{name:"Central African Republic",taxName:"TVA",rate:19,taxIdLabel:"NIF",reverseCharge:!1},CM:{name:"Cameroon",taxName:"TVA",rate:19.25,taxIdLabel:"NIU",reverseCharge:!1},TD:{name:"Chad",taxName:"TVA",rate:18,taxIdLabel:"NIF",reverseCharge:!1},GA:{name:"Gabon",taxName:"TVA",rate:18,taxIdLabel:"NIF",reverseCharge:!1},GQ:{name:"Equatorial Guinea",taxName:"IVA",rate:15,taxIdLabel:"NIF",reverseCharge:!1},ST:{name:"Sao Tome and Principe",taxName:"IVA",rate:15,taxIdLabel:"NIF",reverseCharge:!1},AO:{name:"Angola",taxName:"IVA",rate:14,taxIdLabel:"NIF",reverseCharge:!1},ZA:{name:"South Africa",taxName:"VAT",rate:15,taxIdLabel:"VAT Number",reverseCharge:!1},ZW:{name:"Zimbabwe",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},ZM:{name:"Zambia",taxName:"VAT",rate:16,taxIdLabel:"TPIN",reverseCharge:!1},BW:{name:"Botswana",taxName:"VAT",rate:14,taxIdLabel:"TIN",reverseCharge:!1},NA:{name:"Namibia",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},MZ:{name:"Mozambique",taxName:"IVA",rate:17,taxIdLabel:"NUIT",reverseCharge:!1},MW:{name:"Malawi",taxName:"VAT",rate:16.5,taxIdLabel:"TPIN",reverseCharge:!1},SZ:{name:"Eswatini",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},LS:{name:"Lesotho",taxName:"VAT",rate:15,taxIdLabel:"TIN",reverseCharge:!1},GE:{name:"Georgia",taxName:"VAT",rate:18,taxIdLabel:"TIN",reverseCharge:!1},AM:{name:"Armenia",taxName:"VAT",rate:20,taxIdLabel:"TIN",reverseCharge:!1},AZ:{name:"Azerbaijan",taxName:"VAT",rate:18,taxIdLabel:"VOEN",reverseCharge:!1}},Qn={theme:"dark",company:{name:"",address:"",city:"",country:"",phone:"",email:"",website:"",logo:null},taxInfo:{taxNumber:"",registrationNumber:"",licenses:""},taxConfig:{homeCountry:"MY",taxRegistered:!0,domesticTaxRate:6,domesticTaxName:"SST",applyTaxToInternational:!1,showTaxBreakdown:!0,reverseChargeEnabled:!0,reverseChargeText:"Reverse charge: VAT to be accounted for by the recipient as per Article 196 of the EU VAT Directive",exportServicesText:"Export of services - zero rated for VAT purposes",domesticExemptText:"",requireClientTaxId:!1,validateTaxId:!1,eInvoicingEnabled:!1,eInvoicingFormat:"",customTaxRules:{}},bankDetails:{bankName:"",bankAddress:"",accountName:"",accountNumber:"",sortCode:"",iban:"",swiftCode:"",routingNumber:"",branchCode:"",bsbNumber:"",currency:"MYR",additionalInfo:""},quoteDefaults:{validityDays:30,paymentTerms:"50% deposit on confirmation, balance on completion",termsAndConditions:" This quote is valid for 30 days from the date of issue.\n 50% deposit required upon confirmation.\n Final payment due within 14 days of project completion.\n Any additional requirements may incur extra charges.\n Cancellation within 7 days of project start may incur fees."},users:[{id:"default",name:"Tom",email:"",role:"admin"}],pdfOptions:{showCompanyAddress:!0,showCompanyPhone:!0,showCompanyEmail:!0,showTaxNumber:!1,showBankDetails:!1,showLogo:!0,primaryColor:"#143642",accentColor:"#0F8B8D",lineColor:"#143642",textColor:"#374151",mutedColor:"#6B7280",backgroundColor:"#FFFFFF"},aiSettings:{anthropicKey:"",openaiKey:""},projectTypes:[{id:"broadcast",label:"Broadcast"},{id:"streaming",label:"Streaming"},{id:"graphics",label:"Graphics"},{id:"sports_presentation",label:"Sports Presentation"},{id:"technical_consultancy",label:"Technical Management & Consultancy"},{id:"other",label:"Other"}],regions:[{id:"SEA",label:"South East Asia",currency:"USD",countries:["Malaysia","Singapore","Indonesia","Thailand","Vietnam","Philippines","Myanmar","Cambodia","Laos","Brunei"]},{id:"GCC",label:"Gulf States",currency:"KWD",countries:["Saudi Arabia","UAE","Qatar","Kuwait","Bahrain","Oman"]},{id:"LEVANT",label:"Levant",currency:"USD",countries:["Jordan","Lebanon","Iraq"]},{id:"CENTRAL_ASIA",label:"Central Asia",currency:"USD",countries:["Kazakhstan","Uzbekistan","Turkmenistan","Tajikistan","Kyrgyzstan"]}],preferredCurrencies:["USD","EUR","GBP","MYR","SGD"],okrs:[{id:"okr1",objective:"Expand into GCC market",keyResult:"Win 3 major sports broadcast contracts in Saudi Arabia or UAE by end of 2025",priority:1},{id:"okr2",objective:"Grow recurring revenue",keyResult:"Establish 5 long-term league partnerships across SEA region",priority:2},{id:"okr3",objective:"Build Central Asia presence",keyResult:"Deliver 2 multi-sport events in Kazakhstan or Uzbekistan",priority:3}],opsPreferences:{expandedCountries:{},hiddenCountries:{},dashboardCurrency:"USD"},dashboardPreferences:{currency:"USD",collapsedColumns:{},pipelineMinimized:!1},quotesPreferences:{displayCurrency:"USD",sortBy:"updatedAt",sortDir:"desc"},clientsPreferences:{currency:"USD"},activityLog:[]};async function Yn(){try{const e=localStorage.getItem(Vn);if(e){const t=Jn(JSON.parse(e));return t.aiSettings&&(t.aiSettings=await Dn(t.aiSettings,Hn)),t.bankDetails&&(t.bankDetails=await Dn(t.bankDetails,Wn)),t}return Qn}catch(Pc){return Qn}}function Jn(e){return{...Qn,...e,theme:e.theme||Qn.theme,company:{...Qn.company,...e.company},taxInfo:{...Qn.taxInfo,...e.taxInfo},taxConfig:{...Qn.taxConfig,...e.taxConfig},bankDetails:{...Qn.bankDetails,...e.bankDetails},quoteDefaults:{...Qn.quoteDefaults,...e.quoteDefaults},pdfOptions:{...Qn.pdfOptions,...e.pdfOptions},aiSettings:{...Qn.aiSettings,...e.aiSettings},opsPreferences:{...Qn.opsPreferences,...e.opsPreferences},dashboardPreferences:{...Qn.dashboardPreferences,...e.dashboardPreferences},quotesPreferences:{...Qn.quotesPreferences,...e.quotesPreferences},clientsPreferences:{...Qn.clientsPreferences,...e.clientsPreferences},users:e.users||Qn.users,projectTypes:e.projectTypes||Qn.projectTypes,regions:e.regions||Qn.regions,activityLog:e.activityLog||Qn.activityLog}}async function Zn(e){try{const t=JSON.parse(JSON.stringify(e));t.aiSettings&&(t.aiSettings=await In(t.aiSettings,Hn)),t.bankDetails&&(t.bankDetails=await In(t.bankDetails,Wn)),localStorage.setItem(Vn,JSON.stringify(t)),Ln(0,{encrypted:!0})}catch(Pc){}}let Xn=null;async function ea(e,t){if(!kn())return{success:!0};try{const t=await In(e.aiSettings||{},Hn);if(Xn){const{error:n}=await _n.from("settings").update({company:e.company,quote_defaults:e.quoteDefaults,terms_and_conditions:e.quoteDefaults?.termsAndConditions||"",users:e.users,ai_settings:t,ops_preferences:e.opsPreferences,dashboard_preferences:e.dashboardPreferences,quotes_preferences:e.quotesPreferences,clients_preferences:e.clientsPreferences}).eq("id",Xn);if(n)throw n;return Ln(0,{encrypted:!0}),{success:!0}}return{success:!0}}catch(Pc){return{success:!1,error:Pc.message}}}let ta=Qn;Yn().then(e=>{ta=e,na.setState({settings:e,loading:!1})});const na=h($n((e,t)=>({settings:ta,loading:!0,syncStatus:"idle",syncError:null,clearSyncError:()=>{e({syncError:null,syncStatus:"idle"})},setTheme:async n=>{const a={...t().settings,theme:n};await Zn(a),e({settings:a}),"light"===n?(document.documentElement.classList.add("light"),document.documentElement.classList.remove("dark")):(document.documentElement.classList.add("dark"),document.documentElement.classList.remove("light"))},initialize:async()=>{if(!kn()){const t=await Yn();return void e({settings:t,loading:!1,syncStatus:"idle"})}e({loading:!0,syncStatus:"syncing"});try{const{data:t,error:n}=await _n.from("settings").select("*").limit(1).single();if(n)throw n;if(t){Xn=t.id;const n=t.ai_settings?await Dn(t.ai_settings,Hn):Qn.aiSettings,a=Jn({...await Yn(),company:t.company||Qn.company,quoteDefaults:{...Qn.quoteDefaults,...t.quote_defaults,termsAndConditions:t.terms_and_conditions||Qn.quoteDefaults.termsAndConditions},users:t.users||Qn.users,aiSettings:n,opsPreferences:t.ops_preferences||Qn.opsPreferences,dashboardPreferences:t.dashboard_preferences||Qn.dashboardPreferences,quotesPreferences:t.quotes_preferences||Qn.quotesPreferences,clientsPreferences:t.clients_preferences||Qn.clientsPreferences});await Zn(a),e({settings:a,loading:!1,syncStatus:"success",syncError:null})}else{const t=await Yn();e({settings:t,loading:!1,syncStatus:"success",syncError:null})}}catch(Pc){const n=await Yn();e({settings:n,loading:!1,syncStatus:"error",syncError:Pc.message})}},setCompanyInfo:async n=>{const a=t(),r={...a.settings,company:{...a.settings.company,...n}};await Zn(r),ea(r),e({settings:r})},setTaxInfo:async n=>{const a=t(),r={...a.settings,taxInfo:{...a.settings.taxInfo,...n}};await Zn(r),e({settings:r})},setTaxConfig:async n=>{const a=t(),r={...a.settings,taxConfig:{...a.settings.taxConfig,...n}};await Zn(r),e({settings:r})},setPreferredCurrencies:async n=>{const a={...t().settings,preferredCurrencies:n};await Zn(a),e({settings:a})},setBankDetails:async n=>{const a=t(),r={...a.settings,bankDetails:{...a.settings.bankDetails,...n}};await Zn(r),e({settings:r}),Ln(0,{encrypted:!0})},setQuoteDefaults:async n=>{const a=t(),r={...a.settings,quoteDefaults:{...a.settings.quoteDefaults,...n}};await Zn(r),ea(r),e({settings:r})},setPdfOptions:async n=>{const a=t(),r={...a.settings,pdfOptions:{...a.settings.pdfOptions,...n}};await Zn(r),e({settings:r})},setOpsPreferences:async n=>{const a=t(),r={...a.settings,opsPreferences:{...a.settings.opsPreferences,...n}};await Zn(r),ea(r),e({settings:r})},setDashboardPreferences:async n=>{const a=t(),r={...a.settings,dashboardPreferences:{...a.settings.dashboardPreferences,...n}};await Zn(r),ea(r),e({settings:r})},setQuotesPreferences:async n=>{const a=t(),r={...a.settings,quotesPreferences:{...a.settings.quotesPreferences,...n}};await Zn(r),ea(r),e({settings:r})},setClientsPreferences:async n=>{const a=t(),r={...a.settings,clientsPreferences:{...a.settings.clientsPreferences,...n}};await Zn(r),ea(r),e({settings:r})},setAiSettings:async n=>{const a=t();n.anthropicKey&&En(n.anthropicKey,"sk-ant-"),n.openaiKey&&En(n.openaiKey,"sk-"),n.anthropicKey||n.openaiKey;const r={...a.settings,aiSettings:{...a.settings.aiSettings,...n}};await Zn(r),ea(r),e({settings:r}),Ln(0,{hasAnthropicKey:!!n.anthropicKey,hasOpenaiKey:!!n.openaiKey,encrypted:!0})},addUser:async n=>{const a=t(),r={id:`${Date.now()}-${Math.random().toString(36).substring(2,11)}`,name:n.name||"",email:n.email||"",role:n.role||"user"},o={...a.settings,users:[...a.settings.users,r]};await Zn(o),ea(o),e({settings:o})},updateUser:async(n,a)=>{const r=t(),o={...r.settings,users:r.settings.users.map(e=>e.id===n?{...e,...a}:e)};await Zn(o),ea(o),e({settings:o})},deleteUser:async n=>{const a=t(),r={...a.settings,users:a.settings.users.filter(e=>e.id!==n)};await Zn(r),ea(r),e({settings:r})},getUser:e=>t().settings.users.find(t=>t.id===e),addProjectType:async n=>{const a=t(),r=n.toLowerCase().replace(/\s+/g,"_")+"_"+Math.random().toString(36).substring(2,7),o={...a.settings,projectTypes:[...a.settings.projectTypes,{id:r,label:n}]};await Zn(o),e({settings:o})},updateProjectType:async(n,a)=>{const r=t(),o={...r.settings,projectTypes:r.settings.projectTypes.map(e=>e.id===n?{...e,label:a}:e)};await Zn(o),e({settings:o})},deleteProjectType:async n=>{const a=t(),r={...a.settings,projectTypes:a.settings.projectTypes.filter(e=>e.id!==n)};await Zn(r),e({settings:r})},moveProjectType:async(n,a)=>{const r=t(),o=[...r.settings.projectTypes],i=o.findIndex(e=>e.id===n);if(-1===i)return;const s="up"===a?i-1:i+1;if(s<0||s>=o.length)return;[o[i],o[s]]=[o[s],o[i]];const l={...r.settings,projectTypes:o};await Zn(l),e({settings:l})},addRegion:async(n,a="USD",r=[])=>{const o=t(),i=n.toUpperCase().replace(/\s+/g,"_"),s={...o.settings,regions:[...o.settings.regions,{id:i,label:n,currency:a,countries:r}]};await Zn(s),e({settings:s})},updateRegion:async(n,a)=>{const r=t(),o={...r.settings,regions:r.settings.regions.map(e=>e.id===n?{...e,...a}:e)};await Zn(o),e({settings:o})},deleteRegion:async n=>{const a=t(),r={...a.settings,regions:a.settings.regions.filter(e=>e.id!==n)};await Zn(r),e({settings:r})},moveRegion:async(n,a)=>{const r=t(),o=[...r.settings.regions],i=o.findIndex(e=>e.id===n);if(-1===i)return;const s="up"===a?i-1:i+1;if(s<0||s>=o.length)return;[o[i],o[s]]=[o[s],o[i]];const l={...r.settings,regions:o};await Zn(l),e({settings:l})},updateOkr:async(n,a)=>{const r=t(),o={...r.settings,okrs:r.settings.okrs.map(e=>e.id===n?{...e,...a}:e)};await Zn(o),ea(o),e({settings:o})},getOkrsForPrompt:()=>{const{settings:e}=t(),n=e.okrs||[];return 0===n.length?"":n.sort((e,t)=>e.priority-t.priority).map((e,t)=>`${t+1}. **${e.objective}**: ${e.keyResult}`).join("\n")},exportSettings:async()=>{const{settings:e}=t(),n={...e,aiSettings:{anthropicKey:e.aiSettings.anthropicKey?"***REDACTED***":"",openaiKey:e.aiSettings.openaiKey?"***REDACTED***":""},bankDetails:{...e.bankDetails,accountNumber:e.bankDetails.accountNumber?"***REDACTED***":"",swiftCode:e.bankDetails.swiftCode?"***REDACTED***":""}},a=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),r=URL.createObjectURL(a),o=document.createElement("a");o.href=r,o.download=`settings-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r),Ln(0,{sanitized:!0})},addActivityLog:async n=>{const a=t(),r={id:`${Date.now()}-${Math.random().toString(36).substring(2,11)}`,timestamp:(new Date).toISOString(),...n},o={...a.settings,activityLog:[r,...a.settings.activityLog||[]].slice(0,1e3)};await Zn(o),e({settings:o})},clearActivityLog:async()=>{const n={...t().settings,activityLog:[]};await Zn(n),e({settings:n})},exportActivityLog:()=>{const{settings:e}=t(),n=e.activityLog||[];if(0===n.length)return void alert("No activity logs to export");const a=n.map(e=>[e.timestamp,e.userName||e.userId||"",e.quoteNumber||"",e.action||"",e.category||"",e.field||"",e.description||"","object"==typeof e.oldValue?JSON.stringify(e.oldValue):e.oldValue||"","object"==typeof e.newValue?JSON.stringify(e.newValue):e.newValue||""]),r=[["Timestamp","User","Quote #","Action","Category","Field","Description","Old Value","New Value"].join(","),...a.map(e=>e.map(e=>`"${String(e).replace(/"/g,'""')}"`).join(","))].join("\n"),o=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(o),s=document.createElement("a");s.href=i,s.download=`activity-log-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)},resetSettings:async()=>{e({settings:Qn}),await Zn(Qn)}}))),aa=[{id:"top",type:"standalone",items:[{id:"dashboard",label:"Dashboard",icon:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"}]},{id:"business",label:"Business",icon:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z",items:[{id:"quotes",label:"Quotes",icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},{id:"clients",label:"Clients",icon:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"},{id:"opportunities",label:"Opportunities",icon:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"},{id:"email",label:"Email",icon:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},{id:"tasks",label:"Tasks",icon:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"},{id:"calendar",label:"Calendar",icon:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"},{id:"sequences",label:"Sequences",icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"},{id:"workflows",label:"Workflows",icon:"M13 10V3L4 14h7v7l9-11h-7z"}]},{id:"finance",label:"Finance",icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",items:[{id:"invoices",label:"Invoices",icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},{id:"purchase-orders",label:"Purchase Orders",icon:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"},{id:"contracts",label:"Contracts",icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2zM15 3v4a1 1 0 001 1h4"}]},{id:"operations",label:"Operations",icon:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z",items:[{id:"projects",label:"Projects",icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"},{id:"analytics",label:"Call Sheets",icon:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"},{id:"kit",label:"Kit",icon:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"},{id:"kit-bookings",label:"Kit Bookings",icon:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"},{id:"crew",label:"Crew",icon:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},{id:"resources",label:"Resources",icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"},{id:"rate-card",label:"Rates",icon:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"},{id:"contacts",label:"Contacts",icon:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"}]},{id:"knowledge",label:"Company Knowledge",icon:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253",items:[{id:"sop",label:"SOP",icon:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"},{id:"knowledge",label:"Research",icon:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"}]}];function ra({activeTab:e,onTabChange:t,onGoToFS:n,collapsed:a,onToggleCollapse:o}){const i=Un(e=>e.hasPermission),{logout:s,user:l}=Un(),{settings:c,setTheme:d}=na(),[u,p]=m.useState(!1),[h,f]=m.useState(!1),[g,y]=m.useState(!1),[b,v]=m.useState(()=>{const e=localStorage.getItem("sidebar-expanded-categories");return e?JSON.parse(e):{business:!0,finance:!0,operations:!0,knowledge:!0}});m.useEffect(()=>{const e=()=>{f(window.innerWidth<1024)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),m.useEffect(()=>{localStorage.setItem("sidebar-expanded-categories",JSON.stringify(b))},[b]);const x=e=>{h&&y(!1),t(e)},w="light"!==c.theme,_=l?.profile?.name||l?.email?.split("@")[0]||"User",k="admin"===l?.profile?.role?"Admin":"User",S=_.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)||"U",C=m.useMemo(()=>aa.map(e=>({...e,items:e.items.filter(e=>i(e.id))})).filter(e=>e.items.length>0),[i]),N=h?g:!a,j=w?"bg-dark-bg":"bg-white",T=w?"border-dark-border":"border-gray-200",I=w?"text-gray-200":"text-gray-900",D=w?"text-gray-400":"text-gray-600",E="text-gray-500",L=w?"hover:bg-white/5":"hover:bg-gray-100",A=w?"hover:text-gray-200":"hover:text-gray-900";return r.jsxs(r.Fragment,{children:[h&&!g&&r.jsx("button",{onClick:()=>y(!0),className:`fixed top-4 left-4 z-50 w-12 h-12 rounded-xl ${w?"bg-dark-card border-dark-border text-gray-400 hover:text-white hover:bg-dark-border":"bg-white border-gray-200 text-gray-600 hover:text-gray-900 hover:bg-gray-100"} border flex items-center justify-center transition-colors shadow-lg`,"aria-label":"Open menu",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),h&&g&&r.jsx("div",{className:"fixed inset-0 bg-black/60 z-40 backdrop-blur-sm",onClick:()=>y(!1)}),r.jsxs("aside",{className:`fixed lg:relative z-50 h-screen ${j} border-r ${T} flex flex-col transition-all duration-300 ease-in-out ${h?g?"w-72 translate-x-0":"w-72 -translate-x-full":a?"w-16":"w-64"}`,children:[r.jsxs("div",{className:`h-16 border-b ${T} flex items-center ${N||h?"justify-between px-4":"justify-center px-2"}`,children:[(N||h)&&r.jsx("button",{onClick:()=>x("dashboard"),className:"flex items-center hover:opacity-80 transition-opacity",children:r.jsx("img",{src:"/productionos-logo.svg",alt:"ProductionOS",className:"h-8",style:{color:w?"#fff":"#143642"}})}),h?r.jsx("button",{onClick:()=>y(!1),className:`w-10 h-10 rounded-lg ${L} flex items-center justify-center ${D} ${A} transition-colors`,title:"Close menu",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}):r.jsx("button",{onClick:o,className:`w-10 h-10 rounded-lg ${L} flex items-center justify-center ${D} ${A} transition-colors`,title:a?"Expand sidebar":"Collapse sidebar",children:r.jsx("svg",{className:"w-5 h-5 transition-transform "+(a?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})})]}),r.jsx("nav",{className:"flex-1 overflow-y-auto py-4 px-2",children:r.jsx("div",{className:"space-y-2",children:C.map(t=>{if("standalone"===t.type)return t.items.map(t=>{const n=e===t.id;return r.jsxs("button",{onClick:()=>x(t.id),className:"w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200 "+(n?"bg-accent-primary/20 text-accent-primary":`${D} ${A} ${L}`),title:N||h?void 0:t.label,children:[r.jsx("svg",{className:"w-5 h-5 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:t.icon})}),(N||h)&&r.jsx("span",{className:"text-sm font-medium truncate",children:t.label})]},t.id)});const n=b[t.id],a=(t=>t.items.some(t=>t.id===e))(t);return r.jsxs("div",{className:"space-y-1",children:[r.jsxs("button",{onClick:()=>{return(N||h)&&(e=t.id,void v(t=>({...t,[e]:!t[e]})));var e},className:`w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all duration-200 ${a?"text-accent-primary":`${E} ${w?"hover:text-gray-300":"hover:text-gray-700"}`} ${N||h?"":"justify-center"}`,title:N||h?void 0:t.label,children:[r.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:t.icon})}),(N||h)&&r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-xs font-semibold uppercase tracking-wider flex-1 text-left",children:t.label}),r.jsx("svg",{className:"w-4 h-4 transition-transform duration-200 "+(n?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),(n||!N&&!h)&&r.jsx("div",{className:"space-y-1 "+(N||h?"pl-3":""),children:t.items.map(t=>{const n=e===t.id;return r.jsxs("button",{onClick:()=>x(t.id),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-all duration-200 "+(n?"bg-accent-primary/20 text-accent-primary":`${D} ${A} ${L}`),title:N||h?void 0:t.label,children:[r.jsx("svg",{className:"w-5 h-5 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:t.icon})}),(N||h)&&r.jsx("span",{className:"text-sm font-medium truncate",children:t.label})]},t.id)})})]},t.id)})})}),r.jsxs("div",{className:`border-t ${T} p-2 space-y-1`,children:[r.jsxs("button",{onClick:()=>{h&&y(!1),n()},className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg ${w?"text-teal-400 hover:bg-teal-500/10":"text-teal-600 hover:bg-teal-50"} transition-colors ${N||h?"":"justify-center"}`,title:"Full Screen Analytics",children:[r.jsx("svg",{className:"w-5 h-5 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),(N||h)&&r.jsx("span",{className:"text-sm font-medium",children:"Full Screen"})]}),r.jsxs("button",{onClick:()=>d(w?"light":"dark"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg ${D} ${A} ${L} transition-colors ${N||h?"":"justify-center"}`,title:w?"Switch to light mode":"Switch to dark mode",children:[w?r.jsx("svg",{className:"w-5 h-5 text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):r.jsx("svg",{className:"w-5 h-5 text-indigo-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),(N||h)&&r.jsx("span",{className:"text-sm font-medium",children:w?"Light Mode":"Dark Mode"})]}),r.jsxs("button",{onClick:()=>x("settings"),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors ${"settings"===e?"bg-accent-primary/20 text-accent-primary":`${D} ${A} ${L}`} ${N||h?"":"justify-center"}`,title:"Settings",children:[r.jsxs("svg",{className:"w-5 h-5 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),(N||h)&&r.jsx("span",{className:"text-sm font-medium",children:"Settings"})]}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{onClick:()=>p(!u),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg ${D} ${A} ${L} transition-colors ${N||h?"":"justify-center"}`,children:[r.jsx("div",{className:`w-8 h-8 rounded-full ${w?"bg-gray-800 border-gray-700":"bg-gray-100 border-gray-300"} border flex items-center justify-center text-xs shrink-0`,children:S}),(N||h)&&r.jsxs("div",{className:"flex-1 text-left min-w-0",children:[r.jsx("p",{className:`text-sm font-medium ${I} truncate`,children:_}),r.jsx("p",{className:`text-xs ${E}`,children:k})]})]}),u&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>p(!1)}),r.jsx("div",{className:`absolute z-50 ${w?"bg-[#1a1f2e] border-dark-border":"bg-white border-gray-200"} border rounded-lg shadow-2xl overflow-hidden ${N||h?"left-0 bottom-full mb-2 w-full":"left-full ml-2 bottom-0 w-48"}`,children:r.jsxs("button",{onClick:()=>{p(!1),h&&y(!1),s()},className:`w-full px-4 py-3 text-left text-sm ${w?"text-gray-400 hover:bg-red-500/10":"text-gray-600 hover:bg-red-50"} hover:text-red-500 transition-colors flex items-center gap-2`,children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sign Out"]})})]})]})]})]})]})}const oa={productionTeam:{id:"productionTeam",name:"Production Team",color:"#3B82F6",subsections:["Production","Technical Crew","Production Management"]},productionEquipment:{id:"productionEquipment",name:"Production Equipment",color:"#06B6D4",subsections:["Video","Audio","Cameras","Graphics","VT","Cabling","Other"]},creative:{id:"creative",name:"Creative",color:"#EC4899",subsections:["Services"]},logistics:{id:"logistics",name:"Logistics",color:"#F59E0B",subsections:["Services"]},expenses:{id:"expenses",name:"Expenses",color:"#10B981",subsections:["Services"]}},ia=["productionTeam","productionEquipment","creative","logistics","expenses"],sa={USD:{code:"USD",symbol:"$",name:"US Dollar"},EUR:{code:"EUR",symbol:"",name:"Euro"},GBP:{code:"GBP",symbol:"",name:"British Pound"},JPY:{code:"JPY",symbol:"",name:"Japanese Yen"},CNY:{code:"CNY",symbol:"",name:"Chinese Yuan"},CHF:{code:"CHF",symbol:"Fr",name:"Swiss Franc"},AUD:{code:"AUD",symbol:"A$",name:"Australian Dollar"},NZD:{code:"NZD",symbol:"NZ$",name:"New Zealand Dollar"},SGD:{code:"SGD",symbol:"S$",name:"Singapore Dollar"},HKD:{code:"HKD",symbol:"HK$",name:"Hong Kong Dollar"},TWD:{code:"TWD",symbol:"NT$",name:"Taiwan Dollar"},KRW:{code:"KRW",symbol:"",name:"South Korean Won"},INR:{code:"INR",symbol:"",name:"Indian Rupee"},MYR:{code:"MYR",symbol:"RM",name:"Malaysian Ringgit"},THB:{code:"THB",symbol:"",name:"Thai Baht"},IDR:{code:"IDR",symbol:"Rp",name:"Indonesian Rupiah"},PHP:{code:"PHP",symbol:"",name:"Philippine Peso"},VND:{code:"VND",symbol:"",name:"Vietnamese Dong"},PKR:{code:"PKR",symbol:"",name:"Pakistani Rupee"},BDT:{code:"BDT",symbol:"",name:"Bangladeshi Taka"},LKR:{code:"LKR",symbol:"Rs",name:"Sri Lankan Rupee"},NPR:{code:"NPR",symbol:"",name:"Nepalese Rupee"},MMK:{code:"MMK",symbol:"K",name:"Myanmar Kyat"},KHR:{code:"KHR",symbol:"",name:"Cambodian Riel"},LAK:{code:"LAK",symbol:"",name:"Lao Kip"},BND:{code:"BND",symbol:"B$",name:"Brunei Dollar"},MOP:{code:"MOP",symbol:"MOP$",name:"Macanese Pataca"},MNT:{code:"MNT",symbol:"",name:"Mongolian Tugrik"},AED:{code:"AED",symbol:".",name:"UAE Dirham"},SAR:{code:"SAR",symbol:"SR",name:"Saudi Riyal"},QAR:{code:"QAR",symbol:"QR",name:"Qatari Riyal"},KWD:{code:"KWD",symbol:"KD",name:"Kuwaiti Dinar"},BHD:{code:"BHD",symbol:"BD",name:"Bahraini Dinar"},OMR:{code:"OMR",symbol:"OMR",name:"Omani Rial"},JOD:{code:"JOD",symbol:"JD",name:"Jordanian Dinar"},ILS:{code:"ILS",symbol:"",name:"Israeli Shekel"},TRY:{code:"TRY",symbol:"",name:"Turkish Lira"},IRR:{code:"IRR",symbol:"",name:"Iranian Rial"},IQD:{code:"IQD",symbol:".",name:"Iraqi Dinar"},LBP:{code:"LBP",symbol:"L",name:"Lebanese Pound"},SYP:{code:"SYP",symbol:"S",name:"Syrian Pound"},YER:{code:"YER",symbol:"",name:"Yemeni Rial"},SEK:{code:"SEK",symbol:"kr",name:"Swedish Krona"},NOK:{code:"NOK",symbol:"kr",name:"Norwegian Krone"},DKK:{code:"DKK",symbol:"kr",name:"Danish Krone"},PLN:{code:"PLN",symbol:"z",name:"Polish Zloty"},CZK:{code:"CZK",symbol:"K",name:"Czech Koruna"},HUF:{code:"HUF",symbol:"Ft",name:"Hungarian Forint"},RON:{code:"RON",symbol:"lei",name:"Romanian Leu"},BGN:{code:"BGN",symbol:"",name:"Bulgarian Lev"},HRK:{code:"HRK",symbol:"kn",name:"Croatian Kuna"},RSD:{code:"RSD",symbol:"",name:"Serbian Dinar"},UAH:{code:"UAH",symbol:"",name:"Ukrainian Hryvnia"},RUB:{code:"RUB",symbol:"",name:"Russian Ruble"},ISK:{code:"ISK",symbol:"kr",name:"Icelandic Krona"},CAD:{code:"CAD",symbol:"C$",name:"Canadian Dollar"},MXN:{code:"MXN",symbol:"Mex$",name:"Mexican Peso"},BRL:{code:"BRL",symbol:"R$",name:"Brazilian Real"},ARS:{code:"ARS",symbol:"$",name:"Argentine Peso"},CLP:{code:"CLP",symbol:"$",name:"Chilean Peso"},COP:{code:"COP",symbol:"$",name:"Colombian Peso"},PEN:{code:"PEN",symbol:"S/",name:"Peruvian Sol"},UYU:{code:"UYU",symbol:"$U",name:"Uruguayan Peso"},VES:{code:"VES",symbol:"Bs",name:"Venezuelan Bolivar"},DOP:{code:"DOP",symbol:"RD$",name:"Dominican Peso"},GTQ:{code:"GTQ",symbol:"Q",name:"Guatemalan Quetzal"},CRC:{code:"CRC",symbol:"",name:"Costa Rican Colon"},PAB:{code:"PAB",symbol:"B/",name:"Panamanian Balboa"},JMD:{code:"JMD",symbol:"J$",name:"Jamaican Dollar"},TTD:{code:"TTD",symbol:"TT$",name:"Trinidad Dollar"},BSD:{code:"BSD",symbol:"B$",name:"Bahamian Dollar"},BBD:{code:"BBD",symbol:"Bds$",name:"Barbados Dollar"},ZAR:{code:"ZAR",symbol:"R",name:"South African Rand"},NGN:{code:"NGN",symbol:"",name:"Nigerian Naira"},EGP:{code:"EGP",symbol:"E",name:"Egyptian Pound"},KES:{code:"KES",symbol:"KSh",name:"Kenyan Shilling"},GHS:{code:"GHS",symbol:"GH",name:"Ghanaian Cedi"},MAD:{code:"MAD",symbol:"MAD",name:"Moroccan Dirham"},TND:{code:"TND",symbol:"DT",name:"Tunisian Dinar"},DZD:{code:"DZD",symbol:"DA",name:"Algerian Dinar"},ETB:{code:"ETB",symbol:"Br",name:"Ethiopian Birr"},TZS:{code:"TZS",symbol:"TSh",name:"Tanzanian Shilling"},UGX:{code:"UGX",symbol:"USh",name:"Ugandan Shilling"},RWF:{code:"RWF",symbol:"RF",name:"Rwandan Franc"},MUR:{code:"MUR",symbol:"",name:"Mauritian Rupee"},XOF:{code:"XOF",symbol:"CFA",name:"West African CFA Franc"},XAF:{code:"XAF",symbol:"FCFA",name:"Central African CFA Franc"},KZT:{code:"KZT",symbol:"",name:"Kazakhstani Tenge"},UZS:{code:"UZS",symbol:"som",name:"Uzbekistani Som"},AZN:{code:"AZN",symbol:"",name:"Azerbaijani Manat"},GEL:{code:"GEL",symbol:"",name:"Georgian Lari"},AMD:{code:"AMD",symbol:"",name:"Armenian Dram"},TJS:{code:"TJS",symbol:"SM",name:"Tajikistani Somoni"},KGS:{code:"KGS",symbol:"",name:"Kyrgyzstani Som"},TMT:{code:"TMT",symbol:"m",name:"Turkmenistani Manat"},AFN:{code:"AFN",symbol:"",name:"Afghan Afghani"},FJD:{code:"FJD",symbol:"FJ$",name:"Fijian Dollar"},PGK:{code:"PGK",symbol:"K",name:"Papua New Guinean Kina"},WST:{code:"WST",symbol:"WS$",name:"Samoan Tala"},TOP:{code:"TOP",symbol:"T$",name:"Tongan Paanga"},VUV:{code:"VUV",symbol:"VT",name:"Vanuatu Vatu"},SBD:{code:"SBD",symbol:"SI$",name:"Solomon Islands Dollar"},XPF:{code:"XPF",symbol:"",name:"CFP Franc"}},la={USD:1,EUR:.92,GBP:.79,JPY:149,CNY:7.24,CHF:.88,AUD:1.53,NZD:1.67,SGD:1.34,HKD:7.82,TWD:31.5,KRW:1320,INR:83.2,MYR:4.47,THB:34.5,IDR:15850,PHP:55.8,VND:24500,PKR:278,BDT:110,LKR:320,NPR:133,MMK:2100,KHR:4100,LAK:20500,BND:1.34,MOP:8.05,MNT:3450,AED:3.67,SAR:3.75,QAR:3.64,KWD:.31,BHD:.38,OMR:.38,JOD:.71,ILS:3.65,TRY:32.5,IRR:42e3,IQD:1310,LBP:89500,SEK:10.5,NOK:10.8,DKK:6.88,PLN:4.02,CZK:23.2,HUF:362,RON:4.58,BGN:1.8,RSD:108,UAH:37.5,RUB:92,ISK:138,CAD:1.36,MXN:17.2,BRL:4.97,ARS:870,CLP:935,COP:4050,PEN:3.72,UYU:39.5,DOP:58.5,GTQ:7.82,CRC:525,PAB:1,JMD:156,TTD:6.78,ZAR:18.7,NGN:1550,EGP:48.5,KES:153,GHS:14.8,MAD:10.1,TND:3.12,DZD:135,ETB:57,TZS:2520,UGX:3780,MUR:45.5,XOF:605,XAF:605,KZT:465,UZS:12400,AZN:1.7,GEL:2.68,AMD:400,TJS:10.95,KGS:89.5,TMT:3.5,AFN:72,FJD:2.24,PGK:3.78,XPF:110},ca={MALAYSIA:{id:"MALAYSIA",name:"Malaysia",defaultCurrency:"MYR",countries:["Malaysia"]},SEA:{id:"SEA",name:"Southeast Asia",defaultCurrency:"USD",countries:["Singapore","Indonesia","Thailand","Vietnam","Philippines"]},GULF:{id:"GULF",name:"Gulf States",defaultCurrency:"KWD",countries:["UAE","Kuwait","Saudi Arabia","Qatar","Bahrain","Oman"]},CENTRAL_ASIA:{id:"CENTRAL_ASIA",name:"Central Asia",defaultCurrency:"USD",countries:["Kazakhstan","Uzbekistan","Tajikistan"]}},da="tell_quote_current";function ua(e){try{return localStorage.setItem(da,JSON.stringify(e)),!0}catch(Pc){return!1}}function ma(){return`TP-${(new Date).getFullYear()}-${Math.floor(9e3*Math.random())+1e3}`}const pa="exchange_rates_cache";async function ha(){const e=function(){try{const e=localStorage.getItem(pa);if(e){const{rates:t,timestamp:n}=JSON.parse(e);if(Date.now()-n<36e5)return{rates:t,timestamp:n}}}catch(Pc){}return null}();if(e)return e;try{const e=await fetch("https://api.exchangerate-api.com/v4/latest/USD");if(!e.ok)throw new Error("Failed to fetch rates");const t=await e.json(),n={};return Object.keys(sa).forEach(e=>{n[e]=t.rates[e]||la[e]}),function(e){try{localStorage.setItem(pa,JSON.stringify({rates:e,timestamp:Date.now()}))}catch(Pc){}}(n),{rates:n,timestamp:Date.now()}}catch(Pc){return{rates:la,timestamp:null}}}function fa(e,t,n,a={}){if(t===n)return e;if(!e||isNaN(e))return 0;const r=e/(a[t]||la[t]||1)*(a[n]||la[n]||1);return isNaN(r)?0:r}function ga(e,t,n={}){const{showSymbol:a=!0,decimals:r=2}=n,o=sa[t],i=null==e||isNaN(e)?0:e;if(!o)return`${i.toFixed(r)}`;const s="IDR"===t?0:r,l=new Intl.NumberFormat("en-US",{minimumFractionDigits:s,maximumFractionDigits:s}).format(i);return a?`${o.symbol}${l}`:l}function ya(e){return{MALAYSIA:"MYR",SEA:"USD",GULF:"USD",CENTRAL_ASIA:"USD"}[e]||"USD"}function ba(e){return sa[e]?.symbol||e}const va=(e,t=1.5)=>({MALAYSIA:{cost:.85*e,charge:.85*e*t},SEA:{cost:e,charge:e*t},GULF:{cost:1.2*e,charge:1.2*e*t},CENTRAL_ASIA:{cost:1.1*e,charge:1.1*e*t}}),xa=[{name:"Project Manager",description:"Remote project management",section:"prod_mgmt_remote",unit:"day",pricing:va(300)},{name:"Technical Project Manager",description:"Remote technical project management",section:"prod_mgmt_remote",unit:"day",pricing:va(300)},{name:"Consultant - TE",description:"Technical engineering consultant",section:"prod_mgmt_remote",unit:"day",pricing:va(500)},{name:"Graphics System - VMix",description:"VMix graphics system package",section:"event_graphics",unit:"day",pricing:va(33.8)},{name:"Graphics Design",description:"Graphics design services",section:"event_graphics",unit:"day",pricing:va(150)},{name:"Graphics Integration",description:"Graphics integration and setup",section:"event_graphics",unit:"day",pricing:va(50)},{name:"Photo Editing",description:"Photo editing services",section:"event_graphics",unit:"item",pricing:va(10)},{name:"Graphics Operator",description:"On-site graphics operator",section:"event_graphics",unit:"day",pricing:va(100)},{name:"Graphics Producer - On Site",description:"On-site graphics producer",section:"event_graphics",unit:"day",pricing:va(400)},{name:"Graphics Engineer",description:"Graphics engineering and technical support",section:"event_graphics",unit:"day",pricing:va(150)},{name:"Technical Producer - Int",description:"International technical producer",section:"prod_staffing",unit:"day",pricing:va(500)},{name:"Technical Director - Int",description:"International technical director",section:"prod_staffing",unit:"day",pricing:va(450)},{name:"Producer - Int On Site",description:"International producer on-site",section:"prod_staffing",unit:"day",pricing:va(500)},{name:"Producer - Remote Int",description:"International remote producer",section:"prod_staffing",unit:"day",pricing:va(300)},{name:"Sound Engineer - Int",description:"International sound engineer",section:"prod_staffing",unit:"day",pricing:va(500)},{name:"Sound Engineer - SEA",description:"South East Asia sound engineer",section:"prod_staffing",unit:"day",pricing:va(350)},{name:"Talent - Int",description:"International talent/presenter",section:"prod_staffing",unit:"day",pricing:va(500)},{name:"Field Producer/Floor Manager - Int",description:"International field producer/floor manager",section:"prod_staffing",unit:"day",pricing:va(450)},{name:"Field Producer/Floor Manager - SEA",description:"South East Asia field producer/floor manager",section:"prod_staffing",unit:"day",pricing:va(250)},{name:"Camera Operator - Int",description:"International camera operator",section:"prod_staffing",unit:"day",pricing:va(450)},{name:"Camera Operator - SEA",description:"South East Asia camera operator",section:"prod_staffing",unit:"day",pricing:va(250)},{name:"SPR Equipment - Silver Package",description:"SPR equipment silver package",section:"spr_equipment",unit:"day",pricing:va(700)},{name:"DJ Cam",description:"DJ camera setup",section:"extras",unit:"day",pricing:va(75)},{name:"Wireless Camera System",description:"Wireless camera system",section:"extras",unit:"day",pricing:va(250)},{name:"Comms",description:"Communications equipment",section:"extras",unit:"day",pricing:va(250)}],wa="tell_rate_card",_a="tell_rate_card_sections",ka="tell_rate_card_sync_queue";function Sa(){try{const e=localStorage.getItem(ka);return e?JSON.parse(e):[]}catch(Pc){return[]}}function Ca(e){try{localStorage.setItem(ka,JSON.stringify(e))}catch(Pc){}}const Na={MALAYSIA:"MYR",SEA:"USD",GULF:"USD",CENTRAL_ASIA:"USD"},ja=()=>({}),Ta=(e,t)=>{if(!e)return t||{};const n={...t||{}};return Object.entries(e).forEach(([e,t])=>{if(!n[e]&&t&&(t.cost||t.charge)){const a=Na[e]||"USD";n[e]={cost:{amount:t.cost||0,baseCurrency:a},charge:{amount:t.charge||0,baseCurrency:a}}}}),n},Ia={SERVICE:"service",EQUIPMENT:"equipment",EXPENSE:"expense"},Da={prod_production:Ia.SERVICE,prod_technical:Ia.SERVICE,prod_management:Ia.SERVICE,equip_video:Ia.EQUIPMENT,equip_audio:Ia.EQUIPMENT,equip_cameras:Ia.EQUIPMENT,equip_graphics:Ia.EQUIPMENT,equip_vt:Ia.EQUIPMENT,equip_cabling:Ia.EQUIPMENT,equip_other:Ia.EQUIPMENT,creative:Ia.SERVICE,logistics:Ia.SERVICE,expenses:Ia.EXPENSE},Ea=e=>Da[e]||Ia.SERVICE,La=[{id:"prod_production",name:"Production",group:"Production Team"},{id:"prod_technical",name:"Technical Crew",group:"Production Team"},{id:"prod_management",name:"Production Management",group:"Production Team"},{id:"equip_video",name:"Video",group:"Production Equipment"},{id:"equip_audio",name:"Audio",group:"Production Equipment"},{id:"equip_cameras",name:"Cameras",group:"Production Equipment"},{id:"equip_graphics",name:"Graphics",group:"Production Equipment"},{id:"equip_vt",name:"VT",group:"Production Equipment"},{id:"equip_cabling",name:"Cabling",group:"Production Equipment"},{id:"equip_other",name:"Other Equipment",group:"Production Equipment"},{id:"creative",name:"Creative",group:"Creative"},{id:"logistics",name:"Logistics",group:"Logistics"},{id:"expenses",name:"Expenses",group:"Expenses"}];function Aa(){try{const e=localStorage.getItem(wa);return e?JSON.parse(e):[]}catch(Pc){return[]}}function Pa(){try{const e=localStorage.getItem(_a);return e?JSON.parse(e):La}catch(Pc){return La}}function Ra(e){try{localStorage.setItem(wa,JSON.stringify(e))}catch(Pc){}}function Oa(e){try{localStorage.setItem(_a,JSON.stringify(e))}catch(Pc){}}function Ma(){return`${Date.now()}-${Math.random().toString(36).substring(2,11)}`}const qa=h($n((e,t)=>({items:Aa(),sections:Pa(),loading:!1,syncStatus:"idle",syncError:null,pendingSyncCount:Sa().length,addToSyncQueue:(t,n,a)=>{const r=Sa();r.push({action:t,id:n,data:a,timestamp:Date.now()}),Ca(r),e(e=>({pendingSyncCount:e.pendingSyncCount+1}))},processSyncQueue:async()=>{if(!kn())return;const t=Sa();if(0===t.length)return;const n=[];for(const e of t)try{"insert"===e.action?await _n.from("rate_cards").insert(e.data):"update"===e.action?await _n.from("rate_cards").update(e.data).eq("id",e.id):"delete"===e.action&&await _n.from("rate_cards").delete().eq("id",e.id)}catch(Pc){n.push({...e,retries:(e.retries||0)+1,lastError:Pc.message})}Ca(n),e({pendingSyncCount:n.length})},getUnsyncedCount:()=>t().items.filter(e=>!e._synced).length,clearSyncError:()=>{e({syncError:null,syncStatus:"idle"})},initialize:async()=>{if(kn()){e({loading:!0,syncStatus:"syncing"});try{const{data:n,error:a}=await _n.from("rate_cards").select("*").order("created_at",{ascending:!0});if(a)throw a;const{data:r,error:o}=await _n.from("rate_card_sections").select("*").order("sort_order",{ascending:!0});if(o)throw o;const i=(n||[]).map(e=>{const t=Ta(e.pricing,e.currency_pricing);return{id:e.id,name:e.name,description:e.description||"",section:e.section,unit:e.unit||"day",pricing:t,createdAt:e.created_at,updatedAt:e.updated_at,_synced:!0}}),s=r&&r.length>0?r.map(e=>({id:e.id,name:e.name,group:e.group_name||"Other"})):La;if(!r||0===r.length)for(let e=0;e<La.length;e++){const t=La[e];await _n.from("rate_card_sections").upsert({id:t.id,name:t.name,sort_order:e,group_name:t.group})}Ra(i),Oa(s),e({items:i,sections:s,loading:!1,syncStatus:"success",syncError:null}),await t().processSyncQueue()}catch(Pc){e({loading:!1,syncStatus:"error",syncError:Pc.message})}}else e({loading:!1,syncStatus:"idle"})},addSection:async n=>{const a={id:n.toLowerCase().replace(/\s+/g,"_")+"_"+Math.random().toString(36).substring(2,7),name:n};if(e(e=>{const t=[...e.sections,a];return Oa(t),{sections:t}}),kn())try{await _n.from("rate_card_sections").insert({id:a.id,name:a.name,sort_order:t().sections.length})}catch(Pc){}return a},deleteSection:async n=>{if(t().items.some(e=>e.section===n)&&e(e=>{const t=e.items.map(e=>e.section===n?{...e,section:"extras",updatedAt:(new Date).toISOString()}:e);return Ra(t),kn()&&t.filter(e=>"extras"===e.section).forEach(e=>{_n.from("rate_cards").update({section:"extras"}).eq("id",e.id)}),{items:t}}),e(e=>{const t=e.sections.filter(e=>e.id!==n);return Oa(t),{sections:t}}),kn())try{await _n.from("rate_card_sections").delete().eq("id",n)}catch(Pc){}},renameSection:async(t,n)=>{if(e(e=>{const a=e.sections.map(e=>e.id===t?{...e,name:n}:e);return Oa(a),{sections:a}}),kn())try{await _n.from("rate_card_sections").update({name:n}).eq("id",t)}catch(Pc){}},moveSection:async(t,n)=>{e(e=>{const a=[...e.sections],r=a.findIndex(e=>e.id===t);if(-1===r)return e;const o="up"===n?r-1:r+1;return o<0||o>=a.length?e:([a[r],a[o]]=[a[o],a[r]],Oa(a),kn()&&a.forEach((e,t)=>{_n.from("rate_card_sections").update({sort_order:t}).eq("id",e.id)}),{sections:a})})},addItem:async t=>{const n=t.pricing?Ta(t.pricing,null):{},a=t.section||"extras",r={id:Ma(),name:t.name||"",description:t.description||"",section:a,unit:t.unit||"day",itemType:t.itemType||Ea(a),kitItemId:t.kitItemId||null,pricing:n,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};if(kn())try{const{data:e,error:t}=await _n.from("rate_cards").insert({name:r.name,description:r.description,section:r.section,unit:r.unit,currency_pricing:r.pricing}).select().single();if(t)throw t;r.id=e.id}catch(Pc){}return e(e=>{const t=[...e.items,r];return Ra(t),{items:t}}),r},updateItem:async(t,n)=>{if(e(e=>{const a=e.items.map(e=>e.id===t?{...e,...n,updatedAt:(new Date).toISOString()}:e);return Ra(a),{items:a}}),kn())try{const e={};void 0!==n.name&&(e.name=n.name),void 0!==n.description&&(e.description=n.description),void 0!==n.section&&(e.section=n.section),void 0!==n.unit&&(e.unit=n.unit),void 0!==n.pricing&&(e.pricing=n.pricing),Object.keys(e).length>0&&await _n.from("rate_cards").update(e).eq("id",t)}catch(Pc){}},updateItemPricing:async(t,n,a,r,o)=>{let i=null;const s=o||Na[n]||"USD";if(e(e=>{const o=e.items.map(e=>{if(e.id!==t)return e;const o=e.pricing?.[n]||{};return i={...e,pricing:{...e.pricing||{},[n]:{...o,[a]:{amount:parseFloat(r)||0,baseCurrency:s}}},updatedAt:(new Date).toISOString()},i});return Ra(o),{items:o}}),kn()&&i)try{await _n.from("rate_cards").update({currency_pricing:i.pricing}).eq("id",t)}catch(Pc){}if(i?.kitItemId&&"cost"===a)try{const{useKitStore:e}=await E(async()=>{const{useKitStore:e}=await Promise.resolve().then(()=>Ii);return{useKitStore:e}},[]),t=e.getState(),a=i.pricing?.[n]?.cost?.amount;void 0!==a&&t.updateItem(i.kitItemId,{dayRate:a})}catch(Pc){}},deleteItem:async t=>{if(e(e=>{const n=e.items.filter(e=>e.id!==t);return Ra(n),{items:n}}),kn())try{await _n.from("rate_cards").delete().eq("id",t)}catch(Pc){}},getItemsBySection:e=>t().items.filter(t=>t.section===e),searchItems:e=>{const n=e.toLowerCase();return t().items.filter(e=>e.name.toLowerCase().includes(n)||e.description.toLowerCase().includes(n))},duplicateItem:e=>{const n=t().items.find(t=>t.id===e);return n?t().addItem({...n,name:`${n.name} (Copy)`}):null},seedRateCard:async()=>{const n=new Set(t().items.map(e=>e.name.toLowerCase())),a=xa.filter(e=>!n.has(e.name.toLowerCase())).map(e=>({...e,id:Ma(),pricing:Ta(e.pricing,e.currencyPricing),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}));if(0===a.length)return{success:!0,added:0,message:"All items already exist"};if(kn())try{const e=a.map(e=>({name:e.name,description:e.description,section:e.section,unit:e.unit,currency_pricing:e.pricing})),{data:t,error:n}=await _n.from("rate_cards").insert(e).select();if(n)throw n;t&&t.forEach((e,t)=>{a[t]&&(a[t].id=e.id)})}catch(Pc){}return e(e=>{const t=[...e.items,...a];return Ra(t),{items:t}}),e({sections:La}),Oa(La),{success:!0,added:a.length}},resetSectionsToDefaults:async()=>{if(kn())try{await _n.from("rate_card_sections").delete().neq("id","");for(let e=0;e<La.length;e++){const t=La[e];await _n.from("rate_card_sections").upsert({id:t.id,name:t.name,sort_order:e,group_name:t.group})}}catch(Pc){}return e({sections:La}),Oa(La),{success:!0}},importFromCSV:async n=>{try{const a=(await n.text()).split("\n");if(a.length<2)throw new Error("Invalid CSV format");const r=a[0].split(",").map(e=>e.trim()),o=["MALAYSIA","SEA","GULF","CENTRAL_ASIA"],i=e=>r.indexOf(e),s=[],l=[];for(let e=1;e<a.length;e++){const n=a[e].trim();if(!n||n.startsWith("#"))continue;const r=[];let c=!1,d="";for(let e=0;e<n.length;e++){const t=n[e];'"'===t?c&&'"'===n[e+1]?(d+='"',e++):c=!c:","!==t||c?d+=t:(r.push(d),d="")}r.push(d);const u={id:r[i("id")]||Ma(),section:r[i("section")]||"extras",name:r[i("name")]||"",description:r[i("description")]||"",unit:r[i("unit")]||"day",pricing:ja(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};o.forEach(e=>{const t=Na[e]||"USD",n=i(`${e}_cost`),a=i(`${e}_charge`),o=i(`${e}_cost_amount`),s=i(`${e}_cost_currency`),l=i(`${e}_charge_amount`),c=i(`${e}_charge_currency`),d=-1!==o&&r[o]?parseFloat(r[o])||0:-1!==n&&parseFloat(r[n])||0,m=-1!==s&&r[s]?r[s]:t,p=-1!==l&&r[l]?parseFloat(r[l])||0:-1!==a&&parseFloat(r[a])||0,h=-1!==c&&r[c]?r[c]:t;(d||p)&&(u.pricing[e]={cost:{amount:d,baseCurrency:m},charge:{amount:p,baseCurrency:h}})});t().items.some(e=>e.id===u.id)?l.push(u):s.push(u)}if(kn()){if(s.length>0){const e=s.map(e=>({name:e.name,description:e.description,section:e.section,unit:e.unit,currency_pricing:e.pricing})),{data:t}=await _n.from("rate_cards").insert(e).select();t&&t.forEach((e,t)=>{s[t]&&(s[t].id=e.id)})}for(const e of l)await _n.from("rate_cards").update({name:e.name,description:e.description,section:e.section,unit:e.unit,currency_pricing:e.pricing}).eq("id",e.id)}return e(e=>{let t=[...e.items];return l.forEach(e=>{t=t.map(t=>t.id===e.id?e:t)}),t=[...t,...s],Ra(t),{items:t}}),{success:!0,count:s.length+l.length}}catch(Pc){return{success:!1,error:Pc.message}}},exportToCSV:()=>{const{items:e}=t(),n=["MALAYSIA","SEA","GULF","CENTRAL_ASIA"],a=["id","section","name","description","unit"];n.forEach(e=>{a.push(`${e}_cost`),a.push(`${e}_charge`)}),n.forEach(e=>{a.push(`${e}_cost_amount`),a.push(`${e}_cost_currency`),a.push(`${e}_charge_amount`),a.push(`${e}_charge_currency`)});let r=a.join(",")+"\n";e.forEach(e=>{const t=[e.id,e.section||"",`"${(e.name||"").replace(/"/g,'""')}"`,`"${(e.description||"").replace(/"/g,'""')}"`,e.unit||"day"];n.forEach(n=>{const a=e.pricing?.[n];t.push(a?.cost?.amount||0),t.push(a?.charge?.amount||0)}),n.forEach(n=>{const a=e.pricing?.[n];t.push(a?.cost?.amount||""),t.push(a?.cost?.baseCurrency||""),t.push(a?.charge?.amount||""),t.push(a?.charge?.baseCurrency||"")}),r+=t.join(",")+"\n"});const o=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(o),s=document.createElement("a");s.href=i,s.download=`rate-card-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(i)},exportTemplate:()=>{const{sections:e}=t(),n=["id","section","name","description","unit"];["MALAYSIA","SEA","GULF","CENTRAL_ASIA"].forEach(e=>{n.push(`${e}_cost`),n.push(`${e}_charge`)});let a=n.join(",")+"\n";a+="# INSTRUCTIONS: Fill in your services below. Delete example rows before importing.\n",a+='# Leave "id" empty for new items. Unit options: day, item, project\n',a+=`# Available sections: ${e.map(e=>e.id+" ("+e.name+")").join(", ")}\n`,a+="#\n",e.slice(0,3).forEach((e,t)=>{const n=100+50*t,r=1.5*n;a+=`,${e.id},"Example ${e.name} Item","Description here",day,${n},${r},${1.2*n},${1.2*r},${1.5*n},${1.5*r},${1.3*n},${1.3*r}\n`});const r=new Blob([a],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(r),i=document.createElement("a");i.href=o,i.download="rate-card-template.csv",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)},exportPublicRateCard:(e="SEA")=>{const{items:n,sections:a}=t();let r=["Category","Service","Description","Unit","Day Rate","Currency"].join(",")+"\n";const o={};a.forEach(e=>{o[e.id]=e.name});[...n].sort((e,t)=>a.findIndex(t=>t.id===e.section)-a.findIndex(e=>e.id===t.section)).forEach(t=>{const n=t.pricing?.[e],a=n?.charge?.amount||0,i=n?.charge?.baseCurrency||"USD";if(a>0){const e=[o[t.section]||t.section||"General",`"${(t.name||"").replace(/"/g,'""')}"`,`"${(t.description||"").replace(/"/g,'""')}"`,t.unit||"day",a,i];r+=e.join(",")+"\n"}});const i=new Blob([r],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(i),l=document.createElement("a");l.href=s,l.download=`tell-productions-rate-card-${e.toLowerCase()}-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s)}}))),za="tell_activities";function Fa(){try{const e=localStorage.getItem(za);return e?JSON.parse(e):[]}catch(Pc){return[]}}function Ba(e){try{localStorage.setItem(za,JSON.stringify(e))}catch(Pc){}}const Ua={call:{label:"Call",icon:"phone",color:"text-green-400",bgColor:"bg-green-400/10"},email:{label:"Email",icon:"mail",color:"text-blue-400",bgColor:"bg-blue-400/10"},meeting:{label:"Meeting",icon:"users",color:"text-purple-400",bgColor:"bg-purple-400/10"},note:{label:"Note",icon:"file-text",color:"text-gray-400",bgColor:"bg-gray-400/10"},task:{label:"Task",icon:"check-square",color:"text-amber-400",bgColor:"bg-amber-400/10"},quote_sent:{label:"Quote Sent",icon:"send",color:"text-cyan-400",bgColor:"bg-cyan-400/10"},quote_viewed:{label:"Quote Viewed",icon:"eye",color:"text-indigo-400",bgColor:"bg-indigo-400/10"},quote_accepted:{label:"Quote Won",icon:"trophy",color:"text-emerald-400",bgColor:"bg-emerald-400/10"},quote_rejected:{label:"Quote Lost",icon:"x-circle",color:"text-red-400",bgColor:"bg-red-400/10"}},$a=[{id:"connected",label:"Connected",color:"text-green-400"},{id:"voicemail",label:"Left Voicemail",color:"text-amber-400"},{id:"no_answer",label:"No Answer",color:"text-gray-400"},{id:"busy",label:"Busy",color:"text-orange-400"},{id:"wrong_number",label:"Wrong Number",color:"text-red-400"}],Va=[{id:"in_person",label:"In Person",icon:"users"},{id:"video",label:"Video Call",icon:"video"},{id:"phone",label:"Phone Call",icon:"phone"}],Ha=[{id:"low",label:"Low",color:"text-gray-400",bgColor:"bg-gray-400/10"},{id:"medium",label:"Medium",color:"text-blue-400",bgColor:"bg-blue-400/10"},{id:"high",label:"High",color:"text-orange-400",bgColor:"bg-orange-400/10"},{id:"urgent",label:"Urgent",color:"text-red-400",bgColor:"bg-red-400/10"}];function Wa(e){return{id:e.id,contactId:e.contact_id,clientId:e.client_id,opportunityId:e.opportunity_id,quoteId:e.quote_id,activityType:e.activity_type,subject:e.subject,description:e.description,callOutcome:e.call_outcome,callDirection:e.call_direction,meetingType:e.meeting_type,meetingLocation:e.meeting_location,durationMinutes:e.duration_minutes,dueDate:e.due_date,isCompleted:e.is_completed,completedAt:e.completed_at,priority:e.priority,assignedTo:e.assigned_to,emailMessageId:e.email_message_id,activityDate:e.activity_date,createdAt:e.created_at,updatedAt:e.updated_at}}const Ga=h($n((e,t)=>({activities:Fa(),loading:!1,error:null,initialized:!1,initialize:async()=>{if(!t().initialized)if(e({loading:!0,error:null}),kn())try{const{data:t,error:n}=await _n.from("activities").select("*").order("activity_date",{ascending:!1}).limit(500);if(n)throw n;const a=(t||[]).map(Wa);Ba(a),e({activities:a,loading:!1,initialized:!0,error:null})}catch(Pc){e({loading:!1,error:Pc.message,initialized:!0})}else e({loading:!1,initialized:!0})},getClientActivities:e=>t().activities.filter(t=>t.clientId===e).sort((e,t)=>new Date(t.activityDate)-new Date(e.activityDate)),getOpportunityActivities:e=>t().activities.filter(t=>t.opportunityId===e).sort((e,t)=>new Date(t.activityDate)-new Date(e.activityDate)),getContactActivities:e=>t().activities.filter(t=>t.contactId===e).sort((e,t)=>new Date(t.activityDate)-new Date(e.activityDate)),getUpcomingTasks:(e=7)=>{const n=new Date((new Date).getTime()+24*e*60*60*1e3);return t().activities.filter(e=>"task"===e.activityType&&!e.isCompleted&&e.dueDate&&new Date(e.dueDate)<=n).sort((e,t)=>new Date(e.dueDate)-new Date(t.dueDate))},getOverdueTasks:()=>{const e=new Date;return t().activities.filter(t=>"task"===t.activityType&&!t.isCompleted&&t.dueDate&&new Date(t.dueDate)<e).sort((e,t)=>new Date(e.dueDate)-new Date(t.dueDate))},getOverdueFollowUps:()=>{const e=new Date;return t().activities.filter(t=>!t.isCompleted&&t.dueDate&&new Date(t.dueDate)<e).sort((e,t)=>new Date(e.dueDate)-new Date(t.dueDate))},getRecentActivities:(e=20)=>t().activities.slice(0,e),addActivity:async t=>{if(!kn())return e({error:"Supabase not configured"}),null;try{const a={contact_id:(n=t).contactId||null,client_id:n.clientId||null,opportunity_id:n.opportunityId||null,quote_id:n.quoteId||null,activity_type:n.activityType,subject:n.subject||null,description:n.description||null,call_outcome:n.callOutcome||null,call_direction:n.callDirection||null,meeting_type:n.meetingType||null,meeting_location:n.meetingLocation||null,duration_minutes:n.durationMinutes||null,due_date:n.dueDate||null,is_completed:n.isCompleted||!1,completed_at:n.completedAt||null,priority:n.priority||null,assigned_to:n.assignedTo||null,email_message_id:n.emailMessageId||null,activity_date:n.activityDate||(new Date).toISOString()},{data:r,error:o}=await _n.from("activities").insert(a).select().single();if(o)throw o;const i=Wa(r);return e(e=>{const t=[i,...e.activities];return Ba(t),{activities:t,error:null}}),i}catch(Pc){return e({error:Pc.message}),null}var n},logCall:async e=>t().addActivity({...e,activityType:"call"}),logMeeting:async e=>t().addActivity({...e,activityType:"meeting"}),logEmail:async e=>t().addActivity({...e,activityType:"email"}),addNote:async e=>t().addActivity({...e,activityType:"note"}),createTask:async e=>t().addActivity({...e,activityType:"task",isCompleted:!1}),updateActivity:async(t,n)=>{if(!kn())return e({error:"Supabase not configured"}),!1;try{const a={};void 0!==n.subject&&(a.subject=n.subject),void 0!==n.description&&(a.description=n.description),void 0!==n.activityType&&(a.activity_type=n.activityType),void 0!==n.activityDate&&(a.activity_date=n.activityDate),void 0!==n.dueDate&&(a.due_date=n.dueDate),void 0!==n.isCompleted&&(a.is_completed=n.isCompleted),void 0!==n.completedAt&&(a.completed_at=n.completedAt),void 0!==n.priority&&(a.priority=n.priority),void 0!==n.callOutcome&&(a.call_outcome=n.callOutcome),void 0!==n.callDirection&&(a.call_direction=n.callDirection),void 0!==n.meetingType&&(a.meeting_type=n.meetingType),void 0!==n.meetingLocation&&(a.meeting_location=n.meetingLocation),void 0!==n.durationMinutes&&(a.duration_minutes=n.durationMinutes);const{error:r}=await _n.from("activities").update(a).eq("id",t);if(r)throw r;return e(e=>{const a=e.activities.map(e=>e.id===t?{...e,...n,updatedAt:(new Date).toISOString()}:e);return Ba(a),{activities:a,error:null}}),!0}catch(Pc){return e({error:Pc.message}),!1}},completeTask:async e=>t().updateActivity(e,{isCompleted:!0,completedAt:(new Date).toISOString()}),reopenTask:async e=>t().updateActivity(e,{isCompleted:!1,completedAt:null}),deleteActivity:async t=>{if(!kn())return e({error:"Supabase not configured"}),!1;try{const{error:n}=await _n.from("activities").delete().eq("id",t);if(n)throw n;return e(e=>{const n=e.activities.filter(e=>e.id!==t);return Ba(n),{activities:n,error:null}}),!0}catch(Pc){return e({error:Pc.message}),!1}},clearError:()=>e({error:null})}))),Ka="tell_clients",Qa="tell_saved_quotes",Ya="tell_clients_sync_queue";function Ja(){try{const e=localStorage.getItem(Ka);return e?JSON.parse(e):[]}catch(Pc){return[]}}function Za(){try{const e=localStorage.getItem(Qa);return e?JSON.parse(e):[]}catch(Pc){return[]}}function Xa(e){try{localStorage.setItem(Ka,JSON.stringify(e))}catch(Pc){}}function er(e){try{localStorage.setItem(Qa,JSON.stringify(e))}catch(Pc){}}function tr(){try{const e=localStorage.getItem(Ya);return e?JSON.parse(e):[]}catch(Pc){return[]}}function nr(e){try{localStorage.setItem(Ya,JSON.stringify(e))}catch(Pc){}}function ar(){return`${Date.now()}-${Math.random().toString(36).substring(2,11)}`}const rr=h($n((e,t)=>({clients:Ja(),savedQuotes:Za(),loading:!1,syncStatus:"idle",syncError:null,pendingSyncCount:tr().length,initialize:async()=>{if(kn()){e({loading:!0,syncStatus:"syncing"});try{const{data:n,error:a}=await _n.from("clients").select("*").order("created_at",{ascending:!1});if(a)throw a;const{data:r,error:o}=await _n.from("quotes").select("*").order("created_at",{ascending:!1});if(o)throw o;const i=(n||[]).map(e=>({id:e.id,company:e.company,contact:e.contact,email:e.email,phone:e.phone,website:e.website,location:e.location,address:e.address,region:e.region,notes:e.notes,tags:e.tags||[],contacts:e.contacts||[],paymentTerms:e.payment_terms,preferredCurrency:e.preferred_currency,industry:e.industry,createdAt:e.created_at,updatedAt:e.updated_at,_synced:!0})),{clients:s,migratedCount:l}=function(e){let t=0;return{clients:e.map(e=>{if(e.contacts&&e.contacts.length>0)return e;if(!(e.contact||e.email||e.phone))return e;const n={id:ar(),name:e.contact||"Primary Contact",email:e.email||"",phone:e.phone||"",role:"",isPrimary:!0,createdAt:(new Date).toISOString()};return t++,{...e,contacts:[n],_contactsMigrated:!0}}),migratedCount:t}}(i);if(l>0)for(const e of s.filter(e=>e._contactsMigrated))try{await _n.from("clients").update({contacts:e.contacts}).eq("id",e.id),delete e._contactsMigrated}catch(Pc){}const c=(r||[]).map(e=>{let t=null;if(e.client?.clientId&&(t=s.find(t=>t.id===e.client.clientId)),!t&&e.client?.company){const n=e.client.company.toLowerCase();t=s.find(e=>e.company?.toLowerCase()===n)}return{id:e.id,quoteNumber:e.quote_number,quoteDate:e.quote_date,validityDays:e.validity_days,status:e.status,currency:e.currency,region:e.region,preparedBy:e.prepared_by,client:e.client||{},clientId:t?.id||e.client?.clientId||null,project:e.project||{},sections:e.sections||{},fees:e.fees||{},proposal:e.proposal||{},createdAt:e.created_at,updatedAt:e.updated_at,_synced:!0}}),d=Ja(),u=Za(),m=d.filter(e=>!e._synced&&!s.find(t=>t.id===e.id)),p=u.filter(e=>!e._synced&&!c.find(t=>t.id===e.id||t.quoteNumber===e.quoteNumber));for(const e of m)try{const{data:t,error:n}=await _n.from("clients").insert({company:e.company,contact:e.contact,email:e.email,phone:e.phone,website:e.website,location:e.location,address:e.address,region:e.region,notes:e.notes,tags:e.tags,contacts:e.contacts,payment_terms:e.paymentTerms,preferred_currency:e.preferredCurrency,industry:e.industry}).select().single();!n&&t&&s.push({...e,id:t.id,_synced:!0})}catch(Pc){}for(const e of p)try{const{data:t,error:n}=await _n.from("quotes").insert({quote_number:e.quoteNumber,quote_date:e.quoteDate,validity_days:e.validityDays,status:e.status,currency:e.currency,region:e.region,prepared_by:e.preparedBy,client:e.client,project:e.project,sections:e.sections,fees:e.fees,proposal:e.proposal}).select().single();!n&&t&&c.push({...e,id:t.id,_synced:!0})}catch(Pc){}Xa(s),er(c),e({clients:s,savedQuotes:c,loading:!1,syncStatus:"success",syncError:null}),await t().processSyncQueue()}catch(Pc){e({loading:!1,syncStatus:"error",syncError:Pc.message})}}else e({loading:!1,syncStatus:"idle"})},processSyncQueue:async()=>{if(!kn())return;const t=tr();if(0===t.length)return;const n=[];for(const e of t)try{"clients"===e.table?"insert"===e.action?await _n.from("clients").insert(e.data):"update"===e.action?await _n.from("clients").update(e.data).eq("id",e.id):"delete"===e.action&&await _n.from("clients").delete().eq("id",e.id):"quotes"===e.table&&("insert"===e.action?await _n.from("quotes").insert(e.data):"update"===e.action?await _n.from("quotes").update(e.data).eq("id",e.id):"delete"===e.action&&await _n.from("quotes").delete().eq("id",e.id))}catch(Pc){n.push({...e,retries:(e.retries||0)+1,lastError:Pc.message})}nr(n),e({pendingSyncCount:n.length})},addToSyncQueue:(t,n,a,r)=>{const o=tr();o.push({table:t,action:n,id:a,data:r,timestamp:Date.now()}),nr(o),e(e=>({pendingSyncCount:e.pendingSyncCount+1}))},getUnsyncedCount:()=>t().clients.filter(e=>!e._synced).length+t().savedQuotes.filter(e=>!e._synced).length,syncAllToSupabase:async()=>{if(!kn())return{success:!1,error:"Supabase not configured"};e({syncStatus:"syncing"});let n=0,a=0;for(const r of t().clients)if(!r._synced)try{const t={company:r.company,contact:r.contact,email:r.email,phone:r.phone,website:r.website,location:r.location,address:r.address,region:r.region,notes:r.notes,tags:r.tags,contacts:r.contacts,payment_terms:r.paymentTerms,preferred_currency:r.preferredCurrency,industry:r.industry},{data:a}=await _n.from("clients").select("id").eq("id",r.id).single();if(a)await _n.from("clients").update(t).eq("id",r.id);else{const{data:n}=await _n.from("clients").insert(t).select().single();n&&e(e=>({clients:e.clients.map(e=>e.id===r.id?{...e,id:n.id,_synced:!0}:e)}))}n++}catch(Pc){a++}for(const r of t().savedQuotes)if(!r._synced)try{const t={quote_number:r.quoteNumber,quote_date:r.quoteDate,validity_days:r.validityDays,status:r.status,currency:r.currency,region:r.region,prepared_by:r.preparedBy,client:r.client,project:r.project,sections:r.sections,fees:r.fees,proposal:r.proposal},{data:a}=await _n.from("quotes").select("id").eq("quote_number",r.quoteNumber).single();if(a)await _n.from("quotes").update(t).eq("id",a.id);else{const{data:n}=await _n.from("quotes").insert(t).select().single();n&&e(e=>({savedQuotes:e.savedQuotes.map(e=>e.id===r.id?{...e,id:n.id,_synced:!0}:e)}))}n++}catch(Pc){a++}return e(e=>({clients:e.clients.map(e=>({...e,_synced:!0})),savedQuotes:e.savedQuotes.map(e=>({...e,_synced:!0})),syncStatus:a>0?"error":"success",syncError:a>0?`${a} items failed to sync`:null})),Xa(t().clients),er(t().savedQuotes),{success:0===a,synced:n,errors:a}},clearSyncError:()=>{e({syncError:null,syncStatus:"idle"})},addClient:async n=>{const a={id:ar(),company:n.company||"",contact:n.contact||"",email:n.email||"",phone:n.phone||"",website:n.website||"",location:n.location||"",address:n.address||"",region:n.region||"MALAYSIA",notes:n.notes||"",contacts:n.contacts||[],tags:n.tags||[],paymentTerms:n.paymentTerms||"net30",preferredCurrency:n.preferredCurrency||"USD",industry:n.industry||"",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),_synced:!1};if(a.contacts.length||!a.contact&&!a.email||a.contacts.push({id:ar(),name:a.contact,email:a.email,phone:a.phone,role:"Primary",isPrimary:!0}),e(e=>{const t=[...e.clients,a];return Xa(t),{clients:t}}),kn())try{const{data:t,error:n}=await _n.from("clients").insert({company:a.company,contact:a.contact,email:a.email,phone:a.phone,website:a.website,location:a.location,address:a.address,region:a.region,notes:a.notes,tags:a.tags,contacts:a.contacts,payment_terms:a.paymentTerms,preferred_currency:a.preferredCurrency,industry:a.industry}).select().single();if(n)throw n;e(e=>{const n=e.clients.map(e=>e.id===a.id?{...e,id:t.id,_synced:!0}:e);return Xa(n),{clients:n,syncStatus:"success",syncError:null}}),a.id=t.id}catch(Pc){t().addToSyncQueue("clients","insert",a.id,{company:a.company,contact:a.contact,email:a.email,phone:a.phone,website:a.website,location:a.location,address:a.address,region:a.region,notes:a.notes,tags:a.tags,contacts:a.contacts}),e({syncStatus:"error",syncError:`Failed to sync client: ${Pc.message}`})}return a},updateClient:async(n,a)=>{if(e(e=>{const t=e.clients.map(e=>e.id===n?{...e,...a,updatedAt:(new Date).toISOString(),_synced:!1}:e);return Xa(t),{clients:t}}),kn())try{const t={};void 0!==a.company&&(t.company=a.company),void 0!==a.contact&&(t.contact=a.contact),void 0!==a.email&&(t.email=a.email),void 0!==a.phone&&(t.phone=a.phone),void 0!==a.website&&(t.website=a.website),void 0!==a.location&&(t.location=a.location),void 0!==a.address&&(t.address=a.address),void 0!==a.region&&(t.region=a.region),void 0!==a.notes&&(t.notes=a.notes),void 0!==a.tags&&(t.tags=a.tags),void 0!==a.contacts&&(t.contacts=a.contacts),void 0!==a.paymentTerms&&(t.payment_terms=a.paymentTerms),void 0!==a.preferredCurrency&&(t.preferred_currency=a.preferredCurrency),void 0!==a.industry&&(t.industry=a.industry);const{error:r}=await _n.from("clients").update(t).eq("id",n);if(r)throw r;e(e=>{const t=e.clients.map(e=>e.id===n?{...e,_synced:!0}:e);return Xa(t),{clients:t,syncStatus:"success",syncError:null}})}catch(Pc){t().addToSyncQueue("clients","update",n,a),e({syncStatus:"error",syncError:`Failed to sync update: ${Pc.message}`})}},deleteClient:async n=>{if(e(e=>{const t=e.clients.filter(e=>e.id!==n),a=e.savedQuotes.filter(e=>e.clientId!==n);return Xa(t),er(a),{clients:t,savedQuotes:a}}),kn())try{const{error:t}=await _n.from("clients").delete().eq("id",n);if(t)throw t;e({syncStatus:"success",syncError:null})}catch(Pc){t().addToSyncQueue("clients","delete",n,null),e({syncStatus:"error",syncError:`Failed to sync delete: ${Pc.message}`})}},getClient:e=>t().clients.find(t=>t.id===e),getClientHealth:(e,n=[],a=[])=>{if(!t().clients.find(t=>t.id===e))return{status:"at-risk",score:0,factors:{}};const r=n.filter(t=>t.clientId===e),o=a.filter(t=>t.clientId===e);let i=0,s=null;if(r.length>0){const e=r.reduce((e,t)=>{const n=new Date(t.activityDate||t.createdAt);return n>e?n:e},new Date(0));s=Math.floor((Date.now()-e)/864e5),i=s<=7?40:s<=14?35:s<=30?25:s<=60?15:s<=90?5:0}let l=0,c=0;const d=o.filter(e=>"won"===e.status).length,u=o.filter(e=>["won","dead","rejected","expired"].includes(e.status)).length;u>0?(c=Math.round(d/u*100),l=c>=60?30:c>=40?20:c>=20?10:5):o.length>0&&(l=15);let m=0;const p=Date.now()-7776e6,h=o.filter(e=>new Date(e.savedAt||e.createdAt).getTime()>p).length;m=h>=3?30:2===h?25:1===h?15:0;const f=i+l+m;let g;return g=f>=60?"good":f>=30?"warning":"at-risk",{status:g,score:f,factors:{daysSinceActivity:s,activityScore:i,winRate:c,winRateScore:l,recentQuotes:h,engagementScore:m}}},getOrCreateClient:async e=>{const{clients:n}=t(),a=e.clientId?n.find(t=>t.id===e.clientId):n.find(t=>t.company?.toLowerCase()===e.company?.toLowerCase());return a||await t().addClient(e)},addContact:async(e,n)=>{const a=t().clients.find(t=>t.id===e);if(!a)return;const r=a.contacts||[],o=0===r.length||n.isPrimary,i={id:ar(),...n,isPrimary:o},s=o?r.map(e=>({...e,isPrimary:!1})):r;await t().updateClient(e,{contacts:[...s,i]})},updateContact:async(e,n,a)=>{const r=t().clients.find(t=>t.id===e);if(!r)return;let o=[...r.contacts||[]];a.isPrimary&&(o=o.map(e=>({...e,isPrimary:!1}))),o=o.map(e=>e.id===n?{...e,...a}:e),await t().updateClient(e,{contacts:o})},deleteContact:async(e,n)=>{const a=t().clients.find(t=>t.id===e);if(!a)return;const r=(a.contacts||[]).find(e=>e.id===n);let o=(a.contacts||[]).filter(e=>e.id!==n);r?.isPrimary&&o.length>0&&(o=o.map((e,t)=>({...e,isPrimary:0===t}))),await t().updateClient(e,{contacts:o})},saveQuote:async(n,a=null)=>{const{getOrCreateClient:r}=t();let o=a||n.client?.clientId;if(!o&&n.client?.company){o=(await r(n.client)).id}const i={...n,id:n.id||ar(),clientId:o,status:n.status||"draft",savedAt:(new Date).toISOString(),_synced:!1};if(e(e=>{const t=e.savedQuotes.findIndex(e=>e.quoteNumber===n.quoteNumber);let a;return t>=0?(a=[...e.savedQuotes],a[t]=i):a=[...e.savedQuotes,i],er(a),{savedQuotes:a}}),kn())try{const t={quote_number:i.quoteNumber,quote_date:i.quoteDate,validity_days:i.validityDays,status:i.status,currency:i.currency,region:i.region,prepared_by:i.preparedBy,client:i.client,project:i.project,sections:i.sections,fees:i.fees,proposal:i.proposal},{data:n}=await _n.from("quotes").select("id").eq("quote_number",i.quoteNumber).single();let a=i.id;if(n)await _n.from("quotes").update(t).eq("id",n.id),a=n.id;else{const{data:e,error:n}=await _n.from("quotes").insert(t).select().single();if(n)throw n;e&&(a=e.id)}e(e=>{const t=e.savedQuotes.map(e=>e.quoteNumber===i.quoteNumber?{...e,id:a,_synced:!0}:e);return er(t),{savedQuotes:t,syncStatus:"success",syncError:null}}),i.id=a}catch(Pc){t().addToSyncQueue("quotes","insert",i.id,{quote_number:i.quoteNumber,quote_date:i.quoteDate,validity_days:i.validityDays,status:i.status,currency:i.currency,region:i.region,prepared_by:i.preparedBy,client:i.client,project:i.project,sections:i.sections,fees:i.fees,proposal:i.proposal}),e({syncStatus:"error",syncError:`Failed to sync quote: ${Pc.message}`})}return i},getClientQuotes:e=>t().savedQuotes.filter(t=>t.clientId===e),getQuote:e=>t().savedQuotes.find(t=>t.id===e),getQuoteByNumber:e=>t().savedQuotes.find(t=>t.quoteNumber===e),deleteQuote:async n=>{if(e(e=>{const t=e.savedQuotes.filter(e=>e.id!==n);return er(t),{savedQuotes:t}}),kn())try{const{error:t}=await _n.from("quotes").delete().eq("id",n);if(t)throw t;e({syncStatus:"success",syncError:null})}catch(Pc){t().addToSyncQueue("quotes","delete",n,null),e({syncStatus:"error",syncError:`Failed to sync delete: ${Pc.message}`})}},updateQuoteStatus:async(n,a,r="",o=null,i="")=>{const s=t().savedQuotes.find(e=>e.id===n),l=s?.status;if(e(e=>{const t=e.savedQuotes.map(e=>{if(e.id!==n)return e;const t=[...e.statusHistory||[],{status:a,timestamp:(new Date).toISOString(),userId:"default",note:r}];return{...e,status:a,statusHistory:t,lostReason:o||e.lostReason,lostReasonNotes:i||e.lostReasonNotes,updatedAt:(new Date).toISOString(),_synced:!1}});return er(t),{savedQuotes:t}}),s&&l!==a){const e={sent:"quote_sent",won:"quote_won",dead:"quote_lost"}[a]||"note",l={sent:"Quote Sent",won:"Quote Won",dead:"Quote Lost",draft:"Quote Drafted"}[a]||`Quote Status: ${a}`;let c=`Quote ${s.quoteNumber||"N/A"} marked as ${a}`;"dead"===a&&o&&(c+=`. Reason: ${o}`,i&&(c+=` - ${i}`)),r&&(c+=`. Note: ${r}`);const d=s.clientId||t().clients.find(e=>e.company===s.client?.company)?.id;Ga.getState().addActivity({clientId:d,quoteId:n,type:e,title:l,description:c,loggedBy:"system",loggedByName:"System"})}if(kn())try{const r=t().savedQuotes.find(e=>e.id===n);if(!r?.quoteNumber)return;const{error:o,count:i}=await _n.from("quotes").update({status:a,project:{...r?.project||{},_statusHistory:r?.statusHistory,_lostReason:r?.lostReason,_lostReasonNotes:r?.lostReasonNotes}}).eq("quote_number",r.quoteNumber);if(o)throw o;e(e=>{const t=e.savedQuotes.map(e=>e.id===n?{...e,_synced:!0}:e);return er(t),{savedQuotes:t,syncStatus:"success",syncError:null}})}catch(Pc){e({syncStatus:"error",syncError:`Failed to sync status: ${Pc.message}`})}},updateQuote:async(t,n)=>{if(e(e=>{const a=e.savedQuotes.map(e=>e.id===t?{...e,...n,updatedAt:(new Date).toISOString(),_synced:!1}:e);return er(a),{savedQuotes:a}}),kn())try{const a={};if(n.status&&(a.status=n.status),n.client&&(a.client=n.client),n.project&&(a.project=n.project),n.sections&&(a.sections=n.sections),n.fees&&(a.fees=n.fees),Object.keys(a).length>0){const{error:n}=await _n.from("quotes").update(a).eq("id",t);if(n)throw n;e(e=>{const n=e.savedQuotes.map(e=>e.id===t?{...e,_synced:!0}:e);return er(n),{savedQuotes:n,syncStatus:"success",syncError:null}})}}catch(Pc){e({syncStatus:"error",syncError:`Failed to sync update: ${Pc.message}`})}},exportData:()=>{const{clients:e,savedQuotes:n}=t(),a={version:1,exportedAt:(new Date).toISOString(),clients:e,savedQuotes:n},r=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),o=URL.createObjectURL(r),i=document.createElement("a");i.href=o,i.download=`tell-productions-backup-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)},importData:async n=>{try{const a=await n.text(),r=JSON.parse(a);if(!r.clients||!r.savedQuotes)throw new Error("Invalid backup file format");const o=r.clients.map(e=>({...e,_synced:!1})),i=r.savedQuotes.map(e=>({...e,_synced:!1}));return e({clients:o,savedQuotes:i}),Xa(o),er(i),await t().syncAllToSupabase(),{success:!0,clientCount:o.length,quoteCount:i.length}}catch(Pc){return{success:!1,error:Pc.message}}},getClientStats:e=>{const n=t().savedQuotes.filter(t=>t.clientId===e);if(!n.length)return null;const a=n.filter(e=>"won"===e.status),r=n.filter(e=>"dead"===e.status||"rejected"===e.status),o=a.length+r.length;return{totalQuotes:n.length,wonCount:a.length,lostCount:r.length,winRate:o>0?Math.round(a.length/o*100):0}},getStats:()=>{const{clients:e,savedQuotes:n}=t();return{totalClients:e.length,totalQuotes:n.length,draftQuotes:n.filter(e=>"draft"===e.status).length,sentQuotes:n.filter(e=>"sent"===e.status).length,approvedQuotes:n.filter(e=>"approved"===e.status||"won"===e.status).length}},getFinancialStats:()=>{const{savedQuotes:e}=t();let n=0,a=0,r=0;return e.forEach(e=>{"won"===e.status?(n++,r++):"dead"!==e.status&&"rejected"!==e.status||(a++,r++)}),{winRate:r>0?Math.round(n/r*100):0,wonCount:n,lostCount:a}}})));let or=null,ir=null;function sr(e){if(ua(e),!e.id)return;const{savedQuotes:t,updateQuote:n}=rr.getState();t.some(t=>t.id===e.id)&&n(e.id,e)}async function lr(e){if(!e||!e.quoteNumber)return{synced:!1};if(!kn())return{synced:!1,reason:"supabase not configured"};const t=JSON.stringify(e);if(t===ir)return{synced:!1,reason:"no changes"};try{const n={quote_number:e.quoteNumber,quote_date:e.quoteDate,validity_days:e.validityDays,status:e.status||"draft",currency:e.currency,region:e.region,prepared_by:e.preparedBy,client:e.client,project:{...e.project,_sectionOrder:e.sectionOrder,_sectionNames:e.sectionNames},sections:e.sections,fees:e.fees,proposal:e.proposal};let a=e.id;if(e.id)await _n.from("quotes").update(n).eq("id",e.id);else{const{data:t}=await _n.from("quotes").select("id").eq("quote_number",e.quoteNumber).limit(1),r=t?.[0];if(r)await _n.from("quotes").update(n).eq("id",r.id),a=r.id;else{const{data:e,error:t}=await _n.from("quotes").insert(n).select().single();!t&&e&&(a=e.id)}}if(ir=t,a&&!e.id){pr.getState().setQuoteId(a);const{saveQuote:t}=rr.getState();t({...e,id:a})}return{synced:!0,id:a}}catch(Pc){return{synced:!1,error:Pc.message}}}function cr(){or&&(clearInterval(or),or=null,window.removeEventListener("beforeunload",cr))}function dr(e){const t=pr.getState().quote,{addActivityLog:n}=na.getState(),{user:a}=Un.getState(),r=a?.profile||{id:a?.userId||"unknown",name:a?.email?.split("@")[0]||"Unknown User"};n({userId:r.id,userName:r.name,quoteId:t.id,quoteNumber:t.quoteNumber,projectName:t.project?.title||"",...e})}function ur(){const e={};return ia.forEach(t=>{const n=oa[t],a={};n.subsections.forEach(e=>{a[e]=[]}),e[t]={...n,subsections:a,customSubsections:[],isExpanded:!0}}),e}function mr(){return{quoteNumber:ma(),currency:"USD",region:"SEA",quoteDate:(new Date).toISOString().split("T")[0],validityDays:30,status:"draft",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),client:{company:"",contactId:null,contact:"",role:"",email:"",phone:"",notes:""},project:{title:"",type:"broadcast",venue:"",startDate:"",endDate:"",description:""},fees:{managementFee:0,commissionFee:0,discount:0,distributeFees:!1},preparedBy:"default",sectionOrder:ia,sectionNames:{},sections:ur(),proposal:{coverImage:null,proposalText:"",isGenerated:!1},statusHistory:[],nextFollowUpDate:null,lostReason:null,lostReasonNotes:"",internalNotes:"",isLocked:!1,lockedAt:null,lockedBy:null,lockedExchangeRates:null}}const pr=h($n(e=>({quote:mr(),rates:la,ratesLoading:!1,ratesUpdated:null,activeSection:null,initialize:async()=>{const t=function(){try{const e=localStorage.getItem(da);return e?JSON.parse(e):null}catch(Pc){return null}}();t&&e({quote:t}),e({ratesLoading:!0});const{rates:n,timestamp:a}=await ha();e({rates:n,ratesUpdated:a,ratesLoading:!1}),or||(or=setInterval(()=>{lr(pr.getState().quote)},3e4),window.addEventListener("beforeunload",cr))},setQuoteId:t=>{e(e=>{const n={...e.quote,id:t};return ua(n),{quote:n}})},syncToSupabase:async()=>lr(pr.getState().quote),resetQuote:()=>{const t=mr();e({quote:t}),ua(t)},loadQuoteData:t=>{const n={...mr(),...t,updatedAt:(new Date).toISOString()};e({quote:n}),ua(n)},setQuoteNumber:t=>{e(e=>{const n={...e.quote,quoteNumber:t,updatedAt:(new Date).toISOString()};return sr(n),{quote:n}})},setCurrency:t=>{e(e=>{if(e.quote.isLocked)return e;const n=e.quote.currency;if(n===t)return e;const a=e.rates,r={...e.quote.sections};Object.keys(r).forEach(e=>{const o=r[e],i={...o.subsections};Object.keys(i).forEach(e=>{i[e]=i[e].map(e=>({...e,cost:Math.round(100*fa(e.cost,n,t,a))/100,charge:Math.round(100*fa(e.charge,n,t,a))/100}))}),r[e]={...o,subsections:i}});const o={...e.quote,currency:t,sections:r,updatedAt:(new Date).toISOString()};return sr(o),{quote:o}})},setRegion:t=>{if(pr.getState().quote.isLocked)return;const n=ca[t]?.defaultCurrency||"USD",a=qa.getState().items;e(e=>{const r={...e.quote.sections};Object.keys(r).forEach(e=>{const n=r[e];Object.keys(n.subsections).forEach(e=>{n.subsections[e]=n.subsections[e].map(e=>{const n=e.rateCardItemId?a.find(t=>t.id===e.rateCardItemId):a.find(t=>t.name===e.name);if(n){const a=n.pricing?.[t],r=a?.cost?.amount??e.cost,o=a?.charge?.amount??e.charge;return{...e,cost:r,charge:o,rateCardItemId:e.rateCardItemId||n.id}}return e})})});const o={...e.quote,region:t,currency:n,sections:r,updatedAt:(new Date).toISOString()};return sr(o),{quote:o}})},setQuoteDate:t=>{e(e=>{if(e.quote.isLocked)return e;const n={...e.quote,quoteDate:t,updatedAt:(new Date).toISOString()};return sr(n),{quote:n}})},setValidityDays:t=>{e(e=>{if(e.quote.isLocked)return e;const n={...e.quote,validityDays:parseInt(t),updatedAt:(new Date).toISOString()};return sr(n),{quote:n}})},setClientDetails:t=>{e(e=>{if(e.quote.isLocked)return e;const n=e.quote.client,a={...e.quote,client:{...e.quote.client,...t},updatedAt:(new Date).toISOString()};return sr(a),Object.keys(t).forEach(e=>{n[e]!==t[e]&&dr({action:"update",category:"client",field:`client.${e}`,oldValue:n[e],newValue:t[e],description:`Changed client ${e} from "${n[e]||"(empty)"}" to "${t[e]||"(empty)"}"`})}),{quote:a}})},setProjectDetails:t=>{e(e=>{if(e.quote.isLocked)return e;const n=e.quote.project,a={...e.quote,project:{...e.quote.project,...t},updatedAt:(new Date).toISOString()};return sr(a),Object.keys(t).forEach(e=>{n[e]!==t[e]&&dr({action:"update",category:"project",field:`project.${e}`,oldValue:n[e],newValue:t[e],description:`Changed project ${e} from "${n[e]||"(empty)"}" to "${t[e]||"(empty)"}"`})}),{quote:a}})},setFees:t=>{e(e=>{if(e.quote.isLocked)return e;const n=e.quote.fees,a={...e.quote,fees:{...e.quote.fees,...t},updatedAt:(new Date).toISOString()};return sr(a),Object.keys(t).forEach(e=>{n[e]!==t[e]&&dr({action:"update",category:"fees",field:`fees.${e}`,oldValue:n[e],newValue:t[e],description:`Changed ${e} from ${n[e]} to ${t[e]}`})}),{quote:a}})},setPreparedBy:t=>{e(e=>{if(e.quote.isLocked)return e;const n={...e.quote,preparedBy:t,updatedAt:(new Date).toISOString()};return sr(n),{quote:n}})},toggleSection:t=>{e(e=>{const n={...e.quote.sections};n[t]={...n[t],isExpanded:!n[t].isExpanded};return{quote:{...e.quote,sections:n}}})},moveSection:(t,n)=>{e(e=>{if(e.quote.isLocked)return e;const a=[...e.quote.sectionOrder||ia],r=a.indexOf(t);if(-1===r)return e;const o="up"===n?r-1:r+1;if(o<0||o>=a.length)return e;[a[r],a[o]]=[a[o],a[r]];const i={...e.quote,sectionOrder:a,updatedAt:(new Date).toISOString()};return sr(i),{quote:i}})},updateSectionName:(t,n)=>{e(e=>{if(e.quote.isLocked)return e;const a={...e.quote.sectionNames};n.trim()?a[t]=n.trim():delete a[t];const r={...e.quote,sectionNames:a,updatedAt:(new Date).toISOString()};return sr(r),{quote:r}})},addLineItem:(t,n,a)=>{e(e=>{if(e.quote.isLocked)return e;const r={...e.quote.sections},o={...r[t]},i={...o.subsections},s={id:`${Date.now()}-${Math.random().toString(36).substring(2,11)}`,name:a.name||"",quantity:a.quantity||1,days:a.days||1,cost:a.cost||0,charge:a.charge||0,rateCardItemId:a.rateCardItemId||null,kitItemId:a.kitItemId||null,...a};i[n]=[...i[n]||[],s],o.subsections=i,r[t]=o;const l={...e.quote,sections:r,updatedAt:(new Date).toISOString()};return sr(l),dr({action:"create",category:"lineItem",field:`${t}.${n}`,newValue:s,description:`Added line item "${s.name||"Unnamed"}" to ${n}`}),{quote:l}})},updateLineItem:(t,n,a,r)=>{e(e=>{if(e.quote.isLocked)return e;const o={...e.quote.sections},i={...o[t]},s={...i.subsections},l=s[n].find(e=>e.id===a);s[n]=s[n].map(e=>e.id===a?{...e,...r}:e),i.subsections=s,o[t]=i;const c={...e.quote,sections:o,updatedAt:(new Date).toISOString()};return sr(c),l&&Object.keys(r).forEach(e=>{l[e]!==r[e]&&dr({action:"update",category:"lineItem",field:`lineItem.${e}`,oldValue:l[e],newValue:r[e],description:`Updated "${l.name||"Unnamed"}" ${e}: ${l[e]}  ${r[e]}`})}),{quote:c}})},deleteLineItem:(t,n,a)=>{e(e=>{if(e.quote.isLocked)return e;const r={...e.quote.sections},o={...r[t]},i={...o.subsections},s=i[n].find(e=>e.id===a);i[n]=i[n].filter(e=>e.id!==a),o.subsections=i,r[t]=o;const l={...e.quote,sections:r,updatedAt:(new Date).toISOString()};return sr(l),s&&dr({action:"delete",category:"lineItem",field:`${t}.${n}`,oldValue:s,description:`Deleted line item "${s.name||"Unnamed"}" from ${n}`}),{quote:l}})},moveLineItem:(t,n,a,r,o)=>{e(e=>{if(e.quote.isLocked)return e;const i={...e.quote.sections},s=e=>({...i[e].subsections}),l=s(t),c=t===r?l:s(r),d=l[n].find(e=>e.id===a);if(!d)return{quote:e.quote};l[n]=l[n].filter(e=>e.id!==a),c[o]=[...c[o]||[],d],i[t]={...i[t],subsections:l},t!==r&&(i[r]={...i[r],subsections:c});const u={...e.quote,sections:i,updatedAt:(new Date).toISOString()};return sr(u),{quote:u}})},addCustomSubsection:(t,n)=>{e(e=>{if(e.quote.isLocked)return e;const a={...e.quote.sections},r={...a[t]};r.customSubsections.includes(n)||(r.customSubsections=[...r.customSubsections,n],r.subsections={...r.subsections,[n]:[]}),a[t]=r;const o={...e.quote,sections:a,updatedAt:(new Date).toISOString()};return sr(o),{quote:o}})},reorderSubsections:(t,n)=>{e(e=>{if(e.quote.isLocked)return e;const a={...e.quote.sections},r={...a[t]};r.subsectionOrder=n,a[t]=r;const o={...e.quote,sections:a,updatedAt:(new Date).toISOString()};return sr(o),{quote:o}})},updateSubsectionName:(t,n,a)=>{e(e=>{if(e.quote.isLocked)return e;const r={...e.quote.sections},o={...r[t]},i={...o.subsectionNames||{}};a.trim()&&a.trim()!==n?i[n]=a.trim():delete i[n],o.subsectionNames=i,r[t]=o;const s={...e.quote,sections:r,updatedAt:(new Date).toISOString()};return sr(s),{quote:s}})},refreshRates:async()=>{e({ratesLoading:!0}),localStorage.removeItem("exchange_rates_cache");const{rates:t,timestamp:n}=await ha();e({rates:t,ratesUpdated:n,ratesLoading:!1})},setProposal:t=>{e(e=>{if(e.quote.isLocked)return e;const n={...e.quote,proposal:{...e.quote.proposal,...t},updatedAt:(new Date).toISOString()};return sr(n),{quote:n}})},updateQuoteStatus:(t,n="",a="default")=>{e(e=>{const r=e.quote.status,o=[...e.quote.statusHistory||[],{status:t,timestamp:(new Date).toISOString(),userId:a,note:n}];let i=e.quote.lockedExchangeRates;["sent","accepted","won"].includes(t)&&!i&&(i={rates:{...e.rates},lockedAt:(new Date).toISOString(),baseCurrency:"USD"});const s={...e.quote,status:t,statusHistory:o,lockedExchangeRates:i,updatedAt:(new Date).toISOString()};return sr(s),dr({action:"status_change",category:"status",field:"status",oldValue:r,newValue:t,description:`Changed status from "${r}" to "${t}"${n?` (${n})`:""}`}),{quote:s}})},setNextFollowUpDate:t=>{e(e=>{const n={...e.quote,nextFollowUpDate:t,updatedAt:(new Date).toISOString()};return sr(n),{quote:n}})},setLostReason:(t,n="")=>{e(e=>{const a={...e.quote,lostReason:t,lostReasonNotes:n,updatedAt:(new Date).toISOString()};return sr(a),{quote:a}})},setInternalNotes:t=>{e(e=>{const n={...e.quote,internalNotes:t,updatedAt:(new Date).toISOString()};return sr(n),{quote:n}})},lockQuote:(t="default")=>{e(e=>{const n=e.quote.lockedExchangeRates||{rates:{...e.rates},lockedAt:(new Date).toISOString(),baseCurrency:"USD"},a={...e.quote,isLocked:!0,lockedAt:(new Date).toISOString(),lockedBy:t,lockedExchangeRates:n,updatedAt:(new Date).toISOString()};return sr(a),dr({action:"lock",category:"lock",field:"isLocked",oldValue:!1,newValue:!0,description:"Locked quote for editing (exchange rates frozen)"}),{quote:a}})},unlockQuote:(t="default")=>{e(e=>{const t={...e.quote,isLocked:!1,lockedAt:null,lockedBy:null,updatedAt:(new Date).toISOString()};return sr(t),dr({action:"unlock",category:"lock",field:"isLocked",oldValue:!0,newValue:!1,description:"Unlocked quote for editing"}),{quote:t}})}}))),hr=m.createContext(null);function fr(){const e=m.useContext(hr);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}function gr({children:e}){const[t,n]=m.useState([]),a=m.useCallback((e,t="info",a=4e3)=>{const r=Date.now()+Math.random();return n(n=>[...n,{id:r,message:e,type:t}]),a>0&&setTimeout(()=>{n(e=>e.filter(e=>e.id!==r))},a),r},[]),o=m.useCallback(e=>{n(t=>t.filter(t=>t.id!==e))},[]),i={info:(e,t)=>a(e,"info",t),success:(e,t)=>a(e,"success",t),error:(e,t)=>a(e,"error",t),warning:(e,t)=>a(e,"warning",t)};return r.jsxs(hr.Provider,{value:i,children:[e,r.jsx(yr,{toasts:t,onRemove:o})]})}function yr({toasts:e,onRemove:t}){return 0===e.length?null:r.jsx("div",{className:"fixed bottom-4 right-4 left-4 sm:left-auto z-[100] flex flex-col gap-2 max-w-sm sm:max-w-md mx-auto sm:mx-0",role:"region","aria-label":"Notifications","aria-live":"polite",children:e.map(e=>r.jsx(br,{toast:e,onRemove:t},e.id))})}function br({toast:e,onRemove:t}){const[n,a]=m.useState(!1),o=()=>{a(!0),setTimeout(()=>t(e.id),200)};return r.jsxs("div",{role:"alert","aria-atomic":"true",className:`\n                ${{info:"bg-blue-500/90 border-blue-400",success:"bg-green-500/90 border-green-400",error:"bg-red-500/90 border-red-400",warning:"bg-yellow-500/90 border-yellow-400"}[e.type]}\n                border rounded-lg px-4 py-3 text-white shadow-lg\n                flex items-start gap-3 w-full\n                transition-all duration-200 ease-out\n                ${n?"opacity-0 translate-x-4 sm:translate-x-4":"opacity-100 translate-x-0"}\n                animate-slide-in-right\n            `,children:[r.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:{info:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",success:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",error:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",warning:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"}[e.type]})}),r.jsx("span",{className:"flex-1 text-sm leading-relaxed",children:e.message}),r.jsx("button",{onClick:o,onKeyDown:e=>{"Escape"!==e.key&&"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),o())},className:"text-white/70 hover:text-white transition-colors min-w-[32px] min-h-[32px] flex items-center justify-center -mr-1","aria-label":"Dismiss notification",title:"Dismiss (Esc)",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}const vr="tell_quote_templates",xr="tell_quote_templates_sync_queue";function wr(){try{const e=localStorage.getItem(xr);return e?JSON.parse(e):[]}catch(Pc){return[]}}function _r(e){try{localStorage.setItem(xr,JSON.stringify(e))}catch(Pc){}}function kr(){try{const e=localStorage.getItem(vr);return e?JSON.parse(e):[]}catch(Pc){return[]}}function Sr(e){try{localStorage.setItem(vr,JSON.stringify(e))}catch(Pc){}}const Cr=h($n((e,t)=>({templates:kr(),loading:!1,syncStatus:"idle",syncError:null,pendingSyncCount:wr().length,clearSyncError:()=>{e({syncError:null,syncStatus:"idle"})},getUnsyncedCount:()=>{const e=wr(),n=t().templates.filter(e=>!1===e._synced);return e.length+n.length},addToSyncQueue:(t,n,a)=>{const r=wr();r.push({action:t,id:n,data:a,timestamp:Date.now()}),_r(r),e({pendingSyncCount:r.length})},processSyncQueue:async()=>{if(!kn())return;const t=wr();if(0===t.length)return;e({syncStatus:"syncing"});const n=[];for(const e of t)try{if("create"===e.action){const{error:t}=await _n.from("quote_templates").insert(e.data);if(t)throw t}else if("update"===e.action){const{error:t}=await _n.from("quote_templates").update(e.data).eq("id",e.id);if(t)throw t}else if("delete"===e.action){const{error:t}=await _n.from("quote_templates").delete().eq("id",e.id);if(t)throw t}}catch(a){n.push(e)}_r(n),e({syncStatus:n.length>0?"error":"success",syncError:n.length>0?`${n.length} items failed to sync`:null,pendingSyncCount:n.length})},syncAllToSupabase:async()=>{const{processSyncQueue:e}=t();await e()},initialize:async()=>{if(kn()){e({loading:!0,syncStatus:"syncing"});try{const{data:n,error:a}=await _n.from("quote_templates").select("*").order("created_at",{ascending:!1});if(a)throw a;const r=(n||[]).map(e=>({id:e.id,name:e.name,description:e.description,category:e.category,sections:e.sections,currency:e.currency,region:e.region,fees:e.fees,projectDefaults:e.project_defaults,createdAt:e.created_at,updatedAt:e.updated_at,usageCount:e.usage_count||0,_synced:!0}));e({templates:r,loading:!1,syncStatus:"success",syncError:null}),Sr(r);wr().length>0&&t().processSyncQueue()}catch(n){e({loading:!1,syncStatus:"error",syncError:n.message})}}else e({loading:!1,syncStatus:"idle"})},getTemplate:e=>t().templates.find(t=>t.id===e),getTemplatesByCategory:e=>t().templates.filter(t=>t.category===e),createTemplate:async n=>{const{templates:a,addToSyncQueue:r}=t(),o={id:`tmpl_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,name:n.name,description:n.description||"",category:n.category||"general",sections:n.sections,currency:n.currency||"USD",region:n.region||"SEA",fees:n.fees||{managementFee:0,commissionFee:0,discountPercent:0},projectDefaults:n.projectDefaults||{},createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),usageCount:0,_synced:!1},i=[o,...a];if(e({templates:i}),Sr(i),kn()){const n={id:o.id,name:o.name,description:o.description,category:o.category,sections:o.sections,currency:o.currency,region:o.region,fees:o.fees,project_defaults:o.projectDefaults,usage_count:0};try{const{error:a}=await _n.from("quote_templates").insert(n);if(a)throw a;const r=t().templates.map(e=>e.id===o.id?{...e,_synced:!0}:e);e({templates:r,syncStatus:"success",syncError:null}),Sr(r)}catch(s){r("create",o.id,n),e({syncStatus:"error",syncError:s.message})}}return o},updateTemplate:async(n,a)=>{const{templates:r,addToSyncQueue:o}=t(),i=r.map(e=>e.id===n?{...e,...a,updatedAt:(new Date).toISOString(),_synced:!1}:e);if(e({templates:i}),Sr(i),kn()){const r={name:a.name,description:a.description,category:a.category,sections:a.sections,currency:a.currency,region:a.region,fees:a.fees,project_defaults:a.projectDefaults,updated_at:(new Date).toISOString()};Object.keys(r).forEach(e=>{void 0===r[e]&&delete r[e]});try{const{error:a}=await _n.from("quote_templates").update(r).eq("id",n);if(a)throw a;const o=t().templates.map(e=>e.id===n?{...e,_synced:!0}:e);e({templates:o,syncStatus:"success",syncError:null}),Sr(o)}catch(s){o("update",n,r),e({syncStatus:"error",syncError:s.message})}}},deleteTemplate:async n=>{const{templates:a,addToSyncQueue:r}=t(),o=a.filter(e=>e.id!==n);if(e({templates:o}),Sr(o),kn())try{const{error:t}=await _n.from("quote_templates").delete().eq("id",n);if(t)throw t;e({syncStatus:"success",syncError:null})}catch(i){r("delete",n,null),e({syncStatus:"error",syncError:i.message})}},incrementUsageCount:async n=>{const{templates:a}=t(),r=a.find(e=>e.id===n);if(!r)return;const o=(r.usageCount||0)+1,i=a.map(e=>e.id===n?{...e,usageCount:o}:e);if(e({templates:i}),Sr(i),kn())try{await _n.from("quote_templates").update({usage_count:o}).eq("id",n)}catch(s){}}})));Cr.subscribe(e=>e.templates,e=>Sr(e));const Nr=[{id:"broadcast",label:"Broadcast"},{id:"streaming",label:"Streaming"},{id:"corporate",label:"Corporate Event"},{id:"sports",label:"Sports"},{id:"concert",label:"Concert/Live"},{id:"general",label:"General"}];function jr({isOpen:e,onClose:t}){const n=pr(e=>e.quote),a=Cr(e=>e.createTemplate),[o,i]=m.useState(""),[s,l]=m.useState(""),[c,d]=m.useState("general"),[u,p]=m.useState(!1),[h,f]=m.useState(!1),[g,y]=m.useState(!0);if(!e)return null;const b=Object.values(n.sections||{}).reduce((e,t)=>e+Object.values(t.subsections||{}).reduce((e,t)=>e+(t.items?.length||0),0),0);return r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>t(!1)}),r.jsxs("div",{className:"relative bg-[#1a1f2e] border border-dark-border rounded-xl shadow-2xl w-full max-w-md",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-border",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-brand-teal to-brand-navy flex items-center justify-center",children:r.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-semibold text-white",children:"Save as Template"}),r.jsxs("p",{className:"text-xs text-gray-400",children:[b," items will be saved"]})]})]}),r.jsx("button",{onClick:()=>t(!1),className:"btn-icon text-gray-400 hover:text-white","aria-label":"Close modal",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Template Name *"}),r.jsx("input",{type:"text",value:o,onChange:e=>i(e.target.value),placeholder:"e.g., Sports Broadcast Package",className:"input",autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Category"}),r.jsx("select",{value:c,onChange:e=>d(e.target.value),className:"input",children:Nr.map(e=>r.jsx("option",{value:e.id,children:e.label},e.id))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Description"}),r.jsx("textarea",{value:s,onChange:e=>l(e.target.value),placeholder:"Brief description of when to use this template...",className:"input min-h-[80px] resize-none",rows:3})]}),r.jsxs("div",{className:"space-y-2 pt-2 border-t border-dark-border",children:[r.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[r.jsx("input",{type:"checkbox",checked:g,onChange:e=>y(e.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-dark-bg text-brand-teal focus:ring-brand-teal"}),r.jsx("span",{className:"text-sm text-gray-300 group-hover:text-white transition-colors",children:"Include fee percentages"})]}),r.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[r.jsx("input",{type:"checkbox",checked:h,onChange:e=>f(e.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-dark-bg text-brand-teal focus:ring-brand-teal"}),r.jsx("span",{className:"text-sm text-gray-300 group-hover:text-white transition-colors",children:"Include project type & description"})]})]}),r.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3",children:r.jsx("p",{className:"text-xs text-blue-300",children:"Templates save your line items, sections, currency, and region. Client details and dates are not included."})})]}),r.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-dark-border",children:[r.jsx("button",{onClick:()=>t(!1),className:"btn btn-ghost",children:"Cancel"}),r.jsx("button",{onClick:async()=>{if(o.trim()){p(!0);try{const e={name:o.trim(),description:s.trim(),category:c,sections:n.sections,currency:n.currency,region:n.region,fees:g?{managementFee:n.managementFee||0,commissionFee:n.commissionFee||0,discountPercent:n.discountPercent||0}:{managementFee:0,commissionFee:0,discountPercent:0},projectDefaults:h?{projectType:n.project?.projectType,description:n.project?.description}:{}};await a(e),t(!0)}catch(e){}finally{p(!1)}}},disabled:!o.trim()||u,className:"btn btn-primary",children:u?r.jsxs(r.Fragment,{children:[r.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Template"]})})]})]})]})}function Tr({onGoToDashboard:e}){const{quote:t,ratesLoading:n,refreshRates:a}=pr(),{saveQuote:o}=rr(),{settings:i,setTheme:s}=na(),l=fr(),c="light"!==i.theme,[d,u]=m.useState(!1),[p,h]=m.useState(!1),[f,g]=m.useState(!1);return r.jsxs(r.Fragment,{children:[r.jsx("header",{className:"sticky top-0 z-50 bg-dark-bg/95 backdrop-blur-md border-b border-dark-border",children:r.jsx("div",{className:"max-w-[1920px] mx-auto px-2 sm:px-4 py-2 sm:py-3",children:r.jsxs("div",{className:"flex items-center justify-between gap-2 sm:gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[r.jsx("button",{onClick:e,className:"btn-icon",title:"Back to Dashboard","aria-label":"Back to Dashboard",children:r.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),r.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("img",{src:"/productionos-logo.svg",alt:"ProductionOS",className:"h-5 sm:h-6 hidden xs:block",style:{color:"#fff"}}),r.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[r.jsx("span",{className:"text-[10px] sm:text-xs font-mono text-accent-primary",children:t.quoteNumber}),r.jsx("span",{className:"text-[10px] text-gray-500 border border-gray-800 rounded px-1 hidden sm:inline",children:"default"===t.preparedBy?"Admin":"User"})]})]})]}),r.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[r.jsx("button",{onClick:()=>s(c?"light":"dark"),className:"min-w-[44px] min-h-[44px] p-2 rounded-lg hover:bg-white/10 transition-colors flex items-center justify-center",title:c?"Switch to light mode":"Switch to dark mode",children:c?r.jsx("svg",{className:"w-5 h-5 text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):r.jsx("svg",{className:"w-5 h-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),r.jsx("div",{className:"px-2 sm:px-3 py-1 min-h-[32px] rounded-full text-[10px] sm:text-xs font-bold uppercase tracking-wider border flex items-center "+("won"===t.status?"bg-green-500/20 text-green-400 border-green-500/30":"sent"===t.status?"bg-blue-500/20 text-blue-400 border-blue-500/30":"dead"===t.status?"bg-red-500/20 text-red-500 border-red-500/30":"bg-gray-700/50 text-gray-400 border-gray-600"),children:t.status||"Draft"}),r.jsx("button",{onClick:a,disabled:n,className:"btn-icon hidden sm:flex",title:"Refresh exchange rates",children:r.jsx("svg",{className:"w-4 h-4 "+(n?"animate-spin":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),r.jsxs("button",{onClick:()=>g(!0),className:"btn-icon",title:"Save as template",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})}),r.jsx("span",{className:"hidden sm:inline",children:"Template"})]}),r.jsxs("button",{onClick:()=>{u(!0);try{const e=o(t);e?.id&&!t.id&&pr.getState().loadQuoteData({...t,id:e.id}),h(!0),setTimeout(()=>h(!1),2e3)}catch{l.error("Failed to save quote.")}finally{u(!1)}},disabled:d,className:"btn-icon "+(p?"text-green-400":""),title:"Save quote to library",children:[p?r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),r.jsx("span",{className:"hidden sm:inline",children:p?"Saved!":"Save"})]})]})]})})}),r.jsx(jr,{isOpen:f,onClose:e=>{g(!1),e&&l.success("Template saved successfully!")}})]})}function Ir(){const{quote:e,setClientDetails:t}=pr(),{clients:n,updateContact:a}=rr(),{client:o}=e,[i,s]=m.useState(!1),[l,c]=m.useState(""),d=o.company?n.filter(e=>e?.company?.toLowerCase()?.includes(o.company.toLowerCase())):n;m.useEffect(()=>{const e=e=>{"Escape"===e.key&&i&&s(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[i]);const u=(e,n)=>{t({[e]:n})},p=o?.clientId?n.find(e=>e.id===o.clientId):n.find(e=>e?.company?.toLowerCase()===o?.company?.toLowerCase()),h=(e,t)=>{u(e,t),p&&o.contactId&&a(p.id,o.contactId,{[e]:t})};return r.jsxs("div",{className:"card",children:[r.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4 text-accent-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Client Details"]}),r.jsxs("div",{className:"space-y-5",children:[r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"label",children:"Company Name"}),r.jsx("input",{type:"text",value:o.company,onChange:e=>u("company",e.target.value),onFocus:()=>!e.isLocked&&s(!0),placeholder:"Type to search or add new client...",className:"input",disabled:e.isLocked}),i&&d.length>0&&r.jsx("div",{className:"absolute z-50 top-full left-0 right-0 mt-1 bg-[#1a1a24] border border-dark-border rounded-lg shadow-xl max-h-64 overflow-y-auto",children:d.map((e,n)=>r.jsxs("button",{onClick:()=>(e=>{const n=e.contacts?.find(e=>e.isPrimary)||e.contacts?.[0];t({clientId:e.id,company:e.company,contactId:n?.id||null,contact:n?.name||e.contact||"",email:n?.email||e.email||"",phone:n?.phone||e.phone||"",role:n?.role||""}),s(!1)})(e),className:"w-full px-3 py-2.5 text-left hover:bg-accent-primary/20 transition-colors flex items-center gap-3 "+(n!==d.length-1?"border-b border-dark-border/50":""),children:[r.jsx("div",{className:"w-8 h-8 rounded-md bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-300 shrink-0",children:e.company.substring(0,2).toUpperCase()}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"text-sm text-gray-200 font-medium truncate",children:e.company}),e.contact&&r.jsx("p",{className:"text-xs text-gray-500 truncate",children:e.contact})]})]},e.id))}),i&&r.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>s(!1)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Contact Person"}),p&&p.contacts?.length>0?r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{value:o.contactId||"",onChange:e=>(e=>{if(!p)return;const n=p.contacts?.find(t=>t.id===e);n&&t({contactId:n.id,contact:n.name,role:n.role||"",email:n.email,phone:n.phone,notes:n.notes||""})})(e.target.value),className:"input flex-1",disabled:e.isLocked,children:[r.jsx("option",{value:"",children:"Select Contact..."}),p.contacts.map(e=>r.jsxs("option",{value:e.id,children:[e.name," ",e.isPrimary?"(Primary)":""," - ",e.role||"No Role"]},e.id))]}),r.jsx("input",{type:"text",value:o.contact,onChange:e=>u("contact",e.target.value),placeholder:"Or type name...",className:"input w-1/3",disabled:e.isLocked})]}):r.jsx("input",{type:"text",value:o.contact,onChange:e=>u("contact",e.target.value),placeholder:"e.g. Ahmad Rahman",className:"input",disabled:e.isLocked})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"label",children:["Role on Project ",r.jsx("span",{className:"text-gray-600 font-normal",children:"(for this quote)"})]}),r.jsx("input",{type:"text",value:o.role||"",onChange:e=>u("role",e.target.value),placeholder:"e.g. Executive Producer, Client Liaison",className:"input",disabled:e.isLocked})]}),r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Email"}),r.jsx("input",{type:"email",value:o.email,onChange:e=>h("email",e.target.value),placeholder:"email@company.com",className:"input",disabled:e.isLocked})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Phone"}),r.jsx("input",{type:"tel",value:o.phone,onChange:e=>h("phone",e.target.value),placeholder:"+65 9123 4567",className:"input",disabled:e.isLocked})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"label",children:["Notes",o.contactId&&r.jsx("span",{className:"text-accent-primary font-normal ml-1",children:"(synced to contact)"}),!o.contactId&&r.jsx("span",{className:"text-gray-600 font-normal ml-1",children:"(internal only)"})]}),r.jsx("textarea",{value:o.notes||"",onChange:e=>h("notes",e.target.value),placeholder:"Notes about this contact...",rows:2,className:"input resize-none text-sm",disabled:e.isLocked})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"label",children:["Event Tags ",r.jsx("span",{className:"text-gray-600 font-normal",children:"(for this quote)"})]}),r.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:(o.tags||[]).map((n,a)=>r.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-accent-primary/20 text-accent-primary rounded text-xs",children:[n,!e.isLocked&&r.jsx("button",{onClick:()=>(e=>{const n=o.tags||[];t({tags:n.filter(t=>t!==e)})})(n),className:"hover:text-white transition-colors",children:r.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},a))}),r.jsx("input",{type:"text",value:l,onChange:e=>c(e.target.value),onKeyDown:e=>{if("Enter"===e.key&&l.trim()){e.preventDefault();const n=o.tags||[];n.includes(l.trim())||t({tags:[...n,l.trim()]}),c("")}},placeholder:"Type and press Enter to add...",className:"input text-sm",disabled:e.isLocked})]})]})]})}function Dr({onGoToSettings:e}){const{quote:t,setProjectDetails:n,setPreparedBy:a,setQuoteDate:o,setValidityDays:i,setRegion:s,setNextFollowUpDate:l,setInternalNotes:c,lockQuote:d,unlockQuote:u}=pr(),[p,h]=m.useState(!1),[f,g]=m.useState(!1),{settings:y}=na(),b=y.projectTypes||[],v=y.regions||[],{project:x}=t,w=y.users||[],_=(e,t)=>{n({[e]:t})},k=w.find(e=>e.id===t.preparedBy)||w[0],S=t.lockedBy?w.find(e=>e.id===t.lockedBy):null;return r.jsxs("div",{className:"card",children:[t.isLocked&&r.jsxs("div",{className:"mb-4 p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),r.jsxs("span",{className:"text-sm font-medium",children:["This quote is locked",S&&r.jsxs("span",{className:"text-amber-500/70",children:[" by ",S.name]}),t.lockedAt&&r.jsxs("span",{className:"text-amber-500/70",children:[" on ",new Date(t.lockedAt).toLocaleDateString()]})]})]}),r.jsx("button",{onClick:()=>{u(k?.id||"default")},className:"text-xs px-3 py-1 bg-amber-500/20 hover:bg-amber-500/30 text-amber-400 rounded-lg transition-colors",children:"Unlock"})]}),r.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-4 flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4 text-accent-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"})}),"Project Details"]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Prepared By"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{value:t.preparedBy||"default",onChange:e=>a(e.target.value),className:"input flex-1",disabled:t.isLocked,children:[r.jsx("option",{value:"default",disabled:!0,children:"Select User"}),w.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]}),r.jsx("button",{className:"btn-ghost px-2",title:"Manage Users in Settings",onClick:e,children:r.jsxs("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Quote Date"}),r.jsx("input",{type:"date",value:t.quoteDate,onChange:e=>o(e.target.value),className:"input",disabled:t.isLocked})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Valid Until"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs("select",{value:t.validityDays,onChange:e=>i(e.target.value),className:"input flex-1",disabled:t.isLocked,children:[r.jsx("option",{value:"7",children:"7 Days"}),r.jsx("option",{value:"14",children:"14 Days"}),r.jsx("option",{value:"30",children:"30 Days"}),r.jsx("option",{value:"60",children:"60 Days"}),r.jsx("option",{value:"90",children:"90 Days"})]}),r.jsx("div",{className:"flex items-center justify-center px-3 bg-dark-bg/50 border border-dark-border rounded-lg text-sm text-gray-400 min-w-[100px]",children:(()=>{if(!t.quoteDate)return"-";const e=new Date(t.quoteDate);return e.setDate(e.getDate()+(parseInt(t.validityDays)||30)),e.toLocaleDateString()})()})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Project Title"}),r.jsx("input",{type:"text",value:x.title,onChange:e=>_("title",e.target.value),placeholder:"e.g. Shopee Cup Semi-Final",className:"input",disabled:t.isLocked})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Project Type"}),r.jsx("select",{value:x.type,onChange:e=>_("type",e.target.value),className:"input",disabled:t.isLocked,children:b.map(e=>r.jsx("option",{value:e.id,children:e.label},e.id))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Region (Rates)"}),r.jsx("select",{value:t.region||v[0]?.id||"SEA",onChange:e=>s(e.target.value),className:"input",disabled:t.isLocked,children:v.map(e=>r.jsx("option",{value:e.id,children:e.label},e.id))})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Currency"}),r.jsx("select",{value:t.currency||"USD",onChange:e=>{pr.getState().setCurrency(e.target.value)},className:"input",disabled:t.isLocked,children:Object.values(sa).map(e=>r.jsxs("option",{value:e.code,children:[e.symbol," ",e.code," - ",e.name]},e.code))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Venue"}),r.jsx("input",{type:"text",value:x.venue,onChange:e=>_("venue",e.target.value),placeholder:"e.g. Jalan Besar Stadium",className:"input",disabled:t.isLocked})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Start Date"}),r.jsx("input",{type:"date",value:x.startDate,onChange:e=>{const t=e.target.value;_("startDate",t),x.endDate&&t>x.endDate&&_("endDate",t)},className:"input",disabled:t.isLocked})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"End Date"}),r.jsx("input",{type:"date",value:x.endDate,onChange:e=>_("endDate",e.target.value),min:x.startDate||"",className:"input",disabled:t.isLocked})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Description"}),r.jsx("textarea",{value:x.description,onChange:e=>_("description",e.target.value),placeholder:"Brief project description...",rows:2,className:"input resize-none",disabled:t.isLocked})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4 text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),"Follow-up Reminder"]})}),r.jsx("input",{type:"date",value:t.nextFollowUpDate||"",onChange:e=>l(e.target.value||null),className:"input",disabled:t.isLocked}),r.jsx("p",{className:"form-helper",children:"Set a reminder date to follow up on this quote"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Internal Notes",r.jsx("span",{className:"text-xs text-gray-500 font-normal",children:"(Not shown in PDF)"})]})}),r.jsx("textarea",{value:t.internalNotes||"",onChange:e=>c(e.target.value),placeholder:"Team notes, context, reminders...",rows:3,className:"input resize-none",disabled:t.isLocked}),r.jsx("p",{className:"form-helper",children:"Useful for handoff context between team members"})]}),r.jsxs("div",{className:"border-t border-dark-border pt-4",children:[r.jsxs("button",{onClick:()=>h(!p),className:"w-full flex items-center justify-between text-sm text-gray-400 hover:text-gray-300 transition-colors",children:[r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Activity Log",t.statusHistory?.length>0&&r.jsx("span",{className:"text-xs bg-gray-700 px-1.5 py-0.5 rounded",children:t.statusHistory.length})]}),r.jsx("svg",{className:"w-4 h-4 transition-transform "+(p?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),p&&r.jsx("div",{className:"mt-3 space-y-2 max-h-64 overflow-y-auto",children:t.statusHistory&&0!==t.statusHistory.length?[...t.statusHistory].reverse().map((e,t)=>{const n=w.find(t=>t.id===e.userId),a=new Date(e.timestamp);return r.jsxs("div",{className:"flex items-start gap-3 text-sm p-2 rounded bg-dark-bg/50",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-600 mt-1.5 shrink-0"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[r.jsx("span",{className:"text-gray-300",children:"Status changed to"}),r.jsx("span",{className:`font-semibold uppercase text-xs ${{draft:"text-gray-400",sent:"text-blue-400",under_review:"text-amber-400",approved:"text-emerald-400",won:"text-green-400",rejected:"text-red-400",expired:"text-gray-500",dead:"text-red-500"}[e.status]||"text-gray-400"}`,children:e.status?.replace("_"," ")})]}),e.note&&r.jsxs("p",{className:"text-gray-500 text-xs mt-1",children:['"',e.note,'"']}),r.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[n?.name||"System","  ",a.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]},t)}):r.jsx("p",{className:"text-sm text-gray-500 italic",children:"No activity recorded yet"})})]}),!t.isLocked&&r.jsxs("div",{className:"border-t border-dark-border pt-4",children:[r.jsxs("button",{onClick:()=>g(!0),className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-dark-bg/50 hover:bg-dark-bg border border-dark-border rounded-lg text-sm text-gray-400 hover:text-gray-300 transition-colors",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Lock Quote"]}),r.jsx("p",{className:"form-helper text-center mt-2",children:"Locking prevents accidental edits to this quote"})]})]}),f&&r.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black/75 backdrop-blur-md modal-backdrop p-4",children:r.jsxs("div",{className:"bg-[#1a1f2e] border border-dark-border rounded-xl p-6 w-full max-w-sm shadow-2xl",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-amber-500/20 rounded-lg",children:r.jsx("svg",{className:"w-6 h-6 text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),r.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Lock Quote?"})]}),r.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Locking this quote will prevent any further edits. You can unlock it later if needed."}),r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>g(!1),className:"flex-1 px-4 py-2 bg-dark-bg hover:bg-dark-bg/80 border border-dark-border rounded-lg text-sm text-gray-300 transition-colors",children:"Cancel"}),r.jsx("button",{onClick:()=>{d(k?.id||"default"),g(!1)},className:"flex-1 px-4 py-2 bg-amber-500/20 hover:bg-amber-500/30 border border-amber-500/30 rounded-lg text-sm text-amber-400 font-medium transition-colors",children:"Lock Quote"})]})]})})]})}function Er(){const{quote:e,setFees:t}=pr(),n=e.fees||{managementFee:0,commissionFee:0,discount:0},a=(e,n)=>{if(""===n)return void t({[e]:""});const a=parseFloat(n);if(isNaN(a))return;const r=Math.min(100,Math.max(0,a));t({[e]:r})},o=(e,n)=>{(""===n||isNaN(parseFloat(n)))&&t({[e]:0})};return r.jsxs("div",{className:"card",children:[r.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4 text-accent-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Fees & Adjustments"]}),r.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Management %"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"number",value:n.managementFee,onChange:e=>a("managementFee",e.target.value),onBlur:e=>o("managementFee",e.target.value),min:"0",max:"100",step:"0.5",className:"input pr-8 text-center",disabled:e.isLocked}),r.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"})]}),r.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Added to charge"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Commission %"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"number",value:n.commissionFee,onChange:e=>a("commissionFee",e.target.value),onBlur:e=>o("commissionFee",e.target.value),min:"0",max:"100",step:"0.5",className:"input pr-8 text-center",disabled:e.isLocked}),r.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"})]}),r.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Added to charge"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"label",children:"Discount %"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"number",value:n.discount,onChange:e=>a("discount",e.target.value),onBlur:e=>o("discount",e.target.value),min:"0",max:"100",step:"0.5",className:"input pr-8 text-center",disabled:e.isLocked}),r.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"})]}),r.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Off final total"})]})]}),r.jsx("div",{className:"mt-4 pt-4 border-t border-gray-800",children:r.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[r.jsx("input",{type:"checkbox",checked:n.distributeFees||!1,onChange:e=>t({distributeFees:e.target.checked}),className:"checkbox border-gray-600 rounded bg-gray-900 group-hover:border-accent-primary transition-colors",disabled:e.isLocked}),r.jsxs("div",{children:[r.jsx("span",{className:"text-sm font-medium text-gray-300 group-hover:text-white transition-colors",children:"Distribute Fees into Unit Rates"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Hides separate fee line items on PDF by inflating unit prices"})]})]})})]})}function Lr(e){if(!e)return{totalCost:0,totalCharge:0};const t=Number(e.quantity)||1,n=Number(e.days)||1;return{totalCost:(Number(e.cost)||0)*t*n,totalCharge:(Number(e.charge)||0)*t*n}}function Ar(e){if(!e)return 0;const{totalCost:t,totalCharge:n}=Lr(e);return function(e,t){const n=Number(e)||0,a=Number(t)||0;return 0===a?0:(a-n)/a*100}(t,n)}function Pr(e){if(!e||"object"!=typeof e)return{totalCost:0,totalCharge:0};let t=0,n=0;return Object.values(e).forEach(e=>{const a=function(e){return e&&Array.isArray(e)?e.reduce((e,t)=>{if(!t)return e;const{totalCost:n,totalCharge:a}=Lr(t);return{totalCost:e.totalCost+n,totalCharge:e.totalCharge+a}},{totalCost:0,totalCharge:0}):{totalCost:0,totalCharge:0}}(e);t+=a.totalCost,n+=a.totalCharge}),{totalCost:t,totalCharge:n}}function Rr(e,t={}){const n=function(e){if(!e||"object"!=typeof e)return{totalCost:0,totalCharge:0};let t=0,n=0;return Object.values(e).forEach(e=>{if(e?.subsections){const a=Pr(e.subsections);t+=a.totalCost,n+=a.totalCharge}}),{totalCost:t,totalCharge:n}}(e),a=t.managementFee||0,r=t.commissionFee||0,o=t.discount||0,i=n.totalCharge*a/100,s=n.totalCharge*r/100,l=n.totalCharge+i+s,c=l*o/100,d=l-c,u=n.totalCost;return{baseCost:n.totalCost,baseCharge:n.totalCharge,managementAmount:i,commissionAmount:s,chargeWithFees:l,discountAmount:c,totalCost:u,totalCharge:d,profit:d-u,margin:d>0?(d-u)/d*100:0,getDistributedRate:e=>{if(!t.distributeFees)return e;return e*(1+(a+r)/100)}}}function Or({item:e,sectionId:t,subsectionName:n}){const{quote:a,updateLineItem:o,deleteLineItem:i,rates:s}=pr(),{items:l,sections:c}=qa(),[d,u]=m.useState(!1),[p,h]=m.useState([]),[f,g]=m.useState(-1),y=m.useRef(null),b=Lr(e),v=Ar(e),x=function(e){return e>=30?"text-green-400":e>=20?"text-amber-400":"text-red-400"}(v),w=e.rateCardItemId?l.find(t=>t.id===e.rateCardItemId):null,_=(()=>{if(!w)return null;const e=w?.pricing?.[a.region];return{cost:e?.cost?.amount??0,charge:e?.charge?.amount??0}})(),k=_&&(e.cost!==_.cost||e.charge!==_.charge),S=ya(a.region),C="MALAYSIA"===a.region?b.totalCharge:fa(b.totalCharge,S,a.currency,s),N=(a,r)=>{o(t,n,e.id,{[a]:r})},j=e=>{if(N("name",e),e.length>=2){const t=(e=>{const t=e.toLowerCase();return l.filter(e=>e.name.toLowerCase().includes(t)).slice(0,8)})(e);h(t),u(t.length>0),g(-1)}else u(!1)},T=e=>{const t=c.find(t=>t.id===e);return t?.name||e},I=r=>{const i=r?.pricing?.[a.region],s=i?.cost?.amount??0,l=i?.charge?.amount??0;o(t,n,e.id,{name:r.name,cost:s,charge:l,rateCardItemId:r.id}),u(!1),g(-1)};return m.useEffect(()=>{const e=e=>{y.current&&!y.current.contains(e.target)&&(u(!1),g(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),r.jsxs("div",{draggable:!a.isLocked,onDragStart:r=>{a.isLocked||(r.dataTransfer.setData("application/json",JSON.stringify({sectionId:t,subsectionName:n,itemId:e.id})),r.dataTransfer.effectAllowed="move")},className:"group bg-dark-card border border-dark-border rounded-lg p-2 hover:border-gray-700 transition-colors "+(a.isLocked?"cursor-default opacity-75":"cursor-move"),role:"article","aria-label":`Line item: ${e.name||"Unnamed item"}`,children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsxs("div",{className:"relative flex-1 min-w-[140px] sm:min-w-[180px]",ref:y,children:[r.jsx("label",{htmlFor:`item-name-${e.id}`,className:"sr-only",children:"Item name"}),r.jsx("input",{id:`item-name-${e.id}`,type:"text",value:e.name,onChange:e=>j(e.target.value),onKeyDown:e=>{if(d)switch(e.key){case"ArrowDown":e.preventDefault(),g(e=>e<p.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),g(e=>e>0?e-1:p.length-1);break;case"Enter":e.preventDefault(),f>=0&&p[f]&&I(p[f]);break;case"Escape":u(!1),g(-1)}},placeholder:"Item name...",className:"input-sm w-full text-sm","aria-autocomplete":"list","aria-controls":d?`autocomplete-${e.id}`:void 0,"aria-expanded":d,disabled:a.isLocked}),d&&r.jsx("div",{id:`autocomplete-${e.id}`,className:"absolute z-20 top-full left-0 right-0 mt-1 bg-dark-card border border-dark-border rounded-lg shadow-xl overflow-hidden",role:"listbox","aria-label":"Item suggestions",children:p.map((e,t)=>r.jsxs("button",{onClick:()=>I(e),className:"w-full px-3 py-2 text-left text-sm hover:bg-white/10 transition-colors flex justify-between items-center "+(t===f?"bg-white/10":""),role:"option","aria-selected":t===f,children:[r.jsx("span",{className:"text-gray-200",children:e.name}),r.jsx("span",{className:"text-xs text-gray-500",children:T(e.section)})]},e.id||t))}),k&&!a.isLocked&&r.jsx("button",{onClick:()=>{_&&o(t,n,e.id,{cost:_.cost,charge:_.charge})},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-amber-400 hover:text-amber-300 hover:bg-amber-500/10 rounded transition-colors",title:`Price differs from rate card (Cost: ${ba(a.currency)}${_.cost}, Charge: ${ba(a.currency)}${_.charge}). Click to refresh.`,"aria-label":"Refresh price from rate card",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),r.jsxs("div",{className:"w-14 sm:w-16",children:[r.jsx("label",{htmlFor:`quantity-${e.id}`,className:"sr-only",children:"Quantity"}),r.jsx("input",{id:`quantity-${e.id}`,type:"number",value:e.quantity,onChange:e=>N("quantity",""===e.target.value?"":parseFloat(e.target.value)),onBlur:t=>{(""===t.target.value||isNaN(e.quantity))&&N("quantity",1)},onFocus:e=>e.target.select(),min:"1",className:"input-sm w-full text-left text-sm",title:"Qty","aria-label":"Quantity",placeholder:"Qty",disabled:a.isLocked})]}),r.jsxs("div",{className:"w-14 sm:w-16",children:[r.jsx("label",{htmlFor:`days-${e.id}`,className:"sr-only",children:"Days"}),r.jsx("input",{id:`days-${e.id}`,type:"number",value:e.days,onChange:e=>N("days",""===e.target.value?"":parseFloat(e.target.value)),onBlur:t=>{(""===t.target.value||isNaN(e.days))&&N("days",1)},onFocus:e=>e.target.select(),min:"0.5",step:"0.5",className:"input-sm w-full text-left text-sm",title:"Days","aria-label":"Number of days",placeholder:"Days",disabled:a.isLocked})]}),r.jsxs("div",{className:"w-24 hidden lg:block relative",children:[r.jsx("label",{htmlFor:`cost-${e.id}`,className:"sr-only",children:"Cost per unit"}),r.jsxs("div",{className:"relative",children:[r.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-gray-500",children:ba(a.currency)}),r.jsx("input",{id:`cost-${e.id}`,type:"number",value:e.cost,onChange:e=>N("cost",""===e.target.value?"":parseFloat(e.target.value)),onBlur:t=>{(""===t.target.value||isNaN(e.cost))&&N("cost",0)},onFocus:e=>e.target.select(),min:"0",className:"input-sm w-full pl-6 text-left text-sm text-gray-500",title:"Cost","aria-label":`Cost per unit in ${a.currency}`,disabled:a.isLocked})]})]}),r.jsxs("div",{className:"w-20 sm:w-24 relative",children:[r.jsx("label",{htmlFor:`charge-${e.id}`,className:"sr-only",children:"Charge per unit"}),r.jsxs("div",{className:"relative",children:[r.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-gray-400",children:ba(a.currency)}),r.jsx("input",{id:`charge-${e.id}`,type:"number",value:e.charge,onChange:e=>N("charge",""===e.target.value?"":parseFloat(e.target.value)),onBlur:t=>{(""===t.target.value||isNaN(e.charge))&&N("charge",0)},onFocus:e=>e.target.select(),min:"0",className:"input-sm w-full pl-5 sm:pl-6 text-left text-sm",title:"Charge","aria-label":`Charge per unit in ${a.currency}`,disabled:a.isLocked})]})]}),r.jsx("div",{className:"w-20 sm:w-24 text-right flex items-center justify-end",role:"status","aria-live":"polite","aria-label":`Total: ${ga(C,a.currency)}`,children:r.jsx("span",{className:"text-xs sm:text-sm font-semibold text-gray-100",children:ga(C,a.currency)})}),r.jsx("div",{className:"w-14 text-right hidden lg:flex items-center justify-end",role:"status","aria-live":"polite","aria-label":`Margin: ${v.toFixed(0)}%`,children:r.jsxs("span",{className:"text-xs font-bold px-1.5 py-0.5 rounded "+(v>=30?"bg-green-500/10 text-green-400":v>=15?"bg-amber-500/10 text-amber-400":"bg-red-500/10 text-red-400"),children:[v.toFixed(0),"%"]})}),!a.isLocked&&r.jsx("button",{onClick:()=>{i(t,n,e.id)},className:"p-2 min-w-[36px] min-h-[36px] text-gray-600 hover:text-red-400 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity flex items-center justify-center",title:"Delete item","aria-label":`Delete ${e.name||"item"}`,children:r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),r.jsxs("div",{className:"flex lg:hidden items-center justify-between mt-2 pt-2 border-t border-dark-border text-xs text-gray-500",children:[r.jsxs("span",{"aria-label":`Cost: ${ba(a.currency)}${e.cost}`,children:["Cost: ",ba(a.currency),e.cost]}),r.jsxs("span",{className:x,"aria-label":`Margin: ${v.toFixed(0)}%`,children:["Margin: ",v.toFixed(0),"%"]})]})]})}function Mr({sectionId:e,subsectionName:t,color:n,isDragging:a}){const{quote:o,addLineItem:i,updateSubsectionName:s}=pr(),{items:l}=qa(),c=o.sections[e],d=c?.subsections?.[t]||[],[u,p]=m.useState(!1),[h,f]=m.useState(!1),[g,y]=m.useState(""),[b,v]=m.useState(""),x=m.useRef(null),w=c?.subsectionNames?.[t]||t;m.useEffect(()=>{h&&x.current&&(x.current.focus(),x.current.select())},[h]);const _=()=>{s(e,t,g),f(!1)},k=()=>{f(!1),y("")},S=((e,t)=>{if("creative"===e)return"creative";if("logistics"===e)return"logistics";if("expenses"===e)return"expenses";if("productionTeam"===e)return{Production:"prod_production","Technical Crew":"prod_technical","Production Management":"prod_management"}[t]||"prod_production";if("productionEquipment"===e)return{Video:"equip_video",Audio:"equip_audio",Cameras:"equip_cameras",Graphics:"equip_graphics",VT:"equip_vt",Cabling:"equip_cabling",Other:"equip_other"}[t]||"equip_other";return"other"})(e,t),C=l.filter(e=>e.section===S),N=b.trim()?C.filter(e=>e.name.toLowerCase().includes(b.toLowerCase())):C.slice(0,8),j=(e,t)=>{if(!t.trim())return e;const n=new RegExp(`(${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return e.split(n).map((e,t)=>n.test(e)?r.jsx("mark",{className:"bg-accent-primary/30 text-accent-primary px-0.5 rounded",children:e},t):e)},T=(n=null)=>{const a=o.region,r=n?.pricing?.[a],s=r?.cost?.amount??0,l=r?.charge?.amount??0;i(e,t,{name:n?.name||"",cost:s,charge:l,quantity:1,days:1,isPercentage:n?.isPercentage||!1,percentValue:n?.percentValue||0,rateCardItemId:n?.id||null}),p(!1)},I=["creative","logistics","expenses"].includes(e)&&"Services"===t;return r.jsxs("div",{className:"bg-dark-bg/50 rounded-md p-2 transition-colors hover:bg-dark-bg/70",onDragOver:e=>{o.isLocked||(e.preventDefault(),e.currentTarget.classList.add("bg-accent-primary/10"))},onDragLeave:e=>{o.isLocked||(e.preventDefault(),e.currentTarget.classList.remove("bg-accent-primary/10"))},onDrop:n=>{if(o.isLocked)return;n.preventDefault(),n.currentTarget.classList.remove("bg-accent-primary/10");const a=JSON.parse(n.dataTransfer.getData("application/json"));!a||a.sectionId===e&&a.subsectionName===t||pr.getState().moveLineItem(a.sectionId,a.subsectionName,a.itemId,e,t)},children:[!I&&r.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[r.jsx("svg",{className:"w-3 h-3 text-gray-600 flex-shrink-0 cursor-grab",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8h16M4 16h16"})}),h?r.jsxs("div",{className:"flex items-center gap-1",onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),draggable:!1,children:[r.jsx("input",{ref:x,type:"text",value:g,onChange:e=>y(e.target.value),onKeyDown:e=>{"Enter"===e.key&&_(),"Escape"===e.key&&k()},className:"input-sm text-xs py-0.5 w-32","aria-label":"Subsection name",draggable:!1}),r.jsx("button",{onClick:_,className:"p-0.5 text-green-400 hover:text-green-300","aria-label":"Save",children:r.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("button",{onClick:k,className:"p-0.5 text-gray-400 hover:text-gray-300","aria-label":"Cancel",children:r.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):r.jsx("h4",{className:"text-xs font-medium text-gray-400 cursor-text hover:text-gray-300",onClick:e=>{e.stopPropagation(),y(w),f(!0)},onMouseDown:e=>e.stopPropagation(),draggable:!1,title:"Click to rename",children:w}),r.jsxs("span",{className:"text-[10px] text-gray-600",children:[d.length," items"]})]}),d.length>0&&r.jsxs("div",{className:"space-y-1 mb-1",children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2 px-2 py-0.5 text-[10px] text-gray-500 border-b border-dark-border",children:[r.jsx("div",{className:"flex-1 min-w-[180px]",children:"Item"}),r.jsx("div",{className:"w-16 text-left",children:"Qty"}),r.jsx("div",{className:"w-16 text-left",children:"Days"}),r.jsx("div",{className:"w-24 text-left hidden lg:block",children:"Cost"}),r.jsx("div",{className:"w-24 text-left",children:"Charge"}),r.jsx("div",{className:"w-24 text-right",children:"Total"}),r.jsx("div",{className:"w-14 text-right hidden lg:block",children:"Margin"}),r.jsx("div",{className:"w-6"})]}),d.map(n=>r.jsx(Or,{item:n,sectionId:e,subsectionName:t},n.id))]}),!o.isLocked&&(u?r.jsxs("div",{className:"bg-dark-card rounded-lg p-2 space-y-2",children:[C.length>0&&r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Quick Add"}),C.length>8&&r.jsx("input",{type:"text",value:b,onChange:e=>v(e.target.value),placeholder:"Search items...",className:"input-sm text-xs py-0.5 px-2 w-32"})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 max-h-32 overflow-y-auto",children:[N.map(e=>r.jsxs("button",{onClick:()=>T(e),className:"text-xs px-2.5 py-1.5 bg-dark-bg hover:bg-white/10 rounded-md transition-colors text-gray-400 hover:text-gray-200 border border-dark-border hover:border-gray-600",children:["+ ",j(e.name,b)]},e.name)),b&&0===N.length&&r.jsx("span",{className:"text-xs text-gray-500 italic",children:"No matching items"})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>T(),className:"text-xs px-3 py-1.5 bg-accent-primary/20 hover:bg-accent-primary/30 text-accent-primary rounded transition-colors",children:"+ Custom Item"}),r.jsx("button",{onClick:()=>{p(!1),v("")},className:"text-xs px-3 py-1.5 text-gray-500 hover:text-gray-300",children:"Cancel"})]})]}):r.jsxs("button",{onClick:()=>p(!0),className:"w-full py-1.5 text-xs text-gray-500 hover:text-gray-300 hover:bg-white/5 rounded transition-colors flex items-center justify-center gap-1",style:{borderColor:n},children:[r.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Item"]}))]})}const qr=m.memo(function({sectionId:e,index:t,totalSections:n}){const{quote:a,toggleSection:o,moveSection:i,updateSectionName:s,moveSubsection:l,rates:c}=pr(),d=a.sections[e],u=oa[e],[p,h]=m.useState(!1),[f,g]=m.useState(""),[y,b]=m.useState(!1),[v,x]=m.useState(""),[w,_]=m.useState(null),[k,S]=m.useState(null),C=m.useRef(null),N=a.sectionNames?.[e]||u?.name||"";if(m.useEffect(()=>{y&&C.current&&(C.current.focus(),C.current.select())},[y]),!d||!u)return null;const j=Pr(d.subsections),T=ya(a.region),I=ga("MALAYSIA"===a.region?j.totalCharge:fa(j.totalCharge,T,a.currency,c),a.currency),D=[...u.subsections,...d.customSubsections||[]],E=d.subsectionOrder||D,L=Object.values(d.subsections).reduce((e,t)=>e+t.length,0),A=()=>{_(null),S(null)},P=()=>{if(f.trim()){const{addCustomSubsection:t}=pr.getState();t(e,f.trim()),g(""),h(!1)}},R=()=>{s(e,v),b(!1)},O=()=>{b(!1),x("")};return r.jsxs("div",{className:"card overflow-hidden",style:{borderLeftColor:u.color,borderLeftWidth:"3px"},role:"region","aria-labelledby":`section-${e}-title`,children:[r.jsxs("div",{role:"button",tabIndex:0,className:"section-header -m-4 mb-0 w-full cursor-pointer",onClick:()=>o(e),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),o(e))},"aria-expanded":d.isExpanded,"aria-controls":`section-${e}-content`,children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:u.color},"aria-hidden":"true"}),y?r.jsxs("div",{className:"flex items-center gap-2",onClick:e=>e.stopPropagation(),children:[r.jsx("input",{ref:C,type:"text",value:v,onChange:e=>x(e.target.value),onKeyDown:e=>{"Enter"===e.key&&R(),"Escape"===e.key&&O()},className:"input-sm text-sm font-semibold py-0.5","aria-label":"Section name"}),r.jsx("button",{onClick:R,className:"p-1 text-green-400 hover:text-green-300","aria-label":"Save name",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("button",{onClick:O,className:"p-1 text-gray-400 hover:text-gray-300","aria-label":"Cancel",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):r.jsx("h3",{id:`section-${e}-title`,className:"font-semibold text-gray-200 cursor-pointer hover:text-white",onClick:e=>{e.stopPropagation(),x(N),b(!0)},title:"Click to rename",children:N}),r.jsxs("span",{className:"text-xs text-gray-500 bg-dark-card px-2 py-0.5 rounded flex-shrink-0",children:[L," items"]})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"flex items-center gap-1",onClick:e=>e.stopPropagation(),children:[r.jsx("button",{onClick:t=>{t.stopPropagation(),i(e,"up")},disabled:0===t,className:"p-1 rounded transition-colors "+(0===t?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-white hover:bg-white/10"),"aria-label":"Move section up",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),r.jsx("button",{onClick:t=>{t.stopPropagation(),i(e,"down")},disabled:t===n-1,className:"p-1 rounded transition-colors "+(t===n-1?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-white hover:bg-white/10"),"aria-label":"Move section down",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),r.jsx("span",{className:"text-sm font-medium text-gray-300",children:I}),r.jsx("svg",{className:"w-5 h-5 text-gray-400 transition-transform duration-200 "+(d.isExpanded?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),d.isExpanded&&r.jsxs("div",{id:`section-${e}-content`,className:"mt-3 space-y-2",children:[E.map((t,n)=>r.jsx("div",{draggable:!a.isLocked,onDragStart:e=>!a.isLocked&&((e,t)=>{_(t),e.dataTransfer.setData("subsection",t),e.dataTransfer.effectAllowed="move"})(e,t),onDragOver:e=>!a.isLocked&&((e,t)=>{e.preventDefault(),w&&w!==t&&S(t)})(e,t),onDrop:n=>!a.isLocked&&((t,n)=>{if(t.preventDefault(),w&&w!==n){const t=[...E],a=t.indexOf(w),r=t.indexOf(n);if(-1!==a&&-1!==r){t.splice(a,1),t.splice(r,0,w);const{reorderSubsections:n}=pr.getState();n(e,t)}}_(null),S(null)})(n,t),onDragEnd:A,className:`transition-all duration-150 ${w===t?"opacity-50 scale-[0.98]":""} ${k===t?"ring-2 ring-accent-primary/50 rounded-lg":""}`,children:r.jsx(Mr,{sectionId:e,subsectionName:t,color:u.color,isDragging:w===t})},t)),!a.isLocked&&(p?r.jsxs("div",{className:"flex items-center gap-2 p-2 bg-dark-bg rounded-lg",children:[r.jsx("label",{htmlFor:`new-subsection-${e}`,className:"sr-only",children:"New subsection name"}),r.jsx("input",{id:`new-subsection-${e}`,type:"text",value:f,onChange:e=>g(e.target.value),placeholder:"Subsection name...",className:"input-sm flex-1",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&P(),"Escape"===e.key&&(h(!1),g(""))},"aria-label":"New subsection name"}),r.jsx("button",{onClick:P,className:"btn-primary text-xs py-1 px-2","aria-label":"Add subsection",children:"Add"}),r.jsx("button",{onClick:()=>{h(!1),g("")},className:"btn-ghost text-xs py-1 px-2","aria-label":"Cancel adding subsection",children:"Cancel"})]}):r.jsxs("button",{onClick:()=>h(!0),className:"w-full py-2 text-sm text-gray-500 hover:text-gray-300 hover:bg-white/5 rounded-lg transition-colors flex items-center justify-center gap-1","aria-label":"Add new subsection",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Subsection"]}))]})]})});function zr({onGoToSettings:e}){const t=pr(e=>e.quote),n=t.sectionOrder||ia,a=t.status,o="sent"===a||"won"===a;return r.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 h-[calc(100vh-60px)]",children:[o&&r.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-lg p-4 flex items-center gap-3",children:[r.jsx("svg",{className:"w-5 h-5 text-amber-400 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-amber-400",children:"Quote Locked"}),r.jsxs("p",{className:"text-xs text-gray-400",children:["This quote is ","sent"===a?"sent to the client":"marked as won"," and cannot be edited. To make changes, change the status to Draft first."]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 "+(o?"pointer-events-none opacity-70":""),children:[r.jsx(Ir,{}),r.jsx(Dr,{onGoToSettings:e})]}),r.jsx("div",{className:o?"pointer-events-none opacity-70":"",children:r.jsx(Er,{})}),r.jsx("div",{className:"space-y-2 "+(o?"pointer-events-none opacity-70":""),children:n.map((e,t)=>r.jsx(qr,{sectionId:e,index:t,totalSections:n.length},e))})]})}const Fr="#FFFFFF",Br="#1E293B",Ur="#334155",$r="#64748B",Vr="#0F8B8D",Hr="#E2E8F0",Wr=i.create({page:{backgroundColor:Fr,paddingTop:30,paddingBottom:40,paddingHorizontal:30,fontFamily:"Helvetica",color:Br,fontSize:6},header:{marginBottom:12,paddingBottom:8,borderBottomWidth:1,borderBottomColor:Hr},title:{fontSize:10,color:Br,letterSpacing:1,textTransform:"uppercase",marginBottom:2},company:{fontSize:7,color:Vr,marginBottom:1},address:{fontSize:6,color:$r},intro:{fontSize:5.5,color:Ur,marginBottom:10,lineHeight:1.4},columnsContainer:{flexDirection:"row",gap:16},column:{flex:1},section:{marginBottom:6},sectionTitle:{fontSize:6.5,color:Br,fontFamily:"Helvetica-Bold",marginBottom:2},subsectionTitle:{fontSize:6,color:Ur,fontFamily:"Helvetica-Bold",marginTop:2,marginBottom:1},text:{fontSize:5.5,color:Ur,lineHeight:1.35,textAlign:"justify"},listItem:{fontSize:5.5,color:Ur,lineHeight:1.35,marginLeft:6},footer:{position:"absolute",bottom:0,left:0,right:0,paddingVertical:10,paddingHorizontal:30,borderTopWidth:1,borderTopColor:Hr,backgroundColor:Fr},footerContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},footerLeft:{flexDirection:"row",alignItems:"center"},footerLogo:{fontSize:8,color:Br,letterSpacing:2,marginRight:6},footerDivider:{width:1,height:8,backgroundColor:Hr,marginRight:6},footerText:{fontSize:6,color:$r},footerRight:{flexDirection:"row",alignItems:"center"},footerQuote:{fontSize:6,color:Vr},footerPageNum:{fontSize:6,color:$r,marginLeft:10}});function Gr({quoteNumber:e,companyWebsite:t,companyName:n,companyAddress:a}){const i=n||"Your Company",c=a||"";return r.jsxs(o,{size:"A4",style:Wr.page,children:[r.jsxs(s,{style:Wr.header,children:[r.jsx(l,{style:Wr.title,children:"General Terms and Conditions"}),r.jsx(l,{style:Wr.company,children:i.toUpperCase()}),c&&r.jsx(l,{style:Wr.address,children:c})]}),r.jsxs(l,{style:Wr.intro,children:['These General Terms and Conditions ("Terms") apply to all services provided by ',i,' ("the Company", "we", "us", "our") to any client ("the Client", "you", "your"). By engaging our services, you agree to be bound by these Terms.']}),r.jsxs(s,{style:Wr.columnsContainer,children:[r.jsxs(s,{style:Wr.column,children:[r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"1. DEFINITIONS"}),r.jsx(l,{style:Wr.text,children:'"Agreement" means the contract formed between the Company and the Client comprising any quotation, proposal, statement of work, and these Terms; "Deliverables" means any tangible outputs provided to the Client including but not limited to broadcast feeds, recordings, graphics, and technical documentation; "Equipment" means all technical equipment, hardware, software, and infrastructure provided or operated by the Company; "Event" means the sporting event, broadcast, live production, or other activity for which Services are provided; "Fees" means all charges payable by the Client for the Services as set out in any quotation or statement of work; "Footage" means all video, audio, graphics, and visual content captured, created, or produced by the Company; "Services" means the event delivery, technical services, broadcast services, streaming, graphics, presentation, and related services provided by the Company.'})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"2. SERVICES"}),r.jsx(l,{style:Wr.subsectionTitle,children:"2.1 Scope"}),r.jsx(l,{style:Wr.text,children:"The Company shall provide the Services as described in the relevant quotation or statement of work. Services may include event delivery, outside broadcast, live streaming, graphics operation, vision mixing, audio, presentation services, and technical crew provision. Any services not expressly included are excluded and require separate agreement."}),r.jsx(l,{style:Wr.subsectionTitle,children:"2.2 Professional Standards"}),r.jsx(l,{style:Wr.text,children:"The Company shall perform the Services with reasonable skill and care in accordance with generally accepted industry standards for professional broadcast and event technical services."}),r.jsx(l,{style:Wr.subsectionTitle,children:"2.3 Technical Standards"}),r.jsx(l,{style:Wr.text,children:"Unless otherwise specified, technical deliverables shall comply with: (a) EBU R128 loudness standards where applicable; (b) minimum HD resolution (19201080); and (c) industry-standard formats appropriate for the delivery method."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"3. CLIENT OBLIGATIONS"}),r.jsx(l,{style:Wr.text,children:"The Client shall: provide accurate and complete information regarding the Event and requirements; ensure appropriate venue access, power supply, internet connectivity, and working conditions for the Company's personnel and Equipment; obtain all necessary rights, licences, permits, and permissions for the Event; provide timely approvals and decisions as reasonably required; ensure safe working conditions and compliance with health and safety requirements; not interfere with or direct the Company's personnel or Equipment without prior agreement. If the Company's performance is delayed or prevented by any act or omission of the Client, the Company shall not be liable for any resulting delay, and the Client shall remain liable for all Fees."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"4. PAYMENT"}),r.jsx(l,{style:Wr.subsectionTitle,children:"4.1 Payment Schedule"}),r.jsx(l,{style:Wr.text,children:"Unless otherwise agreed in writing, Fees shall be payable as follows: 50% upon confirmation of booking (non-refundable deposit); 50% prior to the Event date or within fourteen (14) days of invoice, whichever is earlier."}),r.jsx(l,{style:Wr.subsectionTitle,children:"4.2 Payment Terms"}),r.jsx(l,{style:Wr.text,children:"All invoices are payable within thirty (30) days of the invoice date unless otherwise specified. All amounts are exclusive of applicable taxes, which shall be charged in addition where required by law."}),r.jsx(l,{style:Wr.subsectionTitle,children:"4.3 Late Payment"}),r.jsx(l,{style:Wr.text,children:"If any invoice is not paid when due, the Client shall pay interest on the overdue amount at the rate of 1.5% per month (18% per annum) from the due date until payment in full. The Company may suspend Services and withhold Deliverables until all overdue amounts have been paid."}),r.jsx(l,{style:Wr.subsectionTitle,children:"4.4 Additional Costs"}),r.jsx(l,{style:Wr.text,children:"Travel, accommodation, transport, equipment hire, and other expenses shall be charged in addition to the Fees unless expressly included in the quotation. Any additional services requested during the Event shall be charged at the Company's prevailing rates."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"5. INTELLECTUAL PROPERTY AND FOOTAGE"}),r.jsx(l,{style:Wr.subsectionTitle,children:"5.1 Ownership of Footage"}),r.jsx(l,{style:Wr.text,children:"All Footage created by the Company remains the exclusive property of the Company. The Company retains all copyright and intellectual property rights in all Footage unless expressly agreed otherwise in writing."}),r.jsx(l,{style:Wr.subsectionTitle,children:"5.2 Conditional Licence"}),r.jsx(l,{style:Wr.text,children:"Subject to full payment of all Fees, the Company grants the Client a non-exclusive licence to use the Deliverables for the purposes specified in the Agreement. This licence is conditional upon payment and shall be automatically revoked if payment is not received in full."}),r.jsx(l,{style:Wr.subsectionTitle,children:"5.3 Retention Until Payment"}),r.jsx(l,{style:Wr.text,children:"Until all Fees have been paid in full: the Company retains full ownership and copyright of all Footage and Deliverables; the Client has no right to use, distribute, broadcast, or exploit any Footage or Deliverables; the Company may withhold delivery of any Footage or Deliverables; and any unauthorised use shall constitute copyright infringement."}),r.jsx(l,{style:Wr.subsectionTitle,children:"5.4 Assignment of Rights"}),r.jsx(l,{style:Wr.text,children:"Transfer or assignment of copyright in Footage to the Client shall only occur if: (a) expressly agreed in writing; (b) specified in the statement of work or quotation; and (c) all Fees have been paid in full. Any such assignment shall be made pursuant to Section 27 of the Copyright Act 1987 (Malaysia)."}),r.jsx(l,{style:Wr.subsectionTitle,children:"5.5 Company's Rights"}),r.jsx(l,{style:Wr.text,children:"The Company reserves the right to use Footage for promotional purposes, portfolio display, award submissions, showreels, and case studies, provided such use does not disclose the Client's confidential information."}),r.jsx(l,{style:Wr.subsectionTitle,children:"5.6 Company Background IP"}),r.jsx(l,{style:Wr.text,children:"All pre-existing materials, templates, graphics libraries, software tools, and methodologies owned by the Company remain the Company's exclusive property and are licensed, not assigned, to the Client solely for use within the Deliverables."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"6. EQUIPMENT"}),r.jsx(l,{style:Wr.subsectionTitle,children:"6.1 Company Equipment"}),r.jsx(l,{style:Wr.text,children:"Equipment provided by the Company remains the Company's property at all times. The Client shall not move, adjust, or interfere with Equipment without the Company's consent. The Client shall be liable for any damage to or loss of Equipment caused by the Client, its employees, agents, or invitees, excluding fair wear and tear."}),r.jsx(l,{style:Wr.subsectionTitle,children:"6.2 Client Equipment"}),r.jsx(l,{style:Wr.text,children:"Any equipment supplied by the Client shall be at the Client's sole risk. The Company accepts no liability for damage to or loss of Client-supplied equipment except where caused by the Company's gross negligence or wilful misconduct."})]})]}),r.jsxs(s,{style:Wr.column,children:[r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"7. CANCELLATION AND POSTPONEMENT"}),r.jsx(l,{style:Wr.subsectionTitle,children:"7.1 Cancellation by Client"}),r.jsx(l,{style:Wr.text,children:"If the Client cancels the Agreement, the following cancellation fees apply based on notice prior to the Event date: More than 30 days' notice: 25% of total Fees plus costs incurred; 15 to 30 days' notice: 50% of total Fees plus costs incurred; 5 to 14 days' notice: 75% of total Fees plus costs incurred; Less than 5 days' notice: 100% of total Fees plus costs incurred."}),r.jsx(l,{style:Wr.subsectionTitle,children:"7.2 Postponement"}),r.jsx(l,{style:Wr.text,children:"If the Event is postponed, the Company shall use reasonable endeavours to accommodate the new date, subject to availability. The Client shall pay any additional costs for rebooking crew and equipment. If the rescheduled date is more than 60 days from the original date, the cancellation fees in Clause 7.1 shall apply."}),r.jsx(l,{style:Wr.subsectionTitle,children:"7.3 Cancellation by Company"}),r.jsx(l,{style:Wr.text,children:"The Company may cancel the Agreement with immediate effect if the Client fails to pay any amount due or breaches any material term. The Company shall not be liable for any loss resulting from such cancellation."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"8. FORCE MAJEURE"}),r.jsx(l,{style:Wr.text,children:"Neither Party shall be liable for any failure or delay in performance resulting from circumstances beyond its reasonable control, including: acts of God, natural disasters, pandemic, epidemic, war, terrorism, civil unrest, government action, strikes, failure of utilities or telecommunications, cancellation or postponement of the Event by organisers or governing bodies, extreme weather preventing safe working, travel restrictions, or visa denials affecting key personnel. If a force majeure event continues for more than 60 days, either Party may terminate the Agreement. Upon such termination, the Client shall pay for all Services performed and costs incurred to the date of termination."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"9. LIMITATION OF LIABILITY"}),r.jsx(l,{style:Wr.subsectionTitle,children:"9.1 Liability Cap"}),r.jsx(l,{style:Wr.text,children:"The Company's total liability under or in connection with this Agreement shall not exceed the total Fees paid or payable by the Client in the 12 months preceding the claim, or RM 500,000, whichever is greater."}),r.jsx(l,{style:Wr.subsectionTitle,children:"9.2 Exclusion of Consequential Loss"}),r.jsx(l,{style:Wr.text,children:"Neither Party shall be liable for any indirect, special, incidental, or consequential damages, including loss of profits, revenue, business opportunity, or data, whether or not foreseeable."}),r.jsx(l,{style:Wr.subsectionTitle,children:"9.3 Exceptions"}),r.jsx(l,{style:Wr.text,children:"Nothing in these Terms excludes or limits liability for: (a) fraud or wilful misconduct; (b) death or personal injury caused by negligence; or (c) any liability that cannot be limited under applicable law."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"10. CONFIDENTIALITY"}),r.jsx(l,{style:Wr.text,children:"Each Party shall keep confidential all confidential information of the other Party and shall not disclose such information except as necessary for the performance of the Agreement or as required by law. This obligation shall survive termination of the Agreement for a period of five (5) years."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"11. DATA PROTECTION"}),r.jsx(l,{style:Wr.text,children:"Each Party shall comply with its obligations under the Personal Data Protection Act 2010 (Malaysia) in connection with any personal data processed under this Agreement. Where personal data is transferred outside Malaysia, the transferring Party shall ensure compliance with applicable data protection requirements."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"12. INSURANCE"}),r.jsx(l,{style:Wr.text,children:"The Company maintains public liability insurance and equipment insurance appropriate for its operations. Certificates of insurance shall be provided upon request. The Client is responsible for maintaining its own insurance coverage for the Event, including event cancellation insurance where appropriate."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"13. INDEMNITY"}),r.jsx(l,{style:Wr.text,children:"The Client shall indemnify the Company against all losses, damages, costs, and liabilities arising from: (a) any breach of the Agreement by the Client; (b) any claim that Client-supplied materials infringe third-party rights; (c) any third-party claims arising from the Event; and (d) the Client's unauthorised use of Footage or Deliverables."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"14. TERMINATION"}),r.jsx(l,{style:Wr.text,children:"Either Party may terminate the Agreement with immediate effect if the other Party: (a) commits a material breach and fails to remedy it within 14 days of written notice; (b) becomes insolvent or bankrupt; or (c) ceases to carry on business. Upon termination, the Client shall pay for all Services performed and costs incurred, and all provisions relating to intellectual property, liability, and confidentiality shall survive."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"15. DISPUTE RESOLUTION"}),r.jsx(l,{style:Wr.text,children:"Any dispute arising from this Agreement shall first be referred to good faith negotiation between the Parties. If not resolved within 30 days, the dispute shall be finally determined by arbitration administered by the Asian International Arbitration Centre (AIAC) in Kuala Lumpur, Malaysia, in accordance with the AIAC Arbitration Rules. The arbitration shall be conducted in English by a single arbitrator."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"16. GOVERNING LAW"}),r.jsx(l,{style:Wr.text,children:"This Agreement shall be governed by and construed in accordance with the laws of Malaysia."})]}),r.jsxs(s,{style:Wr.section,children:[r.jsx(l,{style:Wr.sectionTitle,children:"17. GENERAL PROVISIONS"}),r.jsxs(l,{style:Wr.text,children:["17.1 Entire Agreement: These Terms, together with any quotation or statement of work, constitute the entire agreement between the Parties and supersede all prior agreements and understandings.","\n","17.2 Amendment: No amendment to these Terms shall be effective unless agreed in writing by both Parties.","\n","17.3 Assignment: The Client shall not assign or transfer any rights under this Agreement without the Company's prior written consent. The Company may subcontract its obligations with notice to the Client.","\n","17.4 Severability: If any provision of these Terms is held invalid or unenforceable, it shall be modified to the minimum extent necessary or severed, and the remaining provisions shall continue in full force.","\n","17.5 Waiver: No failure or delay in exercising any right shall operate as a waiver. A waiver shall only be effective if in writing.","\n","17.6 Notices: Notices shall be in writing and delivered by hand, registered post, or email to the addresses specified in the quotation or statement of work."]})]})]})]}),r.jsx(s,{style:Wr.footer,fixed:!0,children:r.jsxs(s,{style:Wr.footerContent,children:[r.jsxs(s,{style:Wr.footerLeft,children:[n&&r.jsx(l,{style:Wr.footerLogo,children:n.split(" ")[0].toUpperCase()}),n&&r.jsx(s,{style:Wr.footerDivider}),r.jsx(l,{style:Wr.footerText,children:t||""})]}),r.jsxs(s,{style:Wr.footerRight,children:[r.jsx(l,{style:Wr.footerQuote,children:e}),r.jsx(l,{render:({pageNumber:e,totalPages:t})=>`Page ${e} of ${t}`,style:Wr.footerPageNum})]})]})})]})}function Kr(e,t=1){return`rgba(${parseInt(e.slice(1,3),16)}, ${parseInt(e.slice(3,5),16)}, ${parseInt(e.slice(5,7),16)}, ${t})`}function Qr({quote:e,currency:t,includeTerms:n=!1}){const a=na.getState().settings,{company:u,bankDetails:m,quoteDefaults:p,taxInfo:h,pdfOptions:f}=a,{client:g,project:y,sections:b,fees:v}=e,x=Rr(b,v||{}),w={primary:f?.primaryColor||"#143642",accent:f?.accentColor||"#0F8B8D",line:f?.lineColor||f?.primaryColor||"#143642",text:f?.textColor||"#374151",muted:f?.mutedColor||"#6B7280",background:f?.backgroundColor||"#FFFFFF"},_=Kr(w.line,.15),k=Kr(w.primary,.03),S=Kr(w.primary,.08),C=f?.baseFontSize||10,N=f?.fontFamily||"Helvetica",j=i.create({page:{backgroundColor:w.background,fontFamily:N,fontSize:C,color:w.text,paddingTop:30,paddingBottom:50,paddingHorizontal:35},headerBanner:{backgroundColor:w.primary,flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:14,paddingHorizontal:16,marginBottom:16,borderRadius:4},quotationTitle:{fontSize:14,fontFamily:`${N}-Bold`,color:"#FFFFFF",letterSpacing:2},headerDetails:{flexDirection:"row",alignItems:"center",gap:20},headerItem:{alignItems:"flex-end"},headerItemVenue:{alignItems:"flex-end",maxWidth:140},headerLabel:{fontSize:7,color:"#FFFFFF",opacity:.8,textTransform:"uppercase",marginBottom:2,textAlign:"right"},headerValue:{fontSize:9,fontFamily:`${N}-Bold`,color:"#FFFFFF",textAlign:"right"},twoColumn:{flexDirection:"row",marginBottom:16,gap:16},columnHalf:{flex:1,padding:12,backgroundColor:k,borderRadius:4},columnLabel:{fontSize:8,fontFamily:`${N}-Bold`,color:w.accent,textTransform:"uppercase",letterSpacing:.5,marginBottom:8},columnTitle:{fontSize:11,fontFamily:`${N}-Bold`,color:w.primary,marginBottom:4},columnText:{fontSize:9,color:w.text,lineHeight:1.5,marginBottom:1},descriptionRow:{flexDirection:"row",marginBottom:16,gap:16},descriptionBox:{flex:1,padding:12,borderWidth:1,borderTopColor:w.line,borderBottomColor:w.line,borderLeftColor:w.line,borderRightColor:w.line,borderRadius:4},descriptionLabel:{fontSize:8,fontFamily:`${N}-Bold`,color:w.primary,textTransform:"uppercase",marginBottom:6},descriptionText:{fontSize:9,color:w.text,lineHeight:1.5},sectionHeader:{backgroundColor:w.primary,paddingVertical:6,paddingHorizontal:10,marginTop:12,marginBottom:6,borderRadius:3},sectionHeaderText:{fontSize:9,fontFamily:`${N}-Bold`,color:"#FFFFFF",textTransform:"uppercase",letterSpacing:.5},tableHeader:{flexDirection:"row",backgroundColor:S,paddingVertical:5,paddingLeft:10,paddingRight:8,borderBottomWidth:1,borderBottomColor:w.line},tableHeaderCell:{fontSize:7,fontFamily:`${N}-Bold`,color:w.primary,textTransform:"uppercase"},tableRow:{flexDirection:"row",paddingVertical:4,paddingLeft:10,paddingRight:8,borderBottomWidth:.5,borderBottomColor:"#E5E7EB"},tableCell:{fontSize:8,color:w.text},tableCellRight:{fontSize:8,color:w.text,textAlign:"right"},colName:{width:"42%"},colQty:{width:"10%",textAlign:"center"},colDays:{width:"10%",textAlign:"center"},colRate:{width:"18%",textAlign:"right"},colTotal:{width:"20%",textAlign:"right"},subsectionHeader:{backgroundColor:_,paddingVertical:4,paddingHorizontal:8,marginTop:6,borderLeftWidth:2,borderLeftColor:w.line,borderTopWidth:0,borderBottomWidth:0,borderRightWidth:0},subsectionText:{fontSize:8,fontFamily:`${N}-Bold`,color:w.primary},bottomRow:{flexDirection:"row",marginTop:20,gap:12},termsColumn:{flex:1},termsBox:{padding:10,backgroundColor:k,borderRadius:4,marginBottom:8},termsLabel:{fontSize:8,fontFamily:`${N}-Bold`,color:w.primary,marginBottom:4},termsText:{fontSize:7,color:w.muted,lineHeight:1.5},totalsColumn:{width:180},totalsBox:{borderRadius:4,padding:12,borderWidth:1,borderTopColor:w.line,borderBottomColor:w.line,borderLeftColor:w.line,borderRightColor:w.line},totalsRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:3},totalsLabel:{fontSize:8,color:w.muted},totalsValue:{fontSize:8,color:w.text},totalsFinalRow:{flexDirection:"row",justifyContent:"space-between",borderTopWidth:1,borderTopColor:w.line,paddingTop:8,marginTop:8},totalsFinalLabel:{fontSize:11,fontFamily:`${N}-Bold`,color:w.primary},totalsFinalValue:{fontSize:12,fontFamily:`${N}-Bold`,color:w.primary},footer:{position:"absolute",bottom:18,left:35,right:35,borderTopWidth:.5,borderTopColor:"#E5E7EB",paddingTop:8,flexDirection:"row",justifyContent:"space-between"},footerText:{fontSize:7,color:w.muted},footerBold:{fontSize:7,fontFamily:`${N}-Bold`,color:w.primary},logo:{width:100,maxHeight:40,objectFit:"contain",marginBottom:6}}),T=e=>{if(!e)return"-";const t=new Date(e),n=t.getDate(),a=t.toLocaleDateString("en-GB",{month:"short"}),r=t.getFullYear();return`${n}${(e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(n)} ${a} ${r}`},I=new Date(e.createdAt||new Date),D=new Date(I);D.setDate(I.getDate()+(e.validityDays||p?.validityDays||30));const E=(e.sectionOrder||ia).filter(e=>{const t=b?.[e];return!!t?.subsections&&Object.values(t.subsections).some(e=>e?.length>0)});return r.jsxs(c,{children:[r.jsxs(o,{size:"A4",style:j.page,children:[r.jsxs(s,{style:j.headerBanner,children:[r.jsx(l,{style:j.quotationTitle,children:"QUOTATION"}),r.jsxs(s,{style:j.headerDetails,children:[r.jsxs(s,{style:j.headerItem,children:[r.jsx(l,{style:j.headerLabel,children:"Quote No."}),r.jsx(l,{style:j.headerValue,children:e.quoteNumber})]}),r.jsxs(s,{style:j.headerItem,children:[r.jsx(l,{style:j.headerLabel,children:"Date"}),r.jsx(l,{style:j.headerValue,children:T(I)})]}),r.jsxs(s,{style:j.headerItem,children:[r.jsx(l,{style:j.headerLabel,children:"Valid Until"}),r.jsx(l,{style:j.headerValue,children:T(D)})]}),y?.venue&&r.jsxs(s,{style:j.headerItemVenue,children:[r.jsx(l,{style:j.headerLabel,children:"Venue"}),r.jsx(l,{style:j.headerValue,children:y.venue})]})]})]}),r.jsxs(s,{style:j.twoColumn,children:[r.jsxs(s,{style:j.columnHalf,children:[r.jsx(l,{style:j.columnLabel,children:"From"}),f?.showLogo&&u.logo&&r.jsx(d,{src:u.logo,style:j.logo}),r.jsx(l,{style:j.columnTitle,children:u.name}),f?.showCompanyAddress&&u.address&&r.jsx(l,{style:j.columnText,children:u.address}),u.city&&r.jsxs(l,{style:j.columnText,children:[u.city,", ",u.country]}),f?.showCompanyPhone&&u.phone&&r.jsx(l,{style:j.columnText,children:u.phone}),f?.showCompanyEmail&&u.email&&r.jsx(l,{style:j.columnText,children:u.email})]}),r.jsxs(s,{style:j.columnHalf,children:[r.jsx(l,{style:j.columnLabel,children:"To"}),r.jsx(l,{style:j.columnTitle,children:g?.company||"-"}),g?.contact&&r.jsx(l,{style:j.columnText,children:g.contact}),g?.email&&r.jsx(l,{style:j.columnText,children:g.email}),g?.phone&&r.jsx(l,{style:j.columnText,children:g.phone})]})]}),r.jsxs(s,{style:j.descriptionRow,children:[r.jsxs(s,{style:j.descriptionBox,children:[r.jsx(l,{style:j.descriptionLabel,children:"Project"}),r.jsx(l,{style:j.columnTitle,children:y?.title||"-"}),y?.type&&r.jsxs(l,{style:j.descriptionText,children:["Type: ",(e=>{if(!e)return null;const t=(a.projectTypes||[]).find(t=>t.id===e);return t?.label||e.replace(/_/g," ")})(y.type)]}),r.jsxs(l,{style:j.descriptionText,children:["Dates: ",(()=>{if(!y?.startDate)return"-";const e=T(y.startDate);return y?.endDate&&y.endDate!==y.startDate?`${e} - ${T(y.endDate)}`:e})()]}),y?.description&&r.jsx(l,{style:[j.descriptionText,{marginTop:4}],children:y.description})]}),r.jsxs(s,{style:j.descriptionBox,children:[r.jsx(l,{style:j.descriptionLabel,children:"Services Included"}),r.jsx(l,{style:j.descriptionText,children:E.map(t=>{const n=b[t];return e.sectionNames?.[t]||n.name||oa[t]?.name}).join("  ")})]})]}),E.map(n=>{const a=b[n],o=e.sectionNames?.[n]||a.name||oa[n]?.name;return r.jsxs(s,{wrap:!1,children:[r.jsx(s,{style:j.sectionHeader,children:r.jsx(l,{style:j.sectionHeaderText,children:o})}),r.jsxs(s,{style:j.tableHeader,children:[r.jsx(l,{style:[j.tableHeaderCell,j.colName],children:"Description"}),r.jsx(l,{style:[j.tableHeaderCell,j.colQty,{textAlign:"center"}],children:"Qty"}),r.jsx(l,{style:[j.tableHeaderCell,j.colDays,{textAlign:"center"}],children:"Days"}),r.jsx(l,{style:[j.tableHeaderCell,j.colRate,{textAlign:"right"}],children:"Rate"}),r.jsx(l,{style:[j.tableHeaderCell,j.colTotal,{textAlign:"right"}],children:"Total"})]}),Object.entries(a.subsections||{}).map(([e,n])=>{if(!n?.length)return null;const o=a.subsectionNames?.[e]||e;return r.jsxs(s,{children:[r.jsx(s,{style:j.subsectionHeader,children:r.jsx(l,{style:j.subsectionText,children:o})}),n.map((e,n)=>{const a=(e.charge||0)*(e.quantity||1)*(e.days||1);return r.jsxs(s,{style:j.tableRow,children:[r.jsx(l,{style:[j.tableCell,j.colName],children:e.name}),r.jsx(l,{style:[j.tableCell,j.colQty],children:e.quantity||1}),r.jsx(l,{style:[j.tableCell,j.colDays],children:e.days||1}),r.jsx(l,{style:[j.tableCellRight,j.colRate],children:ga(e.charge||0,t)}),r.jsx(l,{style:[j.tableCellRight,j.colTotal],children:ga(a,t)})]},e.id||n)})]},e)})]},n)}),r.jsxs(s,{style:j.bottomRow,children:[r.jsxs(s,{style:j.termsColumn,children:[p?.paymentTerms&&r.jsxs(s,{style:j.termsBox,children:[r.jsx(l,{style:j.termsLabel,children:"Payment Terms"}),r.jsx(l,{style:j.termsText,children:p.paymentTerms})]}),p?.termsAndConditions&&r.jsxs(s,{style:j.termsBox,children:[r.jsx(l,{style:j.termsLabel,children:"Terms & Conditions"}),r.jsx(l,{style:j.termsText,children:p.termsAndConditions})]}),f?.showBankDetails&&m?.bankName&&r.jsxs(s,{style:j.termsBox,children:[r.jsx(l,{style:j.termsLabel,children:"Bank Details"}),r.jsxs(l,{style:j.termsText,children:[m.bankName," | ",m.accountName," | ",m.accountNumber,m.swiftCode&&` | SWIFT: ${m.swiftCode}`]})]})]}),r.jsx(s,{style:j.totalsColumn,children:r.jsxs(s,{style:j.totalsBox,children:[(v?.managementFee>0||v?.commissionFee>0||v?.discount>0)&&r.jsxs(r.Fragment,{children:[r.jsxs(s,{style:j.totalsRow,children:[r.jsx(l,{style:j.totalsLabel,children:"Subtotal"}),r.jsx(l,{style:j.totalsValue,children:ga(x.baseCharge,t)})]}),v?.managementFee>0&&r.jsxs(s,{style:j.totalsRow,children:[r.jsxs(l,{style:j.totalsLabel,children:["Management (",v.managementFee,"%)"]}),r.jsx(l,{style:j.totalsValue,children:ga(x.managementAmount,t)})]}),v?.commissionFee>0&&r.jsxs(s,{style:j.totalsRow,children:[r.jsxs(l,{style:j.totalsLabel,children:["Commission (",v.commissionFee,"%)"]}),r.jsx(l,{style:j.totalsValue,children:ga(x.commissionAmount,t)})]}),v?.discount>0&&r.jsxs(s,{style:j.totalsRow,children:[r.jsxs(l,{style:j.totalsLabel,children:["Discount (",v.discount,"%)"]}),r.jsxs(l,{style:j.totalsValue,children:["-",ga(x.discountAmount,t)]})]})]}),r.jsxs(s,{style:j.totalsFinalRow,children:[r.jsx(l,{style:j.totalsFinalLabel,children:"TOTAL"}),r.jsx(l,{style:j.totalsFinalValue,children:ga(x.totalCharge,t)})]})]})})]}),r.jsxs(s,{style:j.footer,fixed:!0,children:[r.jsxs(l,{style:j.footerText,children:[u.name," ",u.website&&`| ${u.website}`]}),r.jsx(l,{style:j.footerBold,children:e.quoteNumber})]})]}),n&&r.jsx(Gr,{quoteNumber:e.quoteNumber,companyWebsite:u?.website})]})}function Yr(){const{quote:e}=pr(),t=fr(),[n,a]=m.useState(!1),[o,i]=m.useState(!1),s=Rr(e.sections,e.fees),l=t=>ga(t||0,e.currency),c=(s.totalCharge||0)-(s.totalCost||0),d=s.totalCharge>0?c/s.totalCharge*100:0;return r.jsxs("div",{className:"space-y-6 text-gray-100 p-2",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:async()=>{i(!0);try{const t=await u(r.jsx(Qr,{quote:e,currency:e.currency})).toBlob(),n=URL.createObjectURL(t);window.open(n,"_blank"),setTimeout(()=>URL.revokeObjectURL(n),5e3)}catch(Pc){t.error("Failed to generate preview")}finally{i(!1)}},disabled:o,className:"flex-1 btn-secondary py-3",children:o?r.jsxs("span",{className:"flex items-center justify-center gap-2",children:[r.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):r.jsxs("span",{className:"flex items-center justify-center gap-2",children:[r.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Preview"]})}),r.jsx("button",{onClick:async()=>{a(!0);try{const n=await u(r.jsx(Qr,{quote:e,currency:e.currency})).toBlob(),a=e.client?.company||"Client",o=e.project?.title||"Project",i=`${a} - ${o} - ${e.quoteDate||(new Date).toISOString().split("T")[0]} - Quote.pdf`,s=URL.createObjectURL(n),l=document.createElement("a");l.href=s,l.download=i,l.click(),URL.revokeObjectURL(s),t.success("PDF downloaded successfully")}catch(Pc){t.error("Failed to generate PDF")}finally{a(!1)}},disabled:n,className:"flex-1 btn-primary py-3 shadow-lg shadow-accent-primary/20",children:n?r.jsxs("span",{className:"flex items-center justify-center gap-2",children:[r.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):r.jsxs("span",{className:"flex items-center justify-center gap-2",children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]})})]}),r.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Customize PDF colors in Settings  Quote Templates"}),r.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl p-5 shadow-lg",children:[r.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4 border-b border-gray-700 pb-2",children:"Financial Summary"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Total Cost"}),r.jsx("p",{className:"text-lg font-mono text-gray-300",children:l(s.totalCost)})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Total Charge"}),r.jsx("p",{className:"text-xl font-bold font-mono text-white",children:l(s.totalCharge)})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Est. Profit"}),r.jsx("p",{className:"text-lg font-mono font-bold "+(c>=0?"text-emerald-400":"text-red-400"),children:l(c)})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Gross Margin"}),r.jsxs("p",{className:"text-lg font-mono font-bold "+(d>=30?"text-emerald-400":"text-amber-400"),children:[d.toFixed(1),"%"]})]})]}),r.jsxs("div",{className:"space-y-2 text-sm border-t border-gray-700 pt-4",children:[e.fees.managementFee>0&&r.jsxs("div",{className:"flex justify-between text-gray-400",children:[r.jsxs("span",{children:["Management Fee (",e.fees.managementFee,"%)"]}),r.jsx("span",{children:l(s.managementAmount)})]}),e.fees.commissionFee>0&&r.jsxs("div",{className:"flex justify-between text-gray-400",children:[r.jsxs("span",{children:["Commission (",e.fees.commissionFee,"%)"]}),r.jsx("span",{children:l(s.commissionAmount)})]}),e.fees.discount>0&&r.jsxs("div",{className:"flex justify-between text-red-400",children:[r.jsxs("span",{children:["Discount (",e.fees.discount,"%)"]}),r.jsxs("span",{children:["-",l(s.discountAmount)]})]})]})]}),r.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl p-4 shadow-lg",children:[r.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 border-b border-gray-700 pb-2",children:"Section Breakdown"}),r.jsx("div",{className:"space-y-3",children:Object.values(e.sections).map(e=>{const t=Object.values(e.subsections).flat().reduce((e,t)=>e+t.cost*t.quantity*t.days,0),n=Object.values(e.subsections).flat().reduce((e,t)=>e+t.charge*t.quantity*t.days,0);return n>0||t>0?r.jsxs("div",{className:"flex items-center justify-between text-sm group",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),r.jsx("span",{className:"text-gray-300",children:e.name})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-gray-200",children:l(n)}),r.jsxs("p",{className:"text-[10px] text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity",children:["Margin: ",n>0?Math.round((n-t)/n*100):0,"%"]})]})]},e.id):null})})]})]})}function Jr(){const{quote:e}=pr(),{settings:t}=na(),[n,a]=m.useState(!1),[o,i]=m.useState(!0),[s,l]=m.useState(!1),[c,d]=m.useState(null),{client:u,project:p,sections:h,fees:f}=e,g=Rr(h,f||{}),y=!!t.aiSettings?.anthropicKey,b=t.users?.find(t=>t.id===e.preparedBy),v=b?.name?.split(" ")[0]||"Team",x=u.contact?.split(" ")[0]||"there",w=p.startDate?p.endDate&&p.endDate!==p.startDate?`${p.startDate} to ${p.endDate}`:p.startDate:"TBC",_=()=>{const e=[];return Object.values(h||{}).forEach(t=>{if(t?.subsections){Object.values(t.subsections).some(e=>Array.isArray(e)&&e.length>0)&&t.name&&e.push(t.name.toLowerCase())}}),0===e.length?"all the kit and crew":1===e.length?e[0]:2===e.length?`${e[0]} and ${e[1]}`:`${e.slice(0,-1).join(", ")}, and ${e[e.length-1]}`},k=c||(()=>{const t=ga(g.totalCharge,e.currency);return{subject:`Quote for ${p.title||"Project"}${"TBC"!==w?` | ${w}`:""}`,body:`Hi ${x},\n\nI've put together the quote for ${p.title||"the project"}${p.venue?` at ${p.venue}`:""}.\n\nAttached is our proposal covering ${_()}. Total comes to ${t}. Quote's valid for ${e.validityDays||30} days.\n\nHappy to jump on a call if you'd like to talk through any of it. Let me know if you have any questions.\n\nBest,\n${v}`}})(),{subject:S,body:C}=k;return r.jsxs("div",{className:"card mt-4",children:[r.jsxs("button",{onClick:()=>i(!o),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-300 hover:text-white transition-colors",children:[r.jsxs("span",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"w-4 h-4 text-accent-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Quote Email"]}),r.jsx("svg",{className:"w-4 h-4 transition-transform "+(o?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),o&&r.jsxs("div",{className:"mt-3 space-y-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-1",children:[r.jsx("label",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Subject"}),r.jsx("button",{onClick:()=>(async e=>{await navigator.clipboard.writeText(e),a(!0),setTimeout(()=>a(!1),2e3)})(S),className:"text-[10px] text-gray-500 hover:text-accent-primary transition-colors",children:"Copy"})]}),r.jsx("div",{className:"bg-slate-800/50 rounded px-2 py-1.5 text-xs text-gray-300 font-mono",children:S})]}),r.jsxs("div",{children:[r.jsx("div",{className:"flex items-center justify-between mb-1",children:r.jsx("label",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Body"})}),r.jsx("div",{className:"bg-slate-800/50 rounded px-2 py-2 text-xs text-gray-300 whitespace-pre-wrap leading-relaxed max-h-48 overflow-y-auto",children:C})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:async()=>{if(y){l(!0);try{const n=ga(g.totalCharge,e.currency),a=`Generate a client email to accompany a production services quote from ${t.company?.name||"our company"}.\n\n## Input Data\n\nCLIENT: ${u.company||"Client"}\nCONTACT: ${x}\nPROJECT: ${p.title||"Project"}\nTYPE: ${p.type||"Production"}\nVENUE: ${p.venue||"TBC"}\nDATES: ${w}\nQUOTE REFERENCE: ${e.quoteNumber}\nTOTAL: ${n}\nCURRENCY: ${e.currency}\nVALIDITY: ${e.validityDays||30} days\nSERVICES: ${_()}\nSENDER: ${v}\n\n## Writing Style\n\nWrite in Tom's voice: professional but casual, direct, efficient. Never stuffy.\n\nTone rules:\n- Use contractions naturally (I'm, we're, it's, we've)\n- Short paragraphs, 1-3 sentences each\n- No waffle or filler\n- Warm but not overly friendly\n- Confident without being pushy\n\n## Email Structure\n\nSubject line: Quote for [Project Title] | [Dates]\n\nBody:\n1. Opening (1 sentence) - Greeting and brief context\n2. The quote (2-3 sentences) - Reference attached quote, mention total and what it covers, note validity\n3. Next steps (1-2 sentences) - Clear call to action, offer to discuss\n4. Sign off: "Best, ${v}"\n\n## Rules\n\nAVOID:\n- Bullet points in the email\n- "Please find attached" (say "I've attached" or "Attached is")\n- "I hope this email finds you well"\n- "Don't hesitate to contact me" (say "Let me know if you have any questions")\n- Long paragraphs\n- Excessive thank-yous\n- Marketing language\n\n## Output Format\n\nReturn ONLY a JSON object:\n{"subject": "the email subject line", "body": "the email body"}\n\nKeep it under 120 words. No bullet points.`,r=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":t.aiSettings.anthropicKey,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:500,messages:[{role:"user",content:a}]})});if(!r.ok)throw new Error("API request failed");const o=await r.json(),i=(o.content[0]?.text||"").match(/\{[\s\S]*\}/);if(i){const e=JSON.parse(i[0]);d(e)}}catch(n){}finally{l(!1)}}},disabled:s||!y,title:y?"":"Add Anthropic API key in Settings",className:`flex-1 py-2 rounded text-xs font-medium transition-all flex items-center justify-center gap-2 ${y?"bg-purple-500/20 text-purple-400 border border-purple-500/30 hover:bg-purple-500/30":"bg-gray-700/50 text-gray-500 border border-gray-600/30 cursor-not-allowed"} disabled:opacity-50`,children:s?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-3 h-3 border-2 border-purple-400 border-t-transparent rounded-full animate-spin"}),"Generating..."]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),c?"Regenerate":"Generate"]})}),r.jsx("button",{onClick:async()=>{const e=`Subject: ${S}\n\n${C}`;await navigator.clipboard.writeText(e),a(!0),setTimeout(()=>a(!1),2e3)},className:"flex-1 py-2 rounded text-xs font-medium transition-all flex items-center justify-center gap-2 "+(n?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-accent-primary/20 text-accent-primary border border-accent-primary/30 hover:bg-accent-primary/30"),children:n?r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy"]})})]})]})]})}function Zr(){return r.jsx("div",{className:"w-[320px] min-w-[320px] border-l border-dark-border bg-dark-bg overflow-y-auto h-[calc(100vh-60px)] sticky top-[60px]",children:r.jsxs("div",{className:"p-4",children:[r.jsx(Yr,{}),r.jsx(Jr,{})]})})}function Xr(e,t="This field"){return(e||"").toString().trim()?{valid:!0,error:null}:{valid:!1,error:`${t} is required`}}function eo(e,t=!1){if(!e||!e.trim())return t?{valid:!1,error:"Email is required"}:{valid:!0,error:null};return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())?{valid:!0,error:null}:{valid:!1,error:"Please enter a valid email address"}}function to(e,t=!1){if(!e||!e.trim())return t?{valid:!1,error:"Phone number is required"}:{valid:!0,error:null};const n=e.replace(/\D/g,"");return/^[\d\s\-\+\(\)]+$/.test(e)?n.length<7?{valid:!1,error:"Phone number is too short"}:n.length>15?{valid:!1,error:"Phone number is too long"}:{valid:!0,error:null}:{valid:!1,error:"Phone number contains invalid characters"}}function no(e,t=!1){if(!e||!e.trim())return t?{valid:!1,error:"URL is required"}:{valid:!0,error:null};let n=e.trim();n.startsWith("http://")||n.startsWith("https://")||(n="https://"+n);try{return new URL(n),{valid:!0,error:null}}catch{return{valid:!1,error:"Please enter a valid URL"}}}function ao(e,t={}){const{min:n,max:a,required:r=!1,fieldName:o="Value"}=t;if(""===e||null==e)return r?{valid:!1,error:`${o} is required`}:{valid:!0,error:null};const i=parseFloat(e);return isNaN(i)?{valid:!1,error:`${o} must be a valid number`}:void 0!==n&&i<n?{valid:!1,error:`${o} must be at least ${n}`}:void 0!==a&&i>a?{valid:!1,error:`${o} must be at most ${a}`}:{valid:!0,error:null}}function ro(e,t,n="This field"){return(e||"").toString().trim().length<t?{valid:!1,error:`${n} must be at least ${t} characters`}:{valid:!0,error:null}}function oo(e,t,n="This field"){return(e||"").toString().length>t?{valid:!1,error:`${n} must be at most ${t} characters`}:{valid:!0,error:null}}function io(e,t){const n={};let a=!0;for(const[r,o]of Object.entries(t)){const t=e[r],i=o.label||r;if(o.required){const e=Xr(t,i);if(!e.valid){n[r]=e.error,a=!1;continue}}if(t||o.required){if(o.email){const e=eo(t,o.required);if(!e.valid){n[r]=e.error,a=!1;continue}}if(o.phone){const e=to(t,o.required);if(!e.valid){n[r]=e.error,a=!1;continue}}if(o.url){const e=no(t,o.required);if(!e.valid){n[r]=e.error,a=!1;continue}}if(o.number||void 0!==o.min||void 0!==o.max){const e=ao(t,{min:o.min,max:o.max,required:o.required,fieldName:i});if(!e.valid){n[r]=e.error,a=!1;continue}}if(o.minLength){const e=ro(t,o.minLength,i);if(!e.valid){n[r]=e.error,a=!1;continue}}if(o.maxLength){const e=oo(t,o.maxLength,i);if(!e.valid){n[r]=e.error,a=!1;continue}}}}return{isValid:a,errors:n}}function so(e){return e&&"string"==typeof e?e.trim():""}function lo({initialMode:e="login"}){const{login:t,signup:n,loginWithGoogle:a,resetPassword:o,error:i,clearError:s,isLoading:l,rateLimited:c,lockoutTimeRemaining:d,getRemainingAttempts:u,isSupabaseAuth:p}=Un(),[h,f]=m.useState(e),[g,y]=m.useState(""),[b,v]=m.useState(""),[x,w]=m.useState(""),[_,k]=m.useState(""),[S,C]=m.useState(!1),[N,j]=m.useState(!1),[T,I]=m.useState(!1),[D,E]=m.useState(!1),[L,A]=m.useState(null),[P,R]=m.useState(0),O=p(),M="signup"===h?function(e,t=!0){if(!e||!e.trim())return t?{valid:!1,error:"Password is required"}:{valid:!0,error:null};const n=e.trim(),a=[];return n.length<8&&a.push("at least 8 characters"),/[A-Z]/.test(n)||a.push("one uppercase letter"),/[a-z]/.test(n)||a.push("one lowercase letter"),/[0-9]/.test(n)||a.push("one number"),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(n)||a.push("one special character"),a.length>0?{valid:!1,error:`Password must contain ${a.join(", ")}`}:{valid:!0,error:null}}(x):{valid:!0,error:null},q="signup"===h?function(e){if(!e)return{score:0,label:"Too short",color:"red"};let t=0;return e.length>=8&&t++,e.length>=12&&t++,/[A-Z]/.test(e)&&/[a-z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e)&&t++,t=Math.min(t,4),{score:t,label:["Weak","Fair","Good","Strong","Very Strong"][t],color:["red","orange","yellow","green","emerald"][t]}}(x):null;m.useEffect(()=>{if(c&&d>0){R(d);const e=setInterval(()=>{R(t=>t<=1?(clearInterval(e),window.location.reload(),0):t-1)},1e3);return()=>clearInterval(e)}},[c,d]);const z=e=>{f(e),I(!1),E(!1),A(null),s()},F=!_||x===_,B=u(),U=B<=2&&B>0;return r.jsx("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-md",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("img",{src:"/productionos-logo.svg",alt:"ProductionOS Logo",className:"h-10 mx-auto mb-4",role:"img",style:{color:"#fff"}}),r.jsx("h1",{className:"text-xl font-bold text-white mb-2",children:"ProductionOS"}),r.jsx("p",{className:"text-gray-500 text-sm",children:"login"===h?"Secure Access":"signup"===h?"Request Access":"Reset Password"})]}),r.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl p-6 shadow-2xl",children:[D?r.jsxs("div",{className:"text-center py-4",children:[r.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx("svg",{className:"w-8 h-8 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),r.jsx("h2",{className:"text-lg font-semibold text-white mb-2",children:"Check Your Email"}),r.jsxs("p",{className:"text-gray-400 text-sm mb-4",children:["We've sent a password reset link to ",r.jsx("span",{className:"text-white font-medium",children:b})]}),r.jsx("p",{className:"text-gray-500 text-xs mb-6",children:"Click the link in the email to reset your password. The link will expire in 24 hours."}),r.jsx("button",{type:"button",onClick:()=>{E(!1),z("login")},className:"btn-primary px-6 py-2",children:"Back to Sign In"})]}):T?r.jsxs("div",{className:"text-center py-4",children:[r.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:r.jsx("svg",{className:"w-8 h-8 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),r.jsx("h2",{className:"text-lg font-semibold text-white mb-2",children:"Request Submitted"}),r.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Your access request has been submitted. An administrator will review and approve your account."}),r.jsx("p",{className:"text-gray-500 text-xs mb-6",children:"You will be able to sign in once your account is approved."}),r.jsx("button",{type:"button",onClick:()=>{I(!1),z("login")},className:"btn-primary px-6 py-2",children:"Back to Sign In"})]}):r.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),"forgot"===h&&O){if(!b)return;A(null);const e=await o(b);return void(e.success?E(!0):A(e.error))}if("signup"===h&&O){if(!(g&&b&&x&&_))return;if(x!==_)return;return void(await n(g,b,x)&&I(!0))}if(O){if(!b||!x)return;await t(b,x)}else{if(!x)return;await t(x)}},className:"space-y-5",noValidate:!0,children:[O&&"signup"===h&&r.jsxs("div",{children:[r.jsx("label",{htmlFor:"name",className:"label",children:"Full Name"}),r.jsx("input",{id:"name",name:"name",type:"text",value:g,onChange:e=>{y(e.target.value),i&&s()},placeholder:"Your full name",className:"input",autoFocus:!0,autoComplete:"name",disabled:c,required:!0})]}),O&&"forgot"===h&&r.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Enter your email address and we'll send you a link to reset your password."}),O&&r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"label",children:"Email Address"}),r.jsx("input",{id:"email",name:"email",type:"email",value:b,onChange:e=>{v(e.target.value),i&&s(),L&&A(null)},placeholder:"your.email@company.com",className:"input",autoFocus:"login"===h||"forgot"===h,autoComplete:"email",disabled:c,required:!0})]}),"forgot"!==h&&r.jsxs("div",{children:[r.jsx("label",{htmlFor:"password",className:"label",children:O?"Password":"Access Password"}),r.jsx("input",{id:"password",name:"password",type:"password",value:x,onChange:e=>{w(e.target.value),i&&s()},placeholder:"signup"===h?"Create a password":O?"Enter your password":"Enter access password",className:O?"input":"input text-center text-lg tracking-widest",autoFocus:!O,autoComplete:"signup"===h?"new-password":"current-password",disabled:c,"aria-invalid":i?"true":"false","aria-describedby":i?"password-error":void 0,required:!0})]}),O&&"signup"===h&&r.jsxs("div",{children:[r.jsx("label",{htmlFor:"confirmPassword",className:"label",children:"Confirm Password"}),r.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:_,onChange:e=>{k(e.target.value),i&&s()},placeholder:"Confirm your password",className:"input "+(F?"":"border-red-500 focus:border-red-500 focus:ring-red-500/20"),autoComplete:"new-password",disabled:c,required:!0}),!F&&r.jsx("p",{className:"mt-1 text-xs text-red-400",children:"Passwords do not match"}),x&&q&&r.jsxs("div",{className:"mt-2",children:[r.jsx("div",{className:"flex gap-1 mb-1",children:[0,1,2,3].map(e=>r.jsx("div",{className:"h-1 flex-1 rounded-full transition-colors "+(e<=q.score?"red"===q.color?"bg-red-500":"orange"===q.color?"bg-orange-500":"yellow"===q.color?"bg-yellow-500":"green"===q.color?"bg-green-500":"bg-emerald-500":"bg-dark-border")},e))}),r.jsxs("p",{className:"text-xs "+("red"===q.color?"text-red-400":"orange"===q.color?"text-orange-400":"yellow"===q.color?"text-yellow-400":"text-green-400"),children:["Password strength: ",q.label]})]}),!M.valid&&x&&r.jsx("p",{className:"mt-1 text-xs text-red-400",children:M.error})]}),O&&"signup"===h&&r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("input",{id:"acceptTerms",type:"checkbox",checked:S,onChange:e=>C(e.target.checked),className:"mt-1 h-4 w-4 rounded border-gray-600 bg-dark-bg text-brand-teal focus:ring-brand-teal/20 focus:ring-offset-0",disabled:c}),r.jsxs("label",{htmlFor:"acceptTerms",className:"text-sm text-gray-400",children:["I agree to the"," ",r.jsx("a",{href:"/legal/terms",target:"_blank",rel:"noopener noreferrer",className:"text-brand-teal hover:text-brand-teal-light underline",children:"Terms of Service"})," ","and"," ",r.jsx("a",{href:"/legal/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-brand-teal hover:text-brand-teal-light underline",children:"Privacy Policy"})]})]}),O&&"signup"===h&&r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx("input",{id:"acceptGDPR",type:"checkbox",checked:N,onChange:e=>j(e.target.checked),className:"mt-1 h-4 w-4 rounded border-gray-600 bg-dark-bg text-brand-teal focus:ring-brand-teal/20 focus:ring-offset-0",disabled:c}),r.jsxs("label",{htmlFor:"acceptGDPR",className:"text-sm text-gray-400",children:["I consent to ProductionOS processing my personal data as described in the"," ",r.jsx("a",{href:"/legal/gdpr",target:"_blank",rel:"noopener noreferrer",className:"text-brand-teal hover:text-brand-teal-light underline",children:"Data Processing Agreement"}),". I understand I can withdraw consent at any time."]})]}),U&&!c&&r.jsxs("div",{className:"flex items-center gap-2 text-yellow-400 text-sm bg-yellow-500/10 border border-yellow-500/20 rounded-lg px-3 py-2",children:[r.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),r.jsxs("span",{children:[B," attempt",1!==B?"s":""," remaining"]})]}),c&&P>0&&r.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 border border-red-500/20 rounded-lg px-3 py-2",children:[r.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-semibold",children:"Account temporarily locked"}),r.jsxs("div",{className:"text-xs",children:["Unlock in ",($=P,`${Math.floor($/60)}:${($%60).toString().padStart(2,"0")}`)]})]})]}),i&&!c&&r.jsxs("div",{id:"password-error",role:"alert",className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 border border-red-500/20 rounded-lg px-3 py-2",children:[r.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),r.jsx("span",{children:i})]}),L&&r.jsxs("div",{role:"alert",className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 border border-red-500/20 rounded-lg px-3 py-2",children:[r.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),r.jsx("span",{children:L})]}),r.jsx("button",{type:"submit",disabled:l||c||("forgot"===h?!b:"signup"===h?!(g&&b&&x&&_&&F&&M.valid&&S&&N):O&&!b||!x),className:"btn-primary w-full py-3 text-base disabled:opacity-50 disabled:cursor-not-allowed","aria-busy":l,children:l?r.jsxs("span",{className:"flex items-center justify-center gap-2",children:[r.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r.jsx("span",{children:"forgot"===h?"Sending...":"signup"===h?"Submitting...":"Signing in..."}),r.jsx("span",{className:"sr-only",children:"Please wait"})]}):c?"Account Locked":"forgot"===h?"Send Reset Link":"signup"===h?"Request Access":"Sign In"}),O&&"login"===h&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"relative my-4",children:[r.jsx("div",{className:"absolute inset-0 flex items-center",children:r.jsx("div",{className:"w-full border-t border-dark-border"})}),r.jsx("div",{className:"relative flex justify-center text-xs",children:r.jsx("span",{className:"px-2 bg-dark-card text-gray-500",children:"or"})})]}),r.jsxs("button",{type:"button",onClick:a,disabled:l||c,className:"w-full py-3 px-4 flex items-center justify-center gap-3 bg-white hover:bg-gray-100 text-gray-800 font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[r.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),r.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),r.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),r.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Sign in with Google"]})]}),O&&r.jsx("div",{className:"flex items-center justify-between text-sm",children:"login"===h?r.jsxs(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:()=>z("forgot"),className:"text-gray-500 hover:text-gray-400 transition-colors",children:"Forgot password?"}),r.jsx("button",{type:"button",onClick:()=>z("signup"),className:"text-brand-teal hover:text-brand-teal-light transition-colors",children:"Request access"})]}):"forgot"===h?r.jsx("button",{type:"button",onClick:()=>z("login"),className:"text-brand-teal hover:text-brand-teal-light transition-colors w-full text-center",children:" Back to Sign In"}):r.jsx("button",{type:"button",onClick:()=>z("login"),className:"text-brand-teal hover:text-brand-teal-light transition-colors w-full text-center",children:"Already have an account? Sign in"})})]}),!T&&r.jsx("div",{className:"mt-6 pt-6 border-t border-dark-border",children:r.jsxs("div",{className:"flex items-start gap-2 text-xs text-gray-500",children:[r.jsx("svg",{className:"w-4 h-4 mt-0.5 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-semibold text-gray-400 mb-1",children:"Security Features"}),r.jsxs("ul",{className:"space-y-0.5",children:[r.jsx("li",{children:" Session expires after 24 hours"}),r.jsx("li",{children:" 5 login attempts before lockout"}),r.jsx("li",{children:" 15-minute lockout period"}),O&&r.jsx("li",{children:" Encrypted authentication tokens"})]})]})]})})]}),r.jsx("p",{className:"text-center text-gray-600 text-xs mt-6",children:"Authorized personnel only  All activity is logged"})]})});var $}function co({size:e="md",text:t="Loading..."}){return r.jsxs("div",{className:"flex flex-col items-center justify-center p-8",role:"status","aria-live":"polite",children:[r.jsxs("svg",{className:`${{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"}[e]} animate-spin text-accent-primary`,fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t&&r.jsx("p",{className:"mt-3 text-sm text-gray-400",children:t}),r.jsx("span",{className:"sr-only",children:t})]})}const uo=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},mo=(...e)=>e.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim(),po=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var ho={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const fo=m.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:a,className:r="",children:o,iconNode:i,...s},l)=>m.createElement("svg",{ref:l,...ho,width:t,height:t,stroke:e,strokeWidth:a?24*Number(n)/Number(t):n,className:mo("lucide",r),...!o&&!po(s)&&{"aria-hidden":"true"},...s},[...i.map(([e,t])=>m.createElement(e,t)),...Array.isArray(o)?o:[o]])),go=(e,t)=>{const n=m.forwardRef(({className:n,...a},r)=>{return m.createElement(fo,{ref:r,iconNode:t,className:mo(`lucide-${o=uo(e),o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...a});var o});return n.displayName=uo(e),n},yo=go("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),bo=go("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),vo=go("building-2",[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]]),xo=go("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),wo=go("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),_o=go("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),ko=go("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),So=go("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Co=go("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),No=go("cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]),jo=go("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),To=go("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),Io=go("earth",[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3a2 2 0 0 1 2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.1.9-2 2-2h3.17",key:"1tzkfa"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"14pb5j"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Do=go("film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]),Eo=go("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Lo=go("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),Ao=go("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),Po=go("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Ro=go("radio",[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Oo=go("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Mo=go("rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]),qo=go("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),zo=go("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),Fo=go("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Bo=go("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Uo=go("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),$o=go("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),Vo=go("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),Ho=go("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),Wo=go("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),Go=go("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ko="productionos_cookie_consent";function Qo(){const[e,t]=m.useState(!1),[n,a]=m.useState(!1),[o,i]=m.useState({essential:!0,analytics:!1,marketing:!1});m.useEffect(()=>{if(!localStorage.getItem(Ko)){const e=setTimeout(()=>t(!0),1e3);return()=>clearTimeout(e)}},[]);const s=e=>{const n={type:e,preferences:"all"===e?{essential:!0,analytics:!0,marketing:!0}:o,timestamp:(new Date).toISOString(),version:"1.0"};localStorage.setItem(Ko,JSON.stringify(n)),t(!1)};return e?r.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 p-3 md:p-6 animate-slide-up",children:r.jsx("div",{className:"max-w-3xl mx-auto bg-marketing-surface border border-marketing-border rounded-xl shadow-2xl overflow-hidden",children:r.jsxs("div",{className:"p-4 md:p-6",children:[r.jsxs("div",{className:"flex flex-col md:flex-row md:items-start gap-4",children:[r.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-marketing-primary/10 rounded-lg flex items-center justify-center shrink-0",children:r.jsx(No,{className:"text-marketing-primary",size:20})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-base md:text-lg font-bold text-marketing-text-primary mb-2",children:"We value your privacy"}),r.jsxs("p",{className:"text-marketing-text-secondary text-sm mb-4 leading-relaxed",children:['We use cookies to enhance your experience and analyze our traffic. By clicking "Accept All", you consent to our use of cookies.'," ",r.jsx(bt,{to:"/legal/privacy",className:"text-marketing-primary hover:underline",children:"Privacy Policy"})]}),r.jsxs("div",{className:"flex flex-wrap gap-2 md:gap-3",children:[r.jsx("button",{onClick:()=>{s("all")},className:"px-4 py-2 md:px-5 md:py-2.5 bg-marketing-primary text-white text-sm font-semibold rounded-lg hover:bg-marketing-primary/90 transition-colors",children:"Accept All"}),r.jsx("button",{onClick:()=>{i({essential:!0,analytics:!1,marketing:!1}),s("essential")},className:"px-4 py-2 md:px-5 md:py-2.5 bg-marketing-background border border-marketing-border text-marketing-text-primary text-sm font-medium rounded-lg hover:bg-marketing-border/50 transition-colors",children:"Essential Only"}),r.jsx("button",{onClick:()=>a(!n),className:"px-4 py-2 md:px-5 md:py-2.5 text-marketing-text-secondary hover:text-marketing-text-primary transition-colors text-sm",children:n?"Hide":"Customize"})]})]})]}),n&&r.jsxs("div",{className:"mt-6 pt-6 border-t border-marketing-border",children:[r.jsxs("h4",{className:"font-semibold text-marketing-text-primary mb-4 flex items-center gap-2 text-sm",children:[r.jsx(qo,{size:16,className:"text-marketing-accent"}),"Cookie Preferences"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between p-3 md:p-4 bg-marketing-background rounded-lg",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-marketing-text-primary text-sm",children:"Essential Cookies"}),r.jsx("p",{className:"text-marketing-text-secondary text-xs",children:"Required for the website to function."})]}),r.jsx("div",{className:"w-10 h-5 bg-marketing-primary rounded-full relative shrink-0",children:r.jsx("div",{className:"absolute right-0.5 top-0.5 w-4 h-4 bg-white rounded-full"})})]}),r.jsxs("div",{className:"flex items-center justify-between p-3 md:p-4 bg-marketing-background rounded-lg",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-marketing-text-primary text-sm",children:"Analytics Cookies"}),r.jsx("p",{className:"text-marketing-text-secondary text-xs",children:"Help us understand site usage."})]}),r.jsx("button",{onClick:()=>i(e=>({...e,analytics:!e.analytics})),className:"w-10 h-5 rounded-full relative transition-colors shrink-0 "+(o.analytics?"bg-marketing-primary":"bg-marketing-border"),children:r.jsx("div",{className:"absolute top-0.5 w-4 h-4 bg-white rounded-full transition-all "+(o.analytics?"right-0.5":"left-0.5")})})]}),r.jsxs("div",{className:"flex items-center justify-between p-3 md:p-4 bg-marketing-background rounded-lg",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-marketing-text-primary text-sm",children:"Marketing Cookies"}),r.jsx("p",{className:"text-marketing-text-secondary text-xs",children:"Used for relevant advertisements."})]}),r.jsx("button",{onClick:()=>i(e=>({...e,marketing:!e.marketing})),className:"w-10 h-5 rounded-full relative transition-colors shrink-0 "+(o.marketing?"bg-marketing-primary":"bg-marketing-border"),children:r.jsx("div",{className:"absolute top-0.5 w-4 h-4 bg-white rounded-full transition-all "+(o.marketing?"right-0.5":"left-0.5")})})]})]}),r.jsx("div",{className:"mt-4 flex justify-end",children:r.jsx("button",{onClick:()=>{s("custom")},className:"px-4 py-2 bg-marketing-accent text-white text-sm font-semibold rounded-lg hover:bg-marketing-accent/90 transition-colors",children:"Save Preferences"})})]})]})})}):null}function Yo(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:a,onRegistered:r,onRegisteredSW:o,onRegisterError:i}=e,[s,l]=m.useState(!1),[c,d]=m.useState(!1),[u]=m.useState(()=>function(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:a,onRegistered:r,onRegisteredSW:o,onRegisterError:i}=e;let s,l,c;return l=async function(){if("serviceWorker"in navigator){if(s=await E(async()=>{const{Workbox:e}=await import("./workbox-window.prod.es5-CLYUWRvB.js");return{Workbox:e}},[]).then(({Workbox:e})=>new e("/sw.js",{scope:"/",type:"classic"})).catch(e=>{i?.(e)}),!s)return;c=()=>{s?.messageSkipWaiting()};{let e=!1;const t=()=>{e=!0,s?.addEventListener("controlling",e=>{e.isUpdate&&window.location.reload()}),n?.()};s.addEventListener("installed",n=>{void 0===n.isUpdate?void 0!==n.isExternal&&n.isExternal?t():!e&&a?.():n.isUpdate||a?.()}),s.addEventListener("waiting",t)}s.register({immediate:t}).then(e=>{o?o("/sw.js",e):r?.(e)}).catch(e=>{i?.(e)})}}(),async(e=!0)=>{await l,c?.()}}({immediate:t,onOfflineReady(){d(!0),a?.()},onNeedRefresh(){l(!0),n?.()},onRegistered:r,onRegisteredSW:o,onRegisterError:i}));return{needRefresh:[s,l],offlineReady:[c,d],updateServiceWorker:u}}function Jo(){const[e,t]=m.useState(navigator.onLine),[n,a]=m.useState(!1),[o,i]=m.useState(!1),[s,l]=m.useState(null),{needRefresh:[c,d],updateServiceWorker:u}=Yo({onRegistered(e){},onRegisterError(e){}});m.useEffect(()=>{const e=()=>{t(!0),a(!1)},n=()=>{t(!1),a(!0)};return window.addEventListener("online",e),window.addEventListener("offline",n),navigator.onLine||a(!0),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}},[]),m.useEffect(()=>{const e=e=>{e.preventDefault(),l(e);const t=localStorage.getItem("pwa-install-dismissed");(!t||Date.now()-parseInt(t)>6048e5)&&i(!0)};return window.addEventListener("beforeinstallprompt",e),()=>{window.removeEventListener("beforeinstallprompt",e)}},[]);return r.jsxs(r.Fragment,{children:[n&&!e&&r.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-50 animate-slide-up",children:r.jsxs("div",{className:"bg-amber-500/90 backdrop-blur-sm text-white px-4 py-3 rounded-lg shadow-lg flex items-center gap-3",children:[r.jsx(Ho,{className:"w-5 h-5 flex-shrink-0"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-medium text-sm",children:"You're offline"}),r.jsx("p",{className:"text-xs text-amber-100",children:"Changes will sync when you reconnect"})]}),r.jsx("button",{onClick:()=>a(!1),className:"p-1 hover:bg-white/20 rounded",children:r.jsx(Go,{className:"w-4 h-4"})})]})}),e&&n&&r.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-50 animate-slide-up",children:r.jsxs("div",{className:"bg-emerald-500/90 backdrop-blur-sm text-white px-4 py-3 rounded-lg shadow-lg flex items-center gap-3",children:[r.jsx(Wo,{className:"w-5 h-5 flex-shrink-0"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-medium text-sm",children:"Back online"}),r.jsx("p",{className:"text-xs text-emerald-100",children:"Syncing your changes..."})]}),r.jsx("button",{onClick:()=>a(!1),className:"p-1 hover:bg-white/20 rounded",children:r.jsx(Go,{className:"w-4 h-4"})})]})}),c&&r.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-50 animate-slide-up",children:r.jsxs("div",{className:"bg-blue-500/90 backdrop-blur-sm text-white px-4 py-3 rounded-lg shadow-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Oo,{className:"w-5 h-5 flex-shrink-0"}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-medium text-sm",children:"Update available"}),r.jsx("p",{className:"text-xs text-blue-100",children:"A new version is ready"})]})]}),r.jsxs("div",{className:"flex gap-2 mt-3",children:[r.jsx("button",{onClick:()=>u(!0),className:"flex-1 bg-white text-blue-600 px-3 py-1.5 rounded text-sm font-medium hover:bg-blue-50 transition-colors",children:"Update now"}),r.jsx("button",{onClick:()=>d(!1),className:"px-3 py-1.5 rounded text-sm hover:bg-white/20 transition-colors",children:"Later"})]})]})}),o&&s&&r.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-50 animate-slide-up",children:r.jsxs("div",{className:"bg-dark-card border border-dark-border text-white px-4 py-3 rounded-lg shadow-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-brand-navy to-brand-teal rounded-lg flex items-center justify-center",children:r.jsx(To,{className:"w-5 h-5"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"font-medium text-sm",children:"Install ProductionOS"}),r.jsx("p",{className:"text-xs text-gray-400",children:"Add to home screen for quick access"})]})]}),r.jsxs("div",{className:"flex gap-2 mt-3",children:[r.jsx("button",{onClick:async()=>{if(!s)return;s.prompt();const{outcome:e}=await s.userChoice;l(null),i(!1)},className:"flex-1 bg-brand-teal text-white px-3 py-1.5 rounded text-sm font-medium hover:bg-brand-teal/90 transition-colors",children:"Install"}),r.jsx("button",{onClick:()=>{localStorage.setItem("pwa-install-dismissed",Date.now().toString()),i(!1)},className:"px-3 py-1.5 rounded text-sm text-gray-400 hover:bg-dark-border transition-colors",children:"Not now"})]})]})}),!e&&r.jsxs("div",{className:"fixed top-0 left-0 right-0 z-40 bg-amber-500 text-white text-center py-1 text-xs font-medium",children:[r.jsx(Ho,{className:"w-3 h-3 inline-block mr-1"}),"Offline Mode - Changes saved locally"]})]})}const Zo=[{id:"all",label:"All Templates"},{id:"broadcast",label:"Broadcast"},{id:"streaming",label:"Streaming"},{id:"corporate",label:"Corporate Event"},{id:"sports",label:"Sports"},{id:"concert",label:"Concert/Live"},{id:"general",label:"General"}];function Xo({isOpen:e,onClose:t,onSelectTemplate:n,onStartBlank:a}){const o=Cr(e=>e.templates),i=Cr(e=>e.deleteTemplate),[s,l]=m.useState("all"),[c,d]=m.useState(""),[u,p]=m.useState(null),h=m.useMemo(()=>{let e=o;if("all"!==s&&(e=e.filter(e=>e.category===s)),c.trim()){const t=c.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t))}return e.sort((e,t)=>t.usageCount!==e.usageCount?(t.usageCount||0)-(e.usageCount||0):new Date(t.createdAt)-new Date(e.createdAt))},[o,s,c]);if(!e)return null;return r.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[r.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>t()}),r.jsxs("div",{className:"relative bg-[#1a1f2e] border border-dark-border rounded-xl shadow-2xl w-full max-w-2xl max-h-[85vh] flex flex-col",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-border",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-brand-teal to-brand-navy flex items-center justify-center",children:r.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-semibold text-white",children:"Choose a Template"}),r.jsxs("p",{className:"text-xs text-gray-400",children:[o.length," templates available"]})]})]}),r.jsx("button",{onClick:()=>t(),className:"btn-icon text-gray-400 hover:text-white","aria-label":"Close modal",children:r.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r.jsxs("div",{className:"p-4 border-b border-dark-border space-y-3",children:[r.jsxs("div",{className:"relative",children:[r.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),r.jsx("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"Search templates...",className:"input pl-10",autoFocus:!0})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:Zo.map(e=>r.jsx("button",{onClick:()=>l(e.id),className:"px-3 py-1.5 text-xs font-medium rounded-full transition-colors "+(s===e.id?"bg-brand-teal text-white":"bg-dark-bg text-gray-400 hover:bg-white/5 hover:text-white"),children:e.label},e.id))})]}),r.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:0===h.length?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-800 flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),r.jsx("p",{className:"text-gray-400 mb-2",children:"No templates found"}),r.jsx("p",{className:"text-sm text-gray-500",children:0===o.length?"Create your first template by saving a quote":"Try adjusting your search or category filter"})]}):r.jsx("div",{className:"grid gap-3",children:h.map(e=>{return r.jsxs("div",{className:"group relative bg-dark-bg border border-dark-border rounded-lg p-4 hover:border-brand-teal/50 transition-all cursor-pointer",onClick:()=>n(e),children:[r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h3",{className:"font-medium text-white truncate",children:e.name}),e.usageCount>0&&r.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] bg-brand-teal/20 text-brand-teal rounded",children:["Used ",e.usageCount,"x"]})]}),e.description&&r.jsx("p",{className:"text-sm text-gray-400 line-clamp-1 mb-2",children:e.description}),r.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),(t=e.sections,t?Object.values(t).reduce((e,t)=>e+Object.values(t.subsections||{}).reduce((e,t)=>e+(t.items?.length||0),0),0):0)," items"]}),r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.region," / ",e.currency]}),r.jsx("span",{className:"px-2 py-0.5 bg-gray-800 rounded text-gray-400 capitalize",children:e.category})]})]}),r.jsx("button",{onClick:t=>{t.stopPropagation(),p(e.id)},className:"opacity-0 group-hover:opacity-100 p-2 hover:bg-red-500/10 text-gray-500 hover:text-red-400 rounded-lg transition-all",title:"Delete template",children:r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),u===e.id&&r.jsxs("div",{className:"absolute inset-0 bg-dark-bg/95 rounded-lg flex items-center justify-center gap-3 p-4",children:[r.jsx("span",{className:"text-sm text-gray-300",children:"Delete this template?"}),r.jsx("button",{onClick:t=>{t.stopPropagation(),(async e=>{await i(e),p(null)})(e.id)},className:"px-3 py-1.5 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600",children:"Delete"}),r.jsx("button",{onClick:e=>{e.stopPropagation(),p(null)},className:"px-3 py-1.5 bg-gray-700 text-white text-sm rounded-lg hover:bg-gray-600",children:"Cancel"})]})]},e.id);var t})})}),r.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-dark-border bg-dark-bg/50",children:[r.jsxs("button",{onClick:a,className:"btn btn-ghost",children:[r.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Start Blank"]}),r.jsx("button",{onClick:()=>t(),className:"btn btn-ghost",children:"Cancel"})]})]})]})}const ei={SEA:["Malaysia","Singapore","Indonesia","Thailand","Vietnam","Philippines","Myanmar","Cambodia","Laos","Brunei"],GCC:["Saudi Arabia","UAE","Qatar","Kuwait","Bahrain","Oman"],Levant:["Jordan","Lebanon","Iraq","Syria"],"Central Asia":["Kazakhstan","Uzbekistan","Turkmenistan","Tajikistan","Kyrgyzstan","Afghanistan"]},ti=[...ei.SEA,...ei.GCC,...ei.Levant,...ei["Central Asia"]],ni=e=>ei.SEA.includes(e)?"SEA":ei.GCC.includes(e)?"GCC":ei.Levant.includes(e)?"Levant":ei["Central Asia"].includes(e)?"Central Asia":"Other";function ai(e){return{id:e.id,title:e.title,clientId:e.client_id,client:e.client||{},region:e.region,country:e.country,status:e.status||"active",value:e.value,currency:e.currency||"USD",probability:e.probability||50,source:e.source||"",competitors:e.competitors||[],contacts:e.contacts||[],accountOwnerId:e.account_owner_id||null,brief:e.brief||"",notes:e.notes||"",nextAction:e.next_action||"",nextActionDate:e.next_action_date,expectedCloseDate:e.expected_close_date,convertedToQuoteId:e.converted_to_quote_id,createdAt:e.created_at,updatedAt:e.updated_at}}const ri=h($n((e,t)=>({opportunities:[],loading:!1,error:null,realtimeSubscription:null,initialize:async()=>{if(kn()){e({loading:!0,error:null});try{const{data:n,error:a}=await _n.from("opportunities").select("*").order("created_at",{ascending:!1});if(a)throw a;const r=(n||[]).map(ai);e({opportunities:r,loading:!1,error:null}),t().subscribeToRealtime()}catch(Pc){e({loading:!1,error:Pc.message})}}else e({loading:!1,error:"Supabase not configured"})},subscribeToRealtime:()=>{if(!kn())return;const n=t().realtimeSubscription;n&&_n.removeChannel(n);const a=_n.channel("opportunities-realtime").on("postgres_changes",{event:"*",schema:"public",table:"opportunities"},t=>{const{eventType:n,new:a,old:r}=t;e(e=>{let t=[...e.opportunities];if("INSERT"===n){t.find(e=>e.id===a.id)||(t=[ai(a),...t])}else"UPDATE"===n?t=t.map(e=>e.id===a.id?ai(a):e):"DELETE"===n&&(t=t.filter(e=>e.id!==r.id));return{opportunities:t}})}).subscribe();e({realtimeSubscription:a})},unsubscribe:()=>{const n=t().realtimeSubscription;n&&(_n.removeChannel(n),e({realtimeSubscription:null}))},addOpportunity:async t=>{if(!kn())return e({error:"Supabase not configured"}),null;try{const a={title:t.title||"",clientId:t.clientId||null,client:t.client||{},region:t.region||ni(t.country),country:t.country||"",status:t.status||"active",value:t.value||0,currency:t.currency||"USD",probability:t.probability||50,source:t.source||"",competitors:t.competitors||[],contacts:t.contacts||[],accountOwnerId:t.accountOwnerId||null,brief:t.brief||"",notes:t.notes||"",nextAction:t.nextAction||"",nextActionDate:t.nextActionDate||null,expectedCloseDate:t.expectedCloseDate||null,convertedToQuoteId:null},{data:r,error:o}=await _n.from("opportunities").insert((n=a,{title:n.title,client_id:n.clientId||null,client:n.client||{},region:n.region,country:n.country,status:n.status,value:n.value,currency:n.currency,probability:n.probability,source:n.source,competitors:n.competitors,contacts:n.contacts,account_owner_id:n.accountOwnerId,brief:n.brief,notes:n.notes,next_action:n.nextAction,next_action_date:n.nextActionDate||null,expected_close_date:n.expectedCloseDate||null,converted_to_quote_id:n.convertedToQuoteId||null})).select().single();if(o)throw o;const i=ai(r);return e(e=>({opportunities:[i,...e.opportunities.filter(e=>e.id!==i.id)],error:null})),i}catch(Pc){return e({error:Pc.message}),null}var n},updateOpportunity:async(t,n)=>{if(kn()){n.country&&!n.region&&(n.region=ni(n.country));try{const a={};if(void 0!==n.title&&(a.title=n.title),void 0!==n.clientId&&(a.client_id=n.clientId),void 0!==n.client&&(a.client=n.client),void 0!==n.region&&(a.region=n.region),void 0!==n.country&&(a.country=n.country),void 0!==n.status&&(a.status=n.status),void 0!==n.value&&(a.value=n.value),void 0!==n.currency&&(a.currency=n.currency),void 0!==n.probability&&(a.probability=n.probability),void 0!==n.source&&(a.source=n.source),void 0!==n.competitors&&(a.competitors=n.competitors),void 0!==n.contacts&&(a.contacts=n.contacts),void 0!==n.accountOwnerId&&(a.account_owner_id=n.accountOwnerId),void 0!==n.brief&&(a.brief=n.brief),void 0!==n.notes&&(a.notes=n.notes),void 0!==n.nextAction&&(a.next_action=n.nextAction),void 0!==n.nextActionDate&&(a.next_action_date=n.nextActionDate),void 0!==n.expectedCloseDate&&(a.expected_close_date=n.expectedCloseDate),void 0!==n.convertedToQuoteId&&(a.converted_to_quote_id=n.convertedToQuoteId),Object.keys(a).length>0){const{error:r}=await _n.from("opportunities").update(a).eq("id",t);if(r)throw r;e(e=>({opportunities:e.opportunities.map(e=>e.id===t?{...e,...n,updatedAt:(new Date).toISOString()}:e),error:null}))}}catch(Pc){e({error:Pc.message})}}else e({error:"Supabase not configured"})},deleteOpportunity:async t=>{if(kn())try{const{error:n}=await _n.from("opportunities").delete().eq("id",t);if(n)throw n;e(e=>({opportunities:e.opportunities.filter(e=>e.id!==t),error:null}))}catch(Pc){e({error:Pc.message})}else e({error:"Supabase not configured"})},getOpportunity:e=>t().opportunities.find(t=>t.id===e),getClientOpportunities:e=>t().opportunities.filter(t=>t.clientId===e),getOpportunitiesByCountry:e=>t().opportunities.filter(t=>t.country===e),getOpportunitiesByRegion:e=>t().opportunities.filter(t=>t.region===e),getOpportunitiesGroupedByCountry:()=>{const{opportunities:e}=t(),n={};return ti.forEach(e=>{n[e]=[]}),n.Other=[],e.forEach(e=>{const t=e.country||"Other";n[t]?n[t].push(e):n.Other.push(e)}),n},updateStatus:async(e,n)=>{await t().updateOpportunity(e,{status:n})},addContact:async(e,n)=>{const a=t().getOpportunity(e);if(!a)return;const r={id:crypto.randomUUID(),name:n.name||"",role:n.role||"",email:n.email||"",phone:n.phone||"",isPrimary:n.isPrimary||!1};let o=[...a.contacts||[]];r.isPrimary&&(o=o.map(e=>({...e,isPrimary:!1}))),o.push(r),await t().updateOpportunity(e,{contacts:o})},updateContact:async(e,n,a)=>{const r=t().getOpportunity(e);if(!r)return;let o=[...r.contacts||[]];a.isPrimary&&(o=o.map(e=>({...e,isPrimary:!1}))),o=o.map(e=>e.id===n?{...e,...a}:e),await t().updateOpportunity(e,{contacts:o})},deleteContact:async(e,n)=>{const a=t().getOpportunity(e);if(!a)return;const r=(a.contacts||[]).filter(e=>e.id!==n);await t().updateOpportunity(e,{contacts:r})},getPipelineStats:()=>{const{opportunities:e}=t(),n=e.filter(e=>"active"===e.status),a=n.reduce((e,t)=>e+(t.value||0),0),r=n.reduce((e,t)=>{const n=(t.probability||0)/100;return e+(t.value||0)*n},0),o={};n.forEach(e=>{const t=e.country||"Other";o[t]||(o[t]={count:0,value:0}),o[t].count++,o[t].value+=e.value||0});const i={};return n.forEach(e=>{const t=e.region||"Other";i[t]||(i[t]={count:0,value:0}),i[t].count++,i[t].value+=e.value||0}),{totalCount:n.length,totalValue:a,weightedValue:r,byCountry:o,byRegion:i,wonCount:e.filter(e=>"won"===e.status).length,lostCount:e.filter(e=>"lost"===e.status).length}},getUpcomingActions:()=>{const{opportunities:e}=t(),n=new Date,a=new Date(n.getTime()+6048e5);return e.filter(e=>{if("active"!==e.status||!e.nextActionDate)return!1;const t=new Date(e.nextActionDate);return t>=n&&t<=a}).sort((e,t)=>new Date(e.nextActionDate)-new Date(t.nextActionDate))},clearError:()=>{e({error:null})}}))),oi="tell_deal_context",ii="tell_task_patterns",si={new_opportunity:[{id:"research_client",title:"Research client background",description:"Review their website, recent news, and social media presence",priority:"high"},{id:"identify_stakeholders",title:"Identify key stakeholders",description:"Find decision makers and influencers in the organization",priority:"high"},{id:"schedule_discovery",title:"Schedule discovery call",description:"Book initial meeting to understand requirements",priority:"high"}],discovery:[{id:"send_intro_email",title:"Send introduction email",description:"Brief company intro with relevant case studies",priority:"high"},{id:"prepare_questions",title:"Prepare discovery questions",description:"List questions about budget, timeline, requirements",priority:"medium"},{id:"check_competitors",title:"Research competitors bidding",description:"Identify who else might be pitching",priority:"medium"}],proposal:[{id:"draft_proposal",title:"Draft initial proposal",description:"Create proposal based on client requirements",priority:"high"},{id:"review_pricing",title:"Review pricing strategy",description:"Ensure competitive pricing with healthy margins",priority:"high"},{id:"internal_review",title:"Get internal review",description:"Have team review proposal before sending",priority:"medium"}],follow_up:[{id:"follow_up_call",title:"Follow-up call",description:"Check in on proposal status and address questions",priority:"high"},{id:"send_reminder",title:"Send gentle reminder",description:"Follow up on pending proposal",priority:"medium"},{id:"add_value",title:"Share relevant content",description:"Send case study or article relevant to their needs",priority:"low"}],negotiation:[{id:"prepare_alternatives",title:"Prepare alternative options",description:"Have backup pricing/scope options ready",priority:"high"},{id:"clarify_objections",title:"Address objections",description:"Document and respond to client concerns",priority:"high"},{id:"final_meeting",title:"Schedule decision meeting",description:"Book meeting to finalize terms",priority:"medium"}],at_risk:[{id:"executive_outreach",title:"Executive-level outreach",description:"Escalate to senior contact if available",priority:"high"},{id:"requalify",title:"Re-qualify opportunity",description:"Confirm deal is still viable and budget available",priority:"high"},{id:"offer_meeting",title:"Offer in-person meeting",description:"Suggest face-to-face to rebuild momentum",priority:"medium"}],closing:[{id:"confirm_timeline",title:"Confirm decision timeline",description:"Verify when client will make final decision",priority:"high"},{id:"remove_blockers",title:"Identify remaining blockers",description:"Ask what is needed to move forward",priority:"high"},{id:"prep_contract",title:"Prepare contract/agreement",description:"Have paperwork ready for quick close",priority:"medium"}]};function li(){try{const e=localStorage.getItem(oi);return e?JSON.parse(e):{}}catch(Pc){return{}}}function ci(e){try{localStorage.setItem(oi,JSON.stringify(e))}catch(Pc){}}function di(){try{const e=localStorage.getItem(ii);return e?JSON.parse(e):{completedTasks:[],skippedTasks:[],effectiveness:{}}}catch(Pc){return{completedTasks:[],skippedTasks:[],effectiveness:{}}}}function ui(e){try{localStorage.setItem(ii,JSON.stringify(e))}catch(Pc){}}const mi=h($n((e,t)=>({contexts:li(),taskPatterns:di(),loading:!1,getContext:n=>{const a=t().contexts;if(!a[n]){const t={opportunityId:n,suggestedTasks:[],completedTasks:[],skippedTasks:[],milestones:[],lastInteraction:null,notes:[],createdAt:(new Date).toISOString()};return e({contexts:{...a,[n]:t}}),ci({...a,[n]:t}),t}return a[n]},updateContext:(n,a)=>{const r=t().contexts,o={...r[n]||{opportunityId:n,createdAt:(new Date).toISOString()},...a,updatedAt:(new Date).toISOString()},i={...r,[n]:o};e({contexts:i}),ci(i),t().syncContextToSupabase(n,o)},addSuggestedTask:(e,n)=>{const a=[...t().getContext(e).suggestedTasks,{...n,suggestedAt:(new Date).toISOString(),status:"pending"}];t().updateContext(e,{suggestedTasks:a})},completeTask:(e,n,a="completed")=>{const r=t().getContext(e),o=r.suggestedTasks.find(e=>e.id===n);if(o){const i=r.suggestedTasks.filter(e=>e.id!==n),s=[...r.completedTasks,{...o,completedAt:(new Date).toISOString(),outcome:a}];t().updateContext(e,{suggestedTasks:i,completedTasks:s}),t().trackTaskPattern(o.id,"completed",e)}},skipTask:(e,n,a="")=>{const r=t().getContext(e),o=r.suggestedTasks.find(e=>e.id===n);if(o){const i=r.suggestedTasks.filter(e=>e.id!==n),s=[...r.skippedTasks,{...o,skippedAt:(new Date).toISOString(),reason:a}];t().updateContext(e,{suggestedTasks:i,skippedTasks:s}),t().trackTaskPattern(o.id,"skipped",e)}},addMilestone:(e,n)=>{const a=[...t().getContext(e).milestones,{...n,timestamp:(new Date).toISOString()}];t().updateContext(e,{milestones:a,lastInteraction:(new Date).toISOString()})},trackTaskPattern:(n,a,r)=>{const o=t().taskPatterns,i=`${n}_${a}`,s={...o.effectiveness,[i]:(o.effectiveness[i]||0)+1},l={...o,effectiveness:s,["completed"===a?"completedTasks":"skippedTasks"]:[...o["completed"===a?"completedTasks":"skippedTasks"],{taskTemplateId:n,opportunityId:r,timestamp:(new Date).toISOString()}].slice(-100)};e({taskPatterns:l}),ui(l),t().syncPatternsToSupabase(l)},getTaskEffectiveness:e=>{const n=t().taskPatterns,a=n.effectiveness[`${e}_completed`]||0,r=a+(n.effectiveness[`${e}_skipped`]||0);return 0===r?.5:a/r},getSmartTasks:(e,n=[],a=[])=>{if(!e)return[];const r=t().getContext(e.id),o=new Date,i=(()=>{if("won"===e.status||"lost"===e.status)return null;const t=a.filter(t=>t.opportunityId===e.id||t.client?.company===e.client?.company),r=t.some(e=>"sent"===e.status),i=t.some(e=>"draft"===e.status),s=new Date(e.createdAt||e.created_at),l=Math.floor((o-s)/864e5),c=n.filter(t=>t.opportunityId===e.id||t.clientId===e.clientId).sort((e,t)=>new Date(t.activityDate)-new Date(e.activityDate))[0],d=c?Math.floor((o-new Date(c.activityDate))/864e5):l,u=e.nextActionDate?new Date(e.nextActionDate):null,m=u&&u<o,p=e.expectedCloseDate?new Date(e.expectedCloseDate):null,h=p?Math.floor((p-o)/864e5):null;return m||d>14?"at_risk":null!==h&&h<=7&&h>=0?"closing":r?d>3?"follow_up":"negotiation":i?"proposal":l<=3&&!c?"new_opportunity":"discovery"})();if(!i)return[];const s=si[i]||[],l=new Set(r.suggestedTasks.filter(e=>{const t=new Date(e.suggestedAt);return Math.floor((o-t)/864e5)<7}).map(e=>e.id)),c=new Set(r.completedTasks.filter(e=>{const t=new Date(e.completedAt);return Math.floor((o-t)/864e5)<30}).map(e=>e.id));return s.filter(e=>!l.has(e.id)&&!c.has(e.id)).map(e=>{const n=t().getTaskEffectiveness(e.id)*("high"===e.priority?3:"medium"===e.priority?2:1);return{...e,score:n,stage:i}}).sort((e,t)=>t.score-e.score).slice(0,3)},clearContext:n=>{const a=t().contexts,{[n]:r,...o}=a;e({contexts:o}),ci(o)},syncContextToSupabase:async(e,t)=>{if(kn())try{const{error:n}=await _n.from("deal_contexts").upsert({opportunity_id:e,suggested_tasks:t.suggestedTasks||[],completed_tasks:t.completedTasks||[],skipped_tasks:t.skippedTasks||[],milestones:t.milestones||[],notes:t.notes||[],last_interaction:t.lastInteraction,updated_at:(new Date).toISOString()},{onConflict:"opportunity_id"})}catch(Pc){}},syncPatternsToSupabase:async e=>{if(kn())try{const{data:t}=await _n.from("task_patterns").select("id").limit(1).single();t&&await _n.from("task_patterns").update({completed_tasks:e.completedTasks||[],skipped_tasks:e.skippedTasks||[],effectiveness:e.effectiveness||{},updated_at:(new Date).toISOString()}).eq("id",t.id)}catch(Pc){}},initialize:async()=>{if(e({loading:!0}),kn())try{const{data:t,error:n}=await _n.from("deal_contexts").select("*");if(!n&&t){const n={};t.forEach(e=>{n[e.opportunity_id]={opportunityId:e.opportunity_id,suggestedTasks:e.suggested_tasks||[],completedTasks:e.completed_tasks||[],skippedTasks:e.skipped_tasks||[],milestones:e.milestones||[],notes:e.notes||[],lastInteraction:e.last_interaction,createdAt:e.created_at,updatedAt:e.updated_at}}),e({contexts:n}),ci(n)}const{data:a,error:r}=await _n.from("task_patterns").select("*").limit(1).single();if(!r&&a){const t={completedTasks:a.completed_tasks||[],skippedTasks:a.skipped_tasks||[],effectiveness:a.effectiveness||{}};e({taskPatterns:t}),ui(t)}}catch(Pc){}e({loading:!1})}})));mi.subscribe(e=>e.contexts,e=>ci(e));const pi={MARKET_INSIGHT:"market_insight",PRICING_STRATEGY:"pricing_strategy",CLIENT_PREFERENCE:"client_preference",COMPETITOR_INTEL:"competitor_intel",PROCESS_TIP:"process_tip",REGIONAL_PATTERN:"regional_pattern"},hi={RESEARCH:"research",STRATEGY:"strategy",LEADGEN:"leadgen",FINANCE:"finance"};function fi(e){return{id:e.id,type:e.fragment_type,title:e.title,content:e.content,source:e.source,confidence:e.confidence,appliedToAgents:e.applied_to_agents||[],verified:e.verified,needsReview:e.needs_review,createdAt:e.created_at,updatedAt:e.updated_at,lastUsedAt:e.last_used_at,tags:e.tags||[],impactScore:e.impact_score,usageCount:e.usage_count,region:e.region,dealType:e.deal_type,expiresAt:e.expires_at}}function gi(e){return{id:e.id,agentName:e.agent_name,learningType:e.learning_type,context:e.context,outcome:e.outcome,lesson:e.lesson,confidenceScore:e.confidence_score,usageCount:e.usage_count,impactScore:e.impact_score,createdAt:e.created_at,verified:e.verified,quoteId:e.quote_id,opportunityId:e.opportunity_id}}const yi=h($n((e,t)=>({fragments:[],learnings:[],agentPrompts:{},loading:!1,error:null,initialize:async()=>{if(kn()){e({loading:!0,error:null});try{const{data:t,error:n}=await _n.from("knowledge_fragments").select("*").order("created_at",{ascending:!1}),{data:a,error:r}=await _n.from("agent_learnings").select("*").order("created_at",{ascending:!1}),{data:o,error:i}=await _n.from("agent_prompts").select("*").eq("active",!0),s=(t||[]).map(fi),l=(a||[]).map(gi),c={};(o||[]).forEach(e=>{c[e.agent_name]={version:e.prompt_version,basePrompt:e.base_prompt,learnedContext:e.learned_context,performanceScore:e.performance_score}}),e({fragments:s,learnings:l,agentPrompts:c,loading:!1,error:null})}catch(Pc){e({loading:!1,error:Pc.message})}}else e({loading:!1,error:"Supabase not configured"})},addFragment:async t=>{if(!kn())return e({error:"Supabase not configured"}),null;try{const n={type:t.type,title:t.title||"",content:t.content,source:t.source||"human_input",confidence:t.confidence||.7,appliedToAgents:t.appliedToAgents||Object.values(hi),verified:t.verified||!1,needsReview:!1,tags:t.tags||[],region:t.region||null,dealType:t.dealType||null},{data:a,error:r}=await _n.from("knowledge_fragments").insert(function(e){return{fragment_type:e.type,title:e.title,content:e.content,source:e.source||"human_input",confidence:e.confidence||.5,applied_to_agents:e.appliedToAgents||[],verified:e.verified||!1,needs_review:e.needsReview||!1,tags:e.tags||[],impact_score:e.impactScore||0,usage_count:e.usageCount||0,region:e.region||null,deal_type:e.dealType||null,expires_at:e.expiresAt||null}}(n)).select().single();if(r)throw r;const o=fi(a);return e(e=>({fragments:[o,...e.fragments],error:null})),o}catch(Pc){return e({error:Pc.message}),null}},updateFragment:async(t,n)=>{if(kn())try{const a={};void 0!==n.type&&(a.fragment_type=n.type),void 0!==n.title&&(a.title=n.title),void 0!==n.content&&(a.content=n.content),void 0!==n.confidence&&(a.confidence=n.confidence),void 0!==n.verified&&(a.verified=n.verified),void 0!==n.needsReview&&(a.needs_review=n.needsReview),void 0!==n.tags&&(a.tags=n.tags),void 0!==n.appliedToAgents&&(a.applied_to_agents=n.appliedToAgents),void 0!==n.region&&(a.region=n.region),void 0!==n.dealType&&(a.deal_type=n.dealType),a.updated_at=(new Date).toISOString();const{error:r}=await _n.from("knowledge_fragments").update(a).eq("id",t);if(r)throw r;e(e=>({fragments:e.fragments.map(e=>e.id===t?{...e,...n,updatedAt:a.updated_at}:e),error:null}))}catch(Pc){e({error:Pc.message})}else e({error:"Supabase not configured"})},verifyFragment:async e=>{await t().updateFragment(e,{verified:!0,needsReview:!1})},rejectFragment:async t=>{if(kn())try{const{error:n}=await _n.from("knowledge_fragments").delete().eq("id",t);if(n)throw n;e(e=>({fragments:e.fragments.filter(e=>e.id!==t),error:null}))}catch(Pc){e({error:Pc.message})}},deleteFragment:async e=>{await t().rejectFragment(e)},addLearning:async t=>{if(!kn())return e({error:"Supabase not configured"}),null;try{const{data:n,error:a}=await _n.from("agent_learnings").insert({agent_name:t.agentName,learning_type:t.learningType,context:t.context,outcome:t.outcome,lesson:t.lesson,confidence_score:t.confidenceScore||.5,verified:!1,quote_id:t.quoteId||null,opportunity_id:t.opportunityId||null}).select().single();if(a)throw a;const r=gi(n);return e(e=>({learnings:[r,...e.learnings],error:null})),r}catch(Pc){return e({error:Pc.message}),null}},verifyLearning:async t=>{if(kn())try{const{error:n}=await _n.from("agent_learnings").update({verified:!0}).eq("id",t);if(n)throw n;e(e=>({learnings:e.learnings.map(e=>e.id===t?{...e,verified:!0}:e),error:null}))}catch(Pc){e({error:Pc.message})}},getRelevantKnowledge:(e={})=>{const{fragments:n}=t(),{region:a,dealType:r,tags:o=[],agentName:i}=e;return n.filter(e=>{if(!e.verified)return!1;if(i&&e.appliedToAgents.length>0&&!e.appliedToAgents.includes(i))return!1;if(a&&e.region&&e.region!==a)return!1;if(r&&e.dealType&&e.dealType!==r)return!1;if(o.length>0&&e.tags.length>0){if(!o.some(t=>e.tags.includes(t)))return!1}return!0}).sort((e,t)=>t.impactScore!==e.impactScore?t.impactScore-e.impactScore:t.confidence-e.confidence).slice(0,20)},getRelevantLearnings:(e={})=>{const{learnings:n}=t(),{region:a,dealType:r,agentName:o}=e;return n.filter(e=>{if(!e.verified||e.confidenceScore<.5)return!1;if(o&&e.agentName!==o)return!1;if(e.context){if(a&&e.context.country&&e.context.country!==a&&e.context.region!==a)return!1;if(r&&e.context.deal_type&&e.context.deal_type!==r)return!1}return!0}).sort((e,t)=>t.confidenceScore-e.confidenceScore).slice(0,10)},getPendingReview:()=>{const{fragments:e,learnings:n}=t(),a=e.filter(e=>!e.verified||e.needsReview),r=n.filter(e=>!e.verified);return{fragments:a,learnings:r,totalCount:a.length+r.length}},getStats:()=>{const{fragments:e,learnings:n}=t(),a=e.filter(e=>e.verified),r={},o={};return e.forEach(e=>{r[e.type]=(r[e.type]||0)+1,e.region&&(o[e.region]=(o[e.region]||0)+1)}),{totalFragments:e.length,verifiedFragments:a.length,pendingVerification:e.length-a.length,totalLearnings:n.length,verifiedLearnings:n.filter(e=>e.verified).length,byType:r,byRegion:o,avgConfidence:a.length>0?a.reduce((e,t)=>e+t.confidence,0)/a.length:0}},buildAgentPrompt:async(e,n={})=>{const{agentPrompts:a}=t(),r=a[e]?.basePrompt||"",o=t().getRelevantKnowledge({...n,agentName:e}),i=t().getRelevantLearnings({...n,agentName:e});let s=r;return o.length>0&&(s+="\n\nACCUMULATED KNOWLEDGE (verified by human):\n",s+=o.map(e=>`- ${e.content} [confidence: ${(100*e.confidence).toFixed(0)}%]`).join("\n")),i.length>0&&(s+="\n\nLEARNINGS FROM PAST DEALS:\n",s+=i.map(e=>`- ${e.lesson} [from: ${e.learningType}, confidence: ${(100*e.confidenceScore).toFixed(0)}%]`).join("\n")),n.currentTask&&(s+=`\n\nCURRENT TASK:\n${n.currentTask}`),s},clearError:()=>{e({error:null})}}))),bi={Camera:"equip_cameras",Lens:"equip_cameras",Tripod:"equip_other",Audio:"equip_audio",Comms:"equip_audio",Graphics:"equip_graphics",Switching:"equip_video",Streaming:"equip_video",Cabling:"equip_cabling",Power:"equip_other",Lighting:"equip_other",Monitors:"equip_video",Storage:"equip_other",Rigging:"equip_other",Network:"equip_other",Other:"equip_other"},vi=async(e,t)=>{const n=qa.getState(),a=bi[t]||"equip_other";if(!e.dayRate&&!e.weekRate&&!e.monthRate)return null;if(e.rateCardItemId){if(n.items.find(t=>t.id===e.rateCardItemId)){const t={SEA:{cost:{amount:e.dayRate||0,baseCurrency:e.rateCurrency||"USD"},charge:{amount:Math.round(1.3*(e.dayRate||0)),baseCurrency:e.rateCurrency||"USD"}}};return n.updateItem(e.rateCardItemId,{pricing:t}),e.rateCardItemId}}const r=await n.addItem({name:e.name,description:`${e.manufacturer||""} ${e.model||""}`.trim()||e.name,section:a,unit:"day",itemType:Ia.EQUIPMENT,kitItemId:e.id,pricing:{SEA:{cost:{amount:e.dayRate||0,baseCurrency:e.rateCurrency||"USD"},charge:{amount:Math.round(1.3*(e.dayRate||0)),baseCurrency:e.rateCurrency||"USD"}}}});return r?.id||null},xi={AVAILABLE:"available",ON_JOB:"on_job",MAINTENANCE:"maintenance",SOLD:"sold",RETIRED:"retired",LOST:"lost"},wi={[xi.AVAILABLE]:{label:"Available",color:"text-green-400",bg:"bg-green-500/20"},[xi.ON_JOB]:{label:"On Job",color:"text-blue-400",bg:"bg-blue-500/20"},[xi.MAINTENANCE]:{label:"Maintenance",color:"text-amber-400",bg:"bg-amber-500/20"},[xi.SOLD]:{label:"Sold",color:"text-gray-400",bg:"bg-gray-500/20"},[xi.RETIRED]:{label:"Retired",color:"text-gray-500",bg:"bg-gray-600/20"},[xi.LOST]:{label:"Lost",color:"text-red-400",bg:"bg-red-500/20"}},_i={EXCELLENT:"excellent",GOOD:"good",FAIR:"fair",POOR:"poor"},ki={[_i.EXCELLENT]:{label:"Excellent",color:"text-green-400"},[_i.GOOD]:{label:"Good",color:"text-blue-400"},[_i.FAIR]:{label:"Fair",color:"text-amber-400"},[_i.POOR]:{label:"Poor",color:"text-red-400"}},Si=[{id:"camera",name:"Camera",color:"#3B82F6",icon:"video",prefix:"CAM"},{id:"lens",name:"Lens",color:"#8B5CF6",icon:"aperture",prefix:"LENS"},{id:"tripod",name:"Tripod",color:"#10B981",icon:"maximize",prefix:"TRI"},{id:"audio",name:"Audio",color:"#F59E0B",icon:"mic",prefix:"AUD"},{id:"comms",name:"Comms",color:"#EF4444",icon:"headphones",prefix:"COM"},{id:"graphics",name:"Graphics",color:"#EC4899",icon:"monitor",prefix:"GFX"},{id:"switching",name:"Switching",color:"#6366F1",icon:"grid",prefix:"SWT"},{id:"streaming",name:"Streaming",color:"#14B8A6",icon:"wifi",prefix:"STR"},{id:"cabling",name:"Cabling",color:"#6B7280",icon:"cable",prefix:"CBL"},{id:"power",name:"Power",color:"#84CC16",icon:"battery",prefix:"PWR"},{id:"lighting",name:"Lighting",color:"#FBBF24",icon:"sun",prefix:"LGT"},{id:"monitors",name:"Monitors",color:"#0EA5E9",icon:"tv",prefix:"MON"},{id:"storage",name:"Storage",color:"#78716C",icon:"package",prefix:"STG"},{id:"rigging",name:"Rigging",color:"#A3A3A3",icon:"tool",prefix:"RIG"},{id:"network",name:"Network",color:"#22D3EE",icon:"network",prefix:"NET"},{id:"other",name:"Other",color:"#9CA3AF",icon:"more-horizontal",prefix:"OTH"}],Ci=["KL Office","Kuwait Office","Bangkok Storage","On Location"];function Ni(e){return{id:e.id,kitId:e.kit_id,name:e.name,categoryId:e.category_id,categoryName:e.category_name,categoryColor:e.category_color,manufacturer:e.manufacturer,model:e.model,serialNumber:e.serial_number,purchaseDate:e.purchase_date,purchasePrice:e.purchase_price,purchaseCurrency:e.purchase_currency||"USD",currentValue:e.current_value,calculatedValue:e.calculated_value,depreciationRate:e.depreciation_rate,rateCardItemId:e.rate_card_item_id,dayRate:e.day_rate,weekRate:e.week_rate,monthRate:e.month_rate,rateCurrency:e.rate_currency||"USD",location:e.location,status:e.status||"available",condition:e.condition||"good",parentKitId:e.parent_kit_id,parentKitCode:e.parent_kit_code,parentName:e.parent_name,isPackage:e.is_package,childCount:e.child_count||0,quantity:e.quantity||1,quantityAvailable:e.quantity_available||e.quantity||1,specs:e.specs||{},technicalTags:e.technical_tags||[],operationalTags:e.operational_tags||[],jobTypeTags:e.job_type_tags||[],lastUsedDate:e.last_used_date,totalDaysUsed:e.total_days_used||0,totalRevenue:e.total_revenue||0,expectedLifespanMonths:e.expected_lifespan_months,ageMonths:e.age_months,daysSinceLastUse:e.days_since_last_use,replacementDueDate:e.replacement_due_date,insured:e.insured,insuranceValue:e.insurance_value,insurancePolicyRef:e.insurance_policy_ref,notes:e.notes,imageUrl:e.image_url,imagePath:e.image_path,manualUrl:e.manual_url,qrCode:e.qr_code,createdAt:e.created_at,updatedAt:e.updated_at}}function ji(e){const t={};return void 0!==e.kitId&&(t.kit_id=e.kitId),void 0!==e.name&&(t.name=e.name),void 0!==e.categoryId&&(t.category_id=e.categoryId),void 0!==e.manufacturer&&(t.manufacturer=e.manufacturer),void 0!==e.model&&(t.model=e.model),void 0!==e.serialNumber&&(t.serial_number=e.serialNumber),void 0!==e.purchaseDate&&(t.purchase_date=e.purchaseDate),void 0!==e.purchasePrice&&(t.purchase_price=e.purchasePrice),void 0!==e.purchaseCurrency&&(t.purchase_currency=e.purchaseCurrency),void 0!==e.currentValue&&(t.current_value=e.currentValue),void 0!==e.depreciationRate&&(t.depreciation_rate=e.depreciationRate),void 0!==e.rateCardItemId&&(t.rate_card_item_id=e.rateCardItemId),void 0!==e.dayRate&&(t.day_rate=e.dayRate),void 0!==e.weekRate&&(t.week_rate=e.weekRate),void 0!==e.monthRate&&(t.month_rate=e.monthRate),void 0!==e.rateCurrency&&(t.rate_currency=e.rateCurrency),void 0!==e.location&&(t.location=e.location),void 0!==e.status&&(t.status=e.status),void 0!==e.condition&&(t.condition=e.condition),void 0!==e.parentKitId&&(t.parent_kit_id=e.parentKitId),void 0!==e.isPackage&&(t.is_package=e.isPackage),void 0!==e.quantity&&(t.quantity=e.quantity),void 0!==e.quantityAvailable&&(t.quantity_available=e.quantityAvailable),void 0!==e.specs&&(t.specs=e.specs),void 0!==e.technicalTags&&(t.technical_tags=e.technicalTags),void 0!==e.operationalTags&&(t.operational_tags=e.operationalTags),void 0!==e.jobTypeTags&&(t.job_type_tags=e.jobTypeTags),void 0!==e.lastUsedDate&&(t.last_used_date=e.lastUsedDate),void 0!==e.expectedLifespanMonths&&(t.expected_lifespan_months=e.expectedLifespanMonths),void 0!==e.insured&&(t.insured=e.insured),void 0!==e.insuranceValue&&(t.insurance_value=e.insuranceValue),void 0!==e.insurancePolicyRef&&(t.insurance_policy_ref=e.insurancePolicyRef),void 0!==e.notes&&(t.notes=e.notes),void 0!==e.imageUrl&&(t.image_url=e.imageUrl),void 0!==e.imagePath&&(t.image_path=e.imagePath),void 0!==e.manualUrl&&(t.manual_url=e.manualUrl),t}const Ti=h($n((e,t)=>({items:[],categories:Si,locations:Ci,bookings:[],loading:!1,error:null,filters:{search:"",category:null,status:null,location:null,parentOnly:!1},initialize:async()=>{if(kn()){e({loading:!0,error:null});try{const{data:t,error:n}=await _n.from("kit_categories").select("*").order("sort_order");if(!n&&t&&t.length>0){const n=t.map(e=>({id:e.id,name:e.name,description:e.description,color:e.color,icon:e.icon,prefix:e.name.substring(0,3).toUpperCase()}));e({categories:n})}const{data:a,error:r}=await _n.from("kit_locations").select("name").order("name");!r&&a&&e({locations:a.map(e=>e.name)});const{data:o,error:i}=await _n.from("kit_items_extended").select("*").order("kit_id");if(i){const{data:t,error:n}=await _n.from("kit_items").select("*").order("kit_id");if(n)throw n;const a=(t||[]).map(Ni);e({items:a,loading:!1,error:null})}else{const t=(o||[]).map(Ni);e({items:t,loading:!1,error:null})}}catch(Pc){e({loading:!1,error:Pc.message})}}else e({loading:!1,error:"Supabase not configured"})},addItem:async n=>{if(!kn())return e({error:"Supabase not configured"}),null;try{const a=ji(n),{data:r,error:o}=await _n.from("kit_items").insert(a).select().single();if(o)throw o;const i=Ni(r);if(e(e=>({items:[...e.items,i],error:null})),i.dayRate||i.weekRate||i.monthRate){const a=n.categoryName||t().categories.find(e=>e.id===i.categoryId)?.name,r=await vi(i,a);r&&!i.rateCardItemId&&(await _n.from("kit_items").update({rate_card_item_id:r}).eq("id",i.id),e(e=>({items:e.items.map(e=>e.id===i.id?{...e,rateCardItemId:r}:e)})))}return i}catch(Pc){return e({error:Pc.message}),null}},updateItem:async(n,a)=>{if(kn())try{const r=ji(a),{error:o}=await _n.from("kit_items").update(r).eq("id",n);if(o)throw o;if(e(e=>({items:e.items.map(e=>e.id===n?{...e,...a}:e),error:null})),void 0!==a.dayRate||void 0!==a.weekRate||void 0!==a.monthRate){const a=t().items.find(e=>e.id===n);if(a){const r=a.categoryName||t().categories.find(e=>e.id===a.categoryId)?.name,o=await vi(a,r);o&&!a.rateCardItemId&&(await _n.from("kit_items").update({rate_card_item_id:o}).eq("id",n),e(e=>({items:e.items.map(e=>e.id===n?{...e,rateCardItemId:o}:e)})))}}}catch(Pc){e({error:Pc.message})}else e({error:"Supabase not configured"})},deleteItem:async t=>{if(kn())try{const{error:n}=await _n.from("kit_items").delete().eq("id",t);if(n)throw n;e(e=>({items:e.items.filter(e=>e.id!==t),error:null}))}catch(Pc){e({error:Pc.message})}else e({error:"Supabase not configured"})},syncAllToRateCard:async()=>{const{items:n,categories:a}=t();let r=0,o=0;for(const t of n)if(t.dayRate||t.weekRate||t.monthRate)try{const n=t.categoryName||a.find(e=>e.id===t.categoryId)?.name,o=await vi(t,n);o&&!t.rateCardItemId&&(await _n.from("kit_items").update({rate_card_item_id:o}).eq("id",t.id),e(e=>({items:e.items.map(e=>e.id===t.id?{...e,rateCardItemId:o}:e)}))),r++}catch(Pc){o++}return{syncedCount:r,errorCount:o}},generateKitId:async e=>{const{items:n,categories:a}=t(),r=a.find(t=>t.name===e||t.id===e),o=r?.prefix||e.substring(0,3).toUpperCase(),i=n.filter(e=>e.kitId&&e.kitId.startsWith(o+"-")).map(e=>{const t=e.kitId.match(new RegExp(`${o}-(\\d+)`));return t?parseInt(t[1],10):0}),s=i.length>0?Math.max(...i)+1:1;return`${o}-${String(s).padStart(3,"0")}`},getChildren:e=>{const{items:n}=t();return n.filter(t=>t.parentKitId===e)},getPackages:()=>{const{items:e}=t();return e.filter(e=>e.isPackage||e.childCount>0)},getAvailable:()=>{const{items:e}=t();return e.filter(e=>e.status===xi.AVAILABLE)},getByCategory:e=>{const{items:n}=t();return n.filter(t=>t.categoryId===e)},getByLocation:e=>{const{items:n}=t();return n.filter(t=>t.location===e)},getFilteredItems:()=>{const{items:e,filters:n}=t();let a=[...e];if(n.search){const e=n.search.toLowerCase();a=a.filter(t=>t.kitId?.toLowerCase().includes(e)||t.name?.toLowerCase().includes(e)||t.manufacturer?.toLowerCase().includes(e)||t.model?.toLowerCase().includes(e)||t.serialNumber?.toLowerCase().includes(e))}return n.category&&(a=a.filter(e=>e.categoryId===n.category||e.categoryName===n.category)),n.status&&(a=a.filter(e=>e.status===n.status)),n.location&&(a=a.filter(e=>e.location===n.location)),n.parentOnly&&(a=a.filter(e=>!e.parentKitId)),a},setFilters:t=>{e(e=>({filters:{...e.filters,...t}}))},clearFilters:()=>{e({filters:{search:"",category:null,status:null,location:null,parentOnly:!1}})},getStats:()=>{const{items:e}=t(),n=e.reduce((e,t)=>e+(t.currentValue||t.purchasePrice||0),0),a=e.reduce((e,t)=>e+(t.totalRevenue||0),0),r={},o={},i={};e.forEach(e=>{r[e.status]=(r[e.status]||0)+1,e.categoryName&&(o[e.categoryName]=(o[e.categoryName]||0)+1),e.location&&(i[e.location]=(i[e.location]||0)+1)});const s=e.filter(e=>"poor"===e.condition).length,l=e.filter(e=>e.daysSinceLastUse&&e.daysSinceLastUse>180).length;return{totalItems:e.length,totalValue:n,totalRevenue:a,byStatus:r,byCategory:o,byLocation:i,needsMaintenance:s,deadStock:l,availableCount:r[xi.AVAILABLE]||0,onJobCount:r[xi.ON_JOB]||0}},clearError:()=>{e({error:null})},uploadImage:async(n,a)=>{if(!kn())return e({error:"Supabase not configured"}),null;try{const{items:e}=t(),r=e.find(e=>e.id===n),o=r?.kitId||n,i=await async function(e,t){if(!_n)throw new Error("Supabase not configured");try{const n=e.name.split(".").pop(),a=`${t}-${Date.now()}.${n}`,{data:r,error:o}=await _n.storage.from(Sn).upload(a,e,{cacheControl:"3600",upsert:!1});if(o)throw o;const{data:{publicUrl:i}}=_n.storage.from(Sn).getPublicUrl(a);return{url:i,path:r.path}}catch(n){throw n}}(a,o);return i&&await t().updateItem(n,{imageUrl:i.url,imagePath:i.path}),i}catch(Pc){return e({error:Pc.message}),null}},removeImage:async n=>{if(kn())try{const{items:e}=t(),a=e.find(e=>e.id===n);a?.imagePath&&await async function(e){if(_n&&e)try{const{error:t}=await _n.storage.from(Sn).remove([e]);if(t)throw t}catch(t){throw t}}(a.imagePath),await t().updateItem(n,{imageUrl:null,imagePath:null})}catch(Pc){e({error:Pc.message})}else e({error:"Supabase not configured"})},exportToCSV:(e={})=>{const{items:n,categories:a}=t(),{includeFinancial:r=!0,includeRates:o=!0}=e,i=["Kit ID","Name","Category","Manufacturer","Model","Serial Number","Status","Condition","Location","Quantity","Available"];r&&i.push("Purchase Date","Purchase Price","Currency","Current Value"),o&&i.push("Day Rate","Week Rate","Month Rate","Rate Currency"),i.push("Notes","Tags");let s=i.join(",")+"\n";n.forEach(e=>{const t=a.find(t=>t.id===e.categoryId),n=[...e.technicalTags||[],...e.operationalTags||[],...e.jobTypeTags||[]].join("; "),i=[e.kitId||"",`"${(e.name||"").replace(/"/g,'""')}"`,t?.name||e.categoryName||"",`"${(e.manufacturer||"").replace(/"/g,'""')}"`,`"${(e.model||"").replace(/"/g,'""')}"`,e.serialNumber||"",e.status||"available",e.condition||"good",e.location||"",e.quantity||1,e.quantityAvailable||e.quantity||1];r&&i.push(e.purchaseDate||"",e.purchasePrice||"",e.purchaseCurrency||"USD",e.currentValue||e.calculatedValue||""),o&&i.push(e.dayRate||"",e.weekRate||"",e.monthRate||"",e.rateCurrency||"USD"),i.push(`"${(e.notes||"").replace(/"/g,'""')}"`,`"${n}"`),s+=i.join(",")+"\n"});const l=new Blob([s],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(l),d=document.createElement("a");d.href=c,d.download=`kit-list-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c)},exportPublicList:()=>{const{items:e,categories:n}=t();let a=["Code","Equipment","Category","Manufacturer","Model","Status","Availability","Day Rate","Week Rate"].join(",")+"\n";e.filter(e=>"available"===e.status||"on_job"===e.status).forEach(e=>{const t=n.find(t=>t.id===e.categoryId),r=[e.kitId||"",`"${(e.name||"").replace(/"/g,'""')}"`,t?.name||e.categoryName||"",e.manufacturer||"",e.model||"","available"===e.status?"Available":"In Use",e.quantityAvailable||0,e.dayRate?`$${e.dayRate}`:"POA",e.weekRate?`$${e.weekRate}`:"POA"];a+=r.join(",")+"\n"});const r=new Blob([a],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(r),i=document.createElement("a");i.href=o,i.download=`tell-equipment-list-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)}}))),Ii=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_CATEGORIES:Si,DEFAULT_LOCATIONS:Ci,KIT_CONDITION:_i,KIT_CONDITION_CONFIG:ki,KIT_STATUS:xi,KIT_STATUS_CONFIG:wi,useKitStore:Ti},Symbol.toStringTag,{value:"Module"})),Di={OPERATIONS:"Operations",GRAPHICS:"Graphics",EQUIPMENT:"Equipment",COMMERCIAL:"Commercial"},Ei={[Di.OPERATIONS]:{color:"bg-blue-500/10 text-blue-400 border-blue-500/30",icon:"",description:"Production workflows and operational procedures"},[Di.GRAPHICS]:{color:"bg-purple-500/10 text-purple-400 border-purple-500/30",icon:"",description:"Graphics, branding, and visual asset guidelines"},[Di.EQUIPMENT]:{color:"bg-green-500/10 text-green-400 border-green-500/30",icon:"",description:"Equipment handling, maintenance, and setup"},[Di.COMMERCIAL]:{color:"bg-orange-500/10 text-orange-400 border-orange-500/30",icon:"",description:"Sales, billing, and client management"}},Li=[{id:"ops-1",title:"Pre-Production Checklist",category:Di.OPERATIONS,description:"Complete checklist before any shoot day",checklist:[{id:"ops-1-1",text:"Confirm call times with all crew members",completed:!1},{id:"ops-1-2",text:"Review location access and parking details",completed:!1},{id:"ops-1-3",text:"Confirm catering and craft services",completed:!1},{id:"ops-1-4",text:"Verify transport arrangements",completed:!1},{id:"ops-1-5",text:"Check weather forecast and contingency plans",completed:!1},{id:"ops-1-6",text:"Distribute call sheets to all stakeholders",completed:!1},{id:"ops-1-7",text:"Confirm equipment delivery/pickup times",completed:!1},{id:"ops-1-8",text:"Brief production assistants on duties",completed:!1}],tags:["production","shoot","prep"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"ops-2",title:"Live Broadcast Setup",category:Di.OPERATIONS,description:"Setup checklist for live broadcast productions",checklist:[{id:"ops-2-1",text:"Test all communication channels (comms/IFB)",completed:!1},{id:"ops-2-2",text:"Verify uplink/streaming connection",completed:!1},{id:"ops-2-3",text:"Run full technical rehearsal",completed:!1},{id:"ops-2-4",text:"Test backup systems and failover",completed:!1},{id:"ops-2-5",text:"Confirm graphics and lower thirds",completed:!1},{id:"ops-2-6",text:"Brief talent on rundown and timings",completed:!1},{id:"ops-2-7",text:"Verify recording backup is running",completed:!1}],tags:["broadcast","live","technical"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"ops-3",title:"Post-Production Wrap",category:Di.OPERATIONS,description:"End of production day checklist",checklist:[{id:"ops-3-1",text:"Backup all media to multiple locations",completed:!1},{id:"ops-3-2",text:"Complete equipment return inventory",completed:!1},{id:"ops-3-3",text:"Submit crew timesheets and expenses",completed:!1},{id:"ops-3-4",text:"Send wrap report to production team",completed:!1},{id:"ops-3-5",text:"Update production schedule if needed",completed:!1},{id:"ops-3-6",text:"Clear and secure location",completed:!1}],tags:["wrap","post","admin"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"gfx-1",title:"Brand Package Delivery",category:Di.GRAPHICS,description:"Delivering graphics package to client",checklist:[{id:"gfx-1-1",text:"Export all graphics in required formats (PNG, MOV, etc.)",completed:!1},{id:"gfx-1-2",text:"Include all color profiles and specifications",completed:!1},{id:"gfx-1-3",text:"Provide font files with licensing information",completed:!1},{id:"gfx-1-4",text:"Create usage guidelines document",completed:!1},{id:"gfx-1-5",text:"Organize files in clear folder structure",completed:!1},{id:"gfx-1-6",text:"Generate preview/thumbnail images",completed:!1},{id:"gfx-1-7",text:"Send delivery confirmation to client",completed:!1}],tags:["graphics","branding","delivery"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"gfx-2",title:"Lower Thirds & Bug Setup",category:Di.GRAPHICS,description:"Preparing on-air graphics elements",checklist:[{id:"gfx-2-1",text:"Verify correct sponsor logos and placements",completed:!1},{id:"gfx-2-2",text:"Check all name spellings and titles",completed:!1},{id:"gfx-2-3",text:"Test graphics in broadcast system",completed:!1},{id:"gfx-2-4",text:"Verify safe zone compliance",completed:!1},{id:"gfx-2-5",text:"Prepare backup graphics package",completed:!1},{id:"gfx-2-6",text:"Brief graphics operator on triggers",completed:!1}],tags:["broadcast","graphics","on-air"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"gfx-3",title:"Social Media Asset Creation",category:Di.GRAPHICS,description:"Creating graphics for social platforms",checklist:[{id:"gfx-3-1",text:"Create assets in all required dimensions",completed:!1},{id:"gfx-3-2",text:"Optimize file sizes for web delivery",completed:!1},{id:"gfx-3-3",text:"Include alt text descriptions",completed:!1},{id:"gfx-3-4",text:"Verify brand color accuracy across displays",completed:!1},{id:"gfx-3-5",text:"Export animated versions if required",completed:!1},{id:"gfx-3-6",text:"Get client approval before publishing",completed:!1}],tags:["social","digital","content"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"eq-1",title:"Camera Prep & Check",category:Di.EQUIPMENT,description:"Pre-shoot camera preparation",checklist:[{id:"eq-1-1",text:"Clean sensor and lens elements",completed:!1},{id:"eq-1-2",text:"Format all media cards",completed:!1},{id:"eq-1-3",text:"Charge all batteries (min 4x per camera)",completed:!1},{id:"eq-1-4",text:"Update firmware if required",completed:!1},{id:"eq-1-5",text:"Set correct frame rate and codec",completed:!1},{id:"eq-1-6",text:"Calibrate white balance/color profiles",completed:!1},{id:"eq-1-7",text:"Test all lenses for focus accuracy",completed:!1},{id:"eq-1-8",text:"Pack backup camera body",completed:!1}],tags:["camera","prep","technical"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"eq-2",title:"Audio Kit Preparation",category:Di.EQUIPMENT,description:"Audio equipment checklist before shoot",checklist:[{id:"eq-2-1",text:"Test all wireless frequencies",completed:!1},{id:"eq-2-2",text:"Check and charge all transmitter batteries",completed:!1},{id:"eq-2-3",text:"Pack spare lavalier capsules",completed:!1},{id:"eq-2-4",text:"Test all XLR cables for faults",completed:!1},{id:"eq-2-5",text:"Verify mixer/recorder settings",completed:!1},{id:"eq-2-6",text:"Include windshields and dead cats",completed:!1},{id:"eq-2-7",text:"Pack headphones for monitoring",completed:!1}],tags:["audio","sound","technical"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"eq-3",title:"Equipment Return & Inventory",category:Di.EQUIPMENT,description:"Post-shoot equipment return process",checklist:[{id:"eq-3-1",text:"Inventory all returned items against packing list",completed:!1},{id:"eq-3-2",text:"Document any damage or issues",completed:!1},{id:"eq-3-3",text:"Clean all equipment before storage",completed:!1},{id:"eq-3-4",text:"Recharge all batteries for next use",completed:!1},{id:"eq-3-5",text:"Update equipment availability in system",completed:!1},{id:"eq-3-6",text:"Log maintenance needs for repairs",completed:!1},{id:"eq-3-7",text:"Store in designated locations",completed:!1}],tags:["inventory","return","maintenance"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"com-1",title:"New Client Onboarding",category:Di.COMMERCIAL,description:"Steps for onboarding new clients",checklist:[{id:"com-1-1",text:"Schedule discovery/kickoff meeting",completed:!1},{id:"com-1-2",text:"Collect company details and billing info",completed:!1},{id:"com-1-3",text:"Create client record in CRM",completed:!1},{id:"com-1-4",text:"Set up communication channels (Slack, etc.)",completed:!1},{id:"com-1-5",text:"Send welcome package with company info",completed:!1},{id:"com-1-6",text:"Assign account manager/primary contact",completed:!1},{id:"com-1-7",text:"Schedule follow-up check-in",completed:!1}],tags:["client","onboarding","sales"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"com-2",title:"Quote to Invoice Workflow",category:Di.COMMERCIAL,description:"Converting approved quotes to invoices",checklist:[{id:"com-2-1",text:"Verify all line items match final scope",completed:!1},{id:"com-2-2",text:"Confirm payment terms with client",completed:!1},{id:"com-2-3",text:"Generate invoice from approved quote",completed:!1},{id:"com-2-4",text:"Add correct billing address and PO number",completed:!1},{id:"com-2-5",text:"Review for accuracy before sending",completed:!1},{id:"com-2-6",text:"Send invoice with payment instructions",completed:!1},{id:"com-2-7",text:"Set payment reminder in system",completed:!1},{id:"com-2-8",text:"Mark opportunity as Won",completed:!1}],tags:["invoice","billing","finance"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"com-3",title:"Proposal Submission",category:Di.COMMERCIAL,description:"Submitting proposals to prospective clients",checklist:[{id:"com-3-1",text:"Review RFP/brief thoroughly",completed:!1},{id:"com-3-2",text:"Build detailed cost breakdown",completed:!1},{id:"com-3-3",text:"Include case studies and references",completed:!1},{id:"com-3-4",text:"Get internal approval on pricing",completed:!1},{id:"com-3-5",text:"Create professional PDF proposal",completed:!1},{id:"com-3-6",text:"Proofread all content",completed:!1},{id:"com-3-7",text:"Submit before deadline",completed:!1},{id:"com-3-8",text:"Schedule follow-up call with client",completed:!1}],tags:["proposal","sales","pitch"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"com-4",title:"Project Closeout",category:Di.COMMERCIAL,description:"Final steps after project completion",checklist:[{id:"com-4-1",text:"Send final deliverables to client",completed:!1},{id:"com-4-2",text:"Collect client feedback/testimonial",completed:!1},{id:"com-4-3",text:"Reconcile all expenses and costs",completed:!1},{id:"com-4-4",text:"Issue final invoice for remaining balance",completed:!1},{id:"com-4-5",text:"Update project records and lessons learned",completed:!1},{id:"com-4-6",text:"Archive project files",completed:!1},{id:"com-4-7",text:"Schedule future touchpoint with client",completed:!1}],tags:["closeout","project","admin"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}],Ai=()=>{try{const e=localStorage.getItem("sop_collapsed_state");return e?JSON.parse(e):{}}catch{return{}}},Pi=h($n((e,t)=>({sops:[],isLoading:!1,error:null,collapsedSops:Ai(),toggleCollapsed:t=>{e(e=>{const n={...e.collapsedSops,[t]:!e.collapsedSops[t]};return(e=>{try{localStorage.setItem("sop_collapsed_state",JSON.stringify(e))}catch(Pc){}})(n),{collapsedSops:n}})},isCollapsed:e=>t().collapsedSops[e]||!1,initialize:async()=>{e({isLoading:!0});try{const{data:t,error:n}=await _n.from("sops").select("*").order("created_at",{ascending:!1});if(n)throw n;if(t&&t.length>0){const n=t.map(Oi);e({sops:n,isLoading:!1})}else{const{data:t,error:n}=await _n.from("sops").insert(Li.map(Ri)).select();if(n)throw n;e({sops:t?t.map(Oi):Li,isLoading:!1})}}catch(t){e({sops:Li,isLoading:!1})}},addSop:async t=>{const n={id:crypto.randomUUID(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),checklist:t.checklist||[],tags:t.tags||[],...t};e(e=>({sops:[n,...e.sops]}));try{const{error:e}=await _n.from("sops").insert(Ri(n));if(e)throw e}catch(a){}return n},updateSop:async(n,a)=>{const r={...a,updatedAt:(new Date).toISOString()};e(e=>({sops:e.sops.map(e=>e.id===n?{...e,...r}:e)}));try{const e=t().sops.find(e=>e.id===n);if(e){const{error:t}=await _n.from("sops").update(Ri({...e,...r})).eq("id",n);if(t)throw t}}catch(o){}},deleteSop:async t=>{e(e=>({sops:e.sops.filter(e=>e.id!==t)}));try{const{error:e}=await _n.from("sops").delete().eq("id",t);if(e)throw e}catch(n){}},toggleChecklistItem:async(e,n)=>{const a=t().sops.find(t=>t.id===e);if(!a)return;const r=a.checklist.map(e=>e.id===n?{...e,completed:!e.completed}:e);await t().updateSop(e,{checklist:r})},addChecklistItem:async(e,n)=>{const a=t().sops.find(t=>t.id===e);if(!a)return;const r={id:crypto.randomUUID(),text:n,completed:!1},o=[...a.checklist,r];return await t().updateSop(e,{checklist:o}),r},removeChecklistItem:async(e,n)=>{const a=t().sops.find(t=>t.id===e);if(!a)return;const r=a.checklist.filter(e=>e.id!==n);await t().updateSop(e,{checklist:r})},updateChecklistItemText:async(e,n,a)=>{const r=t().sops.find(t=>t.id===e);if(!r)return;const o=r.checklist.map(e=>e.id===n?{...e,text:a}:e);await t().updateSop(e,{checklist:o})},getByCategory:e=>t().sops.filter(t=>t.category===e),getCompletionPercentage:e=>{const n=t().sops.find(t=>t.id===e);if(!n||!n.checklist?.length)return 0;const a=n.checklist.filter(e=>e.completed).length;return Math.round(a/n.checklist.length*100)},resetChecklist:async e=>{const n=t().sops.find(t=>t.id===e);if(!n)return;const a=n.checklist.map(e=>({...e,completed:!1}));await t().updateSop(e,{checklist:a})},duplicateSop:async e=>{const n=t().sops.find(t=>t.id===e);if(!n)return;const a={...n,id:crypto.randomUUID(),title:`${n.title} (Copy)`,checklist:n.checklist.map(e=>({...e,id:crypto.randomUUID(),completed:!1})),photos:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return await t().addSop(a)},updateSopPhotos:async(e,n)=>{await t().updateSop(e,{photos:n})}})));function Ri(e){return{id:e.id,title:e.title,category:e.category,description:e.description||"",checklist:e.checklist||[],tags:e.tags||[],photos:e.photos||[],created_at:e.createdAt,updated_at:e.updatedAt}}function Oi(e){return{id:e.id,title:e.title,category:e.category,description:e.description||"",checklist:e.checklist||[],tags:e.tags||[],photos:e.photos||[],createdAt:e.created_at,updatedAt:e.updated_at}}const Mi={draft:{label:"Draft",color:"gray"},confirmed:{label:"Confirmed",color:"blue"},in_progress:{label:"In Progress",color:"yellow"},wrapped:{label:"Wrapped",color:"green"},closed:{label:"Closed",color:"purple"},cancelled:{label:"Cancelled",color:"red"}};function qi(e){return{id:e.id,projectCode:e.project_code,name:e.name,opportunityId:e.opportunity_id,quoteId:e.quote_id,clientId:e.client_id,client:e.client||{},description:e.description||"",region:e.region||"",country:e.country||"",startDate:e.start_date,endDate:e.end_date,status:e.status||"draft",currency:e.currency||"USD",budgetTotal:e.budget_total||0,budgetBreakdown:e.budget_breakdown||{},actualsTotal:e.actuals_total||0,actualsBreakdown:e.actuals_breakdown||{},projectManagerId:e.project_manager_id,projectManagerName:e.project_manager_name||"",settings:e.settings||{},notes:e.notes||"",tags:e.tags||[],confirmedAt:e.confirmed_at,startedAt:e.started_at,wrappedAt:e.wrapped_at,closedAt:e.closed_at,createdAt:e.created_at,updatedAt:e.updated_at}}const zi=h($n((e,t)=>({projects:[],loading:!1,error:null,realtimeSubscription:null,initialize:async()=>{if(kn()){e({loading:!0,error:null});try{const{data:n,error:a}=await _n.from("projects").select("*").order("created_at",{ascending:!1});if(a)throw a;const r=(n||[]).map(qi);e({projects:r,loading:!1,error:null}),t().subscribeToRealtime()}catch(Pc){e({loading:!1,error:Pc.message})}}else e({loading:!1,error:"Supabase not configured"})},subscribeToRealtime:()=>{if(!kn())return;const n=t().realtimeSubscription;n&&_n.removeChannel(n);const a=_n.channel("projects-realtime").on("postgres_changes",{event:"*",schema:"public",table:"projects"},t=>{const{eventType:n,new:a,old:r}=t;e(e=>{let t=[...e.projects];if("INSERT"===n){t.find(e=>e.id===a.id)||(t=[qi(a),...t])}else"UPDATE"===n?t=t.map(e=>e.id===a.id?qi(a):e):"DELETE"===n&&(t=t.filter(e=>e.id!==r.id));return{projects:t}})}).subscribe();e({realtimeSubscription:a})},unsubscribe:()=>{const n=t().realtimeSubscription;n&&(_n.removeChannel(n),e({realtimeSubscription:null}))},generateProjectCode:async()=>{if(!kn())return null;try{const{data:e,error:t}=await _n.rpc("generate_project_code");if(t)throw t;return e}catch(Pc){const n=(new Date).toISOString().slice(0,7).replace("-",""),a=t().projects,r=`PRJ-${n}-`,o=a.filter(e=>e.projectCode?.startsWith(r)).length+1;return`${r}${String(o).padStart(3,"0")}`}},addProject:async n=>{if(!kn())return e({error:"Supabase not configured"}),null;try{let a=n.projectCode;a||(a=await t().generateProjectCode());const r={projectCode:a,name:n.name||"",opportunityId:n.opportunityId||null,quoteId:n.quoteId||null,clientId:n.clientId||null,client:n.client||{},description:n.description||"",region:n.region||"",country:n.country||"",startDate:n.startDate||null,endDate:n.endDate||null,status:n.status||"draft",currency:n.currency||"USD",budgetTotal:n.budgetTotal||0,budgetBreakdown:n.budgetBreakdown||{},projectManagerId:n.projectManagerId||null,projectManagerName:n.projectManagerName||"",settings:n.settings||{},notes:n.notes||"",tags:n.tags||[]},{data:o,error:i}=await _n.from("projects").insert(function(e){return{project_code:e.projectCode,name:e.name,opportunity_id:e.opportunityId||null,quote_id:e.quoteId||null,client_id:e.clientId||null,client:e.client||{},description:e.description||"",region:e.region||"",country:e.country||"",start_date:e.startDate||null,end_date:e.endDate||null,status:e.status||"draft",currency:e.currency||"USD",budget_total:e.budgetTotal||0,budget_breakdown:e.budgetBreakdown||{},actuals_total:e.actualsTotal||0,actuals_breakdown:e.actualsBreakdown||{},project_manager_id:e.projectManagerId||null,project_manager_name:e.projectManagerName||"",settings:e.settings||{},notes:e.notes||"",tags:e.tags||[]}}(r)).select().single();if(i)throw i;const s=qi(o);return e(e=>({projects:[s,...e.projects.filter(e=>e.id!==s.id)],error:null})),s}catch(Pc){return e({error:Pc.message}),null}},updateProject:async(t,n)=>{if(kn())try{const a={};if(void 0!==n.projectCode&&(a.project_code=n.projectCode),void 0!==n.name&&(a.name=n.name),void 0!==n.opportunityId&&(a.opportunity_id=n.opportunityId),void 0!==n.quoteId&&(a.quote_id=n.quoteId),void 0!==n.clientId&&(a.client_id=n.clientId),void 0!==n.client&&(a.client=n.client),void 0!==n.description&&(a.description=n.description),void 0!==n.region&&(a.region=n.region),void 0!==n.country&&(a.country=n.country),void 0!==n.startDate&&(a.start_date=n.startDate),void 0!==n.endDate&&(a.end_date=n.endDate),void 0!==n.status&&(a.status=n.status),void 0!==n.currency&&(a.currency=n.currency),void 0!==n.budgetTotal&&(a.budget_total=n.budgetTotal),void 0!==n.budgetBreakdown&&(a.budget_breakdown=n.budgetBreakdown),void 0!==n.actualsTotal&&(a.actuals_total=n.actualsTotal),void 0!==n.actualsBreakdown&&(a.actuals_breakdown=n.actualsBreakdown),void 0!==n.projectManagerId&&(a.project_manager_id=n.projectManagerId),void 0!==n.projectManagerName&&(a.project_manager_name=n.projectManagerName),void 0!==n.settings&&(a.settings=n.settings),void 0!==n.notes&&(a.notes=n.notes),void 0!==n.tags&&(a.tags=n.tags),"confirmed"!==n.status||n.confirmedAt||(a.confirmed_at=(new Date).toISOString()),"in_progress"!==n.status||n.startedAt||(a.started_at=(new Date).toISOString()),"wrapped"!==n.status||n.wrappedAt||(a.wrapped_at=(new Date).toISOString()),"closed"!==n.status||n.closedAt||(a.closed_at=(new Date).toISOString()),Object.keys(a).length>0){const{error:r}=await _n.from("projects").update(a).eq("id",t);if(r)throw r;e(e=>({projects:e.projects.map(e=>e.id===t?{...e,...n,updatedAt:(new Date).toISOString()}:e),error:null}))}}catch(Pc){e({error:Pc.message})}else e({error:"Supabase not configured"})},deleteProject:async t=>{if(kn())try{const{error:n}=await _n.from("projects").delete().eq("id",t);if(n)throw n;e(e=>({projects:e.projects.filter(e=>e.id!==t),error:null}))}catch(Pc){e({error:Pc.message})}else e({error:"Supabase not configured"})},getProject:e=>t().projects.find(t=>t.id===e),getProjectsByStatus:e=>t().projects.filter(t=>t.status===e),getClientProjects:e=>t().projects.filter(t=>t.clientId===e),getActiveProjects:()=>t().projects.filter(e=>"confirmed"===e.status||"in_progress"===e.status),updateStatus:async(e,n)=>{await t().updateProject(e,{status:n})},createFromQuote:async(e,n=null)=>{const a={name:e.project?.title||n?.title||"Untitled Project",opportunityId:n?.id||null,quoteId:e.id||null,clientId:e.client?.clientId||n?.clientId||null,client:{company:e.client?.company||n?.client?.company||"",contact:e.client?.contact||"",email:e.client?.email||"",phone:e.client?.phone||""},description:e.project?.description||n?.brief||"",region:e.region||n?.region||"",country:e.project?.location||n?.country||"",startDate:e.project?.startDate||null,endDate:e.project?.endDate||null,status:"confirmed",currency:e.currency||"USD",budgetTotal:e.totals?.grandTotal||n?.value||0,budgetBreakdown:e.sections||{}},r=await t().addProject(a);if(r&&e.id)try{await _n.from("quotes").update({project_id:r.id}).eq("id",e.id)}catch(Pc){}if(r&&n?.id)try{await _n.from("opportunities").update({converted_to_project_id:r.id}).eq("id",n.id)}catch(Pc){}return r},getProjectStats:()=>{const{projects:e}=t(),n={};Object.keys(Mi).forEach(t=>{n[t]=e.filter(e=>e.status===t).length});const a=e.filter(e=>"confirmed"===e.status||"in_progress"===e.status),r=a.reduce((e,t)=>e+(t.budgetTotal||0),0),o=a.reduce((e,t)=>e+(t.actualsTotal||0),0);return{total:e.length,byStatus:n,activeCount:a.length,totalBudget:r,totalActuals:o,budgetRemaining:r-o}},clearError:()=>{e({error:null})}}))),Fi={camera:{label:"Camera",color:"#3B82F6"},sound:{label:"Sound",color:"#8B5CF6"},lighting:{label:"Lighting",color:"#F59E0B"},grip:{label:"Grip",color:"#6B7280"},art:{label:"Art Department",color:"#EC4899"},wardrobe:{label:"Wardrobe",color:"#14B8A6"},makeup:{label:"Hair & Makeup",color:"#F43F5E"},production:{label:"Production",color:"#10B981"},direction:{label:"Direction",color:"#EF4444"},editing:{label:"Post Production",color:"#6366F1"},vfx:{label:"VFX",color:"#8B5CF6"},transport:{label:"Transport",color:"#64748B"},catering:{label:"Catering",color:"#F97316"},other:{label:"Other",color:"#9CA3AF"}},Bi={available:{label:"Available",color:"green"},busy:{label:"Busy",color:"yellow"},unavailable:{label:"Unavailable",color:"red"},on_project:{label:"On Project",color:"blue"}};function Ui(e){return{id:e.id,firstName:e.first_name,lastName:e.last_name,nickname:e.nickname||"",email:e.email||"",phone:e.phone||"",phoneSecondary:e.phone_secondary||"",city:e.city||"",country:e.country||"",timezone:e.timezone||"",department:e.department||"",roleTitle:e.role_title||"",skills:e.skills||[],experienceYears:e.experience_years||0,dayRate:e.day_rate||0,halfDayRate:e.half_day_rate||0,hourlyRate:e.hourly_rate||0,overtimeRate:e.overtime_rate||0,currency:e.currency||"USD",rateNotes:e.rate_notes||"",ownsEquipment:e.owns_equipment||!1,equipmentList:e.equipment_list||[],equipmentNotes:e.equipment_notes||"",availabilityStatus:e.availability_status||"available",availabilityNotes:e.availability_notes||"",website:e.website||"",imdbLink:e.imdb_link||"",linkedinLink:e.linkedin_link||"",instagramLink:e.instagram_link||"",showreelLink:e.showreel_link||"",portfolioLinks:e.portfolio_links||[],resumeUrl:e.resume_url||"",rating:e.rating||0,totalProjects:e.total_projects||0,notes:e.notes||"",tags:e.tags||[],isFavorite:e.is_favorite||!1,isArchived:e.is_archived||!1,emergencyContactName:e.emergency_contact_name||"",emergencyContactPhone:e.emergency_contact_phone||"",emergencyContactRelation:e.emergency_contact_relation||"",createdAt:e.created_at,updatedAt:e.updated_at,lastContactedAt:e.last_contacted_at,departmentName:e.department_name||Fi[e.department]?.label||"",departmentColor:e.department_color||Fi[e.department]?.color||"#6B7280",projectCount:e.project_count||0,avgProjectRating:e.avg_project_rating||0,totalEarned:e.total_earned||0}}function $i(e){return{first_name:e.firstName,last_name:e.lastName,nickname:e.nickname||null,email:e.email||null,phone:e.phone||null,phone_secondary:e.phoneSecondary||null,city:e.city||null,country:e.country||null,timezone:e.timezone||null,department:e.department||null,role_title:e.roleTitle||null,skills:e.skills||[],experience_years:e.experienceYears||null,day_rate:e.dayRate||0,half_day_rate:e.halfDayRate||0,hourly_rate:e.hourlyRate||0,overtime_rate:e.overtimeRate||0,currency:e.currency||"USD",rate_notes:e.rateNotes||null,owns_equipment:e.ownsEquipment||!1,equipment_list:e.equipmentList||[],equipment_notes:e.equipmentNotes||null,availability_status:e.availabilityStatus||"available",availability_notes:e.availabilityNotes||null,website:e.website||null,imdb_link:e.imdbLink||null,linkedin_link:e.linkedinLink||null,instagram_link:e.instagramLink||null,showreel_link:e.showreelLink||null,portfolio_links:e.portfolioLinks||[],resume_url:e.resumeUrl||null,rating:e.rating||null,notes:e.notes||null,tags:e.tags||[],is_favorite:e.isFavorite||!1,is_archived:e.isArchived||!1,emergency_contact_name:e.emergencyContactName||null,emergency_contact_phone:e.emergencyContactPhone||null,emergency_contact_relation:e.emergencyContactRelation||null}}const Vi=h($n((e,t)=>({crew:[],loading:!1,error:null,realtimeSubscription:null,initialize:async()=>{if(kn()){e({loading:!0,error:null});try{let{data:n,error:a}=await _n.from("crew_summary").select("*").order("first_name",{ascending:!0});if(a&&"42P01"===a.code){const e=await _n.from("crew").select("*").eq("is_archived",!1).order("first_name",{ascending:!0});n=e.data,a=e.error}if(a)throw a;const r=(n||[]).map(Ui);e({crew:r,loading:!1,error:null}),t().subscribeToRealtime()}catch(Pc){e({loading:!1,error:Pc.message})}}else e({loading:!1,error:"Supabase not configured"})},subscribeToRealtime:()=>{if(!kn())return;const n=t().realtimeSubscription;n&&_n.removeChannel(n);const a=_n.channel("crew-realtime").on("postgres_changes",{event:"*",schema:"public",table:"crew"},t=>{const{eventType:n,new:a,old:r}=t;e(e=>{let t=[...e.crew];if("INSERT"===n){t.find(e=>e.id===a.id)||a.is_archived||(t=[...t,Ui(a)].sort((e,t)=>e.firstName.localeCompare(t.firstName)))}else"UPDATE"===n?t=a.is_archived?t.filter(e=>e.id!==a.id):t.map(e=>e.id===a.id?Ui(a):e):"DELETE"===n&&(t=t.filter(e=>e.id!==r.id));return{crew:t}})}).subscribe();e({realtimeSubscription:a})},addCrew:async t=>{if(!kn())throw new Error("Supabase not configured");const n=$i(t),{data:a,error:r}=await _n.from("crew").insert(n).select().single();if(r)throw r;const o=Ui(a);return e(e=>({crew:[...e.crew,o].sort((e,t)=>e.firstName.localeCompare(t.firstName))})),o},updateCrew:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a=$i(n),{data:r,error:o}=await _n.from("crew").update(a).eq("id",t).select().single();if(o)throw o;const i=Ui(r);return e(e=>({crew:e.crew.map(e=>e.id===t?{...e,...i}:e)})),i},deleteCrew:async t=>{if(!kn())throw new Error("Supabase not configured");const{error:n}=await _n.from("crew").update({is_archived:!0}).eq("id",t);if(n)throw n;e(e=>({crew:e.crew.filter(e=>e.id!==t)}))},toggleFavorite:async e=>{const n=t().crew.find(t=>t.id===e);n&&await t().updateCrew(e,{isFavorite:!n.isFavorite})},updateAvailability:async(e,n)=>{await t().updateCrew(e,{availabilityStatus:n})},searchCrew:e=>{const{crew:n}=t();if(!e)return n;const a=e.toLowerCase();return n.filter(e=>e.firstName.toLowerCase().includes(a)||e.lastName.toLowerCase().includes(a)||e.email.toLowerCase().includes(a)||e.roleTitle.toLowerCase().includes(a)||e.skills.some(e=>e.toLowerCase().includes(a))||e.tags.some(e=>e.toLowerCase().includes(a)))},filterByDepartment:e=>{const{crew:n}=t();return e?n.filter(t=>t.department===e):n},filterByAvailability:e=>{const{crew:n}=t();return e?n.filter(t=>t.availabilityStatus===e):n},getCrewById:e=>t().crew.find(t=>t.id===e),getFavorites:()=>t().crew.filter(e=>e.isFavorite),getStats:()=>{const{crew:e}=t(),n={},a={};return e.forEach(e=>{const t=e.department||"other";n[t]=(n[t]||0)+1;const r=e.availabilityStatus||"available";a[r]=(a[r]||0)+1}),{total:e.length,favorites:e.filter(e=>e.isFavorite).length,available:a.available||0,byDepartment:n,byAvailability:a}},cleanup:()=>{const n=t().realtimeSubscription;n&&_n.removeChannel(n),e({realtimeSubscription:null})}}))),Hi={PENDING:"pending",CONFIRMED:"confirmed",CHECKED_OUT:"checked_out",RETURNED:"returned",CANCELLED:"cancelled"},Wi={[Hi.PENDING]:{label:"Pending",color:"amber",bgClass:"bg-amber-500/20",textClass:"text-amber-400"},[Hi.CONFIRMED]:{label:"Confirmed",color:"blue",bgClass:"bg-blue-500/20",textClass:"text-blue-400"},[Hi.CHECKED_OUT]:{label:"Checked Out",color:"green",bgClass:"bg-green-500/20",textClass:"text-green-400"},[Hi.RETURNED]:{label:"Returned",color:"gray",bgClass:"bg-gray-500/20",textClass:"text-gray-400"},[Hi.CANCELLED]:{label:"Cancelled",color:"red",bgClass:"bg-red-500/20",textClass:"text-red-400"}};function Gi(e){return{id:e.id,kitItemId:e.kit_item_id,quantity:e.quantity||1,startDate:e.start_date,endDate:e.end_date,projectId:e.project_id,projectName:e.project_name||e.linked_project_name,purpose:e.purpose,status:e.status||"pending",bookedBy:e.booked_by,bookedByName:e.booked_by_name,approvedBy:e.approved_by,collectionLocation:e.collection_location,returnLocation:e.return_location,checkedOutAt:e.checked_out_at,checkedOutBy:e.checked_out_by,returnedAt:e.returned_at,returnedTo:e.returned_to,returnCondition:e.return_condition,quotedRate:e.quoted_rate,quotedTotal:e.quoted_total,currency:e.currency||"USD",notes:e.notes,internalNotes:e.internal_notes,createdAt:e.created_at,updatedAt:e.updated_at,kitCode:e.kit_code,kitName:e.kit_name,categoryId:e.category_id,categoryName:e.category_name,categoryColor:e.category_color,manufacturer:e.manufacturer,model:e.model,kitLocation:e.kit_location,kitTotalQuantity:e.kit_total_quantity,dayRate:e.day_rate,rateCurrency:e.rate_currency,projectStatus:e.project_status,totalDays:e.total_days,displayStatus:e.display_status,daysOverdue:e.days_overdue}}function Ki(e){const t={};return void 0!==e.kitItemId&&(t.kit_item_id=e.kitItemId),void 0!==e.quantity&&(t.quantity=e.quantity),void 0!==e.startDate&&(t.start_date=e.startDate),void 0!==e.endDate&&(t.end_date=e.endDate),void 0!==e.projectId&&(t.project_id=e.projectId),void 0!==e.projectName&&(t.project_name=e.projectName),void 0!==e.purpose&&(t.purpose=e.purpose),void 0!==e.status&&(t.status=e.status),void 0!==e.bookedBy&&(t.booked_by=e.bookedBy),void 0!==e.bookedByName&&(t.booked_by_name=e.bookedByName),void 0!==e.approvedBy&&(t.approved_by=e.approvedBy),void 0!==e.collectionLocation&&(t.collection_location=e.collectionLocation),void 0!==e.returnLocation&&(t.return_location=e.returnLocation),void 0!==e.checkedOutAt&&(t.checked_out_at=e.checkedOutAt),void 0!==e.checkedOutBy&&(t.checked_out_by=e.checkedOutBy),void 0!==e.returnedAt&&(t.returned_at=e.returnedAt),void 0!==e.returnedTo&&(t.returned_to=e.returnedTo),void 0!==e.returnCondition&&(t.return_condition=e.returnCondition),void 0!==e.quotedRate&&(t.quoted_rate=e.quotedRate),void 0!==e.quotedTotal&&(t.quoted_total=e.quotedTotal),void 0!==e.currency&&(t.currency=e.currency),void 0!==e.notes&&(t.notes=e.notes),void 0!==e.internalNotes&&(t.internal_notes=e.internalNotes),t}const Qi=h($n((e,t)=>({bookings:[],loading:!1,error:null,realtimeSubscription:null,filters:{status:null,kitItemId:null,projectId:null,dateRange:null},initialize:async()=>{if(kn()){e({loading:!0,error:null});try{let{data:n,error:a}=await _n.from("kit_bookings_extended").select("*").order("start_date",{ascending:!0});if(a&&"42P01"===a.code){const e=await _n.from("kit_bookings").select("*").order("start_date",{ascending:!0});n=e.data,a=e.error}if(a)throw a;const r=(n||[]).map(Gi);e({bookings:r,loading:!1,error:null}),t().subscribeToRealtime()}catch(Pc){e({loading:!1,error:Pc.message})}}else e({loading:!1,error:"Supabase not configured"})},subscribeToRealtime:()=>{if(!kn())return;const n=t().realtimeSubscription;n&&_n.removeChannel(n);const a=_n.channel("kit-bookings-realtime").on("postgres_changes",{event:"*",schema:"public",table:"kit_bookings"},async e=>{await t().initialize()}).subscribe();e({realtimeSubscription:a})},createBooking:async t=>{if(!kn())throw new Error("Supabase not configured");const n=Ki(t),{data:a,error:r}=await _n.from("kit_bookings").insert(n).select().single();if(r)throw r;const o=Gi(a);return e(e=>({bookings:[...e.bookings,o].sort((e,t)=>new Date(e.startDate)-new Date(t.startDate))})),o},updateBooking:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a=Ki(n),{data:r,error:o}=await _n.from("kit_bookings").update(a).eq("id",t).select().single();if(o)throw o;const i=Gi(r);return e(e=>({bookings:e.bookings.map(e=>e.id===t?{...e,...i}:e)})),i},cancelBooking:async e=>t().updateBooking(e,{status:Hi.CANCELLED}),confirmBooking:async(e,n=null)=>t().updateBooking(e,{status:Hi.CONFIRMED,approvedBy:n}),checkOut:async(e,n=null)=>t().updateBooking(e,{status:Hi.CHECKED_OUT,checkedOutAt:(new Date).toISOString(),checkedOutBy:n}),returnEquipment:async(e,n={})=>t().updateBooking(e,{status:Hi.RETURNED,returnedAt:(new Date).toISOString(),returnedTo:n.returnedTo,returnCondition:n.condition}),deleteBooking:async(n,a=!1)=>{if(!kn())throw new Error("Supabase not configured");if(a){const{error:t}=await _n.from("kit_bookings").delete().eq("id",n);if(t)throw t;e(e=>({bookings:e.bookings.filter(e=>e.id!==n)}))}else await t().cancelBooking(n)},checkAvailability:async(e,n,a,r=1,o=null)=>{if(!kn())return{isAvailable:!1,availableQuantity:0,conflicts:[]};try{const{data:t,error:i}=await _n.rpc("check_kit_availability",{p_kit_item_id:e,p_start_date:n,p_end_date:a,p_quantity:r,p_exclude_booking_id:o});if(i)throw i;const s=t?.[0]||{is_available:!1,available_quantity:0,conflicting_bookings:[]};return{isAvailable:s.is_available,availableQuantity:s.available_quantity,conflicts:s.conflicting_bookings||[]}}catch(Pc){const{bookings:s}=t(),l=s.filter(t=>t.kitItemId===e&&t.status!==Hi.CANCELLED&&t.status!==Hi.RETURNED&&t.id!==o&&new Date(t.startDate)<=new Date(a)&&new Date(t.endDate)>=new Date(n));return{isAvailable:0===l.length,availableQuantity:0===l.length?r:0,conflicts:l}}},getBookingsForKit:e=>{const{bookings:n}=t();return n.filter(t=>t.kitItemId===e)},getBookingsForProject:e=>{const{bookings:n}=t();return n.filter(t=>t.projectId===e)},getUpcoming:()=>{const{bookings:e}=t(),n=(new Date).toISOString().split("T")[0];return e.filter(e=>e.status!==Hi.CANCELLED&&e.status!==Hi.RETURNED&&e.endDate>=n).sort((e,t)=>new Date(e.startDate)-new Date(t.startDate))},getOverdue:()=>{const{bookings:e}=t(),n=(new Date).toISOString().split("T")[0];return e.filter(e=>e.status===Hi.CHECKED_OUT&&e.endDate<n)},getPendingApproval:()=>{const{bookings:e}=t();return e.filter(e=>e.status===Hi.PENDING)},getBookingsInRange:(e,n)=>{const{bookings:a}=t(),r=new Date(e),o=new Date(n);return a.filter(e=>{const t=new Date(e.startDate),n=new Date(e.endDate);return t<=o&&n>=r&&e.status!==Hi.CANCELLED})},getFilteredBookings:()=>{const{bookings:e,filters:n}=t();let a=[...e];return n.status&&(a=a.filter(e=>e.status===n.status)),n.kitItemId&&(a=a.filter(e=>e.kitItemId===n.kitItemId)),n.projectId&&(a=a.filter(e=>e.projectId===n.projectId)),n.dateRange?.start&&n.dateRange?.end&&(a=a.filter(e=>new Date(e.startDate)<=new Date(n.dateRange.end)&&new Date(e.endDate)>=new Date(n.dateRange.start))),a},setFilters:t=>{e(e=>({filters:{...e.filters,...t}}))},clearFilters:()=>{e({filters:{status:null,kitItemId:null,projectId:null,dateRange:null}})},getStats:()=>{const{bookings:e}=t(),n=(new Date).toISOString().split("T")[0],a=e.filter(e=>e.status!==Hi.CANCELLED&&e.status!==Hi.RETURNED),r=e.filter(e=>e.status===Hi.PENDING),o=e.filter(e=>e.status===Hi.CHECKED_OUT),i=o.filter(e=>e.endDate<n),s=a.filter(e=>{const t=new Date(e.startDate),a=new Date;return a.setDate(a.getDate()+7),t>=new Date(n)&&t<=a});return{total:e.length,active:a.length,pending:r.length,checkedOut:o.length,overdue:i.length,upcomingWeek:s.length}},cleanup:()=>{const n=t().realtimeSubscription;n&&_n.removeChannel(n),e({realtimeSubscription:null})}})));function Yi(e){return{id:e.id,crewId:e.crew_id,projectId:e.project_id,callSheetId:e.call_sheet_id,crewName:e.crew_name||"",crewRole:e.crew_role||"",startDate:e.start_date,endDate:e.end_date,dayRate:parseFloat(e.day_rate)||0,days:parseFloat(e.days)||1,overtimeHours:parseFloat(e.overtime_hours)||0,overtimeRate:parseFloat(e.overtime_rate)||0,totalCost:parseFloat(e.total_cost)||0,currency:e.currency||"USD",status:e.status||"pending",isPaid:e.is_paid||!1,paidDate:e.paid_date,poNumber:e.po_number||"",notes:e.notes||"",createdAt:e.created_at,updatedAt:e.updated_at}}function Ji(e){return{crew_id:e.crewId||null,project_id:e.projectId||null,call_sheet_id:e.callSheetId||null,crew_name:e.crewName||"",crew_role:e.crewRole||"",start_date:e.startDate||null,end_date:e.endDate||null,day_rate:e.dayRate||0,days:e.days||1,overtime_hours:e.overtimeHours||0,overtime_rate:e.overtimeRate||0,total_cost:e.totalCost||0,currency:e.currency||"USD",status:e.status||"pending",is_paid:e.isPaid||!1,paid_date:e.paidDate||null,po_number:e.poNumber||"",notes:e.notes||""}}function Zi(e){return(e.dayRate||0)*(e.days||1)+(e.overtimeHours||0)*(e.overtimeRate||0)}const Xi=h($n((e,t)=>({bookings:[],loading:!1,error:null,realtimeSubscription:null,initialize:async()=>{if(kn()){e({loading:!0,error:null});try{const{data:n,error:a}=await _n.from("crew_bookings").select("*").order("start_date",{ascending:!1});if(a)throw a;const r=(n||[]).map(Yi);e({bookings:r,loading:!1});const o=_n.channel("crew-bookings-changes").on("postgres_changes",{event:"*",schema:"public",table:"crew_bookings"},n=>{const{eventType:a,new:r,old:o}=n,i=t();if("INSERT"===a){const t=Yi(r);i.bookings.find(e=>e.id===t.id)||e({bookings:[t,...i.bookings]})}else if("UPDATE"===a){const t=Yi(r);e({bookings:i.bookings.map(e=>e.id===t.id?t:e)})}else"DELETE"===a&&e({bookings:i.bookings.filter(e=>e.id!==o.id)})}).subscribe();e({realtimeSubscription:o})}catch(n){e({error:n.message,loading:!1})}}else e({loading:!1,error:"Supabase not configured"})},createBooking:async n=>{if(!kn())return null;try{const a=t(),r=n.poNumber||function(e){const t=`PO-${(new Date).getFullYear()}-`,n=e.map(e=>e.poNumber).filter(e=>e?.startsWith(t)).map(e=>parseInt(e.replace(t,""),10)).filter(e=>!isNaN(e)),a=n.length>0?Math.max(...n):0;return`${t}${String(a+1).padStart(4,"0")}`}(a.bookings),o=Zi(n),i={...n,poNumber:r,totalCost:o,status:n.status||"pending"},{data:s,error:l}=await _n.from("crew_bookings").insert(Ji(i)).select().single();if(l)throw l;const c=Yi(s);return e({bookings:[c,...a.bookings]}),c}catch(a){return null}},createFromCrew:async(e,n,a={})=>{const r={crewId:e.id,projectId:n,crewName:e.name,crewRole:e.role||e.department||"",dayRate:e.dayRate||e.rate||0,currency:e.currency||"USD",startDate:a.startDate||(new Date).toISOString().split("T")[0],endDate:a.endDate||a.startDate||(new Date).toISOString().split("T")[0],days:a.days||1};return t().createBooking(r)},syncFromCallSheet:async(e,n)=>{if(!e?.crew||0===e.crew.length)return[];const a=t(),r=[];for(const o of e.crew){if(!a.bookings.find(t=>t.callSheetId===e.id&&t.crewId===o.id)){const a=await t().createBooking({crewId:o.id,projectId:n||e.projectId,callSheetId:e.id,crewName:o.name,crewRole:o.role||o.department||"",dayRate:o.dayRate||o.rate||0,days:1,startDate:e.date||e.shootDate,endDate:e.date||e.shootDate,status:"confirmed"});a&&r.push(a)}}return r},updateBooking:async(n,a)=>{if(!kn())return!1;try{if(void 0!==a.dayRate||void 0!==a.days||void 0!==a.overtimeHours||void 0!==a.overtimeRate){const e={...t().bookings.find(e=>e.id===n),...a};a.totalCost=Zi(e)}const{error:r}=await _n.from("crew_bookings").update(Ji(a)).eq("id",n);if(r)throw r;return e({bookings:t().bookings.map(e=>e.id===n?{...e,...a}:e)}),!0}catch(r){return!1}},updateStatus:async(e,n)=>{const a={status:n};return"completed"===n&&(a.endDate=a.endDate||(new Date).toISOString().split("T")[0]),t().updateBooking(e,a)},markAsPaid:async e=>t().updateBooking(e,{isPaid:!0,paidDate:(new Date).toISOString().split("T")[0]}),deleteBooking:async n=>{if(!kn())return!1;try{const{error:a}=await _n.from("crew_bookings").delete().eq("id",n);if(a)throw a;return e({bookings:t().bookings.filter(e=>e.id!==n)}),!0}catch(a){return!1}},deleteByCallSheet:async n=>{if(!kn())return!1;try{const{error:a}=await _n.from("crew_bookings").delete().eq("call_sheet_id",n);if(a)throw a;return e({bookings:t().bookings.filter(e=>e.callSheetId!==n)}),!0}catch(a){return!1}},getBookingById:e=>t().bookings.find(t=>t.id===e),getBookingsByProject:e=>t().bookings.filter(t=>t.projectId===e),getBookingsByCrew:e=>t().bookings.filter(t=>t.crewId===e),getBookingsByCallSheet:e=>t().bookings.filter(t=>t.callSheetId===e),getProjectCrewCosts:e=>{const n=t().bookings.filter(t=>t.projectId===e&&"cancelled"!==t.status);return{totalCost:n.reduce((e,t)=>e+(t.totalCost||0),0),paidCost:n.filter(e=>e.isPaid).reduce((e,t)=>e+(t.totalCost||0),0),unpaidCost:n.filter(e=>!e.isPaid).reduce((e,t)=>e+(t.totalCost||0),0),bookingsCount:n.length,confirmedCount:n.filter(e=>"confirmed"===e.status).length,completedCount:n.filter(e=>"completed"===e.status).length}},getStats:()=>{const e=t().bookings,n=new Date,a=n.getMonth(),r=n.getFullYear(),o=e.filter(e=>{if(!e.startDate)return!1;const t=new Date(e.startDate);return t.getMonth()===a&&t.getFullYear()===r}),i=e.filter(e=>"confirmed"===e.status||"in_progress"===e.status);return{total:e.length,thisMonth:o.length,active:i.length,pending:e.filter(e=>"pending"===e.status).length,completed:e.filter(e=>"completed"===e.status).length,totalCost:e.filter(e=>"cancelled"!==e.status).reduce((e,t)=>e+(t.totalCost||0),0),thisMonthCost:o.filter(e=>"cancelled"!==e.status).reduce((e,t)=>e+(t.totalCost||0),0),unpaidTotal:e.filter(e=>!e.isPaid&&"cancelled"!==e.status).reduce((e,t)=>e+(t.totalCost||0),0)}},getCrewAvailability:(e,n,a)=>{const r=t().bookings.filter(t=>{if(t.crewId!==e||"cancelled"===t.status)return!1;if(!t.startDate||!t.endDate)return!1;const r=new Date(t.startDate),o=new Date(t.endDate),i=new Date(n);return r<=new Date(a)&&o>=i});return{isAvailable:0===r.length,conflictingBookings:r}},cleanup:()=>{const n=t().realtimeSubscription;n&&_n.removeChannel(n),e({realtimeSubscription:null})}}))),es={DRAFT:"draft",PUBLISHED:"published",COMPLETED:"completed",CANCELLED:"cancelled"},ts={[es.DRAFT]:{label:"Draft",color:"gray",bgClass:"bg-gray-500/20",textClass:"text-gray-400"},[es.PUBLISHED]:{label:"Published",color:"green",bgClass:"bg-green-500/20",textClass:"text-green-400"},[es.COMPLETED]:{label:"Completed",color:"blue",bgClass:"bg-blue-500/20",textClass:"text-blue-400"},[es.CANCELLED]:{label:"Cancelled",color:"red",bgClass:"bg-red-500/20",textClass:"text-red-400"}},ns=[{id:"camera",name:"Camera",color:"#3B82F6"},{id:"sound",name:"Sound",color:"#8B5CF6"},{id:"lighting",name:"Lighting",color:"#F59E0B"},{id:"grip",name:"Grip",color:"#6B7280"},{id:"art",name:"Art",color:"#EC4899"},{id:"wardrobe",name:"Wardrobe",color:"#14B8A6"},{id:"makeup",name:"Hair & Makeup",color:"#F43F5E"},{id:"production",name:"Production",color:"#10B981"},{id:"transport",name:"Transport",color:"#64748B"},{id:"catering",name:"Catering",color:"#F97316"}];function as(e){return{id:e.id,projectId:e.project_id,projectName:e.project_name||e.linked_project_name,productionCompany:e.production_company,productionTitle:e.production_title,episodeTitle:e.episode_title,episodeNumber:e.episode_number,director:e.director,producer:e.producer,productionManager:e.production_manager,shootDate:e.shoot_date,dayNumber:e.day_number,totalDays:e.total_days,generalCallTime:e.general_call_time,firstShotTime:e.first_shot_time,estimatedWrap:e.estimated_wrap,actualWrap:e.actual_wrap,locationName:e.location_name,locationAddress:e.location_address,locationCity:e.location_city,locationCountry:e.location_country,locationCoordinates:e.location_coordinates,locationContactName:e.location_contact_name,locationContactPhone:e.location_contact_phone,locationNotes:e.location_notes,parkingInfo:e.parking_info,baseCampLocation:e.base_camp_location,additionalLocations:e.additional_locations||[],weatherForecast:e.weather_forecast,weatherNotes:e.weather_notes,hospitalName:e.hospital_name,hospitalAddress:e.hospital_address,hospitalPhone:e.hospital_phone,hospitalDistance:e.hospital_distance,emergencyContacts:e.emergency_contacts||[],breakfastTime:e.breakfast_time,breakfastLocation:e.breakfast_location,lunchTime:e.lunch_time,lunchLocation:e.lunch_location,cateringCompany:e.catering_company,cateringContact:e.catering_contact,dietaryNotes:e.dietary_notes,schedule:e.schedule||[],importantNotes:e.important_notes,safetyNotes:e.safety_notes,wardrobeNotes:e.wardrobe_notes,makeupNotes:e.makeup_notes,transportNotes:e.transport_notes,equipmentNotes:e.equipment_notes,mapUrl:e.map_url,mapImagePath:e.map_image_path,attachments:e.attachments||[],status:e.status||"draft",publishedAt:e.published_at,publishedBy:e.published_by,version:e.version||1,createdAt:e.created_at,updatedAt:e.updated_at,createdBy:e.created_by,projectClient:e.project_client,crewCount:e.crew_count||0,crewConfirmedCount:e.crew_confirmed_count||0,castCount:e.cast_count||0,departmentCount:e.department_count||0,displayStatus:e.display_status,daysUntilShoot:e.days_until_shoot,timeZone:e.time_zone,timeZoneOffset:e.time_zone_offset,homeBaseTimezone:e.home_base_timezone,perDiemAmount:e.per_diem_amount,perDiemCurrency:e.per_diem_currency,perDiemNotes:e.per_diem_notes,dressCode:e.dress_code||[],localCurrency:e.local_currency,exchangeRate:e.exchange_rate,currencyNotes:e.currency_notes,accreditationNotes:e.accreditation_notes,accreditationCollectionPoint:e.accreditation_collection_point,accessRestrictions:e.access_restrictions,insuranceInfo:e.insurance_info||{},riskAssessmentUrl:e.risk_assessment_url,riskAssessmentNotes:e.risk_assessment_notes,invoicingEmail:e.invoicing_email,invoicingNotes:e.invoicing_notes,customsNotes:e.customs_notes,carnetInfo:e.carnet_info||[],travelAdviceUrl:e.travel_advice_url,visaRequirements:e.visa_requirements,embassyInfo:e.embassy_info||{},internationalDialingCode:e.international_dialing_code,wifiInfo:e.wifi_info,mobileNetworkNotes:e.mobile_network_notes}}function rs(e){const t={};return void 0!==e.projectId&&(t.project_id=e.projectId),void 0!==e.projectName&&(t.project_name=e.projectName),void 0!==e.productionCompany&&(t.production_company=e.productionCompany),void 0!==e.productionTitle&&(t.production_title=e.productionTitle),void 0!==e.episodeTitle&&(t.episode_title=e.episodeTitle),void 0!==e.episodeNumber&&(t.episode_number=e.episodeNumber),void 0!==e.director&&(t.director=e.director),void 0!==e.producer&&(t.producer=e.producer),void 0!==e.productionManager&&(t.production_manager=e.productionManager),void 0!==e.shootDate&&(t.shoot_date=e.shootDate),void 0!==e.dayNumber&&(t.day_number=e.dayNumber),void 0!==e.totalDays&&(t.total_days=e.totalDays),void 0!==e.generalCallTime&&(t.general_call_time=e.generalCallTime),void 0!==e.firstShotTime&&(t.first_shot_time=e.firstShotTime),void 0!==e.estimatedWrap&&(t.estimated_wrap=e.estimatedWrap),void 0!==e.actualWrap&&(t.actual_wrap=e.actualWrap),void 0!==e.locationName&&(t.location_name=e.locationName),void 0!==e.locationAddress&&(t.location_address=e.locationAddress),void 0!==e.locationCity&&(t.location_city=e.locationCity),void 0!==e.locationCountry&&(t.location_country=e.locationCountry),void 0!==e.locationCoordinates&&(t.location_coordinates=e.locationCoordinates),void 0!==e.locationContactName&&(t.location_contact_name=e.locationContactName),void 0!==e.locationContactPhone&&(t.location_contact_phone=e.locationContactPhone),void 0!==e.locationNotes&&(t.location_notes=e.locationNotes),void 0!==e.parkingInfo&&(t.parking_info=e.parkingInfo),void 0!==e.baseCampLocation&&(t.base_camp_location=e.baseCampLocation),void 0!==e.additionalLocations&&(t.additional_locations=e.additionalLocations),void 0!==e.weatherForecast&&(t.weather_forecast=e.weatherForecast),void 0!==e.weatherNotes&&(t.weather_notes=e.weatherNotes),void 0!==e.hospitalName&&(t.hospital_name=e.hospitalName),void 0!==e.hospitalAddress&&(t.hospital_address=e.hospitalAddress),void 0!==e.hospitalPhone&&(t.hospital_phone=e.hospitalPhone),void 0!==e.hospitalDistance&&(t.hospital_distance=e.hospitalDistance),void 0!==e.emergencyContacts&&(t.emergency_contacts=e.emergencyContacts),void 0!==e.breakfastTime&&(t.breakfast_time=e.breakfastTime),void 0!==e.breakfastLocation&&(t.breakfast_location=e.breakfastLocation),void 0!==e.lunchTime&&(t.lunch_time=e.lunchTime),void 0!==e.lunchLocation&&(t.lunch_location=e.lunchLocation),void 0!==e.cateringCompany&&(t.catering_company=e.cateringCompany),void 0!==e.cateringContact&&(t.catering_contact=e.cateringContact),void 0!==e.dietaryNotes&&(t.dietary_notes=e.dietaryNotes),void 0!==e.schedule&&(t.schedule=e.schedule),void 0!==e.importantNotes&&(t.important_notes=e.importantNotes),void 0!==e.safetyNotes&&(t.safety_notes=e.safetyNotes),void 0!==e.wardrobeNotes&&(t.wardrobe_notes=e.wardrobeNotes),void 0!==e.makeupNotes&&(t.makeup_notes=e.makeupNotes),void 0!==e.transportNotes&&(t.transport_notes=e.transportNotes),void 0!==e.equipmentNotes&&(t.equipment_notes=e.equipmentNotes),void 0!==e.mapUrl&&(t.map_url=e.mapUrl),void 0!==e.mapImagePath&&(t.map_image_path=e.mapImagePath),void 0!==e.attachments&&(t.attachments=e.attachments),void 0!==e.status&&(t.status=e.status),void 0!==e.publishedAt&&(t.published_at=e.publishedAt),void 0!==e.publishedBy&&(t.published_by=e.publishedBy),void 0!==e.timeZone&&(t.time_zone=e.timeZone),void 0!==e.timeZoneOffset&&(t.time_zone_offset=e.timeZoneOffset),void 0!==e.homeBaseTimezone&&(t.home_base_timezone=e.homeBaseTimezone),void 0!==e.perDiemAmount&&(t.per_diem_amount=e.perDiemAmount),void 0!==e.perDiemCurrency&&(t.per_diem_currency=e.perDiemCurrency),void 0!==e.perDiemNotes&&(t.per_diem_notes=e.perDiemNotes),void 0!==e.dressCode&&(t.dress_code=e.dressCode),void 0!==e.localCurrency&&(t.local_currency=e.localCurrency),void 0!==e.exchangeRate&&(t.exchange_rate=e.exchangeRate),void 0!==e.currencyNotes&&(t.currency_notes=e.currencyNotes),void 0!==e.accreditationNotes&&(t.accreditation_notes=e.accreditationNotes),void 0!==e.accreditationCollectionPoint&&(t.accreditation_collection_point=e.accreditationCollectionPoint),void 0!==e.accessRestrictions&&(t.access_restrictions=e.accessRestrictions),void 0!==e.insuranceInfo&&(t.insurance_info=e.insuranceInfo),void 0!==e.riskAssessmentUrl&&(t.risk_assessment_url=e.riskAssessmentUrl),void 0!==e.riskAssessmentNotes&&(t.risk_assessment_notes=e.riskAssessmentNotes),void 0!==e.invoicingEmail&&(t.invoicing_email=e.invoicingEmail),void 0!==e.invoicingNotes&&(t.invoicing_notes=e.invoicingNotes),void 0!==e.customsNotes&&(t.customs_notes=e.customsNotes),void 0!==e.carnetInfo&&(t.carnet_info=e.carnetInfo),void 0!==e.travelAdviceUrl&&(t.travel_advice_url=e.travelAdviceUrl),void 0!==e.visaRequirements&&(t.visa_requirements=e.visaRequirements),void 0!==e.embassyInfo&&(t.embassy_info=e.embassyInfo),void 0!==e.internationalDialingCode&&(t.international_dialing_code=e.internationalDialingCode),void 0!==e.wifiInfo&&(t.wifi_info=e.wifiInfo),void 0!==e.mobileNetworkNotes&&(t.mobile_network_notes=e.mobileNetworkNotes),t}function os(e){return{id:e.id,callSheetId:e.call_sheet_id,crewId:e.crew_id,name:e.name,roleTitle:e.role_title,department:e.department,phone:e.phone||e.crew_phone,email:e.email||e.crew_email,callTime:e.call_time,callLocation:e.call_location,transportMode:e.transport_mode,pickupTime:e.pickup_time,pickupLocation:e.pickup_location,notes:e.notes,confirmed:e.confirmed||!1,confirmedAt:e.confirmed_at,sortOrder:e.sort_order||0,firstName:e.first_name,lastName:e.last_name,departmentColor:e.department_color}}function is(e){return{id:e.id,callSheetId:e.call_sheet_id,name:e.name,characterName:e.character_name,agentContact:e.agent_contact,pickupTime:e.pickup_time,pickupLocation:e.pickup_location,makeupCall:e.makeup_call,wardrobeCall:e.wardrobe_call,onSetCall:e.on_set_call,scenes:e.scenes||[],wardrobeNotes:e.wardrobe_notes,makeupNotes:e.makeup_notes,notes:e.notes,confirmed:e.confirmed||!1,confirmedAt:e.confirmed_at,sortOrder:e.sort_order||0}}function ss(e){return{id:e.id,callSheetId:e.call_sheet_id,hotelName:e.hotel_name,hotelAddress:e.hotel_address,hotelCity:e.hotel_city,hotelCountry:e.hotel_country,hotelPhone:e.hotel_phone,hotelWebsite:e.hotel_website,hotelEmail:e.hotel_email,distanceFromVenue:e.distance_from_venue,distanceFromAirport:e.distance_from_airport,breakfastIncluded:e.breakfast_included,wifiAvailable:e.wifi_available,parkingAvailable:e.parking_available,bookingReference:e.booking_reference,bookingContact:e.booking_contact,checkInTime:e.check_in_time,checkOutTime:e.check_out_time,paymentStatus:e.payment_status,paymentNotes:e.payment_notes,notes:e.notes,sortOrder:e.sort_order||0}}function ls(e){return{id:e.id,accommodationId:e.accommodation_id,crewId:e.crew_id,crewName:e.crew_name,checkInDate:e.check_in_date,checkOutDate:e.check_out_date,roomNumber:e.room_number,roomType:e.room_type,earlyCheckIn:e.early_check_in,lateCheckOut:e.late_check_out,notes:e.notes}}function cs(e){return{id:e.id,callSheetId:e.call_sheet_id,crewId:e.crew_id,crewName:e.crew_name,flightType:e.flight_type,bookingReference:e.booking_reference,flightNumber:e.flight_number,airline:e.airline,departureDate:e.departure_date,departureTime:e.departure_time,departureAirport:e.departure_airport,departureTerminal:e.departure_terminal,arrivalDate:e.arrival_date,arrivalTime:e.arrival_time,arrivalAirport:e.arrival_airport,arrivalTerminal:e.arrival_terminal,hasConnection:e.has_connection,connectionAirport:e.connection_airport,connectionFlightNumber:e.connection_flight_number,connectionDepartureTime:e.connection_departure_time,notes:e.notes,sortOrder:e.sort_order||0}}function ds(e){return{id:e.id,callSheetId:e.call_sheet_id,transferDate:e.transfer_date,transferTime:e.transfer_time,pickupLocation:e.pickup_location,dropoffLocation:e.dropoff_location,transportType:e.transport_type,vehicleDetails:e.vehicle_details,capacity:e.capacity,providerCompany:e.provider_company,driverName:e.driver_name,driverPhone:e.driver_phone,passengers:e.passengers||[],maxPassengers:e.max_passengers,notes:e.notes,sortOrder:e.sort_order||0}}function us(e){return{id:e.id,callSheetId:e.call_sheet_id,vehicleType:e.vehicle_type,vehicleName:e.vehicle_name,licensePlate:e.license_plate,lengthMeters:e.length_meters,widthMeters:e.width_meters,heightMeters:e.height_meters,company:e.company,driverName:e.driver_name,driverPhone:e.driver_phone,assignedLocation:e.assigned_location,parkingSpot:e.parking_spot,arrivalTime:e.arrival_time,departureTime:e.departure_time,notes:e.notes,overnightSecurity:e.overnight_security,sortOrder:e.sort_order||0}}function ms(e){return{id:e.id,callSheetId:e.call_sheet_id,cameraPositions:e.camera_positions||[],cableRuns:e.cable_runs||[],audioSetup:e.audio_setup||{},videoRouting:e.video_routing||[],graphicsSetup:e.graphics_setup,vtSetup:e.vt_setup,commsSetup:e.comms_setup,radioChannels:e.radio_channels||[],recordingSetup:e.recording_setup||[],monitors:e.monitors||[],lightingSetup:e.lighting_setup,powerRequirements:e.power_requirements,generatorInfo:e.generator_info,uplinkInfo:e.uplink_info,internetInfo:e.internet_info,notes:e.notes}}function ps(e){return{id:e.id,callSheetId:e.call_sheet_id,companyName:e.company_name,vendorType:e.vendor_type,contactName:e.contact_name,contactRole:e.contact_role,contactPhone:e.contact_phone,contactEmail:e.contact_email,additionalContacts:e.additional_contacts||[],notes:e.notes,onSite:e.on_site,sortOrder:e.sort_order||0}}function hs(e){return{id:e.id,callSheetId:e.call_sheet_id,contactType:e.contact_type,name:e.name,organization:e.organization,phone:e.phone,phoneSecondary:e.phone_secondary,address:e.address,distanceFromVenue:e.distance_from_venue,notes:e.notes,is24Hour:e.is_24_hour,sortOrder:e.sort_order||0}}function fs(e){return{id:e.id,callSheetId:e.call_sheet_id,mealType:e.meal_type,mealTime:e.meal_time,location:e.location,providerName:e.provider_name,providerPhone:e.provider_phone,headcount:e.headcount,dietaryNotes:e.dietary_notes,menuDescription:e.menu_description,costPerHead:e.cost_per_head,totalCost:e.total_cost,paymentStatus:e.payment_status,notes:e.notes,sortOrder:e.sort_order||0}}function gs(e){return{id:e.id,callSheetId:e.call_sheet_id,forecastDate:e.forecast_date,condition:e.condition,conditionIcon:e.condition_icon,tempHighCelsius:e.temp_high_celsius,tempLowCelsius:e.temp_low_celsius,humidityPercent:e.humidity_percent,windSpeedKmh:e.wind_speed_kmh,windDirection:e.wind_direction,precipitationPercent:e.precipitation_percent,uvIndex:e.uv_index,sunrise:e.sunrise,sunset:e.sunset,notes:e.notes}}const ys=h($n((e,t)=>({callSheets:[],currentCallSheet:null,currentCrew:[],currentCast:[],currentDepartmentCalls:[],currentAccommodation:[],currentRoomAssignments:[],currentFlights:[],currentTransfers:[],currentVehicles:[],currentTechnical:null,currentVendors:[],currentEmergencyContacts:[],currentCatering:[],currentWeather:[],templates:[],loading:!1,error:null,initialize:async()=>{if(kn()){e({loading:!0,error:null});try{let{data:t,error:n}=await _n.from("call_sheets_extended").select("*").order("shoot_date",{ascending:!0});if(n&&"42P01"===n.code){const e=await _n.from("call_sheets").select("*").order("shoot_date",{ascending:!0});t=e.data,n=e.error}if(n)throw n;const a=(t||[]).map(as);e({callSheets:a,loading:!1,error:null});const{data:r}=await _n.from("call_sheet_templates").select("*").eq("is_active",!0).order("name");r&&e({templates:r})}catch(Pc){e({loading:!1,error:Pc.message})}}else e({loading:!1,error:"Supabase not configured"})},loadCallSheet:async t=>{if(!kn())return null;try{const{data:n,error:a}=await _n.from("call_sheets").select("*").eq("id",t).single();if(a)throw a;let{data:r}=await _n.from("call_sheet_crew_extended").select("*").eq("call_sheet_id",t).order("sort_order");if(!r){r=(await _n.from("call_sheet_crew").select("*").eq("call_sheet_id",t).order("sort_order")).data}const{data:o}=await _n.from("call_sheet_cast").select("*").eq("call_sheet_id",t).order("sort_order"),{data:i}=await _n.from("call_sheet_department_calls").select("*").eq("call_sheet_id",t).order("sort_order"),{data:s}=await _n.from("call_sheet_accommodation").select("*").eq("call_sheet_id",t).order("sort_order"),l=(s||[]).map(e=>e.id);let c=[];if(l.length>0){const{data:e}=await _n.from("call_sheet_room_assignments").select("*").in("accommodation_id",l).order("check_in_date");c=e||[]}const{data:d}=await _n.from("call_sheet_flights").select("*").eq("call_sheet_id",t).order("departure_date",{ascending:!0}),{data:u}=await _n.from("call_sheet_transfers").select("*").eq("call_sheet_id",t).order("transfer_date",{ascending:!0}),{data:m}=await _n.from("call_sheet_vehicles").select("*").eq("call_sheet_id",t).order("sort_order"),{data:p}=await _n.from("call_sheet_technical").select("*").eq("call_sheet_id",t).maybeSingle(),{data:h}=await _n.from("call_sheet_vendors").select("*").eq("call_sheet_id",t).order("sort_order"),{data:f}=await _n.from("call_sheet_emergency_contacts").select("*").eq("call_sheet_id",t).order("sort_order"),{data:g}=await _n.from("call_sheet_catering").select("*").eq("call_sheet_id",t).order("sort_order"),{data:y}=await _n.from("call_sheet_weather").select("*").eq("call_sheet_id",t).order("forecast_date"),b=as(n),v=(r||[]).map(os),x=(o||[]).map(is),w=i||[],_=(s||[]).map(ss),k=c.map(ls),S=(d||[]).map(cs),C=(u||[]).map(ds),N=(m||[]).map(us),j=p?ms(p):null,T=(h||[]).map(ps),I=(f||[]).map(hs),D=(g||[]).map(fs),E=(y||[]).map(gs);return e({currentCallSheet:b,currentCrew:v,currentCast:x,currentDepartmentCalls:w,currentAccommodation:_,currentRoomAssignments:k,currentFlights:S,currentTransfers:C,currentVehicles:N,currentTechnical:j,currentVendors:T,currentEmergencyContacts:I,currentCatering:D,currentWeather:E}),{callSheet:b,crew:v,cast:x,departmentCalls:w,accommodation:_,roomAssignments:k,flights:S,transfers:C,vehicles:N,technical:j,vendors:T,emergencyContacts:I,catering:D,weather:E}}catch(Pc){return null}},createCallSheet:async t=>{if(!kn())throw new Error("Supabase not configured");const n=rs(t),{data:a,error:r}=await _n.from("call_sheets").insert(n).select().single();if(r)throw r;const o=as(a);return e(e=>({callSheets:[...e.callSheets,o].sort((e,t)=>new Date(e.shootDate)-new Date(t.shootDate))})),o},updateCallSheet:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a=rs(n),{data:r,error:o}=await _n.from("call_sheets").update(a).eq("id",t).select().single();if(o)throw o;const i=as(r);return e(e=>({callSheets:e.callSheets.map(e=>e.id===t?{...e,...i}:e),currentCallSheet:e.currentCallSheet?.id===t?{...e.currentCallSheet,...i}:e.currentCallSheet})),i},deleteCallSheet:async t=>{if(!kn())throw new Error("Supabase not configured");try{const e=Xi.getState();await e.deleteByCallSheet(t)}catch(a){}const{error:n}=await _n.from("call_sheets").delete().eq("id",t);if(n)throw n;e(e=>({callSheets:e.callSheets.filter(e=>e.id!==t),currentCallSheet:e.currentCallSheet?.id===t?null:e.currentCallSheet}))},publishCallSheet:async(e,n=null)=>t().updateCallSheet(e,{status:es.PUBLISHED,publishedAt:(new Date).toISOString(),publishedBy:n}),completeCallSheet:async(e,n=null)=>t().updateCallSheet(e,{status:es.COMPLETED,actualWrap:n}),duplicateCallSheet:async(e,n,a=null)=>{if(!kn())throw new Error("Supabase not configured");try{const{data:r,error:o}=await _n.rpc("duplicate_call_sheet",{p_call_sheet_id:e,p_new_shoot_date:n,p_new_day_number:a});if(o)throw o;return await t().initialize(),r}catch(Pc){throw Pc}},addCrewMember:async(n,a)=>{if(!kn())throw new Error("Supabase not configured");const r={call_sheet_id:n,crew_id:a.crewId,name:a.name,role_title:a.roleTitle,department:a.department,phone:a.phone,email:a.email,call_time:a.callTime,call_location:a.callLocation,transport_mode:a.transportMode,pickup_time:a.pickupTime,pickup_location:a.pickupLocation,notes:a.notes,sort_order:a.sortOrder||0},{data:o,error:i}=await _n.from("call_sheet_crew").insert(r).select().single();if(i)throw i;const s=os(o);e(e=>({currentCrew:[...e.currentCrew,s]}));try{const e=t().currentCallSheet;if(e){const t=Xi.getState();await t.createBooking({crewId:a.crewId||null,projectId:e.projectId||null,callSheetId:n,crewName:a.name||"",crewRole:a.roleTitle||a.department||"",dayRate:a.dayRate||0,days:1,startDate:e.shootDate,endDate:e.shootDate,status:"confirmed",currency:a.currency||"USD"})}}catch(l){}return s},updateCrewMember:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={};void 0!==n.name&&(a.name=n.name),void 0!==n.roleTitle&&(a.role_title=n.roleTitle),void 0!==n.department&&(a.department=n.department),void 0!==n.phone&&(a.phone=n.phone),void 0!==n.email&&(a.email=n.email),void 0!==n.callTime&&(a.call_time=n.callTime),void 0!==n.callLocation&&(a.call_location=n.callLocation),void 0!==n.transportMode&&(a.transport_mode=n.transportMode),void 0!==n.pickupTime&&(a.pickup_time=n.pickupTime),void 0!==n.pickupLocation&&(a.pickup_location=n.pickupLocation),void 0!==n.notes&&(a.notes=n.notes),void 0!==n.confirmed&&(a.confirmed=n.confirmed,a.confirmed_at=n.confirmed?(new Date).toISOString():null),void 0!==n.sortOrder&&(a.sort_order=n.sortOrder);const{data:r,error:o}=await _n.from("call_sheet_crew").update(a).eq("id",t).select().single();if(o)throw o;const i=os(r);return e(e=>({currentCrew:e.currentCrew.map(e=>e.id===t?{...e,...i}:e)})),i},removeCrewMember:async n=>{if(!kn())throw new Error("Supabase not configured");const a=t().currentCrew.find(e=>e.id===n),r=t().currentCallSheet,{error:o}=await _n.from("call_sheet_crew").delete().eq("id",n);if(o)throw o;if(e(e=>({currentCrew:e.currentCrew.filter(e=>e.id!==n)})),a&&r)try{const e=Xi.getState(),t=e.getBookingsByCallSheet(r.id).find(e=>e.crewId===a.crewId||e.crewName===a.name);t&&await e.deleteBooking(t.id)}catch(i){}},addCastMember:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={call_sheet_id:t,name:n.name,character_name:n.characterName,agent_contact:n.agentContact,pickup_time:n.pickupTime,pickup_location:n.pickupLocation,makeup_call:n.makeupCall,wardrobe_call:n.wardrobeCall,on_set_call:n.onSetCall,scenes:n.scenes||[],wardrobe_notes:n.wardrobeNotes,makeup_notes:n.makeupNotes,notes:n.notes,sort_order:n.sortOrder||0},{data:r,error:o}=await _n.from("call_sheet_cast").insert(a).select().single();if(o)throw o;const i=is(r);return e(e=>({currentCast:[...e.currentCast,i]})),i},updateCastMember:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={};void 0!==n.name&&(a.name=n.name),void 0!==n.characterName&&(a.character_name=n.characterName),void 0!==n.agentContact&&(a.agent_contact=n.agentContact),void 0!==n.pickupTime&&(a.pickup_time=n.pickupTime),void 0!==n.pickupLocation&&(a.pickup_location=n.pickupLocation),void 0!==n.makeupCall&&(a.makeup_call=n.makeupCall),void 0!==n.wardrobeCall&&(a.wardrobe_call=n.wardrobeCall),void 0!==n.onSetCall&&(a.on_set_call=n.onSetCall),void 0!==n.scenes&&(a.scenes=n.scenes),void 0!==n.wardrobeNotes&&(a.wardrobe_notes=n.wardrobeNotes),void 0!==n.makeupNotes&&(a.makeup_notes=n.makeupNotes),void 0!==n.notes&&(a.notes=n.notes),void 0!==n.confirmed&&(a.confirmed=n.confirmed,a.confirmed_at=n.confirmed?(new Date).toISOString():null),void 0!==n.sortOrder&&(a.sort_order=n.sortOrder);const{data:r,error:o}=await _n.from("call_sheet_cast").update(a).eq("id",t).select().single();if(o)throw o;const i=is(r);return e(e=>({currentCast:e.currentCast.map(e=>e.id===t?{...e,...i}:e)})),i},removeCastMember:async t=>{if(!kn())throw new Error("Supabase not configured");const{error:n}=await _n.from("call_sheet_cast").delete().eq("id",t);if(n)throw n;e(e=>({currentCast:e.currentCast.filter(e=>e.id!==t)}))},getUpcoming:()=>{const{callSheets:e}=t(),n=(new Date).toISOString().split("T")[0];return e.filter(e=>e.shootDate>=n&&e.status!==es.CANCELLED&&e.status!==es.COMPLETED)},getToday:()=>{const{callSheets:e}=t(),n=(new Date).toISOString().split("T")[0];return e.filter(e=>e.shootDate===n&&e.status!==es.CANCELLED)},getForProject:e=>{const{callSheets:n}=t();return n.filter(t=>t.projectId===e)},getStats:()=>{const{callSheets:e}=t(),n=(new Date).toISOString().split("T")[0],a=e.filter(e=>e.shootDate>=n&&e.status!==es.CANCELLED),r=e.filter(e=>e.shootDate===n&&e.status!==es.CANCELLED),o=e.filter(e=>e.status===es.DRAFT),i=e.filter(e=>{const t=new Date(e.shootDate),a=new Date;return a.setDate(a.getDate()+7),t>=new Date(n)&&t<=a&&e.status!==es.CANCELLED});return{total:e.length,upcoming:a.length,today:r.length,drafts:o.length,thisWeek:i.length}},clearCurrent:()=>{e({currentCallSheet:null,currentCrew:[],currentCast:[],currentDepartmentCalls:[],currentAccommodation:[],currentRoomAssignments:[],currentFlights:[],currentTransfers:[],currentVehicles:[],currentTechnical:null,currentVendors:[],currentEmergencyContacts:[],currentCatering:[],currentWeather:[]})},addAccommodation:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={call_sheet_id:t,hotel_name:n.hotelName,hotel_address:n.hotelAddress,hotel_city:n.hotelCity,hotel_country:n.hotelCountry,hotel_phone:n.hotelPhone,hotel_website:n.hotelWebsite,hotel_email:n.hotelEmail,distance_from_venue:n.distanceFromVenue,distance_from_airport:n.distanceFromAirport,breakfast_included:n.breakfastIncluded,wifi_available:n.wifiAvailable,parking_available:n.parkingAvailable,booking_reference:n.bookingReference,booking_contact:n.bookingContact,check_in_time:n.checkInTime,check_out_time:n.checkOutTime,payment_status:n.paymentStatus,payment_notes:n.paymentNotes,notes:n.notes,sort_order:n.sortOrder||0},{data:r,error:o}=await _n.from("call_sheet_accommodation").insert(a).select().single();if(o)throw o;const i=ss(r);return e(e=>({currentAccommodation:[...e.currentAccommodation,i]})),i},updateAccommodation:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={};void 0!==n.hotelName&&(a.hotel_name=n.hotelName),void 0!==n.hotelAddress&&(a.hotel_address=n.hotelAddress),void 0!==n.hotelCity&&(a.hotel_city=n.hotelCity),void 0!==n.hotelCountry&&(a.hotel_country=n.hotelCountry),void 0!==n.hotelPhone&&(a.hotel_phone=n.hotelPhone),void 0!==n.hotelWebsite&&(a.hotel_website=n.hotelWebsite),void 0!==n.hotelEmail&&(a.hotel_email=n.hotelEmail),void 0!==n.distanceFromVenue&&(a.distance_from_venue=n.distanceFromVenue),void 0!==n.distanceFromAirport&&(a.distance_from_airport=n.distanceFromAirport),void 0!==n.breakfastIncluded&&(a.breakfast_included=n.breakfastIncluded),void 0!==n.wifiAvailable&&(a.wifi_available=n.wifiAvailable),void 0!==n.parkingAvailable&&(a.parking_available=n.parkingAvailable),void 0!==n.bookingReference&&(a.booking_reference=n.bookingReference),void 0!==n.bookingContact&&(a.booking_contact=n.bookingContact),void 0!==n.checkInTime&&(a.check_in_time=n.checkInTime),void 0!==n.checkOutTime&&(a.check_out_time=n.checkOutTime),void 0!==n.paymentStatus&&(a.payment_status=n.paymentStatus),void 0!==n.paymentNotes&&(a.payment_notes=n.paymentNotes),void 0!==n.notes&&(a.notes=n.notes),void 0!==n.sortOrder&&(a.sort_order=n.sortOrder);const{data:r,error:o}=await _n.from("call_sheet_accommodation").update(a).eq("id",t).select().single();if(o)throw o;const i=ss(r);return e(e=>({currentAccommodation:e.currentAccommodation.map(e=>e.id===t?i:e)})),i},removeAccommodation:async t=>{if(!kn())throw new Error("Supabase not configured");const{error:n}=await _n.from("call_sheet_accommodation").delete().eq("id",t);if(n)throw n;e(e=>({currentAccommodation:e.currentAccommodation.filter(e=>e.id!==t),currentRoomAssignments:e.currentRoomAssignments.filter(e=>e.accommodationId!==t)}))},addRoomAssignment:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={accommodation_id:t,crew_id:n.crewId,crew_name:n.crewName,check_in_date:n.checkInDate,check_out_date:n.checkOutDate,room_number:n.roomNumber,room_type:n.roomType,early_check_in:n.earlyCheckIn,late_check_out:n.lateCheckOut,notes:n.notes},{data:r,error:o}=await _n.from("call_sheet_room_assignments").insert(a).select().single();if(o)throw o;const i=ls(r);return e(e=>({currentRoomAssignments:[...e.currentRoomAssignments,i]})),i},updateRoomAssignment:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={};void 0!==n.crewId&&(a.crew_id=n.crewId),void 0!==n.crewName&&(a.crew_name=n.crewName),void 0!==n.checkInDate&&(a.check_in_date=n.checkInDate),void 0!==n.checkOutDate&&(a.check_out_date=n.checkOutDate),void 0!==n.roomNumber&&(a.room_number=n.roomNumber),void 0!==n.roomType&&(a.room_type=n.roomType),void 0!==n.earlyCheckIn&&(a.early_check_in=n.earlyCheckIn),void 0!==n.lateCheckOut&&(a.late_check_out=n.lateCheckOut),void 0!==n.notes&&(a.notes=n.notes);const{data:r,error:o}=await _n.from("call_sheet_room_assignments").update(a).eq("id",t).select().single();if(o)throw o;const i=ls(r);return e(e=>({currentRoomAssignments:e.currentRoomAssignments.map(e=>e.id===t?i:e)})),i},removeRoomAssignment:async t=>{if(!kn())throw new Error("Supabase not configured");const{error:n}=await _n.from("call_sheet_room_assignments").delete().eq("id",t);if(n)throw n;e(e=>({currentRoomAssignments:e.currentRoomAssignments.filter(e=>e.id!==t)}))},addFlight:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={call_sheet_id:t,crew_id:n.crewId,crew_name:n.crewName,flight_type:n.flightType||"outbound",booking_reference:n.bookingReference,flight_number:n.flightNumber,airline:n.airline,departure_date:n.departureDate,departure_time:n.departureTime,departure_airport:n.departureAirport,departure_terminal:n.departureTerminal,arrival_date:n.arrivalDate,arrival_time:n.arrivalTime,arrival_airport:n.arrivalAirport,arrival_terminal:n.arrivalTerminal,has_connection:n.hasConnection,connection_airport:n.connectionAirport,connection_flight_number:n.connectionFlightNumber,connection_departure_time:n.connectionDepartureTime,notes:n.notes,sort_order:n.sortOrder||0},{data:r,error:o}=await _n.from("call_sheet_flights").insert(a).select().single();if(o)throw o;const i=cs(r);return e(e=>({currentFlights:[...e.currentFlights,i]})),i},updateFlight:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={};void 0!==n.crewId&&(a.crew_id=n.crewId),void 0!==n.crewName&&(a.crew_name=n.crewName),void 0!==n.flightType&&(a.flight_type=n.flightType),void 0!==n.bookingReference&&(a.booking_reference=n.bookingReference),void 0!==n.flightNumber&&(a.flight_number=n.flightNumber),void 0!==n.airline&&(a.airline=n.airline),void 0!==n.departureDate&&(a.departure_date=n.departureDate),void 0!==n.departureTime&&(a.departure_time=n.departureTime),void 0!==n.departureAirport&&(a.departure_airport=n.departureAirport),void 0!==n.departureTerminal&&(a.departure_terminal=n.departureTerminal),void 0!==n.arrivalDate&&(a.arrival_date=n.arrivalDate),void 0!==n.arrivalTime&&(a.arrival_time=n.arrivalTime),void 0!==n.arrivalAirport&&(a.arrival_airport=n.arrivalAirport),void 0!==n.arrivalTerminal&&(a.arrival_terminal=n.arrivalTerminal),void 0!==n.hasConnection&&(a.has_connection=n.hasConnection),void 0!==n.connectionAirport&&(a.connection_airport=n.connectionAirport),void 0!==n.connectionFlightNumber&&(a.connection_flight_number=n.connectionFlightNumber),void 0!==n.connectionDepartureTime&&(a.connection_departure_time=n.connectionDepartureTime),void 0!==n.notes&&(a.notes=n.notes),void 0!==n.sortOrder&&(a.sort_order=n.sortOrder);const{data:r,error:o}=await _n.from("call_sheet_flights").update(a).eq("id",t).select().single();if(o)throw o;const i=cs(r);return e(e=>({currentFlights:e.currentFlights.map(e=>e.id===t?i:e)})),i},removeFlight:async t=>{if(!kn())throw new Error("Supabase not configured");const{error:n}=await _n.from("call_sheet_flights").delete().eq("id",t);if(n)throw n;e(e=>({currentFlights:e.currentFlights.filter(e=>e.id!==t)}))},addTransfer:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={call_sheet_id:t,transfer_date:n.transferDate,transfer_time:n.transferTime,pickup_location:n.pickupLocation,dropoff_location:n.dropoffLocation,transport_type:n.transportType||"minibus",vehicle_details:n.vehicleDetails,capacity:n.capacity,provider_company:n.providerCompany,driver_name:n.driverName,driver_phone:n.driverPhone,passengers:n.passengers||[],max_passengers:n.maxPassengers,notes:n.notes,sort_order:n.sortOrder||0},{data:r,error:o}=await _n.from("call_sheet_transfers").insert(a).select().single();if(o)throw o;const i=ds(r);return e(e=>({currentTransfers:[...e.currentTransfers,i]})),i},updateTransfer:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={};void 0!==n.transferDate&&(a.transfer_date=n.transferDate),void 0!==n.transferTime&&(a.transfer_time=n.transferTime),void 0!==n.pickupLocation&&(a.pickup_location=n.pickupLocation),void 0!==n.dropoffLocation&&(a.dropoff_location=n.dropoffLocation),void 0!==n.transportType&&(a.transport_type=n.transportType),void 0!==n.vehicleDetails&&(a.vehicle_details=n.vehicleDetails),void 0!==n.capacity&&(a.capacity=n.capacity),void 0!==n.providerCompany&&(a.provider_company=n.providerCompany),void 0!==n.driverName&&(a.driver_name=n.driverName),void 0!==n.driverPhone&&(a.driver_phone=n.driverPhone),void 0!==n.passengers&&(a.passengers=n.passengers),void 0!==n.maxPassengers&&(a.max_passengers=n.maxPassengers),void 0!==n.notes&&(a.notes=n.notes),void 0!==n.sortOrder&&(a.sort_order=n.sortOrder);const{data:r,error:o}=await _n.from("call_sheet_transfers").update(a).eq("id",t).select().single();if(o)throw o;const i=ds(r);return e(e=>({currentTransfers:e.currentTransfers.map(e=>e.id===t?i:e)})),i},removeTransfer:async t=>{if(!kn())throw new Error("Supabase not configured");const{error:n}=await _n.from("call_sheet_transfers").delete().eq("id",t);if(n)throw n;e(e=>({currentTransfers:e.currentTransfers.filter(e=>e.id!==t)}))},addVehicle:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={call_sheet_id:t,vehicle_type:n.vehicleType,vehicle_name:n.vehicleName,license_plate:n.licensePlate,length_meters:n.lengthMeters,width_meters:n.widthMeters,height_meters:n.heightMeters,company:n.company,driver_name:n.driverName,driver_phone:n.driverPhone,assigned_location:n.assignedLocation,parking_spot:n.parkingSpot,arrival_time:n.arrivalTime,departure_time:n.departureTime,notes:n.notes,overnight_security:n.overnightSecurity,sort_order:n.sortOrder||0},{data:r,error:o}=await _n.from("call_sheet_vehicles").insert(a).select().single();if(o)throw o;const i=us(r);return e(e=>({currentVehicles:[...e.currentVehicles,i]})),i},updateVehicle:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={};void 0!==n.vehicleType&&(a.vehicle_type=n.vehicleType),void 0!==n.vehicleName&&(a.vehicle_name=n.vehicleName),void 0!==n.licensePlate&&(a.license_plate=n.licensePlate),void 0!==n.lengthMeters&&(a.length_meters=n.lengthMeters),void 0!==n.widthMeters&&(a.width_meters=n.widthMeters),void 0!==n.heightMeters&&(a.height_meters=n.heightMeters),void 0!==n.company&&(a.company=n.company),void 0!==n.driverName&&(a.driver_name=n.driverName),void 0!==n.driverPhone&&(a.driver_phone=n.driverPhone),void 0!==n.assignedLocation&&(a.assigned_location=n.assignedLocation),void 0!==n.parkingSpot&&(a.parking_spot=n.parkingSpot),void 0!==n.arrivalTime&&(a.arrival_time=n.arrivalTime),void 0!==n.departureTime&&(a.departure_time=n.departureTime),void 0!==n.notes&&(a.notes=n.notes),void 0!==n.overnightSecurity&&(a.overnight_security=n.overnightSecurity),void 0!==n.sortOrder&&(a.sort_order=n.sortOrder);const{data:r,error:o}=await _n.from("call_sheet_vehicles").update(a).eq("id",t).select().single();if(o)throw o;const i=us(r);return e(e=>({currentVehicles:e.currentVehicles.map(e=>e.id===t?i:e)})),i},removeVehicle:async t=>{if(!kn())throw new Error("Supabase not configured");const{error:n}=await _n.from("call_sheet_vehicles").delete().eq("id",t);if(n)throw n;e(e=>({currentVehicles:e.currentVehicles.filter(e=>e.id!==t)}))},saveTechnical:async(n,a)=>{if(!kn())throw new Error("Supabase not configured");const r={call_sheet_id:n,camera_positions:a.cameraPositions||[],cable_runs:a.cableRuns||[],audio_setup:a.audioSetup||{},video_routing:a.videoRouting||[],graphics_setup:a.graphicsSetup,vt_setup:a.vtSetup,comms_setup:a.commsSetup,radio_channels:a.radioChannels||[],recording_setup:a.recordingSetup||[],monitors:a.monitors||[],lighting_setup:a.lightingSetup,power_requirements:a.powerRequirements,generator_info:a.generatorInfo,uplink_info:a.uplinkInfo,internet_info:a.internetInfo,notes:a.notes},o=t().currentTechnical;if(o){const{data:t,error:n}=await _n.from("call_sheet_technical").update(r).eq("id",o.id).select().single();if(n)throw n;const a=ms(t);return e({currentTechnical:a}),a}{const{data:t,error:n}=await _n.from("call_sheet_technical").insert(r).select().single();if(n)throw n;const a=ms(t);return e({currentTechnical:a}),a}},addVendor:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={call_sheet_id:t,company_name:n.companyName,vendor_type:n.vendorType,contact_name:n.contactName,contact_role:n.contactRole,contact_phone:n.contactPhone,contact_email:n.contactEmail,additional_contacts:n.additionalContacts||[],notes:n.notes,on_site:void 0===n.onSite||n.onSite,sort_order:n.sortOrder||0},{data:r,error:o}=await _n.from("call_sheet_vendors").insert(a).select().single();if(o)throw o;const i=ps(r);return e(e=>({currentVendors:[...e.currentVendors,i]})),i},updateVendor:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={};void 0!==n.companyName&&(a.company_name=n.companyName),void 0!==n.vendorType&&(a.vendor_type=n.vendorType),void 0!==n.contactName&&(a.contact_name=n.contactName),void 0!==n.contactRole&&(a.contact_role=n.contactRole),void 0!==n.contactPhone&&(a.contact_phone=n.contactPhone),void 0!==n.contactEmail&&(a.contact_email=n.contactEmail),void 0!==n.additionalContacts&&(a.additional_contacts=n.additionalContacts),void 0!==n.notes&&(a.notes=n.notes),void 0!==n.onSite&&(a.on_site=n.onSite),void 0!==n.sortOrder&&(a.sort_order=n.sortOrder);const{data:r,error:o}=await _n.from("call_sheet_vendors").update(a).eq("id",t).select().single();if(o)throw o;const i=ps(r);return e(e=>({currentVendors:e.currentVendors.map(e=>e.id===t?i:e)})),i},removeVendor:async t=>{if(!kn())throw new Error("Supabase not configured");const{error:n}=await _n.from("call_sheet_vendors").delete().eq("id",t);if(n)throw n;e(e=>({currentVendors:e.currentVendors.filter(e=>e.id!==t)}))},addEmergencyContact:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={call_sheet_id:t,contact_type:n.contactType,name:n.name,organization:n.organization,phone:n.phone,phone_secondary:n.phoneSecondary,address:n.address,distance_from_venue:n.distanceFromVenue,notes:n.notes,is_24_hour:n.is24Hour,sort_order:n.sortOrder||0},{data:r,error:o}=await _n.from("call_sheet_emergency_contacts").insert(a).select().single();if(o)throw o;const i=hs(r);return e(e=>({currentEmergencyContacts:[...e.currentEmergencyContacts,i]})),i},updateEmergencyContact:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={};void 0!==n.contactType&&(a.contact_type=n.contactType),void 0!==n.name&&(a.name=n.name),void 0!==n.organization&&(a.organization=n.organization),void 0!==n.phone&&(a.phone=n.phone),void 0!==n.phoneSecondary&&(a.phone_secondary=n.phoneSecondary),void 0!==n.address&&(a.address=n.address),void 0!==n.distanceFromVenue&&(a.distance_from_venue=n.distanceFromVenue),void 0!==n.notes&&(a.notes=n.notes),void 0!==n.is24Hour&&(a.is_24_hour=n.is24Hour),void 0!==n.sortOrder&&(a.sort_order=n.sortOrder);const{data:r,error:o}=await _n.from("call_sheet_emergency_contacts").update(a).eq("id",t).select().single();if(o)throw o;const i=hs(r);return e(e=>({currentEmergencyContacts:e.currentEmergencyContacts.map(e=>e.id===t?i:e)})),i},removeEmergencyContact:async t=>{if(!kn())throw new Error("Supabase not configured");const{error:n}=await _n.from("call_sheet_emergency_contacts").delete().eq("id",t);if(n)throw n;e(e=>({currentEmergencyContacts:e.currentEmergencyContacts.filter(e=>e.id!==t)}))},addCatering:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={call_sheet_id:t,meal_type:n.mealType,meal_time:n.mealTime,location:n.location,provider_name:n.providerName,provider_phone:n.providerPhone,headcount:n.headcount,dietary_notes:n.dietaryNotes,menu_description:n.menuDescription,cost_per_head:n.costPerHead,total_cost:n.totalCost,payment_status:n.paymentStatus||"pending",notes:n.notes,sort_order:n.sortOrder||0},{data:r,error:o}=await _n.from("call_sheet_catering").insert(a).select().single();if(o)throw o;const i=fs(r);return e(e=>({currentCatering:[...e.currentCatering,i]})),i},updateCatering:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={};void 0!==n.mealType&&(a.meal_type=n.mealType),void 0!==n.mealTime&&(a.meal_time=n.mealTime),void 0!==n.location&&(a.location=n.location),void 0!==n.providerName&&(a.provider_name=n.providerName),void 0!==n.providerPhone&&(a.provider_phone=n.providerPhone),void 0!==n.headcount&&(a.headcount=n.headcount),void 0!==n.dietaryNotes&&(a.dietary_notes=n.dietaryNotes),void 0!==n.menuDescription&&(a.menu_description=n.menuDescription),void 0!==n.costPerHead&&(a.cost_per_head=n.costPerHead),void 0!==n.totalCost&&(a.total_cost=n.totalCost),void 0!==n.paymentStatus&&(a.payment_status=n.paymentStatus),void 0!==n.notes&&(a.notes=n.notes),void 0!==n.sortOrder&&(a.sort_order=n.sortOrder);const{data:r,error:o}=await _n.from("call_sheet_catering").update(a).eq("id",t).select().single();if(o)throw o;const i=fs(r);return e(e=>({currentCatering:e.currentCatering.map(e=>e.id===t?i:e)})),i},removeCatering:async t=>{if(!kn())throw new Error("Supabase not configured");const{error:n}=await _n.from("call_sheet_catering").delete().eq("id",t);if(n)throw n;e(e=>({currentCatering:e.currentCatering.filter(e=>e.id!==t)}))},addWeather:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={call_sheet_id:t,forecast_date:n.forecastDate,condition:n.condition,condition_icon:n.conditionIcon,temp_high_celsius:n.tempHighCelsius,temp_low_celsius:n.tempLowCelsius,humidity_percent:n.humidityPercent,wind_speed_kmh:n.windSpeedKmh,wind_direction:n.windDirection,precipitation_percent:n.precipitationPercent,uv_index:n.uvIndex,sunrise:n.sunrise,sunset:n.sunset,notes:n.notes},{data:r,error:o}=await _n.from("call_sheet_weather").insert(a).select().single();if(o)throw o;const i=gs(r);return e(e=>({currentWeather:[...e.currentWeather,i]})),i},updateWeather:async(t,n)=>{if(!kn())throw new Error("Supabase not configured");const a={};void 0!==n.forecastDate&&(a.forecast_date=n.forecastDate),void 0!==n.condition&&(a.condition=n.condition),void 0!==n.conditionIcon&&(a.condition_icon=n.conditionIcon),void 0!==n.tempHighCelsius&&(a.temp_high_celsius=n.tempHighCelsius),void 0!==n.tempLowCelsius&&(a.temp_low_celsius=n.tempLowCelsius),void 0!==n.humidityPercent&&(a.humidity_percent=n.humidityPercent),void 0!==n.windSpeedKmh&&(a.wind_speed_kmh=n.windSpeedKmh),void 0!==n.windDirection&&(a.wind_direction=n.windDirection),void 0!==n.precipitationPercent&&(a.precipitation_percent=n.precipitationPercent),void 0!==n.uvIndex&&(a.uv_index=n.uvIndex),void 0!==n.sunrise&&(a.sunrise=n.sunrise),void 0!==n.sunset&&(a.sunset=n.sunset),void 0!==n.notes&&(a.notes=n.notes);const{data:r,error:o}=await _n.from("call_sheet_weather").update(a).eq("id",t).select().single();if(o)throw o;const i=gs(r);return e(e=>({currentWeather:e.currentWeather.map(e=>e.id===t?i:e)})),i},removeWeather:async t=>{if(!kn())throw new Error("Supabase not configured");const{error:n}=await _n.from("call_sheet_weather").delete().eq("id",t);if(n)throw n;e(e=>({currentWeather:e.currentWeather.filter(e=>e.id!==t)}))}}))),bs={draft:{label:"Draft",color:"text-gray-400 bg-gray-500/10 border-gray-500/20"},sent:{label:"Sent",color:"text-blue-400 bg-blue-500/10 border-blue-500/20"},paid:{label:"Paid",color:"text-green-400 bg-green-500/10 border-green-500/20"},overdue:{label:"Overdue",color:"text-red-400 bg-red-500/10 border-red-500/20"},cancelled:{label:"Cancelled",color:"text-gray-500 bg-gray-600/10 border-gray-600/20"}};function vs(e){return{id:e.id,invoiceNumber:e.invoice_number,quoteId:e.quote_id,clientId:e.client_id,projectId:e.project_id,status:e.status||"draft",subtotal:parseFloat(e.subtotal)||0,taxRate:parseFloat(e.tax_rate)||0,taxAmount:parseFloat(e.tax_amount)||0,total:parseFloat(e.total)||0,currency:e.currency||"USD",issueDate:e.issue_date,dueDate:e.due_date,paidDate:e.paid_date,lineItems:e.line_items||[],notes:e.notes||"",clientName:e.client_name||"",clientEmail:e.client_email||"",clientAddress:e.client_address||"",quoteNumber:e.quote_number||"",lockedExchangeRates:e.locked_exchange_rates||null,createdAt:e.created_at,updatedAt:e.updated_at}}function xs(e){return{invoice_number:e.invoiceNumber,quote_id:e.quoteId||null,client_id:e.clientId||null,project_id:e.projectId||null,status:e.status||"draft",subtotal:e.subtotal||0,tax_rate:e.taxRate||0,tax_amount:e.taxAmount||0,total:e.total||0,currency:e.currency||"USD",issue_date:e.issueDate||null,due_date:e.dueDate||null,paid_date:e.paidDate||null,line_items:e.lineItems||[],notes:e.notes||"",client_name:e.clientName||"",client_email:e.clientEmail||"",client_address:e.clientAddress||"",quote_number:e.quoteNumber||"",locked_exchange_rates:e.lockedExchangeRates||null}}const ws=h($n((e,t)=>({invoices:[],loading:!1,error:null,realtimeSubscription:null,initialize:async()=>{if(kn()){e({loading:!0,error:null});try{const{data:n,error:a}=await _n.from("invoices").select("*").order("created_at",{ascending:!1});if(a)throw a;const r=(n||[]).map(vs);e({invoices:r,loading:!1});const o=_n.channel("invoices-changes").on("postgres_changes",{event:"*",schema:"public",table:"invoices"},n=>{const{eventType:a,new:r,old:o}=n,i=t();if("INSERT"===a){const t=vs(r);i.invoices.find(e=>e.id===t.id)||e({invoices:[t,...i.invoices]})}else if("UPDATE"===a){const t=vs(r);e({invoices:i.invoices.map(e=>e.id===t.id?t:e)})}else"DELETE"===a&&e({invoices:i.invoices.filter(e=>e.id!==o.id)})}).subscribe();e({realtimeSubscription:o})}catch(n){e({error:n.message,loading:!1})}}else e({loading:!1,error:"Supabase not configured"})},createInvoice:async n=>{if(!kn())return null;try{const a=t(),r=n.invoiceNumber||function(e){const t=`INV-${(new Date).getFullYear()}-`,n=e.map(e=>e.invoiceNumber).filter(e=>e?.startsWith(t)).map(e=>parseInt(e.replace(t,""),10)).filter(e=>!isNaN(e)),a=n.length>0?Math.max(...n):0;return`${t}${String(a+1).padStart(4,"0")}`}(a.invoices);let o=n.lockedExchangeRates;if(!o){const{rates:e}=await ha();o={rates:e,lockedAt:(new Date).toISOString(),baseCurrency:"USD"}}const i={...n,invoiceNumber:r,status:n.status||"draft",issueDate:n.issueDate||(new Date).toISOString().split("T")[0],lockedExchangeRates:o},{data:s,error:l}=await _n.from("invoices").insert(xs(i)).select().single();if(l)throw l;const c=vs(s);return e({invoices:[c,...a.invoices]}),c}catch(a){return null}},createFromQuote:async(e,n)=>{if(!e)return null;const a=[];e.sections&&Object.entries(e.sections).forEach(([e,t])=>{t.subsections&&Object.entries(t.subsections).forEach(([t,n])=>{n.items&&n.items.forEach(n=>{n.description&&(n.charge>0||n.total>0)&&a.push({description:n.description,quantity:n.quantity||1,days:n.days||1,rate:n.charge||n.cost||0,total:n.total||n.quantity*n.days*(n.charge||n.cost||0),section:e,subsection:t})})})});const r=a.reduce((e,t)=>e+(t.total||0),0),o=e.taxRate||0,i=r*(o/100),s=r+i,l=new Date;l.setDate(l.getDate()+30);const c={quoteId:e.id,quoteNumber:e.quote_number||e.quoteNumber||"",clientId:e.clientId||n?.id,clientName:n?.company||e.clientName||"",clientEmail:n?.email||e.clientEmail||"",clientAddress:n?.address||e.clientAddress||"",projectId:e.projectId||null,currency:e.currency||"USD",lineItems:a,subtotal:r,taxRate:o,taxAmount:i,total:s,dueDate:l.toISOString().split("T")[0],notes:e.terms||""};return t().createInvoice(c)},updateInvoice:async(n,a)=>{if(!kn())return!1;try{const{error:r}=await _n.from("invoices").update(xs(a)).eq("id",n);if(r)throw r;return e({invoices:t().invoices.map(e=>e.id===n?{...e,...a}:e)}),!0}catch(r){return!1}},updateStatus:async(e,n)=>{const a={status:n};return"paid"===n&&(a.paidDate=(new Date).toISOString().split("T")[0]),t().updateInvoice(e,a)},deleteInvoice:async n=>{if(!kn())return!1;try{const{error:a}=await _n.from("invoices").delete().eq("id",n);if(a)throw a;return e({invoices:t().invoices.filter(e=>e.id!==n)}),!0}catch(a){return!1}},getInvoiceById:e=>t().invoices.find(t=>t.id===e),getInvoicesByClient:e=>t().invoices.filter(t=>t.clientId===e),getInvoicesByProject:e=>t().invoices.filter(t=>t.projectId===e),getStats:()=>{const e=t().invoices,n=new Date;return{total:e.length,draft:e.filter(e=>"draft"===e.status).length,sent:e.filter(e=>"sent"===e.status).length,paid:e.filter(e=>"paid"===e.status).length,overdue:e.filter(e=>"paid"!==e.status&&"cancelled"!==e.status&&(e.dueDate&&new Date(e.dueDate)<n)).length,totalRevenue:e.filter(e=>"paid"===e.status).reduce((e,t)=>e+(t.total||0),0),totalOutstanding:e.filter(e=>"sent"===e.status).reduce((e,t)=>e+(t.total||0),0)}},cleanup:()=>{const n=t().realtimeSubscription;n&&_n.removeChannel(n),e({realtimeSubscription:null})}}))),_s=["Travel","Equipment Rental","Crew Fees","Catering","Transport","Accommodation","Insurance","Permits","Props & Materials","Post Production","Marketing","Office","Software","Other"];function ks(e){return{id:e.id,projectId:e.project_id,clientId:e.client_id,category:e.category,description:e.description||"",amount:parseFloat(e.amount)||0,currency:e.currency||"USD",date:e.date,receiptUrl:e.receipt_url||"",isBillable:e.is_billable||!1,vendor:e.vendor||"",notes:e.notes||"",createdAt:e.created_at,updatedAt:e.updated_at}}function Ss(e){return{project_id:e.projectId||null,client_id:e.clientId||null,category:e.category,description:e.description||"",amount:e.amount||0,currency:e.currency||"USD",date:e.date,receipt_url:e.receiptUrl||null,is_billable:e.isBillable||!1,vendor:e.vendor||"",notes:e.notes||""}}const Cs=h($n((e,t)=>({expenses:[],loading:!1,error:null,realtimeSubscription:null,initialize:async()=>{if(kn()){e({loading:!0,error:null});try{const{data:n,error:a}=await _n.from("expenses").select("*").order("date",{ascending:!1});if(a)throw a;const r=(n||[]).map(ks);e({expenses:r,loading:!1});const o=_n.channel("expenses-changes").on("postgres_changes",{event:"*",schema:"public",table:"expenses"},n=>{const{eventType:a,new:r,old:o}=n,i=t();if("INSERT"===a){const t=ks(r);i.expenses.find(e=>e.id===t.id)||e({expenses:[t,...i.expenses]})}else if("UPDATE"===a){const t=ks(r);e({expenses:i.expenses.map(e=>e.id===t.id?t:e)})}else"DELETE"===a&&e({expenses:i.expenses.filter(e=>e.id!==o.id)})}).subscribe();e({realtimeSubscription:o})}catch(n){e({error:n.message,loading:!1})}}else e({loading:!1,error:"Supabase not configured"})},createExpense:async n=>{if(!kn())return null;try{const a={...n,date:n.date||(new Date).toISOString().split("T")[0]},{data:r,error:o}=await _n.from("expenses").insert(Ss(a)).select().single();if(o)throw o;const i=ks(r);return e({expenses:[i,...t().expenses]}),i}catch(a){return null}},updateExpense:async(n,a)=>{if(!kn())return!1;try{const{error:r}=await _n.from("expenses").update(Ss(a)).eq("id",n);if(r)throw r;return e({expenses:t().expenses.map(e=>e.id===n?{...e,...a}:e)}),!0}catch(r){return!1}},deleteExpense:async n=>{if(!kn())return!1;try{const{error:a}=await _n.from("expenses").delete().eq("id",n);if(a)throw a;return e({expenses:t().expenses.filter(e=>e.id!==n)}),!0}catch(a){return!1}},getExpenseById:e=>t().expenses.find(t=>t.id===e),getExpensesByProject:e=>t().expenses.filter(t=>t.projectId===e),getExpensesByClient:e=>t().expenses.filter(t=>t.clientId===e),getExpensesByCategory:e=>t().expenses.filter(t=>t.category===e),getProjectTotal:e=>t().expenses.filter(t=>t.projectId===e).reduce((e,t)=>e+(t.amount||0),0),getStats:()=>{const e=t().expenses,n=new Date,a=n.getMonth(),r=n.getFullYear(),o=e.filter(e=>{const t=new Date(e.date);return t.getMonth()===a&&t.getFullYear()===r}),i=_s.reduce((t,n)=>(t[n]=e.filter(e=>e.category===n).reduce((e,t)=>e+(t.amount||0),0),t),{});return{total:e.reduce((e,t)=>e+(t.amount||0),0),thisMonth:o.reduce((e,t)=>e+(t.amount||0),0),count:e.length,thisMonthCount:o.length,byCategory:i,billable:e.filter(e=>e.isBillable).reduce((e,t)=>e+(t.amount||0),0)}},cleanup:()=>{const n=t().realtimeSubscription;n&&_n.removeChannel(n),e({realtimeSubscription:null})}}))),Ns={draft:{label:"Draft",color:"text-gray-400 bg-gray-500/10 border-gray-500/20"},pending:{label:"Pending Approval",color:"text-amber-400 bg-amber-500/10 border-amber-500/20"},approved:{label:"Approved",color:"text-blue-400 bg-blue-500/10 border-blue-500/20"},sent:{label:"Sent to Vendor",color:"text-cyan-400 bg-cyan-500/10 border-cyan-500/20"},received:{label:"Received",color:"text-green-400 bg-green-500/10 border-green-500/20"},cancelled:{label:"Cancelled",color:"text-gray-500 bg-gray-600/10 border-gray-600/20"}},js={equipment:{label:"Equipment Rental",icon:"camera"},crew:{label:"Crew/Freelance",icon:"users"},venue:{label:"Venue/Location",icon:"building"},transport:{label:"Transport/Logistics",icon:"truck"},catering:{label:"Catering",icon:"utensils"},props:{label:"Props/Set Design",icon:"box"},post:{label:"Post Production",icon:"film"},other:{label:"Other",icon:"file"}};function Ts(e){return{id:e.id,poNumber:e.po_number,projectId:e.project_id,vendorId:e.vendor_id,vendorName:e.vendor_name||"",vendorEmail:e.vendor_email||"",vendorPhone:e.vendor_phone||"",vendorAddress:e.vendor_address||"",category:e.category||"other",status:e.status||"draft",description:e.description||"",lineItems:e.line_items||[],subtotal:parseFloat(e.subtotal)||0,taxRate:parseFloat(e.tax_rate)||0,taxAmount:parseFloat(e.tax_amount)||0,total:parseFloat(e.total)||0,currency:e.currency||"USD",issueDate:e.issue_date,deliveryDate:e.delivery_date,deliveryLocation:e.delivery_location||"",paymentTerms:e.payment_terms||"Net 30",notes:e.notes||"",internalNotes:e.internal_notes||"",attachments:e.attachments||[],approvedBy:e.approved_by,approvedAt:e.approved_at,lockedExchangeRates:e.locked_exchange_rates||null,createdAt:e.created_at,updatedAt:e.updated_at}}function Is(e){return{po_number:e.poNumber,project_id:e.projectId||null,vendor_id:e.vendorId||null,vendor_name:e.vendorName||"",vendor_email:e.vendorEmail||"",vendor_phone:e.vendorPhone||"",vendor_address:e.vendorAddress||"",category:e.category||"other",status:e.status||"draft",description:e.description||"",line_items:e.lineItems||[],subtotal:e.subtotal||0,tax_rate:e.taxRate||0,tax_amount:e.taxAmount||0,total:e.total||0,currency:e.currency||"USD",issue_date:e.issueDate||null,delivery_date:e.deliveryDate||null,delivery_location:e.deliveryLocation||"",payment_terms:e.paymentTerms||"Net 30",notes:e.notes||"",internal_notes:e.internalNotes||"",attachments:e.attachments||[],approved_by:e.approvedBy||null,approved_at:e.approvedAt||null,locked_exchange_rates:e.lockedExchangeRates||null}}const Ds=h($n((e,t)=>({purchaseOrders:[],loading:!1,error:null,realtimeSubscription:null,initialize:async()=>{if(kn()){e({loading:!0,error:null});try{const{data:n,error:a}=await _n.from("purchase_orders").select("*").order("created_at",{ascending:!1});if(a)throw a;const r=(n||[]).map(Ts);e({purchaseOrders:r,loading:!1});const o=_n.channel("purchase-orders-changes").on("postgres_changes",{event:"*",schema:"public",table:"purchase_orders"},n=>{const{eventType:a,new:r,old:o}=n,i=t();if("INSERT"===a){const t=Ts(r);i.purchaseOrders.find(e=>e.id===t.id)||e({purchaseOrders:[t,...i.purchaseOrders]})}else if("UPDATE"===a){const t=Ts(r);e({purchaseOrders:i.purchaseOrders.map(e=>e.id===t.id?t:e)})}else"DELETE"===a&&e({purchaseOrders:i.purchaseOrders.filter(e=>e.id!==o.id)})}).subscribe();e({realtimeSubscription:o})}catch(n){e({error:n.message,loading:!1})}}else e({loading:!1,error:"Supabase not configured"})},createPurchaseOrder:async n=>{if(!kn())return null;try{const a=t(),r=n.poNumber||function(e){const t=`PO-${(new Date).getFullYear()}-`,n=e.map(e=>e.poNumber).filter(e=>e?.startsWith(t)).map(e=>parseInt(e.replace(t,""),10)).filter(e=>!isNaN(e)),a=n.length>0?Math.max(...n):0;return`${t}${String(a+1).padStart(4,"0")}`}(a.purchaseOrders);let o=n.lockedExchangeRates;if(!o){const{rates:e}=await ha();o={rates:e,lockedAt:(new Date).toISOString(),baseCurrency:"USD"}}const i={...n,poNumber:r,status:n.status||"draft",issueDate:n.issueDate||(new Date).toISOString().split("T")[0],lockedExchangeRates:o},{data:s,error:l}=await _n.from("purchase_orders").insert(Is(i)).select().single();if(l)throw l;const c=Ts(s);return e({purchaseOrders:[c,...a.purchaseOrders]}),c}catch(a){return null}},updatePurchaseOrder:async(n,a)=>{if(!kn())return!1;try{const{error:r}=await _n.from("purchase_orders").update(Is(a)).eq("id",n);if(r)throw r;return e({purchaseOrders:t().purchaseOrders.map(e=>e.id===n?{...e,...a}:e)}),!0}catch(r){return!1}},updateStatus:async(e,n)=>{const a={status:n};return"approved"===n&&(a.approvedAt=(new Date).toISOString()),t().updatePurchaseOrder(e,a)},deletePurchaseOrder:async n=>{if(!kn())return!1;try{const{error:a}=await _n.from("purchase_orders").delete().eq("id",n);if(a)throw a;return e({purchaseOrders:t().purchaseOrders.filter(e=>e.id!==n)}),!0}catch(a){return!1}},getPurchaseOrderById:e=>t().purchaseOrders.find(t=>t.id===e),getPurchaseOrdersByProject:e=>t().purchaseOrders.filter(t=>t.projectId===e),getPurchaseOrdersByVendor:e=>t().purchaseOrders.filter(t=>t.vendorId===e),getStats:()=>{const e=t().purchaseOrders;return{total:e.length,draft:e.filter(e=>"draft"===e.status).length,pending:e.filter(e=>"pending"===e.status).length,approved:e.filter(e=>"approved"===e.status).length,sent:e.filter(e=>"sent"===e.status).length,received:e.filter(e=>"received"===e.status).length,totalValue:e.filter(e=>"cancelled"!==e.status).reduce((e,t)=>e+(t.total||0),0),pendingValue:e.filter(e=>["pending","approved","sent"].includes(e.status)).reduce((e,t)=>e+(t.total||0),0)}},cleanup:()=>{const n=t().realtimeSubscription;n&&_n.removeChannel(n),e({realtimeSubscription:null})}}))),Es={draft:{label:"Draft",color:"text-gray-400 bg-gray-500/10 border-gray-500/20"},pending_review:{label:"Pending Review",color:"text-amber-400 bg-amber-500/10 border-amber-500/20"},sent:{label:"Sent",color:"text-blue-400 bg-blue-500/10 border-blue-500/20"},signed:{label:"Signed",color:"text-green-400 bg-green-500/10 border-green-500/20"},active:{label:"Active",color:"text-teal-400 bg-teal-500/10 border-teal-500/20"},completed:{label:"Completed",color:"text-purple-400 bg-purple-500/10 border-purple-500/20"},cancelled:{label:"Cancelled",color:"text-gray-500 bg-gray-600/10 border-gray-600/20"},expired:{label:"Expired",color:"text-red-400 bg-red-500/10 border-red-500/20"}},Ls={crew:{label:"Crew Agreement",icon:"users"},client:{label:"Client Agreement",icon:"briefcase"},vendor:{label:"Vendor Agreement",icon:"truck"},nda:{label:"NDA",icon:"shield"},location:{label:"Location Release",icon:"map-pin"},talent:{label:"Talent Release",icon:"user"},licensing:{label:"Licensing/Rights",icon:"file-text"},other:{label:"Other",icon:"file"}};function As(e){return{id:e.id,contractRef:e.contract_ref,title:e.title||"",contractType:e.contract_type||"other",status:e.status||"draft",projectId:e.project_id,clientId:e.client_id,crewId:e.crew_id,vendorId:e.vendor_id,partyName:e.party_name||"",partyEmail:e.party_email||"",partyPhone:e.party_phone||"",partyAddress:e.party_address||"",partyCompany:e.party_company||"",startDate:e.start_date,endDate:e.end_date,signedDate:e.signed_date,expiresAt:e.expires_at,value:parseFloat(e.value)||0,currency:e.currency||"USD",paymentTerms:e.payment_terms||"",description:e.description||"",terms:e.terms||"",specialClauses:e.special_clauses||[],documentUrl:e.document_url||"",signedDocumentUrl:e.signed_document_url||"",attachments:e.attachments||[],tags:e.tags||[],notes:e.notes||"",internalNotes:e.internal_notes||"",createdBy:e.created_by,createdAt:e.created_at,updatedAt:e.updated_at}}function Ps(e){return{contract_ref:e.contractRef,title:e.title||"",contract_type:e.contractType||"other",status:e.status||"draft",project_id:e.projectId||null,client_id:e.clientId||null,crew_id:e.crewId||null,vendor_id:e.vendorId||null,party_name:e.partyName||"",party_email:e.partyEmail||"",party_phone:e.partyPhone||"",party_address:e.partyAddress||"",party_company:e.partyCompany||"",start_date:e.startDate||null,end_date:e.endDate||null,signed_date:e.signedDate||null,expires_at:e.expiresAt||null,value:e.value||0,currency:e.currency||"USD",payment_terms:e.paymentTerms||"",description:e.description||"",terms:e.terms||"",special_clauses:e.specialClauses||[],document_url:e.documentUrl||"",signed_document_url:e.signedDocumentUrl||"",attachments:e.attachments||[],tags:e.tags||[],notes:e.notes||"",internal_notes:e.internalNotes||"",created_by:e.createdBy||null}}const Rs=h($n((e,t)=>({contracts:[],loading:!1,error:null,realtimeSubscription:null,initialize:async()=>{if(kn()){e({loading:!0,error:null});try{const{data:n,error:a}=await _n.from("contracts").select("*").order("created_at",{ascending:!1});if(a)throw a;const r=(n||[]).map(As);e({contracts:r,loading:!1});const o=_n.channel("contracts-changes").on("postgres_changes",{event:"*",schema:"public",table:"contracts"},n=>{const{eventType:a,new:r,old:o}=n,i=t();if("INSERT"===a){const t=As(r);i.contracts.find(e=>e.id===t.id)||e({contracts:[t,...i.contracts]})}else if("UPDATE"===a){const t=As(r);e({contracts:i.contracts.map(e=>e.id===t.id?t:e)})}else"DELETE"===a&&e({contracts:i.contracts.filter(e=>e.id!==o.id)})}).subscribe();e({realtimeSubscription:o})}catch(n){e({error:n.message,loading:!1})}}else e({loading:!1,error:"Supabase not configured"})},createContract:async n=>{if(!kn())return null;try{const a=t(),r=n.contractRef||function(e){const t=`CTR-${(new Date).getFullYear()}-`,n=e.map(e=>e.contractRef).filter(e=>e?.startsWith(t)).map(e=>parseInt(e.replace(t,""),10)).filter(e=>!isNaN(e)),a=n.length>0?Math.max(...n):0;return`${t}${String(a+1).padStart(4,"0")}`}(a.contracts),o={...n,contractRef:r,status:n.status||"draft"},{data:i,error:s}=await _n.from("contracts").insert(Ps(o)).select().single();if(s)throw s;const l=As(i);return e({contracts:[l,...a.contracts]}),l}catch(a){return null}},updateContract:async(n,a)=>{if(!kn())return!1;try{const{error:r}=await _n.from("contracts").update(Ps(a)).eq("id",n);if(r)throw r;return e({contracts:t().contracts.map(e=>e.id===n?{...e,...a}:e)}),!0}catch(r){return!1}},updateStatus:async(e,n)=>{const a={status:n};return"signed"===n&&(a.signedDate=(new Date).toISOString().split("T")[0]),t().updateContract(e,a)},deleteContract:async n=>{if(!kn())return!1;try{const{error:a}=await _n.from("contracts").delete().eq("id",n);if(a)throw a;return e({contracts:t().contracts.filter(e=>e.id!==n)}),!0}catch(a){return!1}},getContractById:e=>t().contracts.find(t=>t.id===e),getContractsByProject:e=>t().contracts.filter(t=>t.projectId===e),getContractsByClient:e=>t().contracts.filter(t=>t.clientId===e),getContractsByCrew:e=>t().contracts.filter(t=>t.crewId===e),getExpiringContracts:(e=30)=>{const n=new Date,a=new Date(n.getTime()+24*e*60*60*1e3);return t().contracts.filter(e=>{if(!e.expiresAt||"cancelled"===e.status||"expired"===e.status)return!1;const t=new Date(e.expiresAt);return t>n&&t<=a})},getStats:()=>{const e=t().contracts;return{total:e.length,draft:e.filter(e=>"draft"===e.status).length,pending:e.filter(e=>"pending_review"===e.status||"sent"===e.status).length,signed:e.filter(e=>"signed"===e.status).length,active:e.filter(e=>"active"===e.status).length,completed:e.filter(e=>"completed"===e.status).length,expiringSoon:t().getExpiringContracts(30).length,totalValue:e.filter(e=>["signed","active"].includes(e.status)).reduce((e,t)=>e+(t.value||0),0)}},cleanup:()=>{const n=t().realtimeSubscription;n&&_n.removeChannel(n),e({realtimeSubscription:null})}}))),Os=["https://www.googleapis.com/auth/gmail.readonly","https://www.googleapis.com/auth/gmail.send","https://www.googleapis.com/auth/gmail.compose","https://www.googleapis.com/auth/gmail.modify","https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile"].join(" "),Ms=["openid","profile","email","offline_access","Mail.Read","Mail.Send","Mail.ReadWrite"].join(" "),qs=e=>{if(!e)return"";const t=new Date(e),n=new Date,a=n-t,r=Math.floor(a/864e5);return 0===r?t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):1===r?"Yesterday":r<7?t.toLocaleDateString("en-US",{weekday:"short"}):t.getFullYear()===n.getFullYear()?t.toLocaleDateString("en-US",{month:"short",day:"numeric"}):t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},zs=e=>{if(!e)return{email:"",name:""};const t=e.match(/^(?:"?([^"]*)"?\s)?<?([^>]+)>?$/);return t?{name:t[1]||t[2].split("@")[0],email:t[2]}:{email:e,name:e.split("@")[0]}},Fs=h($n((e,t)=>({googleConnections:[],microsoftConnections:[],connections:[],activeConnection:null,activeProvider:null,isConnecting:!1,connectionError:null,threads:[],selectedThread:null,messages:[],drafts:[],isLoading:!1,isSyncing:!1,syncProgress:null,error:null,currentFolder:"INBOX",searchQuery:"",filters:{unreadOnly:!1,starredOnly:!1,hasAttachments:!1},page:1,pageSize:50,totalThreads:0,hasMore:!0,isComposing:!1,composeDraft:null,replyToMessage:null,initialize:async()=>{const{loadConnections:e,loadThreads:n}=t();await e(),await n()},loadConnections:async()=>{try{const{data:t,error:n}=await _n.from("google_connections").select("*").order("created_at",{ascending:!1}),{data:a,error:r}=await _n.from("microsoft_connections").select("*").order("created_at",{ascending:!1}),o=(t||[]).map(e=>({...e,provider:"google",email:e.google_email,name:e.google_name,picture:e.google_picture})),i=(a||[]).map(e=>({...e,provider:"microsoft",email:e.microsoft_email,name:e.microsoft_name,picture:e.microsoft_picture})),s=[...o,...i].sort((e,t)=>new Date(t.created_at)-new Date(e.created_at)),l=s.find(e=>"active"===e.status);e({googleConnections:o,microsoftConnections:i,connections:s,activeConnection:l||null,activeProvider:l?.provider||null})}catch(t){e({connectionError:t.message})}},setActiveConnection:n=>{const{connections:a}=t(),r=a.find(e=>e.id===n);r&&(e({activeConnection:r,activeProvider:r.provider}),t().loadThreads())},connectGoogle:async()=>{e({isConnecting:!0,connectionError:null});try{const e="653007939230-mq36ne7sl7h3v17u6tbjh255ksaf67om.apps.googleusercontent.com",{data:{user:t}}=await _n.auth.getUser();if(!t)throw new Error("Please log in first");const n=`${window.location.origin}/auth/google-callback`,a=`${t.id}|${Date.now()}`;sessionStorage.setItem("google_oauth_state",a);const r=new URL("https://accounts.google.com/o/oauth2/v2/auth");r.searchParams.set("client_id",e),r.searchParams.set("response_type","code"),r.searchParams.set("redirect_uri",n),r.searchParams.set("scope",Os),r.searchParams.set("access_type","offline"),r.searchParams.set("prompt","consent"),r.searchParams.set("state",a),window.location.href=r.toString()}catch(t){e({isConnecting:!1,connectionError:t.message})}},handleGoogleCallback:async(n,a)=>{e({isConnecting:!0,connectionError:null});try{if(a!==sessionStorage.getItem("google_oauth_state"))throw new Error("Invalid OAuth state - please try again");sessionStorage.removeItem("google_oauth_state");const{data:{session:r}}=await _n.auth.getSession();if(!r)throw new Error("Not authenticated");const o=`${window.location.origin}/auth/google-callback`,{data:i,error:s}=await _n.functions.invoke("google-oauth-callback",{body:{code:n,redirect_uri:o}});if(s)throw s;return await t().loadConnections(),e({isConnecting:!1}),{success:!0,connection:i.connection}}catch(r){return e({isConnecting:!1,connectionError:r.message}),{success:!1,error:r.message}}},disconnectGoogle:async e=>{try{const{error:n}=await _n.from("google_connections").update({status:"disconnected"}).eq("id",e);if(n)throw n;return await t().loadConnections(),{success:!0}}catch(n){return{success:!1,error:n.message}}},connectMicrosoft:async()=>{e({isConnecting:!0,connectionError:null});try{const e="fd9f6064-152c-4277-b707-e1246c36a95f",t="https://deitlnfumugxcbxqqivk.supabase.co",{data:{user:n}}=await _n.auth.getUser();if(!n)throw new Error("Please log in first");const a=`${t}/functions/v1/microsoft-oauth-callback`,r=`${n.id}|${window.location.origin}`,o=new URL("https://login.microsoftonline.com/common/oauth2/v2.0/authorize");o.searchParams.set("client_id",e),o.searchParams.set("response_type","code"),o.searchParams.set("redirect_uri",a),o.searchParams.set("scope",Ms),o.searchParams.set("state",r),o.searchParams.set("prompt","consent"),window.location.href=o.toString()}catch(t){e({isConnecting:!1,connectionError:t.message})}},disconnectMicrosoft:async e=>{try{const{error:n}=await _n.from("microsoft_connections").update({status:"disconnected"}).eq("id",e);if(n)throw n;return await t().loadConnections(),{success:!0}}catch(n){return{success:!1,error:n.message}}},disconnectAccount:async(e,n)=>"google"===n?t().disconnectGoogle(e):"microsoft"===n?t().disconnectMicrosoft(e):{success:!1,error:"Unknown provider"},loadThreads:async(n={})=>{const{activeConnection:a,activeProvider:r,currentFolder:o,searchQuery:i,filters:s,page:l,pageSize:c}=t();if(a){e({isLoading:!0,error:null});try{const d="microsoft"===r?"microsoft_connection_id":"connection_id";let u=_n.from("email_threads").select("*",{count:"exact"}).eq(d,a.id).eq("provider",r).order("last_message_at",{ascending:!1});"INBOX"===o?u=u.eq("is_archived",!1).eq("is_trash",!1).eq("is_spam",!1):"SENT"===o?u=u.contains("labels",["SENT"]):"STARRED"===o?u=u.eq("is_starred",!0):"ARCHIVED"===o?u=u.eq("is_archived",!0):"TRASH"===o?u=u.eq("is_trash",!0):"SPAM"===o&&(u=u.eq("is_spam",!0)),s.unreadOnly&&(u=u.gt("unread_count",0)),s.starredOnly&&(u=u.eq("is_starred",!0)),s.hasAttachments&&(u=u.gt("attachment_count",0)),i&&(u=u.or(`subject.ilike.%${i}%,snippet.ilike.%${i}%`));const m=(l-1)*c;u=u.range(m,m+c-1);const{data:p,error:h,count:f}=await u;if(h)throw h;e({threads:n.append?[...t().threads,...p]:p,totalThreads:f||0,hasMore:p.length===c,isLoading:!1})}catch(d){e({isLoading:!1,error:d.message})}}else e({threads:[],totalThreads:0})},selectThread:async n=>{if(!n)return void e({selectedThread:null,messages:[]});const a=t().threads.find(e=>e.id===n);e({selectedThread:a,isLoading:!0});try{const{data:r,error:o}=await _n.from("email_messages").select("*, email_attachments(*)").eq("thread_id",n).order("sent_at",{ascending:!0});if(o)throw o;e({messages:r||[],isLoading:!1}),a?.unread_count>0&&await t().markThreadAsRead(n)}catch(r){e({isLoading:!1,error:r.message})}},markThreadAsRead:async n=>{try{await _n.from("email_threads").update({unread_count:0}).eq("id",n),await _n.from("email_messages").update({is_read:!0}).eq("thread_id",n),e({threads:t().threads.map(e=>e.id===n?{...e,unread_count:0}:e)});const a=t().threads.find(e=>e.id===n);a?.google_thread_id&&await _n.functions.invoke("gmail-mark-read",{body:{threadId:a.google_thread_id}})}catch(a){}},starThread:async(n,a)=>{try{await _n.from("email_threads").update({is_starred:a}).eq("id",n),e({threads:t().threads.map(e=>e.id===n?{...e,is_starred:a}:e),selectedThread:t().selectedThread?.id===n?{...t().selectedThread,is_starred:a}:t().selectedThread});const r=t().threads.find(e=>e.id===n);r?.google_thread_id&&await _n.functions.invoke("gmail-star",{body:{threadId:r.google_thread_id,starred:a}})}catch(r){}},archiveThread:async n=>{try{await _n.from("email_threads").update({is_archived:!0}).eq("id",n),e({threads:t().threads.filter(e=>e.id!==n),selectedThread:t().selectedThread?.id===n?null:t().selectedThread});const a=t().threads.find(e=>e.id===n);a?.google_thread_id&&await _n.functions.invoke("gmail-archive",{body:{threadId:a.google_thread_id}})}catch(a){}},trashThread:async n=>{try{await _n.from("email_threads").update({is_trash:!0}).eq("id",n),e({threads:t().threads.filter(e=>e.id!==n),selectedThread:t().selectedThread?.id===n?null:t().selectedThread});const a=t().threads.find(e=>e.id===n);a?.google_thread_id&&await _n.functions.invoke("gmail-trash",{body:{threadId:a.google_thread_id}})}catch(a){}},syncEmails:async()=>{const{activeConnection:n,activeProvider:a}=t();if(n){e({isSyncing:!0,syncProgress:{status:"starting",progress:0}});try{const r="microsoft"===a?"microsoft-sync":"gmail-sync",o="microsoft"===a?"microsoft_connections":"google_connections",{data:i,error:s}=await _n.functions.invoke(r,{body:{connectionId:n.id}});if(s)throw s;e({syncProgress:{status:"completed",...i}}),await t().loadThreads(),await _n.from(o).update({last_sync_at:(new Date).toISOString()}).eq("id",n.id),await t().loadConnections()}catch(r){e({syncProgress:{status:"failed",error:r.message}})}finally{e({isSyncing:!1})}}},openCompose:(t={})=>{e({isComposing:!0,composeDraft:{to:t.to||[],cc:[],bcc:[],subject:t.subject||"",body:t.body||"",attachments:[],clientId:t.clientId||null,contactId:t.contactId||null,projectId:t.projectId||null,quoteId:t.quoteId||null},replyToMessage:t.replyTo||null})},closeCompose:()=>{e({isComposing:!1,composeDraft:null,replyToMessage:null})},updateDraft:n=>{e({composeDraft:{...t().composeDraft,...n}})},sendEmail:async()=>{const{composeDraft:e,replyToMessage:n,activeConnection:a,activeProvider:r,selectedThread:o}=t();if(!a)return{success:!1,error:"No email account connected"};try{const i="microsoft"===r?"microsoft-send":"gmail-send",s={connectionId:a.id,to:e.to,cc:e.cc,bcc:e.bcc,subject:e.subject,body:e.body,isHtml:e.isHtml||!1};"microsoft"===r?(s.conversationId=o?.provider_thread_id,s.replyToMessageId=n?.provider_message_id):(s.threadId=o?.google_thread_id||o?.provider_thread_id,s.replyToMessageId=n?.google_message_id||n?.provider_message_id);const{data:l,error:c}=await _n.functions.invoke(i,{body:s});if(c)throw c;return t().closeCompose(),await t().syncEmails(),{success:!0,messageId:l.messageId}}catch(i){return{success:!1,error:i.message}}},linkThreadToEntity:async(e,n,a)=>{try{const{error:r}=await _n.from("email_entity_links").insert({thread_id:e,entity_type:n,entity_id:a,link_type:"manual"});if(r)throw r;const o=`${n}_id`;return await _n.from("email_threads").update({[o]:a}).eq("id",e),await t().loadThreads(),{success:!0}}catch(r){return{success:!1,error:r.message}}},unlinkThreadFromEntity:async(e,n,a)=>{try{await _n.from("email_entity_links").delete().eq("thread_id",e).eq("entity_type",n).eq("entity_id",a);const r=`${n}_id`;return await _n.from("email_threads").update({[r]:null}).eq("id",e),await t().loadThreads(),{success:!0}}catch(r){return{success:!1,error:r.message}}},getThreadsForEntity:async(e,t)=>{try{const{data:n,error:a}=await _n.from("email_entity_links").select("thread_id, email_threads(*)").eq("entity_type",e).eq("entity_id",t);if(a)throw a;return n.map(e=>e.email_threads).filter(Boolean)}catch(n){return[]}},setFolder:n=>{e({currentFolder:n,page:1}),t().loadThreads()},setSearchQuery:n=>{e({searchQuery:n,page:1}),t().loadThreads()},setFilters:n=>{e({filters:{...t().filters,...n},page:1}),t().loadThreads()},loadMore:()=>{const{page:n,hasMore:a,isLoading:r}=t();a&&!r&&(e({page:n+1}),t().loadThreads({append:!0}))},getEmailTrackingStats:async e=>{try{const{data:t,error:n}=await _n.from("email_messages").select("tracking_id, open_count, click_count, first_opened_at, last_opened_at").eq("id",e).single();if(n)throw n;return t}catch(t){return null}},getTrackingEvents:async e=>{try{const{data:t,error:n}=await _n.from("email_tracking_events").select("*").eq("message_id",e).order("occurred_at",{ascending:!1});if(n)throw n;return t||[]}catch(t){return[]}},getThreadTrackingStats:async e=>{try{const{data:t,error:n}=await _n.from("email_messages").select("id, tracking_id, open_count, click_count, first_opened_at, subject").eq("thread_id",e).gt("open_count",0);if(n)throw n;const a=(t||[]).reduce((e,t)=>e+(t.open_count||0),0),r=(t||[]).reduce((e,t)=>e+(t.click_count||0),0);return{totalOpens:a,totalClicks:r,trackedMessages:t?.length||0,messages:t||[]}}catch(t){return{totalOpens:0,totalClicks:0,trackedMessages:0,messages:[]}}},subscribeToTrackingEvents:(e,t)=>{const n=_n.channel(`tracking-${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"email_tracking_events",filter:`message_id=eq.${e}`},e=>{t(e.new)}).subscribe();return()=>{_n.removeChannel(n)}},generateTrackingUrl:(e,t)=>`https://deitlnfumugxcbxqqivk.supabase.co/functions/v1/email-tracking-click?tid=${t}&url=${encodeURIComponent(e)}`,generateTrackingPixel:e=>`<img src="https://deitlnfumugxcbxqqivk.supabase.co/functions/v1/email-tracking-pixel?tid=${e}" width="1" height="1" style="display:none;" alt="" />`,reset:()=>{e({connections:[],activeConnection:null,threads:[],selectedThread:null,messages:[],drafts:[],isLoading:!1,isSyncing:!1,error:null,currentFolder:"INBOX",searchQuery:"",filters:{unreadOnly:!1,starredOnly:!1,hasAttachments:!1},page:1,isComposing:!1,composeDraft:null})}}))),Bs={owner:{label:"Owner",description:"Full access, can transfer ownership"},admin:{label:"Admin",description:"Full access, can manage members"},member:{label:"Member",description:"Can create and edit content"},viewer:{label:"Viewer",description:"Read-only access"}},Us={free:{label:"Free",users:1,projects:3},starter:{label:"Starter",users:5,projects:20,price:29},professional:{label:"Professional",users:20,projects:100,price:79},enterprise:{label:"Enterprise",users:-1,projects:-1,price:"custom"}};function $s(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let n=0;n<32;n++)t+=e.charAt(Math.floor(62*Math.random()));return t}const Vs=h($n((e,t)=>({organization:null,organizations:[],members:[],invitations:[],subscription:null,loading:!1,membersLoading:!1,invitationsLoading:!1,error:null,realtimeSubscription:null,initialize:async n=>{if(!kn()||!n)return e({loading:!1}),null;e({loading:!0,error:null});try{const{data:a,error:r}=await _n.from("organization_members").select("\n                        role,\n                        organization:organizations(*)\n                    ").eq("user_id",n);if(r)throw r;if(!a||0===a.length)return e({loading:!1,organization:null,organizations:[]}),null;const o=a.map(e=>({...e.organization,userRole:e.role})),i=localStorage.getItem("current_organization_id");let s=o.find(e=>e.id===i)||o[0];return e({organizations:o,organization:s,loading:!1}),await Promise.all([t().loadMembers(s.id),t().loadInvitations(s.id),t().loadSubscription(s.id)]),t().subscribeToRealtimeUpdates(s.id),await _n.from("user_profiles").update({organization_id:s.id}).eq("auth_user_id",n),s}catch(a){return e({error:a.message,loading:!1}),null}},switchOrganization:async n=>{const{organizations:a}=t(),r=a.find(e=>e.id===n);if(!r)return!1;localStorage.setItem("current_organization_id",n),t().cleanup(),e({organization:r}),await Promise.all([t().loadMembers(n),t().loadInvitations(n),t().loadSubscription(n)]),t().subscribeToRealtimeUpdates(n);const{data:{user:o}}=await _n.auth.getUser();return o&&await _n.from("user_profiles").update({organization_id:n}).eq("auth_user_id",o.id),!0},createOrganization:async(t,n)=>{if(!kn())return null;try{const a=function(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").substring(0,50)}(t),{data:r}=await _n.from("organizations").select("id").eq("slug",a).single(),o=r?`${a}-${Date.now().toString(36)}`:a,{data:i,error:s}=await _n.from("organizations").insert({name:t,slug:o,subscription_status:"trialing",subscription_plan:"free"}).select().single();if(s)throw s;const{error:l}=await _n.from("organization_members").insert({organization_id:i.id,user_id:n,role:"owner"});if(l)throw l;const{error:c}=await _n.from("settings").insert({organization_id:i.id,company:{name:t},quote_defaults:{currency:"USD",validityDays:30}});await _n.from("user_profiles").update({organization_id:i.id}).eq("auth_user_id",n);const d={...i,userRole:"owner"};return e(e=>({organization:d,organizations:[...e.organizations,d]})),localStorage.setItem("current_organization_id",i.id),i}catch(a){return e({error:a.message}),null}},updateOrganization:async n=>{const{organization:a}=t();if(!a)return!1;try{const{error:t}=await _n.from("organizations").update(n).eq("id",a.id);if(t)throw t;const r={...a,...n};return e(e=>({organization:r,organizations:e.organizations.map(e=>e.id===a.id?r:e)})),!0}catch(r){return!1}},loadMembers:async t=>{if(t){e({membersLoading:!0});try{const{data:n,error:a}=await _n.from("organization_members").select("\n                        id,\n                        role,\n                        created_at,\n                        user:user_profiles!organization_members_user_id_fkey(\n                            id,\n                            name,\n                            email,\n                            status\n                        )\n                    ").eq("organization_id",t);if(a)throw a;const r=(n||[]).map(e=>({id:e.id,role:e.role,createdAt:e.created_at,userId:e.user?.id,name:e.user?.name||"Unknown",email:e.user?.email||"",status:e.user?.status||"active"}));e({members:r,membersLoading:!1})}catch(n){e({membersLoading:!1})}}},updateMemberRole:async(n,a)=>{const{organization:r}=t();if(!r)return!1;try{const{error:t}=await _n.from("organization_members").update({role:a}).eq("id",n).eq("organization_id",r.id);if(t)throw t;return e(e=>({members:e.members.map(e=>e.id===n?{...e,role:a}:e)})),!0}catch(o){return!1}},removeMember:async n=>{const{organization:a,members:r}=t();if(!a)return!1;const o=r.find(e=>e.id===n);if("owner"===o?.role){if(r.filter(e=>"owner"===e.role).length<=1)return e({error:"Cannot remove the last owner. Transfer ownership first."}),!1}try{const{error:t}=await _n.from("organization_members").delete().eq("id",n).eq("organization_id",a.id);if(t)throw t;return e(e=>({members:e.members.filter(e=>e.id!==n)})),!0}catch(i){return!1}},loadInvitations:async t=>{if(t){e({invitationsLoading:!0});try{const{data:n,error:a}=await _n.from("user_invitations").select("*").eq("organization_id",t).is("claimed_at",null).gt("expires_at",(new Date).toISOString()).order("created_at",{ascending:!1});if(a)throw a;e({invitations:n||[],invitationsLoading:!1})}catch(n){e({invitationsLoading:!1})}}},createInvitation:async(n,a="member",r=[])=>{const{organization:o,invitations:i,members:s}=t();if(!o)return null;if(s.some(e=>e.email.toLowerCase()===n.toLowerCase()))return e({error:"This user is already a member of the organization."}),null;if(i.some(e=>e.email.toLowerCase()===n.toLowerCase()))return e({error:"An invitation has already been sent to this email."}),null;try{const{data:{user:t}}=await _n.auth.getUser(),i={organization_id:o.id,email:n.toLowerCase(),role:a,tab_permissions:r,invited_by:t?.id,token:$s(),expires_at:new Date(Date.now()+6048e5).toISOString()},{data:s,error:c}=await _n.from("user_invitations").insert(i).select().single();if(c)throw c;e(e=>({invitations:[s,...e.invitations]}));try{const{data:{session:e}}=await _n.auth.getSession(),{data:n}=await _n.from("user_profiles").select("full_name, email").eq("id",t?.id).single(),a=n?.full_name||n?.email||"A team member";await _n.functions.invoke("send-invitation-email",{body:{invitationId:s.id,email:s.email,organizationName:o.name,inviterName:a,role:s.role,inviteToken:s.token}})}catch(l){}return s}catch(c){return e({error:c.message}),null}},resendInvitation:async n=>{const{organization:a}=t();if(!a)return!1;try{const t={token:$s(),expires_at:new Date(Date.now()+6048e5).toISOString()},{data:o,error:i}=await _n.from("user_invitations").update(t).eq("id",n).eq("organization_id",a.id).select().single();if(i)throw i;e(e=>({invitations:e.invitations.map(e=>e.id===n?o:e)}));try{const{data:{user:e}}=await _n.auth.getUser(),{data:t}=await _n.from("user_profiles").select("full_name, email").eq("id",e?.id).single(),n=t?.full_name||t?.email||"A team member";await _n.functions.invoke("send-invitation-email",{body:{invitationId:o.id,email:o.email,organizationName:a.name,inviterName:n,role:o.role,inviteToken:o.token}})}catch(r){}return o}catch(o){return!1}},cancelInvitation:async n=>{const{organization:a}=t();if(!a)return!1;try{const{error:t}=await _n.from("user_invitations").delete().eq("id",n).eq("organization_id",a.id);if(t)throw t;return e(e=>({invitations:e.invitations.filter(e=>e.id!==n)})),!0}catch(r){return!1}},acceptInvitation:async(e,t)=>{try{const{data:n,error:a}=await _n.from("user_invitations").select("*, organization:organizations(*)").eq("token",e).is("claimed_at",null).gt("expires_at",(new Date).toISOString()).single();if(a||!n)return{success:!1,error:"Invalid or expired invitation"};const{error:r}=await _n.from("organization_members").insert({organization_id:n.organization_id,user_id:t,role:n.role});if(r){if("23505"===r.code)return{success:!1,error:"You are already a member of this organization"};throw r}return await _n.from("user_profiles").update({organization_id:n.organization_id,tab_permissions:n.tab_permissions,status:"active"}).eq("auth_user_id",t),await _n.from("user_invitations").update({claimed_at:(new Date).toISOString(),claimed_by:t}).eq("id",n.id),{success:!0,organization:n.organization}}catch(n){return{success:!1,error:n.message}}},loadSubscription:async t=>{if(t)try{const{data:n,error:a}=await _n.from("subscriptions").select("*").eq("organization_id",t).single();if(a&&"PGRST116"!==a.code)throw a;e({subscription:n||null})}catch(n){}},hasFeatureAccess:e=>{const{organization:n,subscription:a,members:r}=t();if(!n)return!1;const o=a?.plan||n.subscription_plan||"free",i=Us[o];if(!i)return!1;switch(e){case"unlimited_users":return-1===i.users;case"unlimited_projects":return-1===i.projects;case"add_user":return-1===i.users||r.length<i.users;default:return!0}},getSubscriptionLimits:()=>{const{organization:e,subscription:n}=t();return Us[n?.plan||e?.subscription_plan||"free"]||Us.free},subscribeToRealtimeUpdates:n=>{if(!n)return;const a=_n.channel(`org-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"organization_members",filter:`organization_id=eq.${n}`},()=>{t().loadMembers(n)}).on("postgres_changes",{event:"*",schema:"public",table:"user_invitations",filter:`organization_id=eq.${n}`},()=>{t().loadInvitations(n)}).subscribe();e({realtimeSubscription:a})},getOrganizationId:()=>t().organization?.id||null,canManageMembers:()=>{const{organization:e}=t();return"owner"===e?.userRole||"admin"===e?.userRole},isOwner:()=>"owner"===t().organization?.userRole,clearError:()=>e({error:null}),cleanup:()=>{const{realtimeSubscription:n}=t();n&&_n.removeChannel(n),e({realtimeSubscription:null})},reset:()=>{t().cleanup(),localStorage.removeItem("current_organization_id"),e({organization:null,organizations:[],members:[],invitations:[],subscription:null,loading:!1,error:null})}})));const Hs=[{id:"company_setup",label:"Company Setup",required:!0},{id:"billing",label:"Start Trial",required:!1},{id:"pain_points",label:"Pain Points",required:!1},{id:"company_profile",label:"Company Profile",required:!1},{id:"team_invite",label:"Invite Team",required:!1,conditional:!0},{id:"data_import",label:"Import Data",required:!1},{id:"rate_card",label:"Rate Card",required:!1},{id:"first_action",label:"Get Started",required:!0}],Ws=[{id:"video_production",label:"Video Production",icon:"video"},{id:"event_production",label:"Event Production",icon:"calendar"},{id:"photography",label:"Photography",icon:"camera"},{id:"live_streaming",label:"Live Streaming / Broadcast",icon:"radio"},{id:"post_production",label:"Post-Production",icon:"film"},{id:"corporate",label:"Corporate / In-house Team",icon:"building"},{id:"other",label:"Other",icon:"plus"}],Gs=[{id:"commercial",label:"Commercial / Advertising"},{id:"corporate",label:"Corporate / Internal Comms"},{id:"documentary",label:"Documentary"},{id:"branded_content",label:"Branded Content"},{id:"events_live",label:"Events / Live"},{id:"music_videos",label:"Music Videos"},{id:"social_content",label:"Social Content"},{id:"weddings",label:"Weddings"},{id:"other",label:"Other"}],Ks=[{id:"just_me",label:"Just me",value:1},{id:"2-5",label:"2-5 people",value:5},{id:"6-15",label:"6-15 people",value:15},{id:"16+",label:"16+ people",value:100}],Qs=[{id:"quoting_slow",label:"Quoting takes too long",feature:"quotes"},{id:"margins_unknown",label:"Don't know my margins",feature:"dashboard"},{id:"crew_scattered",label:"Crew contacts are scattered",feature:"crew"},{id:"equipment_chaos",label:"Equipment tracking is chaos",feature:"equipment"},{id:"chasing_payments",label:"Chasing invoices and payments",feature:"invoices"},{id:"no_visibility",label:"No visibility on project status",feature:"projects"},{id:"client_comms",label:"Managing client communications",feature:"crm"},{id:"deliverables",label:"Tracking deliverables and revisions",feature:"projects"}],Ys=[{id:"due_on_receipt",label:"Due on Receipt"},{id:"net_7",label:"Net 7"},{id:"net_14",label:"Net 14"},{id:"net_30",label:"Net 30"},{id:"net_45",label:"Net 45"},{id:"net_60",label:"Net 60"}],Js={video_production:["Director","Producer","DP / Camera Operator","Sound Recordist","Editor","Gaffer"],event_production:["Production Manager","Technical Director","AV Technician","Stage Manager","Lighting Tech"],photography:["Photographer","Photo Assistant","Retoucher","Studio Manager"],live_streaming:["Stream Producer","Technical Director","Camera Operator","Audio Engineer","Graphics Operator"],post_production:["Editor","Colorist","Sound Designer","VFX Artist","Motion Graphics"],corporate:["Producer","Videographer","Editor","Project Manager"],other:["Director","Producer","Camera Operator","Editor"]},Zs={US:{junior:350,mid:550,senior:850},GB:{junior:300,mid:500,senior:750},DE:{junior:300,mid:500,senior:700},SG:{junior:250,mid:400,senior:600},MY:{junior:100,mid:200,senior:350},AU:{junior:400,mid:600,senior:900},default:{junior:250,mid:400,senior:600}};async function Xs(e){if(!kn())return null;const{data:t,error:n}=await _n.from("onboarding_progress").select("*").eq("user_id",e).single();if(n&&"PGRST116"===n.code){const{data:t,error:n}=await _n.from("onboarding_progress").insert({user_id:e}).select().single();return n?null:t}return n?null:t}async function el(e,t){if(!kn())return null;const{data:n,error:a}=await _n.from("onboarding_progress").update({...t,last_step_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}).eq("user_id",e).select().single();if(a)throw a;return n}async function tl(e,t){if(!kn())return null;const{data:n,error:a}=await _n.from("onboarding_checklist").select("*").eq("user_id",e).eq("organization_id",t).single();if(a&&"PGRST116"===a.code){const{data:n,error:a}=await _n.from("onboarding_checklist").insert({user_id:e,organization_id:t}).select().single();return a?null:n}return n}async function nl(e,t,n,a){if(!kn())return null;const{data:r,error:o}=await _n.from("onboarding_checklist").update({[n]:a}).eq("user_id",e).eq("organization_id",t).select().single();return o?null:r}async function al(e,t){return nl(e,t,"dismissed",!0)}async function rl(e,t,n){return nl(e,t,"minimized",n)}const ol={clients:{required:["name"],optional:["email","phone","company","address","notes","website"],aliases:{name:["client name","client","contact name","contact"],email:["email address","e-mail","mail"],phone:["phone number","telephone","tel","mobile"],company:["company name","organization","org","business"],address:["address","location","street"],notes:["notes","comments","description"],website:["website","url","web"]}},crew:{required:["name"],optional:["email","phone","role","day_rate","notes","skills"],aliases:{name:["crew name","contact name","full name","crew member"],email:["email address","e-mail","mail"],phone:["phone number","telephone","tel","mobile"],role:["role","position","job title","title","department"],day_rate:["day rate","rate","daily rate","fee","cost"],notes:["notes","comments","description","bio"],skills:["skills","expertise","specialties"]}},equipment:{required:["name"],optional:["category","day_rate","quantity","serial_number","notes","condition"],aliases:{name:["equipment name","item name","item","gear"],category:["category","type","group","department"],day_rate:["day rate","rate","daily rate","rental","cost"],quantity:["quantity","qty","count","amount"],serial_number:["serial number","serial","sn","asset id"],notes:["notes","comments","description"],condition:["condition","status","state"]}}};function il(e){const t=[];let n="",a=!1;for(let r=0;r<e.length;r++){const o=e[r];'"'===o?a&&'"'===e[r+1]?(n+='"',r++):a=!a:","!==o||a?n+=o:(t.push(n),n="")}return t.push(n),t}async function sl(e){return new Promise((t,n)=>{const a=new FileReader;a.onload=a=>{const r=a.target.result,o=e.name.split(".").pop().toLowerCase();if("csv"===o||"txt"===o){const{headers:e,rows:n}=function(e){const t=e.split(/\r?\n/).filter(e=>e.trim());if(0===t.length)return{headers:[],rows:[]};const n=il(t[0]).map(e=>e.trim().toLowerCase()),a=[];for(let r=1;r<t.length;r++){const e=il(t[r]);if(e.some(e=>e.trim())){const t={};n.forEach((n,a)=>{t[n]=e[a]?.trim()||""}),a.push(t)}}return{headers:n,rows:a}}(r);t({headers:e,rows:n,format:"csv"})}else n("xlsx"===o||"xls"===o?new Error("Excel files are not yet supported. Please convert to CSV format."):new Error("Unsupported file format. Please use CSV files."))},a.onerror=()=>n(new Error("Failed to read file")),a.readAsText(e)})}function ll(e){const t=function(e){const t=ol[e];if(!t)return null;let n=[...t.required,...t.optional].join(",")+"\n";return n+={clients:["Acme Corp","john@acme.com","+1 555 123 4567","Acme Corporation","123 Business Ave","Great client, always on time","www.acme.com"],crew:["Jane Smith","jane@email.com","+1 555 987 6543","Director of Photography","650","Award-winning DP","Cinematography, Lighting"],equipment:["RED Komodo","Camera Package","500","2","RK-12345","Primary camera","Excellent"]}[e]?.join(",")||"",n}(e);if(!t)return;const n=new Blob([t],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),r=URL.createObjectURL(n);a.setAttribute("href",r),a.setAttribute("download",`${e}_import_template.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}const cl={company_setup:vo,billing:jo,pain_points:Fo,company_profile:vo,team_invite:$o,data_import:Uo,rate_card:jo,first_action:Mo},dl={video:Vo,camera:wo,radio:Ro,film:Do,calendar:xo,building:vo,plus:Po},ul=["AF","AL","DZ","AD","AO","AG","AR","AM","AU","AT","AZ","BS","BH","BD","BB","BY","BE","BZ","BJ","BT","BO","BA","BW","BR","BN","BG","BF","BI","KH","CM","CA","CV","CF","TD","CL","CN","CO","KM","CG","CD","CR","HR","CU","CY","CZ","DK","DJ","DM","DO","EC","EG","SV","GQ","ER","EE","SZ","ET","FJ","FI","FR","GA","GM","GE","DE","GH","GR","GD","GT","GN","GW","GY","HT","HN","HK","HU","IS","IN","ID","IR","IQ","IE","IL","IT","CI","JM","JP","JO","KZ","KE","KN","KR","KW","KG","LA","LV","LB","LS","LR","LY","LI","LT","LU","MO","MG","MW","MY","MV","ML","MT","MR","MU","MX","MD","MC","MN","ME","MA","MZ","MM","NA","NP","NL","NC","NZ","NI","NE","NG","MK","NO","OM","PK","PS","PA","PG","PY","PE","PH","PL","PT","PR","PF","QA","RE","RO","RU","RW","LC","VC","WS","SM","ST","SA","SN","RS","SC","SL","SG","SK","SI","SB","SO","ZA","SS","ES","LK","SD","SR","SE","CH","SY","TW","TJ","TZ","TH","TL","TG","TO","TT","TN","TR","TM","UG","UA","AE","GB","US","UY","UZ","VA","VE","VN","VU","XK","YE","ZM","ZW","GU"];function ml({userId:e,onComplete:t}){const[n,a]=m.useState(0),[o,i]=m.useState(!0),[s,l]=m.useState(!1),[c,d]=m.useState(null),[u,p]=m.useState(null),{createOrganization:h,createInvitation:f}=Vs(),[g,y]=m.useState({companyName:"",companyType:"",primaryFocus:[],teamSize:"",country:"",currency:"USD",painPoints:[],logo:null,address:"",phone:"",website:"",paymentTerms:"net_30",teamInvites:[{email:"",role:"member"}],crewRates:{},equipmentRates:{},dataImports:{},firstAction:"create_quote"});m.useEffect(()=>{b()},[e]);const b=async()=>{if(e)try{const t=await Xs(e);if(t){p(t);const e=Hs.findIndex(e=>e.id===t.current_step);e>=0&&a(e),y(e=>({...e,companyType:t.company_type||"",primaryFocus:t.primary_focus||[],teamSize:t.team_size||"",painPoints:t.pain_points||[],address:t.company_address||"",phone:t.company_phone||"",website:t.company_website||"",paymentTerms:t.payment_terms||"net_30"}))}}catch(t){}finally{i(!1)}else i(!1)},v=(e,t)=>{y(n=>({...n,[e]:t})),d(null)},x=(e,t,n=null)=>{y(a=>{const r=a[e]||[];return r.includes(t)?{...a,[e]:r.filter(e=>e!==t)}:n&&r.length>=n?a:{...a,[e]:[...r,t]}})},w=e=>{v("country",e);const t={US:"USD",CA:"CAD",MX:"MXN",GT:"GTQ",BZ:"USD",SV:"USD",HN:"USD",NI:"USD",CR:"CRC",PA:"PAB",CU:"USD",JM:"JMD",HT:"USD",DO:"DOP",PR:"USD",TT:"TTD",BB:"BBD",BS:"BSD",LC:"USD",GD:"USD",VC:"USD",AG:"USD",DM:"USD",KN:"USD",BR:"BRL",AR:"ARS",CO:"COP",PE:"PEN",VE:"VES",CL:"CLP",EC:"USD",BO:"USD",PY:"USD",UY:"UYU",GY:"USD",SR:"USD",GB:"GBP",IE:"EUR",FR:"EUR",DE:"EUR",NL:"EUR",BE:"EUR",LU:"EUR",CH:"CHF",AT:"EUR",LI:"CHF",ES:"EUR",PT:"EUR",IT:"EUR",GR:"EUR",MT:"EUR",CY:"EUR",AD:"EUR",SM:"EUR",MC:"EUR",VA:"EUR",SE:"SEK",NO:"NOK",DK:"DKK",FI:"EUR",IS:"ISK",EE:"EUR",LV:"EUR",LT:"EUR",PL:"PLN",CZ:"CZK",SK:"EUR",HU:"HUF",RO:"RON",BG:"BGN",UA:"UAH",BY:"USD",MD:"USD",RU:"RUB",HR:"EUR",SI:"EUR",RS:"RSD",BA:"USD",ME:"EUR",MK:"EUR",AL:"USD",XK:"EUR",AE:"AED",SA:"SAR",QA:"QAR",KW:"KWD",BH:"BHD",OM:"OMR",JO:"JOD",LB:"LBP",SY:"SYP",IQ:"IQD",IR:"IRR",YE:"YER",IL:"ILS",PS:"ILS",TR:"TRY",KZ:"KZT",UZ:"UZS",TM:"TMT",TJ:"TJS",KG:"KGS",AF:"AFN",IN:"INR",PK:"PKR",BD:"BDT",LK:"LKR",NP:"NPR",BT:"INR",MV:"USD",SG:"SGD",MY:"MYR",TH:"THB",ID:"IDR",PH:"PHP",VN:"VND",MM:"MMK",KH:"KHR",LA:"LAK",BN:"BND",TL:"USD",CN:"CNY",JP:"JPY",KR:"KRW",TW:"TWD",HK:"HKD",MO:"MOP",MN:"MNT",AU:"AUD",NZ:"NZD",FJ:"FJD",PG:"PGK",WS:"WST",TO:"TOP",VU:"VUV",SB:"SBD",NC:"XPF",PF:"XPF",GU:"USD",EG:"EGP",MA:"MAD",DZ:"DZD",TN:"TND",LY:"USD",SD:"USD",NG:"NGN",GH:"GHS",SN:"XOF",CI:"XOF",ML:"XOF",BF:"XOF",NE:"XOF",GN:"USD",BJ:"XOF",TG:"XOF",SL:"USD",LR:"USD",MR:"USD",GM:"USD",GW:"XOF",CV:"USD",KE:"KES",TZ:"TZS",UG:"UGX",ET:"ETB",RW:"RWF",BI:"USD",SO:"USD",DJ:"USD",ER:"USD",SS:"USD",MU:"MUR",SC:"USD",MG:"USD",KM:"USD",RE:"EUR",CD:"USD",CG:"XAF",CF:"XAF",CM:"XAF",TD:"XAF",GA:"XAF",GQ:"XAF",ST:"USD",AO:"USD",ZA:"ZAR",ZW:"USD",ZM:"USD",BW:"USD",NA:"ZAR",MZ:"USD",MW:"USD",SZ:"ZAR",LS:"ZAR",GE:"GEL",AM:"AMD",AZ:"AZN"};t[e]&&v("currency",t[e])},_=e=>{switch(e){case"company_setup":return{company_type:g.companyType,primary_focus:g.primaryFocus,team_size:g.teamSize};case"pain_points":return{pain_points:g.painPoints};case"company_profile":return{company_logo_url:g.logo,company_address:g.address,company_phone:g.phone,company_website:g.website,payment_terms:g.paymentTerms};case"rate_card":return{rate_card_configured:Object.keys(g.crewRates).length>0,crew_rates:g.crewRates};case"team_invite":return{team_invites:g.teamInvites.filter(e=>e.email.trim()),team_invites_sent:g.teamInvites.filter(e=>e.email.trim()).length};case"first_action":return{first_action:g.firstAction};default:return{}}},k=async()=>{l(!0);try{const n=await h(g.companyName,e);if(!n)throw new Error("Failed to create organization");const a={company:{name:g.companyName,country:g.country,address:g.address,phone:g.phone,website:g.website,logo:g.logo},quoteDefaults:{currency:g.currency,validityDays:30,paymentTerms:g.paymentTerms},preferredCurrencies:[g.currency,"USD","EUR","GBP"].filter((e,t,n)=>n.indexOf(e)===t).slice(0,5),personalization:{companyType:g.companyType,primaryFocus:g.primaryFocus,painPoints:g.painPoints}};if(await _n.from("settings").update(a).eq("organization_id",n.id),Object.keys(g.crewRates).length>0){const e=Object.entries(g.crewRates).filter(([e,t])=>t&&parseFloat(t)>0).map(([e,t])=>({organization_id:n.id,name:e,description:`${e} day rate`,section:"prod_production",unit:"day",is_active:!0,pricing:{DEFAULT:{cost:{amount:.7*parseFloat(t),baseCurrency:g.currency},charge:{amount:parseFloat(t),baseCurrency:g.currency}}}}));e.length>0&&await _n.from("rate_cards").insert(e)}if(g.teamInvites?.length>0){const e=g.teamInvites.filter(e=>e.email?.trim());for(const t of e)await f(t.email.trim(),t.role||"member",[])}g.dataImports&&(g.dataImports.clients?.length>0&&await async function(e,t,n){if(!kn())return{success:!1,error:"Database not configured",imported:0};const a=e.map(e=>({organization_id:t,created_by:n,name:e.name,email:e.email||null,phone:e.phone||null,company:e.company||null,address:e.address||null,notes:e.notes||null,website:e.website||null,status:"active",source:"import"})),{data:r,error:o}=await _n.from("clients").insert(a).select();return o?{success:!1,error:o.message,imported:0}:{success:!0,imported:r.length,data:r}}(g.dataImports.clients,n.id,e),g.dataImports.crew?.length>0&&await async function(e,t,n){if(!kn())return{success:!1,error:"Database not configured",imported:0};const a=e.map(e=>({organization_id:t,created_by:n,name:e.name,email:e.email||null,phone:e.phone||null,role:e.role||null,day_rate:e.day_rate||null,notes:e.notes||null,skills:e.skills?e.skills.split(",").map(e=>e.trim()):[],status:"active",source:"import"})),{data:r,error:o}=await _n.from("crew").insert(a).select();return o?{success:!1,error:o.message,imported:0}:{success:!0,imported:r.length,data:r}}(g.dataImports.crew,n.id,e),g.dataImports.equipment?.length>0&&await async function(e,t,n){if(!kn())return{success:!1,error:"Database not configured",imported:0};const a=e.map(e=>({organization_id:t,created_by:n,name:e.name,category:e.category||"other",day_rate:e.day_rate||null,quantity:e.quantity||1,serial_number:e.serial_number||null,notes:e.notes||null,condition:e.condition||"good",status:"available",source:"import"})),{data:r,error:o}=await _n.from("equipment").insert(a).select();return o?{success:!1,error:o.message,imported:0}:{success:!0,imported:r.length,data:r}}(g.dataImports.equipment,n.id,e)),await async function(e,t){return el(e,{current_step:"complete",completed_at:(new Date).toISOString(),organization_id:t})}(e,n.id),await _n.from("onboarding_checklist").insert({user_id:e,organization_id:n.id,company_profile_setup:!0}),t?.(n,g.firstAction)}catch(n){d(n.message||"Failed to complete setup. Please try again."),l(!1)}};if(o)return r.jsx("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center",children:r.jsx(Eo,{className:"w-8 h-8 animate-spin text-brand-primary"})});const S=Hs[n],C=cl[S?.id]||vo,N=n===Hs.length-1;return r.jsxs("div",{className:"min-h-screen bg-dark-bg flex flex-col",children:[r.jsx("div",{className:"bg-dark-card border-b border-dark-border px-6 py-4",children:r.jsxs("div",{className:"max-w-3xl mx-auto",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h1",{className:"text-xl font-semibold text-white",children:"Welcome to ProductionOS"}),r.jsxs("span",{className:"text-sm text-gray-500",children:["Step ",n+1," of ",Hs.length]})]}),r.jsx("div",{className:"flex gap-1",children:Hs.map((e,t)=>r.jsx("div",{className:"flex-1 h-1 rounded-full transition-colors "+(t<n?"bg-brand-primary":t===n?"bg-brand-primary/60":"bg-dark-border")},e.id))})]})}),r.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:r.jsxs("div",{className:"max-w-2xl mx-auto",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[r.jsx("div",{className:"w-12 h-12 bg-brand-primary/20 rounded-xl flex items-center justify-center",children:r.jsx(C,{className:"w-6 h-6 text-brand-primary"})}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-semibold text-white",children:S?.label}),"company_setup"===S?.id&&r.jsx("p",{className:"text-gray-400",children:"Let's set up your workspace"}),"pain_points"===S?.id&&r.jsx("p",{className:"text-gray-400",children:"Help us personalize your experience"})]})]}),c&&r.jsxs("div",{className:"mb-6 flex items-center gap-2 p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400",children:[r.jsx(ko,{className:"w-4 h-4 flex-shrink-0"}),r.jsx("span",{children:c}),r.jsx("button",{onClick:()=>d(null),className:"ml-auto",children:r.jsx(Go,{className:"w-4 h-4"})})]}),r.jsx("div",{className:"bg-dark-card border border-dark-border rounded-xl p-6",children:(()=>{switch(Hs[n].id){case"company_setup":return r.jsx(pl,{formData:g,updateField:v,handleCountryChange:w,toggleArrayItem:x});case"billing":return r.jsx(xl,{formData:g,updateField:v,onBillingComplete:e=>v("billingComplete",!0)});case"pain_points":return r.jsx(hl,{formData:g,toggleArrayItem:x});case"company_profile":return r.jsx(fl,{formData:g,updateField:v});case"team_invite":return r.jsx(gl,{formData:g,updateField:v});case"data_import":return r.jsx(yl,{formData:g,updateField:v});case"rate_card":return r.jsx(bl,{formData:g,updateField:v});case"first_action":return r.jsx(vl,{formData:g,updateField:v});default:return null}})()})]})}),r.jsx("div",{className:"bg-dark-card border-t border-dark-border px-6 py-4",children:r.jsxs("div",{className:"max-w-2xl mx-auto flex items-center justify-between",children:[r.jsxs("button",{onClick:()=>{if(n>0){let e=n-1;"team_invite"===Hs[e].id&&"just_me"===g.teamSize&&e--,a(Math.max(0,e))}},disabled:0===n||s,className:"flex items-center gap-2 px-4 py-2 text-gray-400 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(yo,{className:"w-4 h-4"}),"Back"]}),r.jsxs("div",{className:"flex items-center gap-3",children:[!S?.required&&r.jsx("button",{onClick:async()=>{const t=Hs[n];if(!t.required){l(!0);try{if(await async function(e,t){if(!(await Xs(e)))return null;const n=Hs.findIndex(e=>e.id===t),a=Hs[n+1];return el(e,{current_step:a?.id||"complete"})}(e,t.id),n<Hs.length-1){let e=n+1;"team_invite"===Hs[e].id&&"just_me"===g.teamSize&&e++,a(e)}else await k()}catch(r){d(r.message||"Failed to skip step")}finally{l(!1)}}},disabled:s,className:"px-4 py-2 text-gray-400 hover:text-white",children:"Skip"}),r.jsxs("button",{onClick:async()=>{if(!(()=>{switch(Hs[n].id){case"company_setup":if(!g.companyName.trim())return d("Please enter your company name"),!1;if(!g.companyType)return d("Please select your company type"),!1;if(!g.teamSize)return d("Please select your team size"),!1;if(!g.country)return d("Please select your country"),!1;break;case"first_action":if(!g.firstAction)return d("Please select what you want to do first"),!1;break;case"team_invite":{const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,t=g.teamInvites.filter(e=>e.email.trim());for(const n of t)if(!e.test(n.email.trim()))return d(`Invalid email format: ${n.email}`),!1;break}}return!0})())return;const t=Hs[n];l(!0);try{const r=_(t.id);if(await el(e,r),await async function(e,t){const n=await Xs(e);if(!n)return null;const a=n.completed_steps||[];a.includes(t)||a.push(t);const r=Hs.findIndex(e=>e.id===t),o=Hs[r+1];return el(e,{completed_steps:a,current_step:o?.id||"complete"})}(e,t.id),n<Hs.length-1){let e=n+1;"team_invite"===Hs[e].id&&"just_me"===g.teamSize&&e++,a(e)}else await k()}catch(r){d(r.message||"Failed to save progress")}finally{l(!1)}},disabled:s,className:"btn-primary flex items-center gap-2",children:[s?r.jsx(Eo,{className:"w-4 h-4 animate-spin"}):N?r.jsx(zo,{className:"w-4 h-4"}):r.jsx(bo,{className:"w-4 h-4"}),s?"Saving...":N?"Get Started":"Continue"]})]})]})})]})}function pl({formData:e,updateField:t,handleCountryChange:n,toggleArrayItem:a}){return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Company Name *"}),r.jsx("input",{type:"text",value:e.companyName,onChange:e=>t("companyName",e.target.value),placeholder:"Enter your company name",className:"input w-full text-lg",autoFocus:!0})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Company Type *"}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:Ws.map(n=>{const a=dl[n.icon]||vo;return r.jsxs("button",{onClick:()=>t("companyType",n.id),className:"flex items-center gap-3 p-3 rounded-lg border transition-colors "+(e.companyType===n.id?"border-brand-primary bg-brand-primary/10 text-white":"border-dark-border bg-dark-bg text-gray-300 hover:border-gray-600"),children:[r.jsx(a,{className:"w-5 h-5"}),r.jsx("span",{children:n.label})]},n.id)})})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Primary Focus ",r.jsx("span",{className:"text-gray-500",children:"(select up to 3)"})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:Gs.map(t=>r.jsx("button",{onClick:()=>a("primaryFocus",t.id,3),className:"px-3 py-1.5 rounded-full text-sm transition-colors "+(e.primaryFocus.includes(t.id)?"bg-brand-primary text-white":"bg-dark-bg text-gray-400 border border-dark-border hover:border-gray-600"),children:t.label},t.id))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Team Size *"}),r.jsx("div",{className:"grid grid-cols-4 gap-3",children:Ks.map(n=>r.jsx("button",{onClick:()=>t("teamSize",n.id),className:"p-3 rounded-lg border text-center transition-colors "+(e.teamSize===n.id?"border-brand-primary bg-brand-primary/10 text-white":"border-dark-border bg-dark-bg text-gray-300 hover:border-gray-600"),children:n.label},n.id))})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Country *"}),r.jsxs("select",{value:e.country,onChange:e=>n(e.target.value),className:"input w-full",children:[r.jsx("option",{value:"",children:"Select country"}),ul.map(e=>({code:e,name:Kn[e]?.name||e})).sort((e,t)=>e.name.localeCompare(t.name)).map(({code:e,name:t})=>r.jsx("option",{value:e,children:t},e))]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Currency"}),r.jsx("select",{value:e.currency,onChange:e=>t("currency",e.target.value),className:"input w-full",children:Gn.map(e=>r.jsxs("option",{value:e.code,children:[e.code," - ",e.name]},e.code))})]})]})]})}function hl({formData:e,toggleArrayItem:t}){return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("p",{className:"text-gray-400 mb-4",children:["What's your biggest challenge right now? ",r.jsx("span",{className:"text-gray-500",children:"(select up to 3)"})]}),r.jsx("div",{className:"space-y-3",children:Qs.map(n=>r.jsxs("button",{onClick:()=>t("painPoints",n.id,3),className:"w-full flex items-center gap-3 p-4 rounded-lg border transition-colors text-left "+(e.painPoints.includes(n.id)?"border-brand-primary bg-brand-primary/10":"border-dark-border bg-dark-bg hover:border-gray-600"),children:[r.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center "+(e.painPoints.includes(n.id)?"border-brand-primary bg-brand-primary":"border-gray-600"),children:e.painPoints.includes(n.id)&&r.jsx(So,{className:"w-3 h-3 text-white"})}),r.jsx("span",{className:e.painPoints.includes(n.id)?"text-white":"text-gray-300",children:n.label})]},n.id))})]})}function fl({formData:e,updateField:t}){return r.jsxs("div",{className:"space-y-6",children:[r.jsx("p",{className:"text-gray-400",children:"Add your company details. These will appear on your quotes and invoices."}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Company Logo"}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-24 h-16 bg-dark-bg border border-dark-border rounded-lg flex items-center justify-center overflow-hidden",children:e.logo?r.jsx("img",{src:e.logo,alt:"Logo",className:"max-w-full max-h-full object-contain"}):r.jsx("span",{className:"text-gray-500 text-xs",children:"No logo"})}),r.jsxs("div",{children:[r.jsxs("label",{className:"btn-secondary text-sm cursor-pointer",children:["Upload Logo",r.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{const n=e.target.files?.[0];if(n){const e=new FileReader;e.onload=e=>{t("logo",e.target.result)},e.readAsDataURL(n)}}})]}),e.logo&&r.jsx("button",{onClick:()=>t("logo",null),className:"ml-2 text-xs text-red-400",children:"Remove"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Address"}),r.jsx("textarea",{value:e.address,onChange:e=>t("address",e.target.value),placeholder:"123 Main Street, City, Country",className:"input w-full resize-none",rows:2})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone"}),r.jsx("input",{type:"tel",value:e.phone,onChange:e=>t("phone",e.target.value),placeholder:"+1 234 567 8900",className:"input w-full"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Website"}),r.jsx("input",{type:"url",value:e.website,onChange:e=>t("website",e.target.value),placeholder:"https://www.yourcompany.com",className:"input w-full"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Payment Terms"}),r.jsx("select",{value:e.paymentTerms,onChange:e=>t("paymentTerms",e.target.value),className:"input w-full",children:Ys.map(e=>r.jsx("option",{value:e.id,children:e.label},e.id))})]})]})}function gl({formData:e,updateField:t}){const n=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,a=(n,a,r)=>{const o=[...e.teamInvites];o[n]={...o[n],[a]:r},t("teamInvites",o)};return r.jsxs("div",{className:"space-y-6",children:[r.jsx("p",{className:"text-gray-400",children:"Invite your team members to collaborate. They'll receive an email invitation."}),r.jsx("div",{className:"space-y-3",children:e.teamInvites.map((o,i)=>{const s=o.email.trim()&&!(!(l=o.email).trim()||n.test(l.trim()));var l;return r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex gap-3",children:[r.jsx("input",{type:"email",value:o.email,onChange:e=>a(i,"email",e.target.value),placeholder:"colleague@company.com",className:"input flex-1 "+(s?"border-red-500 focus:border-red-500":"")}),r.jsxs("select",{value:o.role,onChange:e=>a(i,"role",e.target.value),className:"input w-32",children:[r.jsx("option",{value:"admin",children:"Admin"}),r.jsx("option",{value:"member",children:"Member"}),r.jsx("option",{value:"viewer",children:"Viewer"})]}),e.teamInvites.length>1&&r.jsx("button",{onClick:()=>(n=>{t("teamInvites",e.teamInvites.filter((e,t)=>t!==n))})(i),className:"text-gray-500 hover:text-red-400",children:r.jsx(Go,{className:"w-5 h-5"})})]}),s&&r.jsx("p",{className:"text-red-500 text-sm pl-1",children:"Please enter a valid email address"})]},i)})}),r.jsxs("button",{onClick:()=>{t("teamInvites",[...e.teamInvites,{email:"",role:"member"}])},className:"flex items-center gap-2 text-brand-primary hover:text-brand-primary/80",children:[r.jsx(Po,{className:"w-4 h-4"}),"Add another"]})]})}function yl({formData:e,updateField:t}){const[n,a]=m.useState({}),[o,i]=m.useState({}),s=async(n,r)=>{if(r){i(e=>({...e,[n]:!0})),a(e=>({...e,[n]:null}));try{const{headers:o,rows:i,format:s}=await sl(r);if(0===i.length)return void a(e=>({...e,[n]:{error:"No data found in file"}}));const l=function(e,t){const n=ol[t];if(!n)return null;const a={},r=[];return e.forEach(e=>{const t=e.toLowerCase().trim();let o=!1;const i=[...n.required,...n.optional];for(const n of i)if(t===n){a[e]=n,o=!0;break}if(!o)for(const[r,s]of Object.entries(n.aliases))if(s.some(e=>t===e.toLowerCase())){a[e]=r,o=!0;break}o||r.push(e)}),{mapping:a,unmapped:r}}(o,n),{validRows:c,invalidRows:d,errors:u}=function(e,t,n){const a=ol[n];if(!a)return{valid:[],invalid:[],errors:["Unknown data type"]};const r=[],o=[],i=[],s=Object.values(t),l=a.required.filter(e=>!s.includes(e));return l.length>0?(i.push(`Missing required fields: ${l.join(", ")}`),{valid:[],invalid:e,errors:i}):(e.forEach((e,n)=>{const s={};let l=!0;const c=[];for(const[a,r]of Object.entries(t))s[r]=e[a]||"";for(const t of a.required)s[t]?.trim()||(l=!1,c.push(`Row ${n+1}: Missing required field "${t}"`));if(s.day_rate&&s.day_rate.trim()){const e=parseFloat(s.day_rate.replace(/[^0-9.-]/g,""));isNaN(e)?c.push(`Row ${n+1}: Invalid day rate "${s.day_rate}"`):s.day_rate=e}if(s.quantity&&s.quantity.trim()){const e=parseInt(s.quantity.replace(/[^0-9]/g,""),10);isNaN(e)?c.push(`Row ${n+1}: Invalid quantity "${s.quantity}"`):s.quantity=e}l?r.push(s):(o.push({row:s,errors:c}),i.push(...c))}),{valid:r,invalid:o,errors:i})}(i,l,n);if(0===c.length)return void a(e=>({...e,[n]:{error:`No valid records found. ${u.length} errors: ${u.slice(0,3).join(", ")}${u.length>3?"...":""}`}}));t("dataImports",{...e.dataImports,[n]:c}),a(e=>({...e,[n]:{success:!0,count:c.length,invalidCount:d.length}}))}catch(o){a(e=>({...e,[n]:{error:o.message||"Failed to process file"}}))}finally{i(e=>({...e,[n]:!1}))}}};return r.jsxs("div",{className:"space-y-6",children:[r.jsx("p",{className:"text-gray-400",children:"Import your existing data to get started quickly, or start fresh."}),r.jsx("div",{className:"grid gap-4",children:["clients","crew","equipment"].map(i=>{const l=n[i],c=o[i],d=e.dataImports?.[i]?.length>0;return r.jsxs("div",{className:"p-4 bg-dark-bg border border-dark-border rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"text-white font-medium capitalize",children:i}),r.jsx("p",{className:"text-sm text-gray-500",children:d?r.jsxs("span",{className:"text-green-400",children:[e.dataImports[i].length," records ready to import"]}):"Import from CSV"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("button",{onClick:()=>(e=>{ll(e)})(i),className:"text-sm text-brand-primary hover:underline flex items-center gap-1",children:[r.jsx(To,{className:"w-3 h-3"}),"Template"]}),d?r.jsxs("button",{onClick:()=>(n=>{t("dataImports",{...e.dataImports,[n]:null}),a(e=>({...e,[n]:null}))})(i),className:"btn-secondary text-sm flex items-center gap-1",children:[r.jsx(Go,{className:"w-4 h-4"}),"Clear"]}):r.jsxs("label",{className:"btn-secondary text-sm cursor-pointer flex items-center gap-1 "+(c?"opacity-50 cursor-wait":""),children:[c?r.jsx(Eo,{className:"w-4 h-4 animate-spin"}):r.jsx(Uo,{className:"w-4 h-4"}),"Upload",r.jsx("input",{type:"file",accept:".csv",className:"hidden",disabled:c,onChange:e=>s(i,e.target.files?.[0])})]})]})]}),l?.error&&r.jsxs("div",{className:"mt-2 text-sm text-red-400 flex items-center gap-1",children:[r.jsx(ko,{className:"w-4 h-4"}),l.error]}),l?.success&&l.invalidCount>0&&r.jsxs("div",{className:"mt-2 text-sm text-yellow-400",children:[l.invalidCount," rows skipped due to validation errors"]})]},i)})}),r.jsx("div",{className:"text-center pt-4",children:r.jsx("p",{className:"text-sm text-gray-500",children:"You can also import data later from Settings"})})]})}function bl({formData:e,updateField:t}){const n=(a=e.country,Zs[a]||Zs.default);var a;const o=(i=e.companyType,Js[i]||Js.other);var i;return r.jsxs("div",{className:"space-y-6",children:[r.jsx("p",{className:"text-gray-400",children:"Set your default day rates. These will be used when creating quotes."}),r.jsx("div",{className:"space-y-3",children:o.map(a=>r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx("span",{className:"text-white w-48",children:a}),r.jsxs("div",{className:"flex-1 relative",children:[r.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:e.currency}),r.jsx("input",{type:"number",value:e.crewRates[a]||"",onChange:n=>((n,a)=>{t("crewRates",{...e.crewRates,[n]:a})})(a,n.target.value),placeholder:n.mid.toString(),className:"input w-full pl-14"})]}),r.jsx("span",{className:"text-gray-500 text-sm",children:"/day"})]},a))}),r.jsxs("p",{className:"text-xs text-gray-500",children:["Suggested rates for your region: ",e.currency," ",n.junior," - ",n.senior,"/day"]})]})}function vl({formData:e,updateField:t}){const n=[{id:"create_quote",label:"Create a quote",description:"Start with a new quote for a client",icon:jo,recommended:e.painPoints.includes("quoting_slow")},{id:"add_project",label:"Add a project",description:"Set up your first production project",icon:Do,recommended:e.painPoints.includes("no_visibility")},{id:"explore_dashboard",label:"Explore the dashboard",description:"Take a tour of all the features",icon:Io}];return r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-gray-400",children:"What would you like to do first?"}),r.jsx("div",{className:"space-y-3",children:n.map(n=>r.jsxs("button",{onClick:()=>t("firstAction",n.id),className:"w-full flex items-center gap-4 p-4 rounded-lg border transition-colors text-left "+(e.firstAction===n.id?"border-brand-primary bg-brand-primary/10":"border-dark-border bg-dark-bg hover:border-gray-600"),children:[r.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center "+(e.firstAction===n.id?"bg-brand-primary/20":"bg-dark-card"),children:r.jsx(n.icon,{className:"w-5 h-5 "+(e.firstAction===n.id?"text-brand-primary":"text-gray-400")})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:e.firstAction===n.id?"text-white font-medium":"text-gray-300",children:n.label}),n.recommended&&r.jsx("span",{className:"px-2 py-0.5 bg-brand-primary/20 text-brand-primary text-xs rounded-full",children:"Recommended"})]}),r.jsx("p",{className:"text-sm text-gray-500",children:n.description})]}),r.jsx("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center "+(e.firstAction===n.id?"border-brand-primary bg-brand-primary":"border-gray-600"),children:e.firstAction===n.id&&r.jsx(So,{className:"w-3 h-3 text-white"})})]},n.id))})]})}function xl({formData:e,updateField:t,onBillingComplete:n}){const[a,o]=m.useState("starter");return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"text-center mb-6",children:[r.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-green-500/20 text-green-400 rounded-full text-sm mb-4",children:[r.jsx(zo,{className:"w-4 h-4"}),"48-Hour Free Trial"]}),r.jsx("p",{className:"text-gray-400",children:"Explore ProductionOS with full access. Choose a plan anytime from Settings."})]}),r.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:[{id:"starter",name:"Starter",price:"$29",period:"/month",features:["Unlimited quotes","Up to 50 clients","5 team members","Custom templates"],recommended:!0},{id:"professional",name:"Professional",price:"$79",period:"/month",features:["Everything in Starter","Unlimited clients","15 team members","API access","Priority support"]}].map(e=>r.jsxs("button",{onClick:()=>{o(e.id),t("selectedPlan",e.id)},className:"relative p-5 rounded-xl border text-left transition-all "+(a===e.id?"border-brand-primary bg-brand-primary/10":"border-dark-border bg-dark-bg hover:border-gray-600"),children:[e.recommended&&r.jsx("span",{className:"absolute -top-3 left-4 px-2 py-1 bg-brand-primary text-white text-xs font-medium rounded",children:"Recommended"}),r.jsxs("div",{className:"flex items-baseline gap-1 mb-3",children:[r.jsx("span",{className:"text-2xl font-bold text-white",children:e.price}),r.jsx("span",{className:"text-gray-500",children:e.period})]}),r.jsx("h4",{className:"font-semibold text-white mb-2",children:e.name}),r.jsx("ul",{className:"space-y-1",children:e.features.map((e,t)=>r.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-400",children:[r.jsx(So,{className:"w-3.5 h-3.5 text-green-500"}),e]},t))}),r.jsx("div",{className:"absolute top-4 right-4 w-5 h-5 rounded-full border-2 flex items-center justify-center "+(a===e.id?"border-brand-primary bg-brand-primary":"border-gray-600"),children:a===e.id&&r.jsx(So,{className:"w-3 h-3 text-white"})})]},e.id))}),r.jsx("div",{className:"bg-dark-bg border border-dark-border rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(zo,{className:"w-5 h-5 text-green-400 flex-shrink-0 mt-0.5"}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-white mb-1",children:"What you get in the trial"}),r.jsxs("ul",{className:"text-sm text-gray-400 space-y-1",children:[r.jsx("li",{children:" Full access to all features"}),r.jsx("li",{children:" Unlimited quotes and projects"}),r.jsx("li",{children:" 5-day trial period"}),r.jsx("li",{children:" Upgrade anytime from Settings"})]})]})]})}),r.jsx("p",{className:"text-xs text-center text-gray-500",children:"Click Continue below to start exploring ProductionOS."})]})}const wl={free:{id:"free",name:"Free",description:"For individuals getting started",priceMonthly:0,priceYearly:0,stripePriceIdMonthly:null,stripePriceIdYearly:null,features:["Up to 5 quotes per month","Up to 3 clients","1 team member","Basic templates","Email support"],limits:{quotesPerMonth:5,clients:3,teamMembers:1,storage:100}},starter:{id:"starter",name:"Starter",description:"For small production companies",priceMonthly:29,priceYearly:290,stripePriceIdMonthly:"price_starter_monthly",stripePriceIdYearly:"price_starter_yearly",features:["Unlimited quotes","Up to 50 clients","Up to 5 team members","Custom templates","Invoice generation","Priority email support"],limits:{quotesPerMonth:-1,clients:50,teamMembers:5,storage:1e3}},professional:{id:"professional",name:"Professional",description:"For growing production teams",priceMonthly:79,priceYearly:790,stripePriceIdMonthly:"price_professional_monthly",stripePriceIdYearly:"price_professional_yearly",features:["Everything in Starter","Unlimited clients","Up to 20 team members","Project management","Crew & kit booking","API access","Phone support"],limits:{quotesPerMonth:-1,clients:-1,teamMembers:20,storage:1e4},popular:!0},enterprise:{id:"enterprise",name:"Enterprise",description:"For large production houses",priceMonthly:199,priceYearly:1990,stripePriceIdMonthly:"price_enterprise_monthly",stripePriceIdYearly:"price_enterprise_yearly",features:["Everything in Professional","Unlimited team members","Multi-organization support","Advanced analytics","Custom integrations","SLA guarantee","Dedicated account manager"],limits:{quotesPerMonth:-1,clients:-1,teamMembers:-1,storage:-1}}};async function _l(e,t="monthly"){if(!kn())throw new Error("Database not configured");const{data:{user:n}}=await _n.auth.getUser();if(!n)throw new Error("Not authenticated");const a=Vs.getState().getOrganizationId();if(!a)throw new Error("No organization selected");const r=wl[e];if(!r)throw new Error("Invalid plan");const o="yearly"===t?r.stripePriceIdYearly:r.stripePriceIdMonthly;if(!o)throw new Error("This plan does not support paid subscriptions");const{data:i,error:s}=await _n.functions.invoke("create-checkout-session",{body:{priceId:o,organizationId:a,successUrl:`${window.location.origin}/settings?tab=billing&success=true`,cancelUrl:`${window.location.origin}/settings?tab=billing&canceled=true`}});if(s)throw s;return i}async function kl(){if(!kn())throw new Error("Database not configured");const{data:{user:e}}=await _n.auth.getUser();if(!e)throw new Error("Not authenticated");const t=Vs.getState().getOrganizationId();if(!t)throw new Error("No organization selected");const{data:n,error:a}=await _n.functions.invoke("create-portal-session",{body:{organizationId:t,returnUrl:`${window.location.origin}/settings?tab=billing`}});if(a)throw a;return n}async function Sl(e){if(!kn())return null;const t=new Date;t.setDate(1),t.setHours(0,0,0,0);const{count:n}=await _n.from("quotes").select("*",{count:"exact",head:!0}).eq("organization_id",e).gte("created_at",t.toISOString()),{count:a}=await _n.from("clients").select("*",{count:"exact",head:!0}).eq("organization_id",e),{count:r}=await _n.from("organization_members").select("*",{count:"exact",head:!0}).eq("organization_id",e).eq("status","active");return{quotesThisMonth:n||0,clientCount:a||0,teamMemberCount:r||0}}async function Cl(e,t="free"){const n=wl[t];if(!n)return{exceeded:!1,warnings:[]};const a=await Sl(e);if(!a)return{exceeded:!1,warnings:[]};const r=[];let o=!1;return-1!==n.limits.quotesPerMonth&&(a.quotesThisMonth>=n.limits.quotesPerMonth?(o=!0,r.push(`You've reached your monthly quote limit (${n.limits.quotesPerMonth})`)):a.quotesThisMonth>=.8*n.limits.quotesPerMonth&&r.push(`You're approaching your monthly quote limit (${a.quotesThisMonth}/${n.limits.quotesPerMonth})`)),-1!==n.limits.clients&&(a.clientCount>=n.limits.clients?(o=!0,r.push(`You've reached your client limit (${n.limits.clients})`)):a.clientCount>=.8*n.limits.clients&&r.push(`You're approaching your client limit (${a.clientCount}/${n.limits.clients})`)),-1!==n.limits.teamMembers&&a.teamMemberCount>=n.limits.teamMembers&&(o=!0,r.push(`You've reached your team member limit (${n.limits.teamMembers})`)),{exceeded:o,warnings:r,usage:a}}async function Nl(e,t=null,n=null){if(!kn())throw new Error("Database not configured");const{data:{user:a}}=await _n.auth.getUser();if(!a)throw new Error("Not authenticated");const{data:r,error:o}=await _n.functions.invoke("cancel-subscription",{body:{subscriptionId:e,reason:t,feedback:n}});if(o)throw o;return r}async function jl(e){if(!kn())throw new Error("Database not configured");const{data:{user:t}}=await _n.auth.getUser();if(!t)throw new Error("Not authenticated");const{data:n,error:a}=await _n.functions.invoke("reactivate-subscription",{body:{subscriptionId:e}});if(a)throw a;return n}async function Tl(e){if(!kn())return[];const{data:t,error:n}=await _n.from("billing_invoices").select("*").eq("organization_id",e).order("created_at",{ascending:!1}).limit(24);return n?[]:t||[]}function Il(e,t="USD"){return new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function Dl({type:e="expired",message:t,hoursRemaining:n,subscription:a,onRetry:o}){const{logout:i}=Un(),{organization:s}=Vs(),[l,c]=m.useState(!1),[d,u]=m.useState("professional"),[p,h]=m.useState("monthly"),[f,g]=m.useState(null),y=(()=>{switch(e){case"trial_expired":return{icon:r.jsx(Co,{className:"w-16 h-16 text-amber-500"}),title:"Your Trial Has Ended",description:"Your 5-day trial has expired. Subscribe now to continue using all features."};case"past_due":return{icon:r.jsx(Bo,{className:"w-16 h-16 text-red-500"}),title:"Payment Past Due",description:"We were unable to process your payment. Please update your payment method to continue."};case"grace":return{icon:r.jsx(Co,{className:"w-16 h-16 text-amber-500"}),title:"Subscription Ending Soon",description:`You have ${n} hours remaining to resubscribe and keep your data.`};default:return{icon:r.jsx(Bo,{className:"w-16 h-16 text-red-500"}),title:"Subscription Expired",description:t||"Your subscription has expired. Please resubscribe to continue."}}})(),b=Object.values(wl).filter(e=>"free"!==e.id);return r.jsx("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center p-4",children:r.jsxs("div",{className:"max-w-4xl w-full",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("div",{className:"flex justify-center mb-4",children:y.icon}),r.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:y.title}),r.jsx("p",{className:"text-gray-400 text-lg max-w-md mx-auto",children:y.description})]}),f&&r.jsx("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/20 rounded-lg text-center text-red-400",children:f}),"grace"===e&&n&&r.jsxs("div",{className:"mb-6 p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-center gap-3",children:[r.jsx(Co,{className:"w-5 h-5 text-amber-500"}),r.jsxs("span",{className:"text-amber-400 font-medium",children:[n," hours remaining in grace period"]})]}),r.jsx("p",{className:"text-center text-sm text-amber-400/80 mt-2",children:"After this period, your account will be locked and data may be deleted."})]}),a?.cancel_at_period_end&&r.jsxs("div",{className:"mb-6 p-6 bg-dark-card border border-dark-border rounded-lg text-center",children:[r.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Want to keep your subscription?"}),r.jsxs("p",{className:"text-gray-400 mb-4",children:["Your ",a.plan_id," plan is still active until the end of your billing period."]}),r.jsxs("button",{onClick:async()=>{if(a?.stripe_subscription_id){c(!0),g(null);try{await jl(a.stripe_subscription_id),o?o():window.location.reload()}catch(e){g(e.message||"Failed to reactivate subscription"),c(!1)}}},disabled:l,className:"px-6 py-3 bg-green-600 hover:bg-green-500 text-white font-medium rounded-lg flex items-center gap-2 mx-auto",children:[l?r.jsx(Eo,{className:"w-5 h-5 animate-spin"}):r.jsx(Oo,{className:"w-5 h-5"}),"Reactivate My Subscription"]})]}),r.jsx("div",{className:"flex justify-center mb-6",children:r.jsxs("div",{className:"flex items-center gap-2 bg-dark-card border border-dark-border rounded-lg p-1",children:[r.jsx("button",{onClick:()=>h("monthly"),className:"px-4 py-2 rounded text-sm font-medium transition-colors "+("monthly"===p?"bg-brand-primary text-white":"text-gray-400 hover:text-white"),children:"Monthly"}),r.jsxs("button",{onClick:()=>h("yearly"),className:"px-4 py-2 rounded text-sm font-medium transition-colors "+("yearly"===p?"bg-brand-primary text-white":"text-gray-400 hover:text-white"),children:["Yearly",r.jsx("span",{className:"ml-1 text-xs text-green-400",children:"Save 17%"})]})]})}),r.jsx("div",{className:"grid md:grid-cols-3 gap-4 mb-8",children:b.map(e=>{const t="yearly"===p?e.priceYearly/12:e.priceMonthly,n=e.popular,a=d===e.id;return r.jsxs("div",{onClick:()=>u(e.id),className:"relative bg-dark-card border rounded-lg p-5 cursor-pointer transition-all "+(a?"border-brand-primary ring-2 ring-brand-primary":n?"border-brand-primary/50":"border-dark-border hover:border-gray-600"),children:[n&&r.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 px-3 py-0.5 bg-brand-primary text-white text-xs font-medium rounded-full",children:"Most Popular"}),r.jsx("h4",{className:"text-lg font-semibold text-white",children:e.name}),r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:e.description}),r.jsxs("div",{className:"mt-4",children:[r.jsxs("span",{className:"text-3xl font-bold text-white",children:["$",t]}),r.jsx("span",{className:"text-gray-500",children:"/mo"}),"yearly"===p&&r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Billed $",e.priceYearly," yearly"]})]}),r.jsx("ul",{className:"mt-4 space-y-2",children:e.features.slice(0,4).map((e,t)=>r.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-300",children:[r.jsx(_o,{className:"w-4 h-4 text-green-500 flex-shrink-0 mt-0.5"}),e]},t))}),a&&r.jsx("div",{className:"absolute top-3 right-3",children:r.jsx("div",{className:"w-6 h-6 bg-brand-primary rounded-full flex items-center justify-center",children:r.jsx(_o,{className:"w-4 h-4 text-white"})})})]},e.id)})}),r.jsxs("div",{className:"text-center space-y-4",children:[r.jsxs("button",{onClick:()=>(async e=>{c(!0),g(null);try{const{url:t}=await _l(e,p);t&&(window.location.href=t)}catch(t){g(t.message||"Failed to start checkout"),c(!1)}})(d),disabled:l,className:"px-8 py-4 bg-brand-primary hover:bg-brand-primary/90 text-white font-semibold rounded-lg flex items-center gap-3 mx-auto text-lg",children:[l?r.jsx(Eo,{className:"w-6 h-6 animate-spin"}):r.jsx(jo,{className:"w-6 h-6"}),l?"Processing...":`Subscribe to ${wl[d]?.name}`,!l&&r.jsx(bo,{className:"w-5 h-5"})]}),r.jsx("p",{className:"text-sm text-gray-500",children:"Secure payment powered by Stripe. Cancel anytime."})]}),r.jsxs("div",{className:"mt-8 pt-6 border-t border-dark-border flex items-center justify-between",children:[r.jsxs("button",{onClick:i,className:"text-gray-400 hover:text-white flex items-center gap-2 text-sm",children:[r.jsx(Lo,{className:"w-4 h-4"}),"Sign out"]}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[r.jsxs("a",{href:"mailto:support@productionos.com",className:"hover:text-white flex items-center gap-1",children:[r.jsx(Ao,{className:"w-4 h-4"}),"Contact Support"]}),o&&r.jsxs("button",{onClick:o,className:"hover:text-white flex items-center gap-1",children:[r.jsx(Oo,{className:"w-4 h-4"}),"Retry"]})]})]}),s&&r.jsx("div",{className:"mt-4 text-center text-xs text-gray-600",children:s.name})]})})}const El=["active","trialing"],Ll=["past_due","incomplete"],Al="full",Pl="warning",Rl="grace",Ol="blocked",Ml="onboarding";async function ql(e){if(!kn()||!e)return{access:Al,subscription:null,message:null,daysRemaining:null};try{const{data:t,error:n}=await _n.from("organizations").select("\n                id,\n                subscription_status,\n                subscription_tier,\n                trial_ends_at,\n                stripe_customer_id,\n                created_at\n            ").eq("id",e).single();if(n||!t)return{access:Ml,subscription:null,message:"Organization not found",daysRemaining:null};const{data:a}=await _n.from("subscriptions").select("*").eq("organization_id",e).order("created_at",{ascending:!1}).limit(1).single(),r=a?.status||t.subscription_status,o=new Date;if("trialing"===r||t.trial_ends_at){const e=new Date(a?.trial_end||t.trial_ends_at);if(e>o){const t=Math.ceil((e-o)/36e5),n=Math.ceil(t/24);return{access:Al,subscription:a,message:t<=24?`Trial ends in ${t} hours`:`Trial ends in ${n} days`,daysRemaining:n,hoursRemaining:t,trialEndsAt:e.toISOString(),isTrial:!0}}if("active"!==a?.status)return{access:Ol,subscription:a,message:"Your trial has expired. Please subscribe to continue.",daysRemaining:0,trialExpired:!0}}if(El.includes(r)){const e=a?.current_period_end?new Date(a.current_period_end):null;let t=null;return e&&(t=Math.ceil((e-o)/864e5)),a?.cancel_at_period_end?{access:Al,subscription:a,message:`Your subscription will end on ${e?.toLocaleDateString()}`,daysRemaining:t,cancelAtPeriodEnd:!0}:{access:Al,subscription:a,message:null,daysRemaining:t}}if(Ll.includes(r))return{access:Pl,subscription:a,message:"Your payment is past due. Please update your payment method.",daysRemaining:null,requiresAction:!0};if("canceled"===r||"expired"===r){const e=a?.current_period_end?new Date(a.current_period_end):null;if(e){const t=new Date(e.getTime()+864e5);if(o<t){const e=Math.ceil((t-o)/36e5);return{access:Rl,subscription:a,message:`Your subscription has ended. You have ${e} hours to resubscribe.`,hoursRemaining:e,graceEndsAt:t.toISOString()}}}return{access:Ol,subscription:a,message:"Your subscription has expired. Please resubscribe to continue.",daysRemaining:0}}if(!a&&!t.stripe_customer_id){const e=new Date(t.created_at);return(o-e)/36e5<1?{access:Ml,subscription:null,message:"Complete onboarding to continue",daysRemaining:null}:{access:Ol,subscription:null,message:"Please subscribe to access the platform.",daysRemaining:null}}return{access:Ol,subscription:a,message:"Unable to verify subscription. Please contact support.",daysRemaining:null}}catch(t){return{access:Al,subscription:null,message:null,daysRemaining:null,error:t.message}}}Un.getState().initialize();const zl=m.lazy(()=>E(()=>import("./ClientsPage-NBQ77edb.js"),__vite__mapDeps([0,1,2,3,4]))),Fl=m.lazy(()=>E(()=>import("./ClientDetailPage-Bcm8WR28.js"),__vite__mapDeps([5,1,2,3,6,7,8,9,4]))),Bl=m.lazy(()=>E(()=>import("./OpportunitiesPage-DjMwHt--.js"),__vite__mapDeps([10,1,2,3,11,4]))),Ul=m.lazy(()=>E(()=>import("./OpportunityDetailPage-DVpn6gnd.js"),__vite__mapDeps([12,1,2,3,7,8,6,4]))),$l=m.lazy(()=>E(()=>import("./RateCardPage-Bycbfa7y.js"),__vite__mapDeps([13,1,2,3,4]))),Vl=m.lazy(()=>E(()=>import("./DashboardPage-CUJXXbu6.js"),__vite__mapDeps([14,1,2,3,6,15,16,17,18,19,20,21,22,23,24,25,4]))),Hl=m.lazy(()=>E(()=>import("./QuotesPage-zxL6n72e.js"),__vite__mapDeps([26,1,2,3,4]))),Wl=m.lazy(()=>E(()=>import("./SettingsPage-C1oqMs43.js"),__vite__mapDeps([27,1,2,3,28,29,30,31,32,33,18,16,34,35,4]))),Gl=m.lazy(()=>E(()=>import("./FSPage-CpnJqR-T.js"),__vite__mapDeps([36,1,2,3,11,4]))),Kl=m.lazy(()=>E(()=>import("./CommercialTasksPage-DTlhN3he.js"),__vite__mapDeps([37,1,2,3,38,4]))),Ql=m.lazy(()=>E(()=>import("./SOPPage-DjzoCv3R.js"),__vite__mapDeps([39,1,2,3,4]))),Yl=m.lazy(()=>E(()=>import("./KnowledgePage-VQKKjN9Q.js"),__vite__mapDeps([40,1,2,3,41,4]))),Jl=m.lazy(()=>E(()=>import("./KitListPage-DYyTlz-4.js"),__vite__mapDeps([42,1,2,3,4]))),Zl=m.lazy(()=>E(()=>import("./ContactsPage-r-3_7XMq.js"),__vite__mapDeps([43,1,2,3,6,9,7,4]))),Xl=m.lazy(()=>E(()=>import("./ProjectsPage-D6VyOyM4.js"),__vite__mapDeps([44,1,2,3,4]))),ec=m.lazy(()=>E(()=>import("./ProjectDetailPage-Dawz7OYa.js"),__vite__mapDeps([45,1,2,3,4]))),tc=m.lazy(()=>E(()=>import("./CrewPage-BZw1_fMn.js"),__vite__mapDeps([46,1,2,3,4]))),nc=m.lazy(()=>E(()=>import("./CrewDetailPage-B3YhcbJb.js"),__vite__mapDeps([47,1,2,3,4]))),ac=m.lazy(()=>E(()=>import("./KitBookingPage-D3nIJJLY.js"),__vite__mapDeps([48,1,2,3,4]))),rc=m.lazy(()=>E(()=>import("./CallSheetPage-DVBLcaTS.js"),__vite__mapDeps([49,1,2,3,4]))),oc=m.lazy(()=>E(()=>import("./CallSheetDetailPage-Bky4VI6K.js"),__vite__mapDeps([50,1,2,3,4]))),ic=m.lazy(()=>E(()=>import("./InvoicesPage-D6kFoN2C.js"),__vite__mapDeps([51,1,2,3,4]))),sc=m.lazy(()=>E(()=>import("./ExpensesPage-BuhHv0bH.js"),__vite__mapDeps([52,1,2,3,4]))),lc=m.lazy(()=>E(()=>import("./ProfitLossPage-B5HJopl1.js"),__vite__mapDeps([53,1,2,3,4]))),cc=m.lazy(()=>E(()=>import("./PurchaseOrdersPage-CQQDCh2H.js"),__vite__mapDeps([54,1,2,3,4]))),dc=m.lazy(()=>E(()=>import("./ContractsPage-U7vXwX-W.js"),__vite__mapDeps([55,1,2,3,4]))),uc=m.lazy(()=>E(()=>import("./EmailPage-u-8luTJc.js"),__vite__mapDeps([56,1,2,3,6,57,32,58,30,24,59,60,21,61,62,4]))),mc=m.lazy(()=>E(()=>import("./EmailTemplatesPage-CmHiTgHX.js"),__vite__mapDeps([63,1,2,3,64,57,59,65,29,66,31,30,33,4]))),pc=m.lazy(()=>E(()=>import("./WorkflowsPage-C2JC5nDi.js"),__vite__mapDeps([67,1,2,3,16,60,66,24,68,30,25,59,69,19,15,29,31,70,35,4]))),hc=m.lazy(()=>E(()=>import("./CalendarPage-C_R0rb65.js"),__vite__mapDeps([71,1,2,3,28,61,65,29,66,30,72,62,4]))),fc=m.lazy(()=>E(()=>import("./EmailSequencesPage-DuxvRSev.js"),__vite__mapDeps([73,1,2,3,64,69,20,59,60,29,33,66,31,70,30,34,4]))),gc=m.lazy(()=>E(()=>import("./TaskBoardPage-GMSCTpTp.js"),__vite__mapDeps([74,1,2,3,62,31,30,22,19,75,58,59,24,60,38,34,4]))),yc=m.lazy(()=>E(()=>import("./ResourcesPage-DUDxdrez.js"),__vite__mapDeps([76,1,2,3,4])));m.lazy(()=>E(()=>import("./LandingPage-DuIECx0M.js"),__vite__mapDeps([77,1,2,3,78,79,69,16,4])));const bc=m.lazy(()=>E(()=>import("./Home-01Dxp09G.js"),__vite__mapDeps([80,1,2,3,81,24,79,82,32,68,75,58,34,23,15,18,59,72,83,84,85,61,65,22,4]))),vc=m.lazy(()=>E(()=>import("./Pricing-Ceo2EGEP.js"),__vite__mapDeps([86,1,2,3,81,24,79,85,84,4]))),xc=m.lazy(()=>E(()=>import("./FeaturePage-CGN0epQO.js"),__vite__mapDeps([87,1,2,3,81,24,79,88,22,18,78,20,82,32,68,75,58,34,23,15,59,72,83,17,85,4]))),wc=m.lazy(()=>E(()=>import("./UseCasePage-Bk59gDwE.js"),__vite__mapDeps([89,1,2,3,81,24,79,88,22,18,78,20,82,32,68,75,58,34,23,15,59,72,85,4]))),_c=m.lazy(()=>E(()=>import("./ComparePage-BHNv9T4N.js"),__vite__mapDeps([90,1,2,3,81,24,79,85,4]))),kc=m.lazy(()=>E(()=>import("./GoogleOAuthCallback-BGRCxx7g.js"),__vite__mapDeps([91,1,2,3,4]))),Sc=m.lazy(()=>E(()=>import("./TermsPage-BAfhFLhW.js"),__vite__mapDeps([92,1,2,3,81,24,79,4]))),Cc=m.lazy(()=>E(()=>import("./PrivacyPage-BauEXYk2.js"),__vite__mapDeps([93,1,2,3,81,24,79,4]))),Nc=m.lazy(()=>E(()=>import("./GDPRPage-CPTG-Deq.js"),__vite__mapDeps([94,1,2,3,81,24,79,33,30,95,4]))),jc=m.lazy(()=>E(()=>import("./ResetPasswordPage-hzODrbjt.js"),__vite__mapDeps([96,1,2,3,4]))),Tc=m.lazy(()=>E(()=>import("./BlogPage-BxPkp2Nq.js"),__vite__mapDeps([97,1,2,3,81,24,79,85,4]))),Ic=m.lazy(()=>E(()=>import("./BlogPostPage-DSTLTAGK.js"),__vite__mapDeps([98,1,2,3,81,24,79,85,21,4]))),Dc=m.lazy(()=>E(()=>import("./AboutPage-BEAUvRTM.js"),__vite__mapDeps([99,1,2,3,81,24,79,85,16,95,4]))),Ec=m.lazy(()=>E(()=>import("./ContactPage-B2ylvfJW.js"),__vite__mapDeps([100,1,2,3,81,24,79,85,34,32,4])));function Lc(){const{isAuthenticated:e,user:t}=Un(),{organization:n,loading:a,initialize:o}=Vs(),i=pr(e=>e.initialize),s=rr(e=>e.initialize),l=qa(e=>e.initialize),c=na(e=>e.initialize),d=ri(e=>e.initialize),u=Ga(e=>e.initialize),p=Cr(e=>e.initialize),h=mi(e=>e.initialize),f=yi(e=>e.initialize),g=Ti(e=>e.initialize),y=Pi(e=>e.initialize),b=zi(e=>e.initialize),v=Vi(e=>e.initialize),x=Qi(e=>e.initialize),w=ys(e=>e.initialize),_=ws(e=>e.initialize),k=Cs(e=>e.initialize),S=Xi(e=>e.initialize),C=Ds(e=>e.initialize),N=Rs(e=>e.initialize),j=Fs(e=>e.initialize),T=pr(e=>e.resetQuote),I=pr(e=>e.loadQuoteData),[D,E]=m.useState(!1),[L,A]=m.useState(null),[P,R]=m.useState(!1),[O,M]=m.useState("dashboard"),[q,z]=m.useState(null),[F,B]=m.useState(null),[U,$]=m.useState(null),[V,H]=m.useState(null),[W,G]=m.useState(null),[K,Q]=m.useState(!1),[Y,J]=m.useState(!1),[Z,X]=m.useState(null),[ee,te]=m.useState(()=>"true"===localStorage.getItem("sidebar-collapsed")),ne=m.useCallback(()=>{te(e=>{const t=!e;return localStorage.setItem("sidebar-collapsed",String(t)),t})},[]),ae=pr(e=>e.quote),{confirmNavigateAway:re,markAsSaved:oe}=function(e,t){const n=m.useRef(null),a=m.useCallback(()=>{if(!e)return!1;if(!n.current)return!1;const a={...t},r={...n.current};return delete a.updatedAt,delete r.updatedAt,JSON.stringify(a)!==JSON.stringify(r)},[t,e]),r=m.useCallback(()=>{e&&t&&(n.current={...t})},[t,e]),o=m.useCallback(e=>{a()?window.confirm("You have unsaved changes. Are you sure you want to leave?")&&(n.current=null,e()):e()},[a]);return m.useEffect(()=>{const e=e=>{if(a())return e.preventDefault(),e.returnValue="",""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[a]),{hasUnsavedChanges:a,confirmNavigateAway:o,markAsSaved:r}}("editor"===O,ae),ie=m.useCallback(e=>{z(e),M("client-detail")},[]),se=m.useCallback((e=null)=>{X(e),J(!0)},[]),le=m.useCallback(e=>{if(e){const t=rr.getState().getClient(e);if(t){const e=t.contacts?.find(e=>e.isPrimary)||t.contacts?.[0];pr.getState().setClientDetails({clientId:t.id,company:t.company,contactId:e?.id||null,contact:e?.name||t.contact||"",email:e?.email||t.email||"",phone:e?.phone||t.phone||""})}}},[]),ce=m.useCallback(e=>{T();const t={sections:e.sections||{},currency:e.currency||"USD",region:e.region||"SEA",managementFee:e.fees?.managementFee||0,commissionFee:e.fees?.commissionFee||0,discountPercent:e.fees?.discountPercent||0,...e.projectDefaults||{}};I(t),le(Z),Cr.getState().incrementUsageCount(e.id),J(!1),X(null),M("editor")},[T,I,le,Z]),de=m.useCallback(()=>{T(),le(Z),J(!1),X(null),M("editor")},[T,le,Z]),ue=m.useCallback(()=>{J(!1),X(null)},[]),me=m.useCallback(e=>{e&&e.sections&&I(e),M("editor")},[I]),pe=m.useCallback(()=>{re(()=>M("clients"))},[re]),he=m.useCallback(()=>{re(()=>M("rate-card"))},[re]),fe=m.useCallback(()=>{re(()=>M("dashboard"))},[re]),ge=m.useCallback(()=>{re(()=>M("settings"))},[re]),ye=m.useCallback(()=>{re(()=>M("quotes"))},[re]),be=m.useCallback(()=>{re(()=>M("fs"))},[re]),ve=m.useCallback(()=>{re(()=>M("opportunities"))},[re]),xe=m.useCallback(()=>{re(()=>M("tasks"))},[re]),we=m.useCallback(()=>{re(()=>M("email"))},[re]),_e=m.useCallback(()=>{re(()=>M("calendar"))},[re]),ke=m.useCallback(()=>{re(()=>M("sequences"))},[re]),Se=m.useCallback(()=>{re(()=>M("workflows"))},[re]),Ce=m.useCallback(()=>{re(()=>M("sop"))},[re]),Ne=m.useCallback(()=>{re(()=>M("knowledge"))},[re]),je=m.useCallback(()=>{re(()=>M("kit"))},[re]),Te=m.useCallback(()=>{re(()=>M("kit-bookings"))},[re]),Ie=m.useCallback(()=>{re(()=>M("contacts"))},[re]),De=m.useCallback(()=>{re(()=>M("projects"))},[re]),Ee=m.useCallback(e=>{$(e),M("project-detail")},[]),Le=m.useCallback(()=>{re(()=>M("crew"))},[re]),Ae=m.useCallback(e=>{H(e),M("crew-detail")},[]),Pe=m.useCallback(()=>{re(()=>M("call-sheets"))},[re]),Re=m.useCallback(e=>{G(e),M("call-sheet-detail")},[]),Oe=m.useCallback(()=>{re(()=>M("invoices"))},[re]),Me=m.useCallback(()=>{re(()=>M("expenses"))},[re]),qe=m.useCallback(()=>{re(()=>M("pl"))},[re]),ze=m.useCallback(()=>{re(()=>M("purchase-orders"))},[re]),Fe=m.useCallback(()=>{re(()=>M("contracts"))},[re]),Be=m.useCallback(()=>{re(()=>M("resources"))},[re]);m.useCallback(e=>{$(e),M("project-detail")},[]);const Ue=m.useCallback(e=>{B(e),M("opportunity-detail")},[]),$e=m.useCallback(e=>{T(),e.client&&pr.getState().setClientDetails({clientId:e.clientId||e.client.clientId||null,company:e.client.company||"",contactId:e.client.contactId||null,contact:e.client.contact||"",email:e.client.email||"",phone:e.client.phone||"",address:e.client.address||""}),e.project&&pr.getState().setProjectDetails({...e.project,opportunityId:e.opportunityId}),e.currency&&pr.getState().setCurrency(e.currency),e.region&&pr.getState().setRegion(e.region);const t=pr.getState();t.loadQuoteData({...t.quote,quoteDate:(new Date).toISOString().split("T")[0]}),M("editor")},[T]),We=m.useCallback(()=>{Q(e=>!e)},[]);m.useEffect(()=>{"editor"===O&&ae.quoteNumber&&oe()},[O,ae.quoteNumber,oe]);const Ke=na(e=>e.settings);m.useEffect(()=>{"light"===(Ke.theme||"dark")?(document.documentElement.classList.add("light"),document.documentElement.classList.remove("dark")):(document.documentElement.classList.add("dark"),document.documentElement.classList.remove("light"))},[Ke.theme]),m.useEffect(()=>{e&&t?.id&&o(t.id).then(()=>{Vs.getState().organization||E(!0)})},[e,t?.id,o]),m.useEffect(()=>{if(e&&n?.id&&!D){const e=localStorage.getItem(`sub_access_${n.id}`);if(e)try{const t=JSON.parse(e);Date.now()-t.timestamp<3e5&&t.access!==Ol&&A(t)}catch(Pc){}ql(n.id).then(e=>{A(e),R(!1),localStorage.setItem(`sub_access_${n.id}`,JSON.stringify({...e,timestamp:Date.now()}))}).catch(e=>{A({access:Al}),R(!1)})}},[e,n?.id,D]);const Qe=m.useCallback(()=>{n?.id&&(R(!0),ql(n.id).then(e=>{A(e),R(!1)}).catch(()=>{A({access:Al}),R(!1)}))},[n?.id]);if(m.useEffect(()=>{if(e&&n){c();const e=setTimeout(()=>{Promise.all([s(),d(),u()]).catch(e=>{})},100),t=setTimeout(()=>{Promise.all([i(),l(),p(),b()]).catch(e=>{})},500),n=setTimeout(()=>{Promise.all([h(),v(),_(),k()]).catch(e=>{})},1500),a=setTimeout(()=>{Promise.all([f(),g(),y(),x(),w(),S(),C(),N(),j()]).catch(e=>{})},3e3);return()=>{clearTimeout(e),clearTimeout(t),clearTimeout(n),clearTimeout(a)}}},[e,n,i,s,l,c,d,u,p,h,f,g,y,b,v,x,w,_,k,S,C,N,j]),!e)return r.jsx(hn,{children:r.jsxs(m.Suspense,{fallback:r.jsx(co,{}),children:[r.jsxs(Ge,{children:[r.jsx(He,{path:"/",element:r.jsx(bc,{})}),r.jsx(He,{path:"/pricing",element:r.jsx(vc,{})}),r.jsx(He,{path:"/features",element:r.jsx(Ve,{to:"/",replace:!0})}),r.jsx(He,{path:"/features/:featureId",element:r.jsx(xc,{})}),r.jsx(He,{path:"/use-cases/:useCaseId",element:r.jsx(wc,{})}),r.jsx(He,{path:"/compare/:competitorId",element:r.jsx(_c,{})}),r.jsx(He,{path:"/auth/login",element:r.jsx(lo,{})}),r.jsx(He,{path:"/auth/signup",element:r.jsx(lo,{initialMode:"signup"})}),r.jsx(He,{path:"/auth/google-callback",element:r.jsx(kc,{})}),r.jsx(He,{path:"/reset-password",element:r.jsx(jc,{onComplete:()=>window.location.href="/auth/login"})}),r.jsx(He,{path:"/legal/terms",element:r.jsx(Sc,{})}),r.jsx(He,{path:"/legal/privacy",element:r.jsx(Cc,{})}),r.jsx(He,{path:"/legal/gdpr",element:r.jsx(Nc,{})}),r.jsx(He,{path:"/resources/blog",element:r.jsx(Tc,{})}),r.jsx(He,{path:"/resources/blog/:slug",element:r.jsx(Ic,{})}),r.jsx(He,{path:"/company/about",element:r.jsx(Dc,{})}),r.jsx(He,{path:"/company/contact",element:r.jsx(Ec,{})}),r.jsx(He,{path:"*",element:r.jsx(bc,{})})]}),r.jsx(Qo,{})]})});if(a)return r.jsx(co,{text:"Setting up your workspace..."});if(D||!n&&!a){const e=e=>{E(!1),A(null)};return r.jsx(ml,{userId:t?.userId,onComplete:e})}if(L?.access===Ol)return r.jsx(Dl,{type:L.trialExpired?"trial_expired":"expired",message:L.message,hoursRemaining:L.hoursRemaining,subscription:L.subscription,onRetry:Qe});if(L?.access===Rl)return r.jsx(Dl,{type:"grace",message:L.message,hoursRemaining:L.hoursRemaining,subscription:L.subscription,onRetry:Qe});const Ye=()=>{switch(O){case"clients":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading clients..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(zl,{onSelectClient:ie})})});case"client-detail":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading client details..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Fl,{clientId:q,onBackToDashboard:fe,onEditQuote:me,onNewQuote:se,onSelectOpportunity:Ue})})});case"opportunities":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading opportunities..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Bl,{onSelectOpportunity:Ue})})});case"opportunity-detail":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading opportunity..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Ul,{opportunityId:F,onBack:ve,onConvertToQuote:$e})})});case"rate-card":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading rate card..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx($l,{})})});case"dashboard":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading dashboard..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Vl,{onViewQuote:me,onNewQuote:se,onGoToOpportunities:ve,onGoToKnowledge:Ne})})});case"quotes":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading quotes..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Hl,{onEditQuote:me,onNewQuote:se})})});case"settings":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading settings..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Wl,{})})});case"tasks":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading tasks..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Kl,{})})});case"sop":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading SOPs..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Ql,{})})});case"knowledge":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Knowledge Base..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Yl,{})})});case"kit":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Kit List..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Jl,{})})});case"kit-bookings":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Kit Bookings..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(ac,{})})});case"contacts":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Contacts..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Zl,{})})});case"projects":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Projects..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Xl,{onSelectProject:Ee})})});case"project-detail":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Project..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(ec,{projectId:U,onBack:De,onEditQuote:me})})});case"crew":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Crew..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(tc,{onSelectCrew:Ae})})});case"crew-detail":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Crew Member..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(nc,{crewId:V,onBack:Le})})});case"call-sheets":case"analytics":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Analytics..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(rc,{onSelectCallSheet:Re})})});case"call-sheet-detail":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Call Sheet..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(oc,{callSheetId:W,onBack:Pe})})});case"invoices":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Invoices..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(ic,{})})});case"expenses":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Expenses..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(sc,{})})});case"pl":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading P&L..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(lc,{onSelectProject:Ee})})});case"purchase-orders":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Purchase Orders..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(cc,{})})});case"contracts":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Contracts..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(dc,{})})});case"email":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Email..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",className:"h-screen",children:r.jsx(uc,{})})});case"email-templates":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Templates..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",className:"h-screen",children:r.jsx(mc,{})})});case"workflows":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Workflows..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",className:"h-screen overflow-y-auto",children:r.jsx(pc,{})})});case"calendar":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Calendar..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",className:"h-screen overflow-y-auto",children:r.jsx(hc,{})})});case"sequences":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Sequences..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",className:"h-screen overflow-y-auto",children:r.jsx(fc,{})})});case"task-board":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Task Board..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",className:"h-screen overflow-hidden",children:r.jsx(gc,{})})});case"resources":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading Resources..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(yc,{})})});case"fs":return r.jsx(m.Suspense,{fallback:r.jsx(co,{text:"Loading..."}),children:r.jsx("main",{id:"main-content",tabIndex:"-1",children:r.jsx(Gl,{onExit:fe})})});default:return r.jsxs("main",{id:"main-content",className:"flex-1 flex flex-col lg:flex-row max-w-[1920px] mx-auto w-full",tabIndex:"-1",children:[r.jsx("button",{onClick:We,className:"lg:hidden fixed bottom-4 right-4 z-50 btn-primary rounded-full p-4 shadow-xl","aria-label":K?"Show editor":"Show preview",children:K?r.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}):r.jsxs("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),r.jsx("div",{className:(K?"hidden lg:flex":"flex")+" flex-1",children:r.jsx(zr,{onGoToSettings:ge})}),r.jsx("div",{className:(K?"flex":"hidden lg:flex")+" w-full lg:w-[320px] lg:min-w-[320px]",children:r.jsx(Zr,{})})]})}},Je="opportunity-detail"===O?"opportunities":"client-detail"===O?"clients":"project-detail"===O?"projects":"crew-detail"===O?"crew":"call-sheet-detail"===O||"call-sheets"===O?"analytics":O,Ze=m.useCallback(e=>{"dashboard"===e?fe():"quotes"===e?ye():"clients"===e?pe():"opportunities"===e?ve():"projects"===e?De():"tasks"===e?xe():"task-board"===e?re(()=>M("task-board")):"email"===e?we():"calendar"===e?_e():"sequences"===e?ke():"workflows"===e?Se():"sop"===e?Ce():"knowledge"===e?Ne():"kit"===e?je():"kit-bookings"===e?Te():"crew"===e?Le():"analytics"===e?Pe():"invoices"===e?Oe():"expenses"===e?Me():"pl"===e?qe():"purchase-orders"===e?ze():"contracts"===e?Fe():"resources"===e?Be():"rate-card"===e?he():"contacts"===e?Ie():"settings"===e&&ge()},[fe,ye,pe,ve,De,xe,we,_e,ke,Se,Ce,Ne,je,Te,Le,Pe,Oe,Me,qe,ze,Fe,Be,he,Ie,ge]),Xe="editor"===O;return"fs"===O?r.jsxs("div",{className:"min-h-screen "+("light"===Ke.theme?"bg-light-bg":"bg-dark-bg"),children:[r.jsx(Jo,{}),Ye()]}):r.jsxs("div",{className:"min-h-screen flex "+("light"===Ke.theme?"bg-light-bg":"bg-dark-bg"),children:[r.jsx(Jo,{}),!Xe&&r.jsx(ra,{activeTab:Je,onTabChange:Ze,onGoToFS:be,collapsed:ee,onToggleCollapse:ne}),r.jsxs("div",{className:"flex-1 flex flex-col min-h-screen overflow-hidden "+(Xe||ee?"":"lg:ml-0"),children:[Xe&&r.jsx(Tr,{onGoToDashboard:fe}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:Ye()})]}),r.jsx(Xo,{isOpen:Y,onClose:ue,onSelectTemplate:ce,onStartBlank:de})]})}class Ac extends p.Component{constructor(e){super(e),a(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()}),this.state={hasError:!1,error:null,errorInfo:null,copied:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?r.jsx("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center p-4",children:r.jsxs("div",{className:"max-w-2xl w-full bg-dark-card border border-red-500/30 rounded-xl p-8 shadow-2xl",children:[r.jsx("div",{className:"flex items-center justify-center mb-6",children:r.jsx("div",{className:"w-16 h-16 rounded-full bg-red-500/20 flex items-center justify-center",children:r.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),r.jsx("h1",{className:"text-2xl font-bold text-gray-100 text-center mb-2",children:"Something went wrong"}),r.jsx("p",{className:"text-gray-400 text-center mb-6",children:"The application encountered an unexpected error. Your work has been auto-saved."}),r.jsxs("details",{className:"mb-6 bg-dark-bg rounded-lg border border-dark-border",children:[r.jsx("summary",{className:"px-4 py-3 cursor-pointer text-sm text-gray-400 hover:text-gray-300 select-none",children:"Show error details"}),r.jsx("div",{className:"px-4 pb-4 pt-2",children:r.jsxs("div",{className:"font-mono text-xs text-red-400 bg-red-500/5 p-4 rounded border border-red-500/20 overflow-auto max-h-64",children:[this.state.error&&this.state.error.toString(),r.jsx("br",{}),r.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]})})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[r.jsxs("button",{onClick:this.handleReset,className:"flex-1 btn-primary py-3 flex items-center justify-center gap-2",children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reload Application"]}),r.jsxs("button",{onClick:()=>{const e=`Error: ${this.state.error}\n\nStack: ${this.state.errorInfo?.componentStack}`;navigator.clipboard.writeText(e),this.setState({copied:!0}),setTimeout(()=>this.setState({copied:!1}),2e3)},className:"flex-1 btn-ghost py-3 flex items-center justify-center gap-2 "+(this.state.copied?"text-green-400":""),children:[this.state.copied?r.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):r.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),this.state.copied?"Copied!":"Copy Error Details"]})]}),r.jsx("p",{className:"text-xs text-gray-600 text-center mt-6",children:"If this problem persists, please contact support with the error details."})]})}):this.props.children}}I.createRoot(document.getElementById("root")).render(r.jsx(m.StrictMode,{children:r.jsx(Ac,{children:r.jsx(hn,{children:r.jsx(gr,{children:r.jsx(gt,{children:r.jsx(Lc,{})})})})})}));export{Cl as $,ti as A,al as B,$a as C,kn as D,_n as E,la as F,Bo as G,Co as H,Ia as I,yi as J,Un as K,ma as L,Va as M,Qr as N,ko as O,Eo as P,qo as Q,ei as R,zo as S,Ha as T,$o as U,_o as V,Bs as W,Go as X,To as Y,Sl as Z,E as _,pr as a,Tl as a0,wl as a1,bo as a2,jo as a3,Il as a4,Oo as a5,vo as a6,_l as a7,kl as a8,Nl as a9,Cs as aA,_s as aB,Xi as aC,Ds as aD,Ns as aE,js as aF,Rs as aG,Es as aH,Ls as aI,Po as aJ,qs as aK,zs as aL,Vo as aM,wn as aN,bt as aO,je as aP,wo as aQ,Ee as aR,xt as aS,De as aT,co as aU,Ve as aV,yo as aW,jl as aa,Kn as ab,Gn as ac,Fs as ad,Pi as ae,Di as af,Ei as ag,$n as ah,pi as ai,wi as aj,ki as ak,Si as al,zi as am,Mi as an,Vi as ao,Fi as ap,Bi as aq,Qi as ar,Hi as as,Wi as at,ys as au,es as av,ts as aw,ns as ax,ws as ay,bs as az,na as b,Ga as c,Rr as d,fa as e,ga as f,ri as g,ni as h,mi as i,Ua as j,qa as k,Ti as l,fr as m,Ea as n,go as o,Vs as p,Fo as q,xo as r,so as s,Ao as t,rr as u,io as v,tl as w,Mo as x,So as y,rl as z};
