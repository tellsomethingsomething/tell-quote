import{j as e,p as s}from"./pdf-vendor-CqWdlgKa.js";import{r as a}from"./zustand-vendor-BohoUguQ.js";import{j as t,s as r,b as l,C as n,k as i}from"./index-DKsXopg7.js";import"./react-vendor-DRPWudcR.js";import"./supabase-vendor-DWEVVlJw.js";async function o(e,s){if(!t())throw new Error("Supabase not configured");const a={};void 0!==s.name&&(a.name=s.name),void 0!==s.role&&(a.role=s.role),void 0!==s.status&&(a.status=s.status),void 0!==s.tabPermissions&&(a.tab_permissions=s.tabPermissions);const{data:l,error:n}=await r.from("user_profiles").update(a).eq("id",e).select().single();if(n)throw n;return{id:l.id,authUserId:l.auth_user_id,name:l.name,email:l.email,role:l.role,status:l.status||"active",tabPermissions:l.tab_permissions||[]}}function c(e=12){const s="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*";let a="";for(let t=0;t<e;t++)a+=s.charAt(Math.floor(70*Math.random()));return a}const d=[{id:"dashboard",label:"Dashboard",description:"Overview and analytics"},{id:"quotes",label:"Quotes",description:"Quote management"},{id:"clients",label:"Clients",description:"Client database"},{id:"opportunities",label:"Opportunities",description:"Sales pipeline"},{id:"tasks",label:"Tasks",description:"Commercial tasks"},{id:"rate-card",label:"Rate Card",description:"Pricing rates"},{id:"settings",label:"Settings",description:"System configuration (Admin only)"}],m=["dashboard","quotes","clients","opportunities","tasks","rate-card"],x=[{name:"Professional Navy",primary:"#143642",accent:"#0F8B8D",line:"#143642"},{name:"Modern Blue",primary:"#1E40AF",accent:"#3B82F6",line:"#1E40AF"},{name:"Corporate Gray",primary:"#374151",accent:"#6B7280",line:"#374151"},{name:"Elegant Purple",primary:"#5B21B6",accent:"#8B5CF6",line:"#5B21B6"},{name:"Classic Green",primary:"#065F46",accent:"#10B981",line:"#065F46"}];function h(){const{settings:t,setPdfOptions:r}=l(),i=t.pdfOptions||{},[o,c]=a.useState(!1),[d,m]=a.useState("colors"),h=(e,s)=>{r({[e]:s})};return e.jsxs("div",{className:"flex flex-col h-full bg-dark-bg",children:[e.jsx("div",{className:"bg-dark-card border-b border-dark-border p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-100",children:"PDF Styling"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Customize colors and fonts for your quote PDFs"})]}),e.jsx("button",{onClick:async()=>{c(!0);try{const a=(e=>({quoteNumber:"QT-2024-001",createdAt:(new Date).toISOString(),validityDays:30,currency:"USD",client:{company:"Acme Corporation",contact:"John Smith",email:"john@acme.com",phone:"+1 555 123 4567"},project:{title:"Corporate Event Production",venue:"Grand Ballroom, Hilton Hotel",startDate:(new Date).toISOString(),endDate:new Date(Date.now()+2592e5).toISOString(),type:"Event"},preparedBy:e.users?.[0]?.id,sections:{productionTeam:{id:"productionTeam",name:"Production Team",color:"#3B82F6",subsections:{Camera:[{id:"1",name:"Camera Operator",quantity:2,days:3,cost:400,charge:600},{id:"2",name:"Camera Assistant",quantity:1,days:3,cost:250,charge:400}],Audio:[{id:"3",name:"Audio Engineer",quantity:1,days:3,cost:450,charge:650}]}},productionEquipment:{id:"productionEquipment",name:"Production Equipment",color:"#10B981",subsections:{"Camera Package":[{id:"4",name:"Sony FX6 Camera Kit",quantity:2,days:3,cost:300,charge:500}],"Audio Package":[{id:"5",name:"Wireless Mic System",quantity:4,days:3,cost:50,charge:100}]}}},sectionOrder:["productionTeam","productionEquipment"],fees:{managementFee:10,commissionFee:0,discount:0,distributeFees:!1}}))(t),r=await s(e.jsx(n,{quote:a,currency:"USD"})).toBlob(),l=URL.createObjectURL(r);window.open(l,"_blank"),setTimeout(()=>URL.revokeObjectURL(l),5e3)}catch(a){alert("Failed to generate preview. Check console for details.")}finally{c(!1)}},disabled:o,className:"btn-primary flex items-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Preview PDF"]})})]})}),e.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[e.jsx("div",{className:"w-36 bg-dark-card border-r border-dark-border p-2 flex flex-col gap-1",children:[{id:"colors",label:"Colors",icon:"ðŸŽ¨"},{id:"fonts",label:"Fonts",icon:"âœï¸"},{id:"display",label:"Display",icon:"ðŸ‘ï¸"}].map(s=>e.jsxs("button",{onClick:()=>m(s.id),className:"w-full text-left px-3 py-2.5 rounded-lg text-sm flex items-center gap-2 transition-colors "+(d===s.id?"bg-accent-primary/20 text-accent-primary":"text-gray-400 hover:bg-white/5 hover:text-gray-200"),children:[e.jsx("span",{children:s.icon}),s.label]},s.id))}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-xl",children:["colors"===d&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-200 mb-4",children:"Color Presets"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:x.map((s,a)=>e.jsxs("button",{onClick:()=>(e=>{r({primaryColor:e.primary,accentColor:e.accent,lineColor:e.line})})(s),className:"p-3 rounded-lg border border-dark-border hover:border-gray-600 transition-all group text-left",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-5 h-5 rounded",style:{backgroundColor:s.primary}}),e.jsx("div",{className:"w-5 h-5 rounded",style:{backgroundColor:s.accent}})]}),e.jsx("span",{className:"text-xs text-gray-400 group-hover:text-gray-300",children:s.name})]},a))})]}),e.jsxs("div",{className:"border-t border-dark-border pt-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-200 mb-4",children:"Custom Colors"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(p,{label:"Primary Color (Headers, titles)",value:i.primaryColor||"#143642",onChange:e=>h("primaryColor",e)}),e.jsx(p,{label:"Accent Color (Labels)",value:i.accentColor||"#0F8B8D",onChange:e=>h("accentColor",e)}),e.jsx(p,{label:"Line Color (All lines & borders)",value:i.lineColor||"#143642",onChange:e=>h("lineColor",e)}),e.jsx(p,{label:"Text Color (Body text)",value:i.textColor||"#374151",onChange:e=>h("textColor",e)}),e.jsx(p,{label:"Muted Color (Secondary text)",value:i.mutedColor||"#6B7280",onChange:e=>h("mutedColor",e)})]})]})]}),"fonts"===d&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Font Family"}),e.jsxs("select",{value:i.fontFamily||"Helvetica",onChange:e=>h("fontFamily",e.target.value),className:"input w-full",children:[e.jsx("option",{value:"Helvetica",children:"Helvetica (Clean, Modern)"}),e.jsx("option",{value:"Times-Roman",children:"Times Roman (Classic)"}),e.jsx("option",{value:"Courier",children:"Courier (Monospace)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Note: PDF fonts are limited to these built-in options for compatibility."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Base Font Size"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"8",max:"12",value:i.baseFontSize||10,onChange:e=>h("baseFontSize",parseInt(e.target.value)),className:"flex-1 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-accent-primary"}),e.jsxs("span",{className:"text-sm text-gray-300 font-mono w-8",children:[i.baseFontSize||10,"pt"]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Controls the body text size. Headers scale proportionally."})]})]}),"display"===d&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Choose what information to show on your PDF quotes."}),[{key:"showLogo",label:"Company Logo"},{key:"showCompanyAddress",label:"Company Address"},{key:"showCompanyPhone",label:"Company Phone"},{key:"showCompanyEmail",label:"Company Email"},{key:"showTaxNumber",label:"Tax Number"},{key:"showBankDetails",label:"Bank Details"}].map(({key:s,label:a})=>e.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-dark-card border border-dark-border hover:border-gray-600 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:!1!==i[s],onChange:e=>h(s,e.target.checked),className:"w-5 h-5 rounded bg-dark-bg border-dark-border text-accent-primary focus:ring-accent-primary"}),e.jsx("span",{className:"text-gray-300",children:a})]},s))]})]})}),e.jsxs("div",{className:"w-80 bg-dark-card border-l border-dark-border p-4 overflow-y-auto",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-200 mb-4",children:"Color Preview"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg overflow-hidden border border-dark-border",style:{backgroundColor:i.backgroundColor||"#FFFFFF"},children:[e.jsx("div",{className:"p-3",style:{backgroundColor:i.primaryColor||"#143642"},children:e.jsx("div",{className:"text-white text-xs font-bold",children:"QUOTE"})}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("div",{className:"text-sm font-bold",style:{color:i.primaryColor||"#143642"},children:"Project Title"}),e.jsx("div",{className:"text-xs",style:{color:i.textColor||"#374151"},children:"Body text appears in this color"}),e.jsx("div",{className:"text-xs",style:{color:i.mutedColor||"#6B7280"},children:"Secondary info in muted color"}),e.jsx("div",{className:"text-sm font-bold mt-3 pt-2 border-t",style:{color:i.accentColor||"#0F8B8D",borderColor:(i.accentColor||"#0F8B8D")+"30"},children:"Total: $1,234.00"})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:'Click "Preview PDF" to see how your quote will look with these colors.'})]})]})]})]})}function p({label:s,value:a,onChange:t}){return e.jsxs("div",{children:[e.jsx("label",{className:"label",children:s}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"color",value:a,onChange:e=>t(e.target.value),className:"w-12 h-10 rounded cursor-pointer bg-transparent border border-dark-border"}),e.jsx("input",{type:"text",value:a,onChange:e=>t(e.target.value),placeholder:"#000000",className:"input flex-1 font-mono text-sm"})]})]})}const u=[{id:"company",label:"Company"},{id:"tax",label:"Tax & Legal"},{id:"bank",label:"Bank Details"},{id:"users",label:"Users"},{id:"quote",label:"Quote Defaults"},{id:"terms",label:"Terms & Conditions"},{id:"customize",label:"Customization"},{id:"pdf",label:"PDF Options"},{id:"invoice",label:"Quote Templates"},{id:"ai",label:"AI Features"},{id:"activity",label:"Activity Log"}];function b(){const{isAdmin:s,user:l,refreshProfile:n}=i(),[x,h]=a.useState([]),[p,u]=a.useState(!0),[b,j]=a.useState(null),[y,v]=a.useState(!1),[N,f]=a.useState(null),[w,k]=a.useState(!1),[C,P]=a.useState(!1),[S,D]=a.useState({name:"",email:"",password:"",role:"user",tabPermissions:[...m]}),[L,A]=a.useState({newPassword:"",confirmPassword:""});a.useEffect(()=>{B()},[]);const B=async()=>{try{u(!0);const e=await async function(){if(!t())return[];const{data:e,error:s}=await r.from("user_profiles").select("*").order("created_at",{ascending:!0});if(s)throw s;return e.map(e=>({id:e.id,authUserId:e.auth_user_id,name:e.name,email:e.email,role:e.role,status:e.status||"active",tabPermissions:e.tab_permissions||[],createdAt:e.created_at,updatedAt:e.updated_at}))}();h(e),j(null)}catch(e){j(e.message)}finally{u(!1)}},F=async e=>{if(confirm("Are you sure you want to delete this user? This cannot be undone."))try{P(!0),await async function(e){if(!t())throw new Error("Supabase not configured");const{data:s,error:a}=await r.functions.invoke("delete-user",{body:{authUserId:e}});if(a)throw new Error(a.message||"Failed to delete user");if(s?.error)throw new Error(s.error);return!0}(e),await B()}catch(s){j(s.message)}finally{P(!1)}},T=async e=>{try{P(!0),await async function(e,s=m){return o(e,{status:"active",tabPermissions:s})}(e),await B()}catch(s){j(s.message)}finally{P(!1)}},E=(e,s,a)=>{s.includes(e)?a(s.filter(s=>s!==e)):a([...s,e])};return p?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-accent-primary border-t-transparent rounded-full"})}):e.jsxs("div",{className:"max-w-4xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100",children:"User Management"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage team access and permissions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>k(!0),className:"btn-ghost text-sm",children:"Change My Password"}),s()&&e.jsx("button",{onClick:()=>v(!0),className:"btn-primary text-sm",children:"+ Add User"})]})]}),b&&e.jsxs("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),b,e.jsx("button",{onClick:()=>j(null),className:"ml-auto text-red-400 hover:text-red-300",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),x.filter(e=>"pending"===e.status).length>0&&s()&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),e.jsx("h4",{className:"text-sm font-semibold text-yellow-400",children:"Pending Approval"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",x.filter(e=>"pending"===e.status).length,")"]})]}),e.jsx("div",{className:"space-y-2",children:x.filter(e=>"pending"===e.status).map(s=>{const a=s.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2);return e.jsx("div",{className:"card p-4 border-yellow-500/30 bg-yellow-500/5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-white bg-gradient-to-br from-yellow-600 to-orange-600 opacity-60",children:a}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-200",children:s.name}),e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-yellow-500/20 text-yellow-400 font-medium",children:"PENDING"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Requested access on ",new Date(s.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>T(s.id),disabled:C,className:"px-3 py-1.5 text-sm bg-green-500/20 text-green-400 hover:bg-green-500/30 rounded-lg transition-colors",children:"Approve"}),e.jsx("button",{onClick:()=>F(s.authUserId),disabled:C,className:"px-3 py-1.5 text-sm bg-red-500/20 text-red-400 hover:bg-red-500/30 rounded-lg transition-colors",children:"Reject"})]})]})},s.id)})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-400",children:"Active Users"}),x.filter(e=>"active"===e.status||!e.status).map(a=>{const t=a.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2),r=a.id===l?.profile?.id,n=a.tabPermissions?.length||0;return e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-white "+("admin"===a.role?"bg-gradient-to-br from-amber-500 to-orange-600":"bg-gradient-to-br from-accent-primary to-accent-secondary"),children:t}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-200",children:a.name}),"admin"===a.role&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-amber-500/20 text-amber-400 font-medium",children:"ADMIN"}),r&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-accent-primary/20 text-accent-primary font-medium",children:"YOU"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:a.email}),e.jsx("div",{className:"flex items-center gap-1 mt-1",children:e.jsx("span",{className:"text-xs text-gray-600",children:"admin"===a.role?"All tabs":`${n} tab${1!==n?"s":""}`})})]})]}),s()&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>f(a),className:"p-2 text-gray-500 hover:text-gray-300 hover:bg-white/5 rounded-lg transition-colors",title:"Edit user",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),!r&&e.jsx("button",{onClick:()=>F(a.authUserId),className:"p-2 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Delete user",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},a.id)}),x.filter(e=>"suspended"===e.status).length>0&&s()&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-500 mt-6",children:"Suspended Users"}),x.filter(e=>"suspended"===e.status).map(s=>{const a=s.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2);return e.jsx("div",{className:"card p-4 opacity-60",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-white bg-gray-600",children:a}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-400",children:s.name}),e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-red-500/20 text-red-400 font-medium",children:"SUSPENDED"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>T(s.id),disabled:C,className:"px-3 py-1.5 text-sm bg-green-500/20 text-green-400 hover:bg-green-500/30 rounded-lg transition-colors",children:"Reactivate"}),e.jsx("button",{onClick:()=>F(s.authUserId),disabled:C,className:"p-2 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},s.id)})]}),0===x.length&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No users found"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create your first user to get started"})]})]}),y&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsx("h4",{className:"text-lg font-bold text-gray-100",children:"Create New User"})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{type:"text",value:S.name,onChange:e=>D({...S,name:e.target.value}),className:"input w-full",placeholder:"Full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email *"}),e.jsx("input",{type:"email",value:S.email,onChange:e=>D({...S,email:e.target.value}),className:"input w-full",placeholder:"user@company.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Password *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:S.password,onChange:e=>D({...S,password:e.target.value}),className:"input flex-1",placeholder:"Initial password"}),e.jsx("button",{type:"button",onClick:()=>D({...S,password:c()}),className:"btn-ghost text-sm",children:"Generate"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Role"}),e.jsxs("select",{value:S.role,onChange:e=>D({...S,role:e.target.value}),className:"input w-full",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Administrator"})]})]}),"admin"!==S.role&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tab Permissions"}),e.jsx("div",{className:"space-y-2 p-3 bg-dark-bg rounded-lg",children:d.filter(e=>"settings"!==e.id).map(s=>e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:S.tabPermissions.includes(s.id),onChange:()=>E(s.id,S.tabPermissions,e=>D({...S,tabPermissions:e})),className:"w-4 h-4 rounded bg-dark-card border-dark-border text-accent-primary focus:ring-accent-primary"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-300",children:s.label}),e.jsx("p",{className:"text-xs text-gray-600",children:s.description})]})]},s.id))})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>v(!1),className:"btn-ghost",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(S.name&&S.email&&S.password)try{P(!0),await async function({email:e,password:s,name:a,role:l,tabPermissions:n}){if(!t())throw new Error("Supabase not configured");const{data:i,error:o}=await r.functions.invoke("create-user",{body:{email:e,password:s,name:a,role:l,tabPermissions:n}});if(o)throw new Error(o.message||"Failed to create user");if(i?.error)throw new Error(i.error);return i.user}(S),await B(),v(!1),D({name:"",email:"",password:"",role:"user",tabPermissions:[...m]})}catch(e){j(e.message)}finally{P(!1)}else j("Name, email, and password are required")},disabled:C,className:"btn-primary",children:C?"Creating...":"Create User"})]})]})}),N&&e.jsx(g,{user:N,onClose:()=>f(null),onSave:async(e,s)=>{try{P(!0),await o(e,s),await B(),f(null),e===l?.profile?.id&&await n()}catch(a){j(a.message)}finally{P(!1)}},saving:C,togglePermission:E}),w&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl w-full max-w-sm",children:[e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsx("h4",{className:"text-lg font-bold text-gray-100",children:"Change Password"})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"New Password"}),e.jsx("input",{type:"password",value:L.newPassword,onChange:e=>A({...L,newPassword:e.target.value}),className:"input w-full",placeholder:"Enter new password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Confirm Password"}),e.jsx("input",{type:"password",value:L.confirmPassword,onChange:e=>A({...L,confirmPassword:e.target.value}),className:"input w-full",placeholder:"Confirm new password"})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>k(!1),className:"btn-ghost",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(L.newPassword===L.confirmPassword)if(L.newPassword.length<6)j("Password must be at least 6 characters");else try{P(!0),await async function(e){if(!t())throw new Error("Supabase not configured");const{error:s}=await r.auth.updateUser({password:e});if(s)throw s;return!0}(L.newPassword),k(!1),A({newPassword:"",confirmPassword:""}),j(null),alert("Password changed successfully")}catch(e){j(e.message)}finally{P(!1)}else j("Passwords do not match")},disabled:C,className:"btn-primary",children:C?"Changing...":"Change Password"})]})]})})]})}function g({user:s,onClose:t,onSave:r,saving:l,togglePermission:n}){const[i,o]=a.useState({name:s.name,role:s.role,tabPermissions:[...s.tabPermissions||[]]});return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b border-dark-border",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-100",children:"Edit User"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name"}),e.jsx("input",{type:"text",value:i.name,onChange:e=>o({...i,name:e.target.value}),className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Role"}),e.jsxs("select",{value:i.role,onChange:e=>o({...i,role:e.target.value}),className:"input w-full",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Administrator"})]})]}),"admin"!==i.role&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tab Permissions"}),e.jsx("div",{className:"space-y-2 p-3 bg-dark-bg rounded-lg",children:d.filter(e=>"settings"!==e.id).map(s=>e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.tabPermissions.includes(s.id),onChange:()=>n(s.id,i.tabPermissions,e=>o({...i,tabPermissions:e})),className:"w-4 h-4 rounded bg-dark-card border-dark-border text-accent-primary focus:ring-accent-primary"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-300",children:s.label}),e.jsx("p",{className:"text-xs text-gray-600",children:s.description})]})]},s.id))})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-end gap-2",children:[e.jsx("button",{onClick:t,className:"btn-ghost",children:"Cancel"}),e.jsx("button",{onClick:()=>r(s.id,i),disabled:l,className:"btn-primary",children:l?"Saving...":"Save Changes"})]})]})})}function j(){const{settings:s,setCompanyInfo:t,setTaxInfo:r,setBankDetails:n,setQuoteDefaults:i,setPdfOptions:o,setAiSettings:c,addUser:d,updateUser:m,deleteUser:x,addProjectType:p,updateProjectType:g,deleteProjectType:j,moveProjectType:y,addRegion:v,updateRegion:N,deleteRegion:f,moveRegion:w,clearActivityLog:k,exportActivityLog:C}=l(),[P,S]=a.useState("company"),[D,L]=a.useState(!1),[A,B]=a.useState({name:"",email:""}),[F,T]=a.useState(""),[E,U]=a.useState({label:"",currency:"USD"}),[M,I]=a.useState(!1),R=a.useRef(null),q=()=>{I(!0),R.current&&clearTimeout(R.current),R.current=setTimeout(()=>I(!1),2e3)};a.useEffect(()=>()=>{R.current&&clearTimeout(R.current)},[]);const z=e=>{t(e),q()},W=e=>{r(e),q()},G=e=>{n(e),q()},O=e=>{i(e),q()},H=e=>{c(e),q()};return e.jsxs("div",{className:"h-[calc(100vh-60px)] flex flex-col md:flex-row",children:[e.jsxs("div",{className:"md:hidden bg-dark-card border-b border-dark-border p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-100",children:"Settings"}),M&&e.jsxs("span",{className:"text-xs text-green-400 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]})]}),e.jsx("div",{className:"flex gap-1 overflow-x-auto pb-2 -mx-3 px-3",children:u.map(s=>e.jsx("button",{onClick:()=>S(s.id),className:"flex-shrink-0 px-3 py-2 rounded-lg text-sm transition-colors min-h-[40px] "+(P===s.id?"bg-accent-primary/20 text-accent-primary":"text-gray-400 hover:bg-white/5 hover:text-gray-200"),children:s.label},s.id))})]}),e.jsxs("div",{className:"hidden md:block w-48 bg-dark-card border-r border-dark-border p-4 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-100",children:"Settings"}),M&&e.jsxs("span",{className:"text-xs text-green-400 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]})]}),e.jsx("nav",{className:"space-y-1",children:u.map(s=>e.jsx("button",{onClick:()=>S(s.id),className:"w-full text-left px-3 py-2 rounded-lg text-sm transition-colors min-h-[44px] "+(P===s.id?"bg-accent-primary/20 text-accent-primary":"text-gray-400 hover:bg-white/5 hover:text-gray-200"),children:s.label},s.id))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:["company"===P&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"Company Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company Logo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-32 h-16 bg-dark-card border border-dark-border rounded-lg flex items-center justify-center overflow-hidden",children:s.company.logo?e.jsx("img",{src:s.company.logo,alt:"Company logo",className:"max-w-full max-h-full object-contain"}):e.jsx("span",{className:"text-gray-500 text-xs",children:"No logo"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{className:"btn-secondary text-sm cursor-pointer",children:["Upload Logo",e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{const s=e.target.files?.[0];if(s){const e=new FileReader;e.onload=e=>{z({logo:e.target.result})},e.readAsDataURL(s)}}})]}),s.company.logo&&e.jsx("button",{onClick:()=>z({logo:null}),className:"text-xs text-red-400 hover:text-red-300",children:"Remove"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: PNG or SVG, max 200x100px"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company Name"}),e.jsx("input",{type:"text",value:s.company.name,onChange:e=>z({name:e.target.value}),className:"input",placeholder:"Your Company Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Address"}),e.jsx("textarea",{value:s.company.address,onChange:e=>z({address:e.target.value}),className:"input resize-none",rows:2,placeholder:"Street address"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{type:"text",value:s.company.city,onChange:e=>z({city:e.target.value}),className:"input",placeholder:"City"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Country"}),e.jsx("input",{type:"text",value:s.company.country,onChange:e=>z({country:e.target.value}),className:"input",placeholder:"Country"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone"}),e.jsx("input",{type:"tel",value:s.company.phone,onChange:e=>z({phone:e.target.value}),className:"input",placeholder:"+60 3 1234 5678"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{type:"email",value:s.company.email,onChange:e=>z({email:e.target.value}),className:"input",placeholder:"info@company.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Website"}),e.jsx("input",{type:"url",value:s.company.website,onChange:e=>z({website:e.target.value}),className:"input",placeholder:"https://www.company.com"})]})]})]}),"tax"===P&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"Tax & Legal Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tax Registration Number"}),e.jsx("input",{type:"text",value:s.taxInfo.taxNumber,onChange:e=>W({taxNumber:e.target.value}),className:"input",placeholder:"e.g. GST-123456789"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Business Registration Number"}),e.jsx("input",{type:"text",value:s.taxInfo.registrationNumber,onChange:e=>W({registrationNumber:e.target.value}),className:"input",placeholder:"e.g. 123456-A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Licenses / Certifications"}),e.jsx("textarea",{value:s.taxInfo.licenses,onChange:e=>W({licenses:e.target.value}),className:"input resize-none",rows:3,placeholder:"List any relevant licenses or certifications"})]})]})]}),"bank"===P&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"Bank Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bank Name"}),e.jsx("input",{type:"text",value:s.bankDetails.bankName,onChange:e=>G({bankName:e.target.value}),className:"input",placeholder:"e.g. Maybank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Account Name"}),e.jsx("input",{type:"text",value:s.bankDetails.accountName,onChange:e=>G({accountName:e.target.value}),className:"input",placeholder:"Account holder name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Account Number"}),e.jsx("input",{type:"text",value:s.bankDetails.accountNumber,onChange:e=>G({accountNumber:e.target.value}),className:"input",placeholder:"1234567890"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"SWIFT Code"}),e.jsx("input",{type:"text",value:s.bankDetails.swiftCode,onChange:e=>G({swiftCode:e.target.value}),className:"input",placeholder:"MBBEMYKL"})]})]})]})]}),"users"===P&&e.jsx(b,{}),"quote"===P&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"Quote Defaults"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Default Validity (Days)"}),e.jsx("input",{type:"number",value:s.quoteDefaults.validityDays,onChange:e=>O({validityDays:parseInt(e.target.value)||30}),className:"input w-32",min:"1",max:"365"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Terms"}),e.jsx("input",{type:"text",value:s.quoteDefaults.paymentTerms,onChange:e=>O({paymentTerms:e.target.value}),className:"input",placeholder:"e.g. 50% deposit on confirmation"})]})]})]}),"terms"===P&&e.jsxs("div",{className:"max-w-4xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-2",children:"Terms & Conditions"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"These terms will appear on a separate page in your PDF quotes. Use clear, concise language."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Full Terms & Conditions"}),e.jsx("textarea",{value:s.quoteDefaults.termsAndConditions,onChange:e=>O({termsAndConditions:e.target.value}),className:"input resize-none font-mono text-xs leading-relaxed",rows:20,placeholder:"Enter your full terms and conditions here. These will be formatted into columns on the PDF."}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Tip: Use numbered sections (1. 2. 3.) or bullet points for clarity. The PDF will display these in a multi-column layout."})]}),e.jsx("div",{className:"p-4 bg-dark-bg/50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-400",children:"When exporting a PDF, you'll have the option to include the Terms & Conditions as a second page."})})]})]}),"customize"===P&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"Customization"}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-4",children:"Project Types"}),e.jsx("div",{className:"space-y-2 mb-4",children:(s.projectTypes||[]).map((a,t)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-dark-bg/50 rounded group",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("button",{onClick:()=>{y(a.id,"up"),q()},disabled:0===t,className:"text-gray-600 hover:text-gray-300 disabled:opacity-30",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),e.jsx("button",{onClick:()=>{y(a.id,"down"),q()},disabled:t===s.projectTypes.length-1,className:"text-gray-600 hover:text-gray-300 disabled:opacity-30",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsx("input",{type:"text",value:a.label,onChange:e=>{g(a.id,e.target.value),q()},className:"flex-1 bg-transparent text-sm text-gray-300 focus:bg-dark-bg rounded px-2 py-1 border border-transparent focus:border-dark-border"}),e.jsx("button",{onClick:()=>{confirm(`Delete "${a.label}"?`)&&(j(a.id),q())},className:"p-1 text-gray-600 hover:text-red-400 opacity-0 group-hover:opacity-100",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},a.id))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:F,onChange:e=>T(e.target.value),placeholder:"New project type...",className:"input flex-1",onKeyDown:e=>{"Enter"===e.key&&F.trim()&&(p(F.trim()),T(""),q())}}),e.jsx("button",{onClick:()=>{F.trim()&&(p(F.trim()),T(""),q())},className:"btn-primary",children:"Add"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-4",children:"Regions"}),e.jsx("div",{className:"space-y-2 mb-4",children:(s.regions||[]).map((a,t)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-dark-bg/50 rounded group",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("button",{onClick:()=>{w(a.id,"up"),q()},disabled:0===t,className:"text-gray-600 hover:text-gray-300 disabled:opacity-30",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),e.jsx("button",{onClick:()=>{w(a.id,"down"),q()},disabled:t===s.regions.length-1,className:"text-gray-600 hover:text-gray-300 disabled:opacity-30",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsx("input",{type:"text",value:a.label,onChange:e=>{N(a.id,{label:e.target.value}),q()},className:"flex-1 bg-transparent text-sm text-gray-300 focus:bg-dark-bg rounded px-2 py-1 border border-transparent focus:border-dark-border"}),e.jsxs("select",{value:a.currency,onChange:e=>{N(a.id,{currency:e.target.value}),q()},className:"input w-24 text-sm",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"MYR",children:"MYR"}),e.jsx("option",{value:"SGD",children:"SGD"}),e.jsx("option",{value:"GBP",children:"GBP"}),e.jsx("option",{value:"AED",children:"AED"}),e.jsx("option",{value:"SAR",children:"SAR"}),e.jsx("option",{value:"QAR",children:"QAR"}),e.jsx("option",{value:"KWD",children:"KWD"}),e.jsx("option",{value:"THB",children:"THB"}),e.jsx("option",{value:"IDR",children:"IDR"})]}),e.jsx("button",{onClick:()=>{confirm(`Delete "${a.label}"?`)&&(f(a.id),q())},className:"p-1 text-gray-600 hover:text-red-400 opacity-0 group-hover:opacity-100",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},a.id))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:E.label,onChange:e=>U({...E,label:e.target.value}),placeholder:"New region name...",className:"input flex-1",onKeyDown:e=>{"Enter"===e.key&&E.label.trim()&&(v(E.label.trim(),E.currency),U({label:"",currency:"USD"}),q())}}),e.jsxs("select",{value:E.currency,onChange:e=>U({...E,currency:e.target.value}),className:"input w-24",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"MYR",children:"MYR"}),e.jsx("option",{value:"SGD",children:"SGD"}),e.jsx("option",{value:"GBP",children:"GBP"}),e.jsx("option",{value:"AED",children:"AED"})]}),e.jsx("button",{onClick:()=>{E.label.trim()&&(v(E.label.trim(),E.currency),U({label:"",currency:"USD"}),q())},className:"btn-primary",children:"Add"})]})]})]}),"pdf"===P&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"PDF Display Options"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Choose what information to show on exported PDF quotes."}),e.jsx("div",{className:"space-y-3",children:[{key:"showLogo",label:"Show Company Logo"},{key:"showCompanyAddress",label:"Show Company Address"},{key:"showCompanyPhone",label:"Show Company Phone"},{key:"showCompanyEmail",label:"Show Company Email"},{key:"showTaxNumber",label:"Show Tax Number"},{key:"showBankDetails",label:"Show Bank Details"}].map(({key:a,label:t})=>e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.pdfOptions[a],onChange:e=>{return s={[a]:e.target.checked},o(s),void q();var s},className:"w-5 h-5 rounded bg-dark-bg border-dark-border text-accent-primary focus:ring-accent-primary"}),e.jsx("span",{className:"text-gray-300",children:t})]},a))})]}),"invoice"===P&&e.jsx("div",{className:"h-full -m-4 md:-m-6",children:e.jsx(h,{})}),"ai"===P&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-2",children:"AI Features"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Enable AI-powered features like proposal generation and cover page images."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-3",children:"Anthropic API Key (Claude)"}),e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["For AI proposal text generation. Get your key from"," ",e.jsx("a",{href:"https://console.anthropic.com",target:"_blank",rel:"noopener noreferrer",className:"text-accent-primary hover:underline",children:"console.anthropic.com"})]}),e.jsx("input",{type:"password",value:s.aiSettings?.anthropicKey||"",onChange:e=>H({anthropicKey:e.target.value}),className:"input w-full font-mono text-sm",placeholder:"sk-ant-api..."})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-3",children:"OpenAI API Key (DALL-E)"}),e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["For AI cover page image generation. Get your key from"," ",e.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-accent-primary hover:underline",children:"platform.openai.com"})]}),e.jsx("input",{type:"password",value:s.aiSettings?.openaiKey||"",onChange:e=>H({openaiKey:e.target.value}),className:"input w-full font-mono text-sm",placeholder:"sk-..."})]}),e.jsxs("div",{className:"p-4 bg-accent-primary/10 border border-accent-primary/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-semibold text-accent-primary mb-2",children:"AI Features"}),e.jsxs("ul",{className:"text-sm text-gray-400 space-y-1",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:s.aiSettings?.anthropicKey?"text-green-400":"text-gray-600",children:"â—"}),"Generate professional proposals (Claude)"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:s.aiSettings?.openaiKey?"text-green-400":"text-gray-600",children:"â—"}),"AI cover page backgrounds (DALL-E)"]})]})]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Your API keys are stored locally in your browser and never sent to our servers."})]})]}),"activity"===P&&e.jsxs("div",{className:"max-w-4xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-2",children:"Activity Log"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Track all changes made to quotes across your team."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:C,className:"btn-ghost text-sm flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export CSV"]}),e.jsx("button",{onClick:()=>{confirm("Are you sure you want to clear all activity logs?")&&k()},className:"btn-ghost text-sm text-red-400 hover:text-red-300",children:"Clear All"})]})]}),e.jsx("div",{className:"bg-dark-card border border-dark-border rounded-lg overflow-hidden",children:s.activityLog&&0!==s.activityLog.length?e.jsx("div",{className:"divide-y divide-dark-border max-h-[600px] overflow-y-auto",children:s.activityLog.map(s=>{const a=new Date(s.timestamp),t={lock:"text-amber-400 bg-amber-500/10",unlock:"text-green-400 bg-green-500/10",create:"text-blue-400 bg-blue-500/10",update:"text-gray-400 bg-gray-500/10",delete:"text-red-400 bg-red-500/10",status_change:"text-purple-400 bg-purple-500/10"}[s.action]||"text-gray-400 bg-gray-500/10";return e.jsx("div",{className:"p-4 hover:bg-dark-bg/30 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${t}`,children:s.action?.replace("_"," ").toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-200",children:s.description||`${s.action} on ${s.field||"quote"}`}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:[s.quoteNumber&&e.jsxs("span",{className:"font-mono text-accent-primary",children:["#",s.quoteNumber]}),e.jsx("span",{children:s.userName||s.userId||"System"}),e.jsx("span",{children:a.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]})},s.id)})}):e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 text-gray-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-sm",children:"No activity recorded yet"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Changes to quotes will appear here"})]})}),e.jsx("p",{className:"text-xs text-gray-600 mt-4",children:"Activity log stores up to 1,000 entries. Older entries are automatically removed."})]})]})]})}export{j as default};
