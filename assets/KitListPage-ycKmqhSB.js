import{j as e}from"./pdf-vendor-CqWdlgKa.js";import{r as a,R as t}from"./zustand-vendor-BohoUguQ.js";import{w as s,K as l,f as r,x as n,l as i,D as c}from"./index-BALy7xcB.js";import"./react-vendor-DRPWudcR.js";import"./supabase-vendor-DWEVVlJw.js";function d({stats:a}){return e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-3 mb-6",children:[e.jsxs("div",{className:"card text-center p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-brand-teal",children:a.totalItems}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Items"})]}),e.jsxs("div",{className:"card text-center p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:a.availableCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"Available"})]}),e.jsxs("div",{className:"card text-center p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:a.onJobCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"On Job"})]}),e.jsxs("div",{className:"card text-center p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-400",children:r(a.totalValue,"USD").split(".")[0]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Total Value"})]}),e.jsxs("div",{className:"card text-center p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-400",children:r(a.totalRevenue,"USD").split(".")[0]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Revenue"})]}),e.jsxs("div",{className:"card text-center p-3",children:[e.jsx("div",{className:"text-2xl font-bold "+(a.needsMaintenance>0?"text-red-400":"text-gray-500"),children:a.needsMaintenance}),e.jsx("div",{className:"text-xs text-gray-500",children:"Need Attention"})]})]})}function o({category:a,size:t="md"}){const s={video:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z",aperture:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z",mic:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z",headphones:"M3 18v-6a9 9 0 0118 0v6",monitor:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z",grid:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z",wifi:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0",battery:"M5 10h10a2 2 0 012 2v2a2 2 0 01-2 2H5a2 2 0 01-2-2v-2a2 2 0 012-2zm12 2h2",sun:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z",tv:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2z",package:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4",tool:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z",network:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z",cable:"M13 10V3L4 14h7v7l9-11h-7z",maximize:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4",box:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4","more-horizontal":"M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"},l=c.find(e=>e.name===a||e.id===a),r=s[l?.icon]||s.box,n=l?.color||"#6B7280";return e.jsx("div",{className:`${{sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"}[t]} rounded`,style:{color:n},children:e.jsx("svg",{className:"w-full h-full",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:r})})})}function x({item:t,onEdit:s,onDelete:i,children:c,isChild:d=!1}){const[x,m]=a.useState(!1),h=l[t.status]||l.available,u=n[t.condition]||n.good;return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"border-b border-dark-border hover:bg-white/5 transition-colors cursor-pointer "+(d?"bg-dark-bg/30":""),onClick:()=>m(!x),children:[e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[d&&e.jsx("span",{className:"text-gray-600 pl-4",children:"â””"}),e.jsx(o,{category:t.categoryName,size:"sm"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-mono text-sm text-brand-teal",children:t.kitId}),t.childCount>0&&e.jsxs("span",{className:"ml-2 text-xs bg-violet-500/20 text-violet-400 px-1.5 py-0.5 rounded",children:[t.childCount," items"]})]})]})}),e.jsxs("td",{className:"px-3 py-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-200",children:t.name}),t.manufacturer&&e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:t.manufacturer})]}),t.model&&e.jsx("div",{className:"text-xs text-gray-500",children:t.model})]}),e.jsx("td",{className:"px-3 py-2 hidden sm:table-cell",children:e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${h.bg} ${h.color}`,children:h.label})}),e.jsx("td",{className:"px-3 py-2 hidden md:table-cell",children:e.jsx("span",{className:"text-xs text-gray-400",children:t.location||"-"})}),e.jsx("td",{className:"px-3 py-2 hidden lg:table-cell text-right",children:t.dayRate?e.jsx("span",{className:"text-sm text-gray-300",children:r(t.dayRate,t.rateCurrency||"USD")}):e.jsx("span",{className:"text-xs text-gray-600",children:"-"})}),e.jsx("td",{className:"px-3 py-2 hidden xl:table-cell text-right",children:t.currentValue||t.purchasePrice?e.jsx("span",{className:"text-sm text-gray-400",children:r(t.currentValue||t.purchasePrice,t.purchaseCurrency||"USD")}):e.jsx("span",{className:"text-xs text-gray-600",children:"-"})}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),s(t)},className:"p-1.5 text-gray-500 hover:text-gray-300 transition-colors",title:"Edit",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:e=>{e.stopPropagation(),i(t.id)},className:"p-1.5 text-gray-500 hover:text-red-400 transition-colors",title:"Delete",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]}),x&&e.jsx("tr",{className:"bg-dark-bg/50",children:e.jsx("td",{colSpan:7,className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-4",children:[t.imageUrl&&e.jsx("div",{className:"w-24 h-24 rounded-lg overflow-hidden border border-dark-border flex-shrink-0",children:e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Serial Number"}),e.jsx("p",{className:"text-gray-300 font-mono",children:t.serialNumber||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Quantity"}),e.jsxs("p",{className:"text-gray-300",children:[e.jsx("span",{className:t.quantityAvailable>0?"text-green-400":"text-red-400",children:t.quantityAvailable||0}),e.jsxs("span",{className:"text-gray-500",children:[" / ",t.quantity||1]}),e.jsx("span",{className:"text-gray-600 text-xs ml-1",children:"available"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Condition"}),e.jsx("p",{className:u.color,children:u.label})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Purchase Date"}),e.jsx("p",{className:"text-gray-300",children:t.purchaseDate||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Age"}),e.jsx("p",{className:"text-gray-300",children:t.ageMonths?`${t.ageMonths} months`:"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Week Rate"}),e.jsx("p",{className:"text-gray-300",children:t.weekRate?r(t.weekRate,t.rateCurrency):"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Month Rate"}),e.jsx("p",{className:"text-gray-300",children:t.monthRate?r(t.monthRate,t.rateCurrency):"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Total Revenue"}),e.jsx("p",{className:"text-emerald-400",children:r(t.totalRevenue||0,t.rateCurrency||"USD")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Days Used"}),e.jsx("p",{className:"text-gray-300",children:t.totalDaysUsed||0})]}),t.notes&&e.jsxs("div",{className:"col-span-2 md:col-span-4",children:[e.jsx("label",{className:"text-xs text-gray-500",children:"Notes"}),e.jsx("p",{className:"text-gray-400",children:t.notes})]}),(t.technicalTags?.length>0||t.operationalTags?.length>0)&&e.jsxs("div",{className:"col-span-2 md:col-span-4 flex flex-wrap gap-1",children:[t.technicalTags?.map(a=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded",children:a},a)),t.operationalTags?.map(a=>e.jsx("span",{className:"text-xs px-2 py-0.5 bg-amber-500/20 text-amber-400 rounded",children:a},a))]})]})]})})}),x&&c]})}function m({imageUrl:a,onUpload:s,onRemove:l,uploading:r=!1}){const n=t.useRef(null);return e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-lg border border-dark-border overflow-hidden bg-dark-bg flex items-center justify-center flex-shrink-0",children:a?e.jsx("img",{src:a,alt:"Kit",className:"w-full h-full object-cover"}):e.jsx("svg",{className:"w-8 h-8 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("input",{ref:n,type:"file",accept:"image/*",onChange:e=>{const a=e.target.files?.[0];if(a){if(!a.type.startsWith("image/"))return void alert("Please select an image file");if(a.size>5242880)return void alert("Image must be less than 5MB");s(a)}},className:"hidden"}),e.jsx("button",{type:"button",onClick:()=>n.current?.click(),disabled:r,className:"btn-ghost btn-sm text-xs flex items-center gap-1",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-3 h-3 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),a?"Change":"Upload"]})}),a&&e.jsx("button",{type:"button",onClick:l,className:"btn-ghost btn-sm text-xs text-red-400 hover:text-red-300",children:"Remove"}),e.jsx("span",{className:"text-[10px] text-gray-600",children:"Max 5MB, JPG/PNG"})]})]})}function h({item:t,categories:c,locations:d,onSave:o,onClose:x}){const{generateKitId:h,uploadImage:u,removeImage:p}=s(),{items:g,sections:j}=i(),v=!t?.id,[b,y]=a.useState(!1),[N,f]=a.useState(t?.imageUrl||null),[k,C]=a.useState(null),w=a.useMemo(()=>{const e={};return g.forEach(a=>{const t=j.find(e=>e.id===a.section)?.name||a.section||"Other";e[t]||(e[t]=[]),e[t].push(a)}),e},[g,j]),[M,I]=a.useState({kitId:t?.kitId||"",name:t?.name||"",categoryId:t?.categoryId||"",manufacturer:t?.manufacturer||"",model:t?.model||"",serialNumber:t?.serialNumber||"",quantity:t?.quantity||1,quantityAvailable:t?.quantityAvailable||t?.quantity||1,purchaseDate:t?.purchaseDate||"",purchasePrice:t?.purchasePrice||"",purchaseCurrency:t?.purchaseCurrency||"USD",rateCardItemId:t?.rateCardItemId||"",dayRate:t?.dayRate||"",weekRate:t?.weekRate||"",monthRate:t?.monthRate||"",rateCurrency:t?.rateCurrency||"USD",location:t?.location||d[0]||"",status:t?.status||"available",condition:t?.condition||"good",parentKitId:t?.parentKitId||"",notes:t?.notes||"",technicalTags:t?.technicalTags?.join(", ")||"",operationalTags:t?.operationalTags?.join(", ")||"",jobTypeTags:t?.jobTypeTags?.join(", ")||""});a.useEffect(()=>{if(v&&M.categoryId&&!M.kitId){const e=c.find(e=>e.id===M.categoryId);e&&h(e.name).then(e=>{I(a=>({...a,kitId:e}))})}},[M.categoryId,v,c,h]);return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/75 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-dark-card border-b border-dark-border p-4 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:v?"Add Kit Item":`Edit ${t.kitId}`}),e.jsx("button",{onClick:x,className:"p-2 text-gray-400 hover:text-white",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();const a={...M,purchasePrice:M.purchasePrice?parseFloat(M.purchasePrice):null,rateCardItemId:M.rateCardItemId||null,dayRate:M.dayRate?parseFloat(M.dayRate):null,weekRate:M.weekRate?parseFloat(M.weekRate):null,monthRate:M.monthRate?parseFloat(M.monthRate):null,quantity:parseInt(M.quantity)||1,quantityAvailable:parseInt(M.quantityAvailable)||parseInt(M.quantity)||1,technicalTags:M.technicalTags.split(",").map(e=>e.trim()).filter(Boolean),operationalTags:M.operationalTags.split(",").map(e=>e.trim()).filter(Boolean),jobTypeTags:M.jobTypeTags.split(",").map(e=>e.trim()).filter(Boolean),parentKitId:M.parentKitId||null};o(a,k)},className:"p-4 space-y-4",children:[e.jsxs("div",{className:"border-b border-dark-border pb-4",children:[e.jsx("label",{className:"label mb-2",children:"Photo"}),e.jsx(m,{imageUrl:N,onUpload:async e=>{if(v)C(e),f(URL.createObjectURL(e));else{y(!0);try{const a=await u(t.id,e);a&&f(a.url)}catch(a){alert("Failed to upload image: "+a.message)}finally{y(!1)}}},onRemove:async()=>{if(v)C(null),f(null);else if(t?.id){y(!0);try{await p(t.id),f(null)}catch(e){alert("Failed to remove image: "+e.message)}finally{y(!1)}}},uploading:b})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Category"}),e.jsxs("select",{value:M.categoryId,onChange:e=>I({...M,categoryId:e.target.value,kitId:v?"":M.kitId}),className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select category..."}),c.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Kit ID"}),e.jsx("input",{type:"text",value:M.kitId,onChange:e=>I({...M,kitId:e.target.value}),className:"input font-mono",placeholder:"CAM-001",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label label-required",children:"Name"}),e.jsx("input",{type:"text",value:M.name,onChange:e=>I({...M,name:e.target.value}),className:"input",placeholder:"Sony PXW-Z280",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Manufacturer"}),e.jsx("input",{type:"text",value:M.manufacturer,onChange:e=>I({...M,manufacturer:e.target.value}),className:"input",placeholder:"Sony"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Model"}),e.jsx("input",{type:"text",value:M.model,onChange:e=>I({...M,model:e.target.value}),className:"input",placeholder:"PXW-Z280"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Serial Number"}),e.jsx("input",{type:"text",value:M.serialNumber,onChange:e=>I({...M,serialNumber:e.target.value}),className:"input font-mono",placeholder:"SN123456789"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Qty Owned"}),e.jsx("input",{type:"number",min:"1",value:M.quantity,onChange:e=>{const a=parseInt(e.target.value)||1;I(e=>({...e,quantity:a,quantityAvailable:Math.min(e.quantityAvailable,a)}))},className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Qty Available"}),e.jsx("input",{type:"number",min:"0",max:M.quantity,value:M.quantityAvailable,onChange:e=>I({...M,quantityAvailable:parseInt(e.target.value)||0}),className:"input"})]})]})]}),e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3",children:"Purchase Info"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Purchase Date"}),e.jsx("input",{type:"date",value:M.purchaseDate,onChange:e=>I({...M,purchaseDate:e.target.value}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Purchase Price"}),e.jsx("input",{type:"number",step:"0.01",value:M.purchasePrice,onChange:e=>I({...M,purchasePrice:e.target.value}),className:"input",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{value:M.purchaseCurrency,onChange:e=>I({...M,purchaseCurrency:e.target.value}),className:"input",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"MYR",children:"MYR"}),e.jsx("option",{value:"THB",children:"THB"})]})]})]})]}),e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3",children:"Hire Rates"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"label",children:"Link to Rate Card Item"}),e.jsxs("select",{value:M.rateCardItemId,onChange:e=>(e=>{const a=g.find(a=>a.id===e);if(a){const t=a.currencyPricing?.SEA||a.pricing?.SEA||{},s=t.charge?.amount||t.charge||0;I(a=>({...a,rateCardItemId:e,dayRate:s.toString(),weekRate:(5*s).toString(),monthRate:(20*s).toString(),rateCurrency:t.charge?.baseCurrency||"USD"}))}else I(e=>({...e,rateCardItemId:""}))})(e.target.value),className:"input text-sm",children:[e.jsx("option",{value:"",children:"-- Custom pricing (no link) --"}),Object.entries(w).map(([a,t])=>e.jsx("optgroup",{label:a,children:t.map(a=>e.jsxs("option",{value:a.id,children:[a.name," ",a.currencyPricing?.SEA?.charge?.amount?`(${r(a.currencyPricing.SEA.charge.amount,"USD")}/day)`:""]},a.id))},a))]}),M.rateCardItemId&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Pricing synced from rate card. Manual edits will override."})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Day Rate"}),e.jsx("input",{type:"number",step:"0.01",value:M.dayRate,onChange:e=>I({...M,dayRate:e.target.value}),className:"input",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Week Rate"}),e.jsx("input",{type:"number",step:"0.01",value:M.weekRate,onChange:e=>I({...M,weekRate:e.target.value}),className:"input",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Month Rate"}),e.jsx("input",{type:"number",step:"0.01",value:M.monthRate,onChange:e=>I({...M,monthRate:e.target.value}),className:"input",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{value:M.rateCurrency,onChange:e=>I({...M,rateCurrency:e.target.value}),className:"input",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"GBP",children:"GBP"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"MYR",children:"MYR"})]})]})]})]}),e.jsx("div",{className:"border-t border-dark-border pt-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsx("select",{value:M.status,onChange:e=>I({...M,status:e.target.value}),className:"input",children:Object.entries(l).map(([a,t])=>e.jsx("option",{value:a,children:t.label},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Condition"}),e.jsx("select",{value:M.condition,onChange:e=>I({...M,condition:e.target.value}),className:"input",children:Object.entries(n).map(([a,t])=>e.jsx("option",{value:a,children:t.label},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Location"}),e.jsx("select",{value:M.location,onChange:e=>I({...M,location:e.target.value}),className:"input",children:d.map(a=>e.jsx("option",{value:a,children:a},a))})]})]})}),e.jsxs("div",{className:"border-t border-dark-border pt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3",children:"Tags (comma-separated)"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs",children:"Technical (4K, SDI, XLR, V-Lock, etc.)"}),e.jsx("input",{type:"text",value:M.technicalTags,onChange:e=>I({...M,technicalTags:e.target.value}),className:"input text-sm",placeholder:"4K, SDI, V-Lock"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs",children:"Operational (flight-case, rack-mount, weather-sealed)"}),e.jsx("input",{type:"text",value:M.operationalTags,onChange:e=>I({...M,operationalTags:e.target.value}),className:"input text-sm",placeholder:"flight-case, weather-sealed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs",children:"Job Type (OB, Studio, REMI, Presentation)"}),e.jsx("input",{type:"text",value:M.jobTypeTags,onChange:e=>I({...M,jobTypeTags:e.target.value}),className:"input text-sm",placeholder:"OB, REMI"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Notes"}),e.jsx("textarea",{value:M.notes,onChange:e=>I({...M,notes:e.target.value}),className:"input resize-none",rows:2,placeholder:"Any additional notes..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-dark-border",children:[e.jsx("button",{type:"button",onClick:x,className:"btn-ghost",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",children:v?"Add Item":"Save Changes"})]})]})]})})}function u(){const{items:t,categories:r,locations:n,loading:i,error:c,filters:o,initialize:m,addItem:u,updateItem:p,deleteItem:g,uploadImage:j,getFilteredItems:v,getChildren:b,getStats:y,setFilters:N,clearFilters:f,exportToCSV:k,exportPublicList:C}=s(),[w,M]=a.useState(!1),[I,R]=a.useState(null),[L,S]=a.useState("list");a.useEffect(()=>{m()},[m]);const T=a.useMemo(()=>v(),[t,o]),D=a.useMemo(()=>y(),[t]),z=a.useMemo(()=>T.filter(e=>!e.parentKitId),[T]),P=()=>{R(null),M(!0)},A=e=>{R(e),M(!0)},q=async e=>{confirm("Are you sure you want to delete this item?")&&await g(e)};return i?e.jsx("div",{className:"h-[calc(100vh-60px)] flex items-center justify-center",children:e.jsx("div",{className:"text-gray-400",children:"Loading kit list..."})}):e.jsxs("div",{className:"h-[calc(100vh-60px)] overflow-y-auto p-3 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl sm:text-2xl font-bold text-gray-100 flex items-center gap-2",children:[e.jsx("svg",{className:"w-6 h-6 text-brand-teal",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),"Kit List"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Equipment tracking and management"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{className:"btn-ghost text-sm flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export"]}),e.jsxs("div",{className:"hidden group-hover:block absolute right-0 top-full mt-1 bg-dark-card border border-dark-border rounded-lg shadow-xl z-20 min-w-48",children:[e.jsx("button",{onClick:()=>k(),className:"w-full px-4 py-2 text-left text-sm hover:bg-dark-bg transition-colors",children:"Full Kit List (CSV)"}),e.jsx("button",{onClick:()=>k({includeFinancial:!1}),className:"w-full px-4 py-2 text-left text-sm hover:bg-dark-bg transition-colors",children:"Without Financials (CSV)"}),e.jsx("button",{onClick:()=>C(),className:"w-full px-4 py-2 text-left text-sm hover:bg-dark-bg transition-colors border-t border-dark-border",children:"Public Equipment List"})]})]}),e.jsxs("button",{onClick:P,className:"btn-primary flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Item"]})]})]}),c&&e.jsx("div",{className:"mb-4 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-400 font-medium",children:"Database Setup Required"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:c}),c.includes("kit_items")&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Run the ",e.jsx("code",{className:"px-1 py-0.5 bg-dark-bg rounded",children:"supabase-kit-schema.sql"})," file in your Supabase SQL editor to create the required tables."]})]})]})}),e.jsx(d,{stats:D}),e.jsx("div",{className:"card mb-6 p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",value:o.search,onChange:e=>N({search:e.target.value}),className:"input pl-10",placeholder:"Search by ID, name, model..."})]}),e.jsxs("select",{value:o.category||"",onChange:e=>N({category:e.target.value||null}),className:"input-sm",children:[e.jsx("option",{value:"",children:"All Categories"}),r.map(a=>e.jsx("option",{value:a.name,children:a.name},a.id))]}),e.jsxs("select",{value:o.status||"",onChange:e=>N({status:e.target.value||null}),className:"input-sm",children:[e.jsx("option",{value:"",children:"All Status"}),Object.entries(l).map(([a,t])=>e.jsx("option",{value:a,children:t.label},a))]}),e.jsxs("select",{value:o.location||"",onChange:e=>N({location:e.target.value||null}),className:"input-sm",children:[e.jsx("option",{value:"",children:"All Locations"}),n.map(a=>e.jsx("option",{value:a,children:a},a))]}),(o.search||o.category||o.status||o.location)&&e.jsx("button",{onClick:f,className:"btn-ghost btn-sm",children:"Clear"})]})}),e.jsx("div",{className:"card overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-dark-bg/50 border-b border-dark-border",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kit ID"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden sm:table-cell",children:"Status"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell",children:"Location"}),e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider hidden lg:table-cell",children:"Day Rate"}),e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider hidden xl:table-cell",children:"Value"}),e.jsx("th",{className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-dark-border/50",children:0===z.length?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-4 py-12 text-center",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"No equipment found"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:o.search||o.category||o.status||o.location?"Try adjusting your filters":"Start by adding your first piece of equipment"}),e.jsx("button",{onClick:P,className:"btn-primary",children:"Add First Item"})]})}):z.map(a=>e.jsx(x,{item:a,onEdit:A,onDelete:q,children:b(a.id).map(a=>e.jsx(x,{item:a,onEdit:A,onDelete:q,isChild:!0},a.id))},a.id))})]})})}),e.jsxs("div",{className:"mt-4 text-sm text-gray-500 text-center",children:["Showing ",T.length," of ",t.length," items"]}),w&&e.jsx(h,{item:I,categories:r,locations:n,onSave:async(e,a)=>{if(I?.id)await p(I.id,e);else{const t=await u(e);a&&t?.id&&await j(t.id,a)}M(!1),R(null)},onClose:()=>{M(!1),R(null)}})]})}export{u as default};
