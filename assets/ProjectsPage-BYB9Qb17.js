import{j as e}from"./pdf-vendor-CqWdlgKa.js";import{r as t}from"./zustand-vendor-BohoUguQ.js";import{am as r,u as s,f as a,an as l}from"./index-qIMeUE46.js";import"./react-vendor-DRPWudcR.js";import"./supabase-vendor-DWEVVlJw.js";const n=e=>{if(!e)return null;return new Date(e).toLocaleDateString("en-GB",{day:"numeric",month:"short"})};function i({status:t}){const r=l[t]||{label:t,color:"gray"},s={gray:"text-gray-400 bg-gray-500/10 border-gray-500/20",blue:"text-blue-400 bg-blue-500/10 border-blue-500/20",yellow:"text-yellow-400 bg-yellow-500/10 border-yellow-500/20",green:"text-green-400 bg-green-500/10 border-green-500/20",purple:"text-purple-400 bg-purple-500/10 border-purple-500/20",red:"text-red-400 bg-red-500/10 border-red-500/20"};return e.jsx("span",{className:`text-xs px-2 py-0.5 rounded border ${s[r.color]||s.gray}`,children:r.label})}function d({project:t,onSelect:r}){const s=t.budgetTotal>0?Math.round(t.actualsTotal/t.budgetTotal*100):0;return e.jsxs("div",{onClick:()=>r(t.id),className:"bg-dark-card border border-dark-border rounded-lg p-4 hover:border-accent-primary/50 cursor-pointer transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500 font-mono",children:t.projectCode}),e.jsx(i,{status:t.status})]}),e.jsx("h3",{className:"font-semibold text-gray-100 truncate",children:t.name}),t.client?.company&&e.jsx("p",{className:"text-sm text-gray-400 truncate",children:t.client.company})]}),e.jsxs("div",{className:"text-right shrink-0",children:[e.jsx("div",{className:"font-semibold text-gray-200",children:a(t.budgetTotal,t.currency,0)}),e.jsx("div",{className:"text-xs text-gray-500",children:"Budget"})]})]}),(t.startDate||t.endDate)&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400 mb-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsxs("span",{children:[n(t.startDate),t.endDate&&` — ${n(t.endDate)}`]})]}),t.budgetTotal>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-500",children:"Spend vs Budget"}),e.jsxs("span",{className:s>100?"text-red-400":"text-gray-400",children:[a(t.actualsTotal,t.currency,0)," (",s,"%)"]})]}),e.jsx("div",{className:"h-1.5 bg-dark-bg rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all "+(s>100?"bg-red-500":s>80?"bg-yellow-500":"bg-green-500"),style:{width:`${Math.min(s,100)}%`}})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3 text-xs text-gray-500",children:[t.country&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsxs("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),t.country]}),t.projectManagerName&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),t.projectManagerName]})]})]})}function o({isOpen:r,onClose:s,onSave:a,clients:l}){const[n,i]=t.useState({name:"",clientId:"",description:"",startDate:"",endDate:"",currency:"USD",budgetTotal:""});return r?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#1a1f2e] border border-dark-border rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-border",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"New Project"}),e.jsx("button",{onClick:s,className:"btn-icon","aria-label":"Close",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),n.name.trim()&&(a({...n,budgetTotal:parseFloat(n.budgetTotal)||0,client:l.find(e=>e.id===n.clientId)||{}}),i({name:"",clientId:"",description:"",startDate:"",endDate:"",currency:"USD",budgetTotal:""}))},className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Project Name *"}),e.jsx("input",{type:"text",value:n.name,onChange:e=>i({...n,name:e.target.value}),className:"input w-full",placeholder:"e.g., FIFA World Cup 2026 Coverage",autoFocus:!0,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Client"}),e.jsxs("select",{value:n.clientId,onChange:e=>i({...n,clientId:e.target.value}),className:"input w-full",children:[e.jsx("option",{value:"",children:"Select client..."}),l.map(t=>e.jsx("option",{value:t.id,children:t.company},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:n.description,onChange:e=>i({...n,description:e.target.value}),className:"input w-full",rows:3,placeholder:"Brief project description..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:n.startDate,onChange:e=>i({...n,startDate:e.target.value}),className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:n.endDate,onChange:e=>i({...n,endDate:e.target.value}),className:"input w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Currency"}),e.jsxs("select",{value:n.currency,onChange:e=>i({...n,currency:e.target.value}),className:"input w-full",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"MYR",children:"MYR"}),e.jsx("option",{value:"SGD",children:"SGD"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"GBP",children:"GBP"}),e.jsx("option",{value:"AED",children:"AED"}),e.jsx("option",{value:"SAR",children:"SAR"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Budget"}),e.jsx("input",{type:"number",value:n.budgetTotal,onChange:e=>i({...n,budgetTotal:e.target.value}),className:"input w-full",placeholder:"0",min:"0",step:"1000"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",children:"Create Project"})]})]})]})}):null}function c({onSelectProject:c}){const{projects:x,loading:m,error:u,initialize:h,addProject:j,getProjectStats:p}=r(),{clients:g,initialize:b}=s(),[v,f]=t.useState("all"),[y,N]=t.useState(""),[k,w]=t.useState(!1),[C,D]=t.useState("grid");t.useEffect(()=>{h(),b()},[h,b]);const L=t.useMemo(()=>{let e=[...x];if("all"!==v&&(e=e.filter(e=>e.status===v)),y.trim()){const t=y.toLowerCase();e=e.filter(e=>e.name?.toLowerCase().includes(t)||e.projectCode?.toLowerCase().includes(t)||e.client?.company?.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t))}return e},[x,v,y]),M=t.useMemo(()=>p(),[x,p]);return m&&0===x.length?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent-primary"})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"Projects"}),e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:[M.activeCount," active project",1!==M.activeCount?"s":"",M.totalBudget>0&&e.jsxs("span",{className:"ml-2",children:["• ",a(M.totalBudget,"USD",0)," total budget"]})]})]}),e.jsxs("button",{onClick:()=>w(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New Project"]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3 mb-6",children:Object.entries(l).map(([t,{label:r,color:s}])=>{const a=M.byStatus[t]||0,l=v===t;return e.jsxs("button",{onClick:()=>f(l?"all":t),className:"p-3 rounded-lg border transition-all text-left "+(l?"border-accent-primary bg-accent-primary/10":"border-dark-border bg-dark-card hover:border-gray-600"),children:[e.jsx("div",{className:"text-2xl font-bold text-gray-100",children:a}),e.jsx("div",{className:"text-xs text-gray-400",children:r})]},t)})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"Search projects...",value:y,onChange:e=>N(e.target.value),className:"input w-full pl-10"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:["all"!==v&&e.jsxs("button",{onClick:()=>f("all"),className:"text-sm text-gray-400 hover:text-gray-200 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear filter"]}),e.jsxs("div",{className:"flex border border-dark-border rounded-lg overflow-hidden",children:[e.jsx("button",{onClick:()=>D("grid"),className:"p-2 "+("grid"===C?"bg-dark-border text-gray-200":"text-gray-500 hover:text-gray-300"),title:"Grid view","aria-label":"Grid view",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),e.jsx("button",{onClick:()=>D("list"),className:"p-2 "+("list"===C?"bg-dark-border text-gray-200":"text-gray-500 hover:text-gray-300"),title:"List view","aria-label":"List view",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]})]}),u&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 p-4 rounded-lg mb-6",children:u}),0===L.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-300 mb-1",children:"No projects found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:y||"all"!==v?"Try adjusting your filters":"Create your first project to get started"}),!y&&"all"===v&&e.jsx("button",{onClick:()=>w(!0),className:"btn-primary",children:"Create Project"})]}):"grid"===C?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:L.map(t=>e.jsx(d,{project:t,onSelect:c},t.id))}):e.jsx("div",{className:"bg-dark-card border border-dark-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-border text-left",children:[e.jsx("th",{className:"p-3 text-xs font-medium text-gray-500 uppercase",children:"Project"}),e.jsx("th",{className:"p-3 text-xs font-medium text-gray-500 uppercase",children:"Client"}),e.jsx("th",{className:"p-3 text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"p-3 text-xs font-medium text-gray-500 uppercase",children:"Dates"}),e.jsx("th",{className:"p-3 text-xs font-medium text-gray-500 uppercase text-right",children:"Budget"})]})}),e.jsx("tbody",{children:L.map(t=>e.jsxs("tr",{onClick:()=>c(t.id),className:"border-b border-dark-border last:border-0 hover:bg-dark-bg/50 cursor-pointer",children:[e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"text-xs text-gray-500 font-mono",children:t.projectCode}),e.jsx("div",{className:"font-medium text-gray-200",children:t.name})]}),e.jsx("td",{className:"p-3 text-gray-400",children:t.client?.company||"—"}),e.jsx("td",{className:"p-3",children:e.jsx(i,{status:t.status})}),e.jsxs("td",{className:"p-3 text-sm text-gray-400",children:[t.startDate?n(t.startDate):"—",t.endDate&&` — ${n(t.endDate)}`]}),e.jsx("td",{className:"p-3 text-right font-medium text-gray-200",children:a(t.budgetTotal,t.currency,0)})]},t.id))})]})}),e.jsx(o,{isOpen:k,onClose:()=>w(!1),onSave:async e=>{const t=await j(e);t&&(w(!1),c&&c(t.id))},clients:g})]})}export{c as default};
