import{j as e}from"./pdf-vendor-CqWdlgKa.js";import{c as t,r as s}from"./zustand-vendor-BohoUguQ.js";import{ah as a,D as n,E as r,g as i,J as l,ai as o,b as c}from"./index-Civi5K2Q.js";import{u as d,E as x,a as m}from"./timelineStore-Bgp0upDS.js";import"./react-vendor-DRPWudcR.js";import"./supabase-vendor-DWEVVlJw.js";const u={FOOTBALL:"Football",FUTSAL:"Futsal",HANDBALL:"Handball",VOLLEYBALL:"Volleyball",BASKETBALL:"Basketball",CYCLING:"Cycling"},p={[u.FOOTBALL]:{icon:"âš½",color:"bg-green-500/20 text-green-400 border-green-500/30"},[u.FUTSAL]:{icon:"ðŸ¥…",color:"bg-blue-500/20 text-blue-400 border-blue-500/30"},[u.HANDBALL]:{icon:"ðŸ¤¾",color:"bg-orange-500/20 text-orange-400 border-orange-500/30"},[u.VOLLEYBALL]:{icon:"ðŸ",color:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30"},[u.BASKETBALL]:{icon:"ðŸ€",color:"bg-red-500/20 text-red-400 border-red-500/30"},[u.CYCLING]:{icon:"ðŸš´",color:"bg-purple-500/20 text-purple-400 border-purple-500/30"}},h={SEA:["Malaysia","Singapore","Indonesia","Thailand","Vietnam","Philippines","Myanmar","Cambodia","Laos","Brunei"],GCC:["Saudi Arabia","UAE","Qatar","Kuwait","Bahrain","Oman"],Levant:["Jordan","Lebanon","Iraq","Syria"],"Central Asia":["Kazakhstan","Uzbekistan","Turkmenistan","Tajikistan","Kyrgyzstan","Afghanistan"]},g="**Sports Event Research Assistant**\n\nYou are a market research assistant for a sports production company specialising in broadcast graphics and stadium visuals.\n\n**Your task:** Identify upcoming sporting events that represent production opportunities.\n\n**Geographic scope:**\n- GCC (UAE, Saudi, Kuwait, Qatar, Bahrain, Oman)\n- Levant (Jordan, Lebanon, Iraq, Syria)\n- Central Asia (Kazakhstan, Uzbekistan, Kyrgyzstan, Tajikistan, Turkmenistan, Afghanistan)\n- Southeast Asia (Malaysia, Thailand, Indonesia, Singapore, Vietnam, Philippines, Cambodia, Laos, Brunei)\n\n**Sports:** Football, Volleyball, Basketball, Futsal, Handball, Cycling\n\n**Event types to find:**\n- Multi-sport events (Asian Games, SEA Games, Islamic Solidarity Games, GCC Games, etc.)\n- International tournaments and championships\n- Federation-organised tournaments (AFC, AFF, AVC, FIBA Asia, etc.)\n- Regional tournaments and cups\n- Youth tournaments (U17, U19, U21, U23)\n- Cup finals\n- Exhibition matches and friendlies\n- New/inaugural events\n\n**Exclude:** Regular domestic league fixtures\n\n**For each event, provide:**\n- Event name and dates\n- Host city/venue\n- Organising body/federation\n- Key decision makers (names, titles, contact details where available)\n- Current production partner (if known)\n- Opportunity assessment\n\n**Reference sources:**\n- Our existing quotes and opportunities data\n- Federation websites and announcements\n- Sports news and calendars\n- Your own market analysis\n\nPresent findings in a table format, prioritised by date and opportunity size.",v=[{sport:u.FOOTBALL,event_name:"FIFA Club World Cup 2025",organization:"FIFA",country:"USA",region:"Other",event_type:"tournament",tier:"international",start_date:"2025-06-15",end_date:"2025-07-13",venue:"Multiple US cities",notes:"New expanded 32-team format. Asian clubs participating."},{sport:u.FOOTBALL,event_name:"SEA Games 2025",organization:"SEAGF",country:"Thailand",region:"SEA",event_type:"multi-sport",tier:"international",start_date:"2025-12-09",end_date:"2025-12-20",venue:"Bangkok, Chonburi",notes:"33rd SEA Games. Football, volleyball, basketball, futsal, handball."},{sport:u.FOOTBALL,event_name:"AFC U-23 Asian Cup 2026",organization:"AFC",country:"Saudi Arabia",region:"GCC",event_type:"tournament",tier:"international",start_date:"2026-01-07",end_date:"2026-01-25",venue:"Jeddah",notes:"Olympic qualifier pathway"},{sport:u.HANDBALL,event_name:"Asian Men's Handball Championship 2026",organization:"Asian Handball Federation",country:"Kuwait",region:"GCC",event_type:"tournament",tier:"international",start_date:"2026-01-15",end_date:"2026-01-29",venue:"Sabah Al-Salem, Kuwait",notes:"Qualifies top 4 for 2027 World Championship"},{sport:u.FUTSAL,event_name:"AFC Futsal Asian Cup 2026",organization:"AFC",country:"Indonesia",region:"SEA",event_type:"tournament",tier:"international",start_date:"2026-01-27",end_date:"2026-02-08",venue:"TBD Indonesia",notes:"Indonesia hosting for 2nd time"},{sport:u.BASKETBALL,event_name:"FIBA 3x3 Asia Cup 2026",organization:"FIBA",country:"Singapore",region:"SEA",event_type:"tournament",tier:"international",start_date:"2026-04-01",end_date:"2026-04-05",venue:"Singapore Sports Hub",notes:"Part of 3 FIBA events in Singapore 2026-27"},{sport:u.FOOTBALL,event_name:"ASEAN Hyundai Cup 2026",organization:"ASEAN Football Federation",country:"Regional",region:"SEA",event_type:"tournament",tier:"international",start_date:"2026-07-24",end_date:"2026-08-26",venue:"Multiple venues across ASEAN",notes:"30th Anniversary edition. Draw: Jan 15, 2026 Jakarta."},{sport:u.FOOTBALL,event_name:"Asian Games 2026",organization:"OCA",country:"Japan",region:"Other",event_type:"multi-sport",tier:"international",start_date:"2026-09-19",end_date:"2026-10-04",venue:"Aichi-Nagoya",notes:"41 sports, 53 venues. Football, basketball, handball, volleyball included."},{sport:u.FOOTBALL,event_name:"AFC Asian Cup 2027",organization:"AFC",country:"Saudi Arabia",region:"GCC",event_type:"tournament",tier:"international",start_date:"2027-01-01",end_date:"2027-02-01",venue:"Multiple venues Saudi Arabia",notes:"First time Saudi hosts. 24 teams. Major opportunity."},{sport:u.BASKETBALL,event_name:"FIBA Asia Cup 2027",organization:"FIBA",country:"Qatar",region:"GCC",event_type:"tournament",tier:"international",start_date:"2027-08-01",end_date:"2027-08-15",venue:"Doha",notes:"Top Asian basketball championship"}];function j(e){return{id:e.id,sport:e.sport,eventName:e.event_name,organization:e.organization,country:e.country,region:e.region,startDate:e.start_date,endDate:e.end_date,venue:e.venue,eventType:e.event_type,tier:e.tier,broadcastStatus:e.broadcast_status,estimatedValue:e.estimated_value,currency:e.currency||"USD",sourceUrl:e.source_url,notes:e.notes,contacts:e.contacts||[],convertedToOpportunityId:e.converted_to_opportunity_id,researchStatus:e.research_status,discoveredAt:e.discovered_at,updatedAt:e.updated_at}}function b(e){return{sport:e.sport,event_name:e.eventName||e.event_name,organization:e.organization,country:e.country,region:e.region,start_date:e.startDate||e.start_date||null,end_date:e.endDate||e.end_date||null,venue:e.venue,event_type:e.eventType||e.event_type,tier:e.tier,broadcast_status:e.broadcastStatus||e.broadcast_status,estimated_value:e.estimatedValue||e.estimated_value||null,currency:e.currency||"USD",source_url:e.sourceUrl||e.source_url,notes:e.notes,contacts:e.contacts||[],converted_to_opportunity_id:e.convertedToOpportunityId||null,research_status:e.researchStatus||e.research_status||"new"}}const y=t(a((e,t)=>({events:[],loading:!1,error:null,lastResearchDate:null,initialize:async()=>{if(n()){e({loading:!0,error:null});try{const{data:s,error:a}=await r.from("sports_events").select("*").order("start_date",{ascending:!0});if(a)throw a;s&&s.length>0?e({events:s.map(j),loading:!1}):await t().seedKeyEvents()}catch(s){e({loading:!1,error:s.message})}}else e({loading:!1,error:"Supabase not configured"})},seedKeyEvents:async()=>{if(n())try{const t=v.map(e=>b(e)),{data:s,error:a}=await r.from("sports_events").insert(t).select();if(a)throw a;e({events:s?s.map(j):[],loading:!1,lastResearchDate:(new Date).toISOString()})}catch(t){e({loading:!1,error:t.message})}},addEvent:async t=>{if(!n())return null;try{const{data:s,error:a}=await r.from("sports_events").insert(b(t)).select().single();if(a)throw a;const n=j(s);return e(e=>({events:[n,...e.events]})),n}catch(s){return null}},updateEvent:async(t,s)=>{if(n())try{const{error:a}=await r.from("sports_events").update({...b(s),updated_at:(new Date).toISOString()}).eq("id",t);if(a)throw a;e(e=>({events:e.events.map(e=>e.id===t?{...e,...s}:e)}))}catch(a){}},updateEventStatus:async(t,s)=>{if(n())try{const{error:a}=await r.from("sports_events").update({research_status:s,updated_at:(new Date).toISOString()}).eq("id",t);if(a)throw a;e(e=>({events:e.events.map(e=>e.id===t?{...e,researchStatus:s}:e)}))}catch(a){}},convertToOpportunity:async(t,s)=>{if(n())try{const{error:a}=await r.from("sports_events").update({research_status:"converted",converted_to_opportunity_id:s,updated_at:(new Date).toISOString()}).eq("id",t);if(a)throw a;e(e=>({events:e.events.map(e=>e.id===t?{...e,researchStatus:"converted",convertedToOpportunityId:s}:e)}))}catch(a){}},getUpcomingEvents:()=>{const e=t().events,s=new Date,a=new Date;return a.setFullYear(a.getFullYear()+2),e.filter(e=>{if(!e.startDate)return!0;const t=new Date(e.startDate);return t>=s&&t<=a}).sort((e,t)=>e.startDate?t.startDate?new Date(e.startDate)-new Date(t.startDate):-1:1)},getEventsByCountry:()=>{const e=t().getUpcomingEvents(),s={};return e.forEach(e=>{const t=e.country||"Unknown";s[t]||(s[t]=[]),s[t].push(e)}),s},getEventsBySport:()=>{const e=t().getUpcomingEvents(),s={};return e.forEach(e=>{const t=e.sport||"Unknown";s[t]||(s[t]=[]),s[t].push(e)}),s},getEventsByRegion:()=>{const e=t().getUpcomingEvents(),s={};return e.forEach(e=>{const t=e.region||"Other";s[t]||(s[t]=[]),s[t].push(e)}),s},getEventsByStatus:e=>t().events.filter(t=>t.researchStatus===e),getNewEvents:()=>t().events.filter(e=>"new"===e.researchStatus),getStats:()=>{const e=t().events,s=t().getUpcomingEvents(),a={},n={},r={};return e.forEach(e=>{a[e.sport]=(a[e.sport]||0)+1,n[e.region]=(n[e.region]||0)+1,r[e.researchStatus]=(r[e.researchStatus]||0)+1}),{total:e.length,upcoming:s.length,new:r.new||0,reviewed:r.reviewed||0,converted:r.converted||0,dismissed:r.dismissed||0,bySport:a,byRegion:n}},dismissEvent:async e=>{await t().updateEventStatus(e,"dismissed")},markReviewed:async e=>{await t().updateEventStatus(e,"reviewed")}})));function N({type:t}){const s=x[t]||x[m.RESEARCH_FINDING],a={search:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z","trending-up":"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6",users:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",lightbulb:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z",trophy:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z","x-circle":"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",send:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8","check-circle":"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z","book-open":"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253",brain:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z","message-circle":"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",cpu:"M9 3v2m6-2v2M9 19v2m6-2v2M3 9h2m-2 6h2m14-6h2m-2 6h2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"};return e.jsx("div",{className:`w-8 h-8 rounded-lg ${s.bgColor} flex items-center justify-center flex-shrink-0`,children:e.jsx("svg",{className:`w-4 h-4 ${s.color}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:a[s.icon]||a.search})})})}function f({event:t,onExpand:a,onConvert:n}){const r=x[t.type]||x[m.RESEARCH_FINDING],[i,l]=s.useState(!1),[o,c]=s.useState(!1),d=[m.RESEARCH_FINDING,m.MARKET_INTEL,m.COMPETITOR_UPDATE].includes(t.type),u=d&&!t.convertedToOpportunity&&!t.relatedOpportunityId,p=new Date(t.timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),h=new Date(t.timestamp).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"relative pl-10 pb-6 group",children:[e.jsx("div",{className:"absolute left-[15px] top-8 bottom-0 w-px bg-gray-700 group-last:hidden"}),e.jsx("div",{className:"absolute left-0 top-0",children:e.jsx(N,{type:t.type})}),e.jsxs("div",{className:`card ${r.bgColor} ${r.borderColor} border hover:border-white/20 transition-all cursor-pointer`,onClick:()=>l(!i),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("span",{className:`text-[10px] font-medium ${r.color} uppercase tracking-wide`,children:r.label}),t.verified&&e.jsx("span",{className:"text-[9px] bg-green-500/20 text-green-400 px-1.5 py-0.5 rounded",children:"Verified"}),t.agentName&&e.jsx("span",{className:"text-[9px] bg-gray-700/50 text-gray-400 px-1.5 py-0.5 rounded",children:t.agentName})]}),e.jsx("h4",{className:"text-sm font-medium text-gray-200 truncate",children:t.title})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-gray-500",children:p}),e.jsx("p",{className:"text-[10px] text-gray-600",children:h})]})]}),t.description&&e.jsx("p",{className:"text-xs text-gray-400 "+(i?"":"line-clamp-2"),children:t.description}),t.tags&&t.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[t.tags.slice(0,i?void 0:3).map((t,s)=>e.jsx("span",{className:"text-[10px] bg-gray-800/50 text-gray-400 px-1.5 py-0.5 rounded",children:t},s)),!i&&t.tags.length>3&&e.jsxs("span",{className:"text-[10px] text-gray-500",children:["+",t.tags.length-3," more"]})]}),i&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-700/50 space-y-2",children:[void 0!==t.confidence&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Confidence"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-20 h-1.5 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-amber-500 to-green-500 rounded-full",style:{width:100*(t.confidence||0)+"%"}})}),e.jsxs("span",{className:"text-gray-400",children:[(100*(t.confidence||0)).toFixed(0),"%"]})]})]}),void 0!==t.relevanceScore&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Relevance"}),e.jsxs("span",{className:"text-gray-400",children:[(100*(t.relevanceScore||0)).toFixed(0),"%"]})]}),t.region&&e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Region"}),e.jsx("span",{className:"text-gray-400",children:t.region})]}),t.sourceUrls&&t.sourceUrls.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Sources"}),t.sourceUrls.map((t,s)=>e.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"block text-xs text-blue-400 hover:text-blue-300 truncate",onClick:e=>e.stopPropagation(),children:t},s))]}),t.metadata?.recommendedAction&&e.jsxs("div",{className:"mt-2 p-2 bg-violet-500/10 rounded-lg",children:[e.jsx("p",{className:"text-[10px] text-violet-400 uppercase tracking-wide mb-1",children:"Recommended Action"}),e.jsx("p",{className:"text-xs text-gray-300",children:t.metadata.recommendedAction})]}),u&&e.jsx("button",{onClick:async e=>{if(e.stopPropagation(),u&&!o){c(!0);try{await n(t)}finally{c(!1)}}},disabled:o,className:"mt-3 w-full py-2 bg-green-500/20 hover:bg-green-500/30 border border-green-500/30 rounded-lg text-green-400 text-sm font-medium flex items-center justify-center gap-2 transition-colors disabled:opacity-50",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-green-400/30 border-t-green-400 rounded-full animate-spin"}),"Converting..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),"Convert to Opportunity"]})}),(t.convertedToOpportunity||t.relatedOpportunityId)&&d&&e.jsxs("div",{className:"mt-3 py-2 bg-gray-700/50 rounded-lg text-gray-400 text-sm text-center flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Converted to Opportunity"]})]}),e.jsx("div",{className:"flex justify-center mt-2",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500 transition-transform "+(i?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})}function w({onClose:t,onSubmit:a}){const[n,r]=s.useState({title:"",description:"",organization:"",country:"",region:"",opportunityType:"streaming",urgency:5,budgetRange:"",recommendedAction:"",sourceUrls:"",tags:""});return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black/75 backdrop-blur-md p-4",children:e.jsxs("div",{className:"bg-[#1a1f2e] border border-dark-border rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-dark-card border-b border-dark-border p-4 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Add Research Finding"}),e.jsx("button",{onClick:t,className:"p-2 text-gray-400 hover:text-white",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),await a({...n,type:"research_findings",sourceUrls:n.sourceUrls.split("\n").filter(Boolean),tags:n.tags.split(",").map(e=>e.trim()).filter(Boolean)}),t()},className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label label-required",children:"Title"}),e.jsx("input",{type:"text",value:n.title,onChange:e=>r({...n,title:e.target.value}),className:"input",placeholder:"e.g., Thai League Broadcast Tender",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label label-required",children:"Description"}),e.jsx("textarea",{value:n.description,onChange:e=>r({...n,description:e.target.value}),className:"input resize-none",rows:3,placeholder:"Detailed description of the finding...",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Organization"}),e.jsx("input",{type:"text",value:n.organization,onChange:e=>r({...n,organization:e.target.value}),className:"input",placeholder:"e.g., Thai Football League"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Country"}),e.jsx("input",{type:"text",value:n.country,onChange:e=>r({...n,country:e.target.value}),className:"input",placeholder:"e.g., Thailand"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Region"}),e.jsxs("select",{value:n.region,onChange:e=>r({...n,region:e.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"Select region..."}),e.jsx("option",{value:"SEA",children:"SEA"}),e.jsx("option",{value:"GCC",children:"GCC"}),e.jsx("option",{value:"Central Asia",children:"Central Asia"}),e.jsx("option",{value:"Europe",children:"Europe"}),e.jsx("option",{value:"Africa",children:"Africa"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Opportunity Type"}),e.jsxs("select",{value:n.opportunityType,onChange:e=>r({...n,opportunityType:e.target.value}),className:"input",children:[e.jsx("option",{value:"streaming",children:"Streaming"}),e.jsx("option",{value:"production",children:"Production"}),e.jsx("option",{value:"consultancy",children:"Consultancy"}),e.jsx("option",{value:"broadcast",children:"Broadcast"}),e.jsx("option",{value:"graphics",children:"Graphics"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Urgency (1-10)"}),e.jsx("input",{type:"number",min:"1",max:"10",value:n.urgency,onChange:e=>r({...n,urgency:parseInt(e.target.value)}),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Budget Range"}),e.jsx("input",{type:"text",value:n.budgetRange,onChange:e=>r({...n,budgetRange:e.target.value}),className:"input",placeholder:"e.g., $50k-100k"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Recommended Action"}),e.jsx("textarea",{value:n.recommendedAction,onChange:e=>r({...n,recommendedAction:e.target.value}),className:"input resize-none",rows:2,placeholder:"What should we do with this information?"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Source URLs (one per line)"}),e.jsx("textarea",{value:n.sourceUrls,onChange:e=>r({...n,sourceUrls:e.target.value}),className:"input resize-none font-mono text-xs",rows:2,placeholder:"https://example.com/article"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tags (comma-separated)"}),e.jsx("input",{type:"text",value:n.tags,onChange:e=>r({...n,tags:e.target.value}),className:"input",placeholder:"e.g., thailand, football, streaming"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-dark-border",children:[e.jsx("button",{type:"button",onClick:t,className:"btn-ghost",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",children:"Add Finding"})]})]})]})})}function k({onNavigateToOpportunity:t}){const{events:a,loading:n,error:r,filters:l,setFilters:o,clearFilters:c,getFilteredEvents:m,getStats:u,addResearchFinding:p,prepareOpportunityFromEvent:h,markEventAsConverted:g}=d(),{addOpportunity:v}=i(),[j,b]=s.useState(!1),[y,N]=s.useState([]),[k,C]=s.useState(null),S=async e=>{try{const s=h(e),a=await v(s);a&&(await g(e.id,a.id),C({eventTitle:e.title,opportunityId:a.id,opportunityTitle:a.title}),setTimeout(()=>C(null),5e3),t&&t(a.id))}catch(s){}},A=s.useMemo(()=>m(),[a,l]),L=s.useMemo(()=>u(),[a]),E=s.useMemo(()=>{const e={};return A.forEach(t=>{const s=new Date(t.timestamp).toISOString().split("T")[0];e[s]||(e[s]=[]),e[s].push(t)}),e},[A]),_=Object.keys(E).sort((e,t)=>new Date(t)-new Date(e)),M=e=>{const t=new Date(e),s=new Date,a=new Date(s);return a.setDate(a.getDate()-1),e===s.toISOString().split("T")[0]?"Today":e===a.toISOString().split("T")[0]?"Yesterday":t.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})};return n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-400"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-100",children:"Research Timeline"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[L.total," events total, ",L.thisWeek," this week"]})]}),e.jsxs("button",{onClick:()=>b(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Finding"]})]}),e.jsxs("div",{className:"card bg-dark-card p-4 space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",value:l.searchQuery,onChange:e=>{o({searchQuery:e.target.value})},className:"input pl-10",placeholder:"Search events..."})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Object.entries(x).slice(0,6).map(([t,s])=>e.jsx("button",{onClick:()=>(e=>{const t=y.includes(e)?y.filter(t=>t!==e):[...y,e];N(t),o({types:t})})(t),className:"text-xs px-2 py-1 rounded-lg border transition-colors "+(y.includes(t)?`${s.bgColor} ${s.borderColor} ${s.color}`:"bg-gray-800/50 border-gray-700 text-gray-400 hover:border-gray-600"),children:s.label},t)),y.length>0&&e.jsx("button",{onClick:()=>{N([]),c()},className:"text-xs px-2 py-1 text-gray-500 hover:text-gray-300",children:"Clear"})]})]}),r&&e.jsx("div",{className:"card bg-red-500/10 border-red-500/30 p-4 text-sm text-red-400",children:r}),k&&e.jsxs("div",{className:"card bg-green-500/10 border-green-500/30 p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-400 font-medium",children:"Opportunity Created"}),e.jsxs("p",{className:"text-xs text-gray-400",children:['"',k.eventTitle,'" converted to "',k.opportunityTitle,'"']})]})]}),e.jsx("button",{onClick:()=>C(null),className:"text-gray-400 hover:text-white p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),0===_.length?e.jsxs("div",{className:"card bg-dark-card text-center py-12",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("h3",{className:"text-gray-400 font-medium mb-2",children:"No Research Events Yet"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Start adding research findings to build your intelligence timeline"}),e.jsx("button",{onClick:()=>b(!0),className:"btn-primary",children:"Add First Finding"})]}):e.jsx("div",{className:"space-y-6",children:_.map(t=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400",children:M(t)}),e.jsx("div",{className:"flex-1 h-px bg-gray-800"}),e.jsxs("span",{className:"text-xs text-gray-600",children:[E[t].length," events"]})]}),e.jsx("div",{className:"space-y-0",children:E[t].map(t=>e.jsx(f,{event:t,onConvert:S},t.id))})]},t))}),j&&e.jsx(w,{onClose:()=>b(!1),onSubmit:p})]})}function C({tags:t,onChange:a,placeholder:n="Add tags..."}){const[r,i]=s.useState("");return e.jsxs("div",{className:"flex flex-wrap gap-1.5 p-2 bg-dark-card border border-dark-border rounded-lg min-h-[44px]",children:[t.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-brand-teal/20 text-brand-teal text-xs rounded",children:[s,e.jsx("button",{onClick:()=>{return e=s,void a(t.filter(t=>t!==e));var e},className:"hover:text-white",children:"Ã—"})]},s)),e.jsx("input",{type:"text",value:r,onChange:e=>i(e.target.value),onKeyDown:e=>{if("Enter"===e.key||","===e.key){e.preventDefault();const s=r.trim().toLowerCase();s&&!t.includes(s)&&a([...t,s]),i("")}else"Backspace"===e.key&&!r&&t.length>0&&a(t.slice(0,-1))},placeholder:0===t.length?n:"",className:"flex-1 min-w-[100px] bg-transparent border-none outline-none text-sm text-gray-100 placeholder-gray-500"})]})}function S({onAdd:t}){const[a,n]=s.useState(""),[r,i]=s.useState(o.MARKET_INSIGHT),[l,c]=s.useState([]),[d,x]=s.useState(""),[m,u]=s.useState(!1);return e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-300 mb-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-brand-teal",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Quick Knowledge Capture"]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),a.trim()&&(await t({type:r,content:a.trim(),tags:l,region:d||null,source:"human_input",verified:!0}),n(""),c([]),x(""),u(!1))},className:"space-y-3",children:[e.jsx("textarea",{value:a,onChange:e=>n(e.target.value),onFocus:()=>u(!0),placeholder:"Just learned: Thai clubs prefer monthly payments over lump sum...",className:"input text-sm min-h-[80px] resize-none",rows:m?4:2}),m&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs",children:"Type"}),e.jsxs("select",{value:r,onChange:e=>i(e.target.value),className:"input-sm w-full",children:[e.jsx("option",{value:o.MARKET_INSIGHT,children:"Market Insight"}),e.jsx("option",{value:o.PRICING_STRATEGY,children:"Pricing Strategy"}),e.jsx("option",{value:o.CLIENT_PREFERENCE,children:"Client Preference"}),e.jsx("option",{value:o.COMPETITOR_INTEL,children:"Competitor Intel"}),e.jsx("option",{value:o.PROCESS_TIP,children:"Process Tip"}),e.jsx("option",{value:o.REGIONAL_PATTERN,children:"Regional Pattern"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs",children:"Region (optional)"}),e.jsxs("select",{value:d,onChange:e=>x(e.target.value),className:"input-sm w-full",children:[e.jsx("option",{value:"",children:"All Regions"}),e.jsx("option",{value:"GCC",children:"GCC"}),e.jsx("option",{value:"Central Asia",children:"Central Asia"}),e.jsx("option",{value:"SEA",children:"SEA"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs",children:"Tags"}),e.jsx(C,{tags:l,onChange:c,placeholder:"thailand, streaming, clubs..."})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{u(!1),n(""),c([])},className:"btn-ghost btn-sm",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!a.trim(),className:"btn-primary btn-sm",children:"Add Knowledge"})]})]})]})]})}function A({item:t,type:s,onVerify:a,onReject:n}){const r="fragment"===s;return e.jsx("div",{className:"p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 rounded "+(r?"bg-blue-500/20 text-blue-400":"bg-purple-500/20 text-purple-400"),children:r?t.type.replace("_"," "):t.learningType}),t.region&&e.jsx("span",{className:"text-xs text-gray-500",children:t.region})]}),e.jsx("p",{className:"text-sm text-gray-200",children:r?t.content:t.lesson}),!r&&t.context&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Context: ",JSON.stringify(t.context).slice(0,100),"..."]}),t.tags&&t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:t.tags.map(t=>e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-gray-700 text-gray-400 rounded",children:t},t))})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>a(t.id),className:"p-1.5 rounded hover:bg-green-500/20 text-green-400 transition-colors",title:"Verify",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("button",{onClick:()=>n(t.id),className:"p-1.5 rounded hover:bg-red-500/20 text-red-400 transition-colors",title:"Reject",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})})}function L({fragment:t,onEdit:a,onDelete:n}){const[r,i]=s.useState(!1),[l,c]=s.useState(t.content),d={[o.MARKET_INSIGHT]:"bg-blue-500/20 text-blue-400 border-blue-500/30",[o.PRICING_STRATEGY]:"bg-green-500/20 text-green-400 border-green-500/30",[o.CLIENT_PREFERENCE]:"bg-purple-500/20 text-purple-400 border-purple-500/30",[o.COMPETITOR_INTEL]:"bg-red-500/20 text-red-400 border-red-500/30",[o.PROCESS_TIP]:"bg-amber-500/20 text-amber-400 border-amber-500/30",[o.REGIONAL_PATTERN]:"bg-cyan-500/20 text-cyan-400 border-cyan-500/30"};return e.jsxs("div",{className:"card hover:border-gray-700 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded border ${d[t.type]||"bg-gray-500/20 text-gray-400 border-gray-500/30"}`,children:t.type.replace("_"," ")}),t.region&&e.jsx("span",{className:"text-xs text-gray-500",children:t.region}),t.verified&&e.jsxs("span",{className:"text-xs text-green-400 flex items-center gap-0.5",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Verified"]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>i(!r),className:"p-1 text-gray-500 hover:text-gray-300",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>n(t.id),className:"p-1 text-gray-500 hover:text-red-400",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),r?e.jsxs("div",{className:"space-y-2",children:[e.jsx("textarea",{value:l,onChange:e=>c(e.target.value),className:"input text-sm min-h-[60px] resize-none"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>i(!1),className:"btn-ghost btn-sm",children:"Cancel"}),e.jsx("button",{onClick:()=>{a(t.id,{content:l}),i(!1)},className:"btn-primary btn-sm",children:"Save"})]})]}):e.jsx("p",{className:"text-sm text-gray-300",children:t.content}),t.tags&&t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-3",children:t.tags.map(t=>e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-gray-700/50 text-gray-400 rounded",children:t},t))}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-dark-border text-xs text-gray-500",children:[e.jsxs("span",{children:["Confidence: ",(100*t.confidence).toFixed(0),"%"]}),e.jsxs("span",{children:["Impact: ",t.impactScore?.toFixed(2)||"0.00"]}),e.jsxs("span",{children:["Used: ",t.usageCount||0,"x"]})]})]})}function E({stats:t}){return e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-brand-teal",children:t.verifiedFragments}),e.jsx("div",{className:"text-xs text-gray-500",children:"Verified Knowledge"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-400",children:t.pendingVerification}),e.jsx("div",{className:"text-xs text-gray-500",children:"Pending Review"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400",children:t.verifiedLearnings}),e.jsx("div",{className:"text-xs text-gray-500",children:"Deal Learnings"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[(100*t.avgConfidence).toFixed(0),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Avg Confidence"})]})]})}function _({event:t,onMarkReviewed:s,onDismiss:a,onConvert:n}){const r=p[t.sport]||{icon:"ðŸ†",color:"bg-gray-500/20 text-gray-400 border-gray-500/30"},i="converted"===t.researchStatus,l="dismissed"===t.researchStatus;return e.jsxs("div",{className:"card hover:border-gray-700 transition-colors "+(l?"opacity-50":""),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-lg",children:r.icon}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded border ${r.color}`,children:t.sport}),t.tier&&e.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-700/50 text-gray-400",children:t.tier}),t.eventType&&e.jsx("span",{className:"text-xs text-gray-500",children:t.eventType})]}),e.jsx("div",{className:"flex gap-1",children:!i&&!l&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>s(t.id),className:"p-1.5 text-gray-500 hover:text-blue-400 transition-colors",title:"Mark as Reviewed",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("button",{onClick:()=>a(t.id),className:"p-1.5 text-gray-500 hover:text-red-400 transition-colors",title:"Dismiss",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]}),e.jsx("h3",{className:"text-sm font-medium text-gray-200 mb-1",children:t.eventName}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-500 mb-2",children:[t.organization&&e.jsx("span",{children:t.organization}),t.country&&e.jsxs("span",{children:["â€¢ ",t.country]}),t.region&&e.jsxs("span",{children:["â€¢ ",t.region]})]}),(t.startDate||t.venue)&&e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-500 mb-2",children:[t.startDate&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.startDate,t.endDate&&` - ${t.endDate}`]}),t.venue&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"})}),t.venue]})]}),t.notes&&e.jsx("p",{className:"text-xs text-gray-400 mb-2",children:t.notes}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-dark-border",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 rounded "+(i?"bg-green-500/20 text-green-400":l?"bg-gray-500/20 text-gray-500":"reviewed"===t.researchStatus?"bg-blue-500/20 text-blue-400":"bg-amber-500/20 text-amber-400"),children:"new"===t.researchStatus?"New":"reviewed"===t.researchStatus?"Reviewed":"converted"===t.researchStatus?"Converted":"Dismissed"}),!i&&!l&&e.jsxs("button",{onClick:()=>n(t),className:"btn-primary btn-sm flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),"Convert to Opportunity"]})]})]})}function M(){const{events:t,loading:a,error:n,initialize:r,markReviewed:l,dismissEvent:o,convertToOpportunity:d,getStats:x,getUpcomingEvents:m,getEventsByCountry:v,getEventsBySport:j,getEventsByRegion:b,updateEvent:N}=y(),{addOpportunity:f}=i(),w=c(e=>e.getOkrsForPrompt),[k,C]=s.useState("all"),[S,A]=s.useState("all"),[L,E]=s.useState("all"),[M,T]=s.useState("date"),[O,F]=s.useState(!1),[R,B]=s.useState(null),[D,z]=s.useState(null),[I,U]=s.useState("");s.useEffect(()=>{r()},[r]);const G=s.useMemo(()=>x(),[t]),P=s.useMemo(()=>m(),[t]),W=s.useMemo(()=>P.filter(e=>("all"===k||e.sport===k)&&(("all"===S||e.region===S)&&("all"===L||e.researchStatus===L))),[P,k,S,L]),H=s.useMemo(()=>{if("date"===M){const e={};return W.forEach(t=>{const s=t.startDate?t.startDate.substring(0,7):"No Date";e[s]||(e[s]=[]),e[s].push(t)}),Object.entries(e).sort(([e],[t])=>e.localeCompare(t))}if("country"===M){const e={};return W.forEach(t=>{const s=t.country||"Unknown";e[s]||(e[s]=[]),e[s].push(t)}),Object.entries(e).sort(([e],[t])=>e.localeCompare(t))}if("sport"===M){const e={};return W.forEach(t=>{const s=t.sport||"Unknown";e[s]||(e[s]=[]),e[s].push(t)}),Object.entries(e).sort(([e],[t])=>e.localeCompare(t))}if("region"===M){const e={};return W.forEach(t=>{const s=t.region||"Other";e[s]||(e[s]=[]),e[s].push(t)}),Object.entries(e).sort(([e],[t])=>e.localeCompare(t))}return[["All",W]]},[W,M]),V=async e=>{const t={title:e.eventName,country:"Regional"===e.country?"":e.country,region:e.region,source:`Sports Research: ${e.sport}`,brief:`${e.eventType||"Event"} - ${e.organization||"Unknown organization"}`,notes:[e.notes,e.venue?`Venue: ${e.venue}`:null,e.startDate?`Dates: ${e.startDate}${e.endDate?` - ${e.endDate}`:""}`:null,e.broadcastStatus?`Broadcast: ${e.broadcastStatus}`:null].filter(Boolean).join("\n"),value:e.estimatedValue||0,currency:e.currency||"USD",stage:"lead",status:"active"},s=await f(t);s&&(await d(e.id,s.id),B({eventName:e.eventName,oppId:s.id}),setTimeout(()=>B(null),3e3))},K=e=>{if("No Date"===e)return e;const[t,s]=e.split("-");return`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][parseInt(s)-1]} ${t}`};return a?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"text-gray-400",children:"Loading sports events..."})}):n?e.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:[e.jsx("p",{className:"text-sm text-red-400",children:n}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Run ",e.jsx("code",{className:"bg-gray-800 px-1 rounded",children:"supabase-complete-setup.sql"})," in Supabase SQL editor to create required tables."]})]}):e.jsxs("div",{children:[R&&e.jsx("div",{className:"fixed bottom-4 right-4 z-50 bg-green-500/20 border border-green-500/30 rounded-lg p-4 shadow-lg animate-fade-in",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-400 font-medium",children:"Converted to Opportunity"}),e.jsx("p",{className:"text-xs text-gray-400",children:R.eventName})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>F(!O),className:"flex items-center gap-2 text-sm text-gray-400 hover:text-gray-200 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 transition-transform "+(O?"rotate-90":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),"Research Prompt (for AI Assistant)"]}),O&&e.jsxs("div",{className:"mt-3 p-4 bg-dark-card border border-dark-border rounded-lg",children:[w()&&e.jsxs("div",{className:"mb-4 p-3 bg-accent-primary/10 border border-accent-primary/30 rounded-lg",children:[e.jsx("h4",{className:"text-xs font-semibold text-accent-primary mb-2",children:"Company OKRs (Prioritize events aligned with these goals):"}),e.jsx("pre",{className:"text-xs text-gray-300 whitespace-pre-wrap font-mono",children:w()})]}),e.jsx("pre",{className:"text-xs text-gray-400 whitespace-pre-wrap font-mono overflow-x-auto",children:g}),e.jsxs("button",{onClick:()=>{const e=w()?`## Company OKRs (Prioritize events aligned with these goals):\n${w()}\n\n`:"";navigator.clipboard.writeText(e+g)},className:"mt-3 btn-ghost btn-sm flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy Full Prompt (with OKRs)"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-3 mb-6",children:[e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-brand-teal",children:P.length}),e.jsx("div",{className:"text-xs text-gray-500",children:"Upcoming (1-2yr)"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-400",children:G.new}),e.jsx("div",{className:"text-xs text-gray-500",children:"New"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:G.reviewed}),e.jsx("div",{className:"text-xs text-gray-500",children:"Reviewed"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:G.converted}),e.jsx("div",{className:"text-xs text-gray-500",children:"Converted"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-500",children:G.dismissed}),e.jsx("div",{className:"text-xs text-gray-500",children:"Dismissed"})]})]}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2 mb-6",children:Object.entries(u).map(([t,s])=>{const a=p[s],n=G.bySport[s]||0;return e.jsxs("button",{onClick:()=>C(k===s?"all":s),className:"card text-center py-3 transition-all cursor-pointer "+(k===s?"ring-2 ring-brand-teal":"hover:border-gray-600"),children:[e.jsx("div",{className:"text-2xl mb-1",children:a.icon}),e.jsx("div",{className:"text-xs text-gray-400",children:s}),e.jsx("div",{className:"text-sm font-bold text-gray-200",children:n})]},t)})}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-dark-card border border-dark-border rounded-lg p-1",children:[e.jsx("span",{className:"text-xs text-gray-500 px-2",children:"Group by:"}),["date","country","sport","region"].map(t=>e.jsx("button",{onClick:()=>T(t),className:"px-3 py-1 rounded text-xs font-medium transition-colors "+(M===t?"bg-brand-teal/20 text-brand-teal":"text-gray-400 hover:text-gray-200"),children:t.charAt(0).toUpperCase()+t.slice(1)},t))]}),e.jsxs("select",{value:S,onChange:e=>A(e.target.value),className:"input-sm",children:[e.jsx("option",{value:"all",children:"All Regions"}),Object.keys(h).map(t=>e.jsx("option",{value:t,children:t},t)),e.jsx("option",{value:"Other",children:"Other"})]}),e.jsxs("select",{value:L,onChange:e=>E(e.target.value),className:"input-sm",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"reviewed",children:"Reviewed"}),e.jsx("option",{value:"converted",children:"Converted"}),e.jsx("option",{value:"dismissed",children:"Dismissed"})]}),("all"!==k||"all"!==S||"all"!==L)&&e.jsx("button",{onClick:()=>{C("all"),A("all"),E("all")},className:"btn-ghost btn-sm",children:"Clear Filters"})]}),0===W.length?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"No upcoming events found"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Adjust filters or add new events from research."})]}):e.jsx("div",{className:"space-y-6",children:H.map(([s,a])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300",children:"date"===M?K(s):s}),e.jsxs("span",{className:"text-xs px-2 py-0.5 bg-gray-700 text-gray-400 rounded",children:[a.length," event",1!==a.length?"s":""]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:a.map(s=>e.jsxs("div",{children:[e.jsx(_,{event:s,onMarkReviewed:l,onDismiss:o,onConvert:V}),e.jsx("div",{className:"mt-2 ml-4",children:D===s.id?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:I,onChange:e=>U(e.target.value),placeholder:"Add a comment...",className:"input-sm flex-1",autoFocus:!0}),e.jsx("button",{onClick:()=>(async e=>{if(!I.trim())return;const s=t.find(t=>t.id===e),a=s?.notes||"",n=a?`${a}\n\n[${(new Date).toLocaleDateString()}] ${I}`:`[${(new Date).toLocaleDateString()}] ${I}`;await N(e,{notes:n}),z(null),U("")})(s.id),className:"btn-primary btn-sm",children:"Save"}),e.jsx("button",{onClick:()=>{z(null),U("")},className:"btn-ghost btn-sm",children:"Cancel"})]}):e.jsxs("button",{onClick:()=>z(s.id),className:"text-xs text-gray-500 hover:text-gray-300 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),"Add Comment"]})})]},s.id))})]},s))})]})}function T(){const{fragments:t,learnings:a,loading:n,error:r,initialize:i,addFragment:c,updateFragment:x,verifyFragment:m,deleteFragment:u,verifyLearning:p,getPendingReview:h,getStats:g}=l(),v=d(e=>e.initialize),[j,b]=s.useState("sports"),[y,N]=s.useState("all"),[f,w]=s.useState("all"),[C,_]=s.useState(""),[T,O]=s.useState(!1);s.useEffect(()=>{i(),v()},[i,v]);const F=s.useMemo(()=>g(),[t,a]),R=s.useMemo(()=>h(),[t,a]),B=s.useMemo(()=>t.filter(e=>{if("all"!==y&&e.type!==y)return!1;if("all"!==f&&e.region!==f)return!1;if(C){const t=C.toLowerCase(),s=e.content.toLowerCase().includes(t),a=e.tags.some(e=>e.toLowerCase().includes(t));if(!s&&!a)return!1}return!0}),[t,y,f,C]),D=async e=>{};return n?e.jsx("div",{className:"h-[calc(100vh-60px)] flex items-center justify-center",children:e.jsx("div",{className:"text-gray-400",children:"Loading knowledge base..."})}):e.jsxs("div",{className:"h-[calc(100vh-60px)] overflow-y-auto p-3 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl sm:text-2xl font-bold text-gray-100 flex items-center gap-2",children:[e.jsx("svg",{className:"w-6 h-6 text-brand-teal",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Research"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Sports events, market intelligence, and knowledge base"})]}),e.jsx("div",{className:"flex items-center gap-3",children:R.totalCount>0&&"knowledge"===j&&e.jsxs("button",{onClick:()=>O(!T),className:"btn-sm flex items-center gap-2 "+(T?"btn-primary":"bg-amber-500/20 border border-amber-500/30 text-amber-400 hover:bg-amber-500/30"),children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-amber-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-amber-400"})]}),R.totalCount," Pending Review"]})})]}),e.jsxs("div",{className:"flex gap-1 mb-6 bg-dark-card p-1 rounded-lg border border-dark-border w-fit",children:[e.jsx("button",{onClick:()=>b("knowledge"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors "+("knowledge"===j?"bg-brand-teal/20 text-brand-teal":"text-gray-400 hover:text-gray-200 hover:bg-white/5"),children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),"Knowledge"]})}),e.jsx("button",{onClick:()=>b("timeline"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors "+("timeline"===j?"bg-blue-500/20 text-blue-400":"text-gray-400 hover:text-gray-200 hover:bg-white/5"),children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Research Timeline"]})}),e.jsx("button",{onClick:()=>b("sports"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors "+("sports"===j?"bg-green-500/20 text-green-400":"text-gray-400 hover:text-gray-200 hover:bg-white/5"),children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:"âš½"}),"Sports Research"]})})]}),r&&e.jsx("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-sm text-red-400",children:r}),"timeline"===j&&e.jsx(k,{}),"sports"===j&&e.jsx(M,{}),"knowledge"===j&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6",children:e.jsx(E,{stats:F})}),T&&R.totalCount>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-200 mb-3",children:"Pending Review"}),e.jsxs("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:[R.fragments.map(t=>e.jsx(A,{item:t,type:"fragment",onVerify:m,onReject:u},t.id)),R.learnings.map(t=>e.jsx(A,{item:t,type:"learning",onVerify:p,onReject:D},t.id))]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx(S,{onAdd:c}),e.jsxs("div",{className:"card mt-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:"Knowledge by Type"}),e.jsxs("div",{className:"space-y-2",children:[Object.entries(F.byType).map(([t,s])=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400 capitalize",children:t.replace("_"," ")}),e.jsx("span",{className:"text-gray-300",children:s})]},t)),0===Object.keys(F.byType).length&&e.jsx("p",{className:"text-sm text-gray-500",children:"No knowledge yet"})]})]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx("input",{type:"text",value:C,onChange:e=>_(e.target.value),placeholder:"Search knowledge...",className:"input-sm w-full pl-9"}),e.jsx("svg",{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsxs("select",{value:y,onChange:e=>N(e.target.value),className:"input-sm",children:[e.jsx("option",{value:"all",children:"All Types"}),Object.entries(o).map(([t,s])=>e.jsx("option",{value:s,children:s.replace("_"," ")},t))]}),e.jsxs("select",{value:f,onChange:e=>w(e.target.value),className:"input-sm",children:[e.jsx("option",{value:"all",children:"All Regions"}),e.jsx("option",{value:"GCC",children:"GCC"}),e.jsx("option",{value:"Central Asia",children:"Central Asia"}),e.jsx("option",{value:"SEA",children:"SEA"})]})]}),e.jsx("div",{className:"space-y-3",children:0===B.length?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"No knowledge yet"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Start adding market insights, pricing strategies, and learnings."})]}):B.map(t=>e.jsx(L,{fragment:t,onEdit:x,onDelete:u},t.id))})]})]})]})]})}export{T as default};
