import{j as e}from"./pdf-vendor-CqWdlgKa.js";import{r as t}from"./zustand-vendor-BohoUguQ.js";import{M as n,a as o,u as r,P as s,l as i,h as c,L as u}from"./proxy-BCtTbg8K.js";function f(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function l(...e){return t.useCallback(function(...e){return t=>{let n=!1;const o=e.map(e=>{const o=f(e,t);return n||"function"!=typeof o||(n=!0),o});if(n)return()=>{for(let t=0;t<o.length;t++){const n=o[t];"function"==typeof n?n():f(e[t],null)}}}}(...e),e)}class a extends t.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=t.offsetParent,n=o(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=n-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function p({children:o,isPresent:r,anchorX:s,root:i}){const c=t.useId(),u=t.useRef(null),f=t.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:p}=t.useContext(n),h=l(u,o?.ref);return t.useInsertionEffect(()=>{const{width:e,height:t,top:n,left:o,right:l}=f.current;if(r||!u.current||!e||!t)return;const a="left"===s?`left: ${o}`:`right: ${l}`;u.current.dataset.motionPopId=c;const h=document.createElement("style");p&&(h.nonce=p);const d=i??document.head;return d.appendChild(h),h.sheet&&h.sheet.insertRule(`\n          [data-motion-pop-id="${c}"] {\n            position: absolute !important;\n            width: ${e}px !important;\n            height: ${t}px !important;\n            ${a}px !important;\n            top: ${n}px !important;\n          }\n        `),()=>{d.contains(h)&&d.removeChild(h)}},[r]),e.jsx(a,{isPresent:r,childRef:u,sizeRef:f,children:t.cloneElement(o,{ref:h})})}const h=({children:n,initial:o,isPresent:i,onExitComplete:c,custom:u,presenceAffectsLayout:f,mode:l,anchorX:a,root:h})=>{const m=r(d),g=t.useId();let x=!0,C=t.useMemo(()=>(x=!1,{id:g,initial:o,isPresent:i,custom:u,onExitComplete:e=>{m.set(e,!0);for(const t of m.values())if(!t)return;c&&c()},register:e=>(m.set(e,!1),()=>m.delete(e))}),[i,m,c]);return f&&x&&(C={...C}),t.useMemo(()=>{m.forEach((e,t)=>m.set(t,!1))},[i]),t.useEffect(()=>{!i&&!m.size&&c&&c()},[i]),"popLayout"===l&&(n=e.jsx(p,{isPresent:i,anchorX:a,root:h,children:n})),e.jsx(s.Provider,{value:C,children:n})};function d(){return new Map}const m=e=>e.key||"";function g(e){const n=[];return t.Children.forEach(e,e=>{t.isValidElement(e)&&n.push(e)}),n}const x=({children:n,custom:o,initial:s=!0,onExitComplete:f,presenceAffectsLayout:l=!0,mode:a="sync",propagate:p=!1,anchorX:d="left",root:x})=>{const[C,E]=i(p),P=t.useMemo(()=>g(n),[n]),y=p&&!C?[]:P.map(m),j=t.useRef(!0),R=t.useRef(P),v=r(()=>new Map),[w,$]=t.useState(P),[L,M]=t.useState(P);c(()=>{j.current=!1,R.current=P;for(let e=0;e<L.length;e++){const t=m(L[e]);y.includes(t)?v.delete(t):!0!==v.get(t)&&v.set(t,!1)}},[L,y.length,y.join("-")]);const X=[];if(P!==w){let e=[...P];for(let t=0;t<L.length;t++){const n=L[t],o=m(n);y.includes(o)||(e.splice(t,0,n),X.push(n))}return"wait"===a&&X.length&&(e=X),M(g(e)),$(P),null}const{forceRender:z}=t.useContext(u);return e.jsx(e.Fragment,{children:L.map(t=>{const n=m(t),r=!(p&&!C)&&(P===L||y.includes(n));return e.jsx(h,{isPresent:r,initial:!(j.current&&!s)&&void 0,custom:o,presenceAffectsLayout:l,mode:a,root:x,onExitComplete:r?void 0:()=>{if(!v.has(n))return;v.set(n,!0);let e=!0;v.forEach(t=>{t||(e=!1)}),e&&(z?.(),M(R.current),p&&E?.(),f&&f())},anchorX:d,children:t},n)})})};export{x as A};
