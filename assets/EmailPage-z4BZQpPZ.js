import{j as e}from"./pdf-vendor-CqWdlgKa.js";import{r as s}from"./zustand-vendor-BohoUguQ.js";import{o as t,ad as r,u as a,t as l,aJ as n,aK as i,V as d,a5 as c,a6 as o,X as x,aL as m}from"./index-qIMeUE46.js";import{u as h}from"./contactStore-DEZO6BUG.js";import{s as p}from"./sanitize-C9cT1rJa.js";import{S as b}from"./send-Bxr8AJn_.js";import{S as u,P as j}from"./star-BdVtf0ls.js";import{T as f}from"./trash-2-BNlxZ6R6.js";import{C as g}from"./chevron-down-CteB8HXA.js";import{S as y}from"./search-CRv8fqA0.js";import{F as N}from"./funnel-kthCF9PN.js";import{U as v}from"./user-DlDaO2rH.js";import{C as w}from"./chevron-left-CbNrflv1.js";import{L as k}from"./link-2-CvaEhdMA.js";import"./react-vendor-DRPWudcR.js";import"./supabase-vendor-DWEVVlJw.js";const C=t("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]),S=t("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),_=t("inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]),A=t("reply",[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]]),L=[{id:"INBOX",label:"Inbox",icon:_},{id:"SENT",label:"Sent",icon:b},{id:"STARRED",label:"Starred",icon:u},{id:"ARCHIVED",label:"Archived",icon:C},{id:"TRASH",label:"Trash",icon:f}];function T(){const{connections:t,activeConnection:o,activeProvider:x,isConnecting:m,connectionError:p,threads:b,selectedThread:u,messages:j,isLoading:f,isSyncing:v,syncProgress:w,currentFolder:k,searchQuery:C,filters:S,error:_,isComposing:A,composeDraft:T,initialize:H,connectGoogle:B,connectMicrosoft:R,disconnectAccount:D,setActiveConnection:O,loadThreads:U,selectThread:I,syncEmails:P,setFolder:V,setSearchQuery:G,setFilters:K,loadMore:Q,markThreadAsRead:X,starThread:$,archiveThread:J,trashThread:W,openCompose:Y,closeCompose:q,updateDraft:Z,sendEmail:ee,linkThreadToEntity:se}=r(),[te,re]=s.useState(!1),{clients:ae}=a(),{contacts:le}=h(),[ne,ie]=s.useState(!1),[de,ce]=s.useState(null);return s.useEffect(()=>{H();const e=new URLSearchParams(window.location.search);if("true"===e.get("microsoft_connected")&&(window.history.replaceState({},"",window.location.pathname),H()),"microsoft_oauth_failed"===e.get("error")){e.get("error_description");window.history.replaceState({},"",window.location.pathname)}},[]),o||m?e.jsxs("div",{className:"h-full flex",children:[e.jsxs("div",{className:"w-56 border-r border-dark-border flex flex-col",children:[e.jsx("div",{className:"p-3",children:e.jsxs("button",{onClick:()=>Y(),className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-brand-primary text-white rounded-lg hover:bg-brand-primary/90 transition-colors",children:[e.jsx(n,{className:"w-4 h-4"}),"Compose"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-2",children:L.map(s=>{const t=s.icon,r=k===s.id,a="INBOX"===s.id?b.filter(e=>e.unread_count>0).length:0;return e.jsxs("button",{onClick:()=>V(s.id),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-sm mb-1 transition-colors "+(r?"bg-brand-primary/10 text-brand-primary":"text-gray-400 hover:bg-dark-card hover:text-white"),children:[e.jsx(t,{className:"w-4 h-4"}),e.jsx("span",{className:"flex-1 text-left",children:s.label}),a>0&&e.jsx("span",{className:"text-xs bg-brand-primary/20 text-brand-primary px-1.5 py-0.5 rounded",children:a})]},s.id)})}),e.jsxs("div",{className:"p-3 border-t border-dark-border relative",children:[e.jsxs("button",{onClick:()=>re(!te),className:"w-full flex items-center gap-2 text-left hover:bg-dark-card p-2 rounded-lg -m-2 transition-colors",children:["microsoft"===x?e.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center bg-[#0078D4]/20",children:e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 21 21",children:[e.jsx("rect",{x:"1",y:"1",width:"9",height:"9",fill:"#f25022"}),e.jsx("rect",{x:"1",y:"11",width:"9",height:"9",fill:"#00a4ef"}),e.jsx("rect",{x:"11",y:"1",width:"9",height:"9",fill:"#7fba00"}),e.jsx("rect",{x:"11",y:"11",width:"9",height:"9",fill:"#ffb900"})]})}):e.jsx("div",{className:"w-6 h-6 rounded flex items-center justify-center bg-red-500/20",children:e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"}),e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"})]})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.jsx("span",{className:"text-xs text-gray-400 truncate",children:o?.email})]}),o?.last_sync_at&&e.jsxs("p",{className:"text-xs text-gray-600",children:["Synced ",i(o.last_sync_at)]})]}),e.jsx(g,{className:"w-4 h-4 text-gray-500 transition-transform "+(te?"rotate-180":"")})]}),te&&e.jsxs("div",{className:"absolute bottom-full left-0 right-0 mb-1 bg-dark-card border border-dark-border rounded-lg shadow-xl overflow-hidden z-50",children:[t.filter(e=>"active"===e.status).map(s=>e.jsxs("button",{onClick:()=>{O(s.id),re(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-left hover:bg-dark-border/50 transition-colors "+(o?.id===s.id?"bg-brand-primary/10":""),children:["microsoft"===s.provider?e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 21 21",children:[e.jsx("rect",{x:"1",y:"1",width:"9",height:"9",fill:"#f25022"}),e.jsx("rect",{x:"1",y:"11",width:"9",height:"9",fill:"#00a4ef"}),e.jsx("rect",{x:"11",y:"1",width:"9",height:"9",fill:"#7fba00"}),e.jsx("rect",{x:"11",y:"11",width:"9",height:"9",fill:"#ffb900"})]}):e.jsxs("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"}),e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"})]}),e.jsx("span",{className:"text-sm text-gray-300 truncate flex-1",children:s.email}),o?.id===s.id&&e.jsx(d,{className:"w-4 h-4 text-brand-primary"})]},s.id)),e.jsx("div",{className:"border-t border-dark-border"}),e.jsxs("button",{onClick:()=>{B(),re(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-left hover:bg-dark-border/50 transition-colors text-gray-400 hover:text-white",children:[e.jsx(n,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Add Gmail account"})]}),e.jsxs("button",{onClick:()=>{R(),re(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-left hover:bg-dark-border/50 transition-colors text-gray-400 hover:text-white",children:[e.jsx(n,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Add Outlook account"})]})]})]})]}),e.jsxs("div",{className:"w-96 border-r border-dark-border flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),e.jsx("input",{type:"text",placeholder:"Search emails...",value:C,onChange:e=>G(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-dark-card border border-dark-border rounded-lg text-sm text-white placeholder-gray-500 focus:outline-none focus:border-brand-primary"})]}),e.jsx("button",{onClick:P,disabled:v,className:"p-2 rounded-lg hover:bg-dark-card transition-colors "+(v?"animate-spin text-brand-primary":"text-gray-400"),title:"Sync emails",children:e.jsx(c,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>K({unreadOnly:!S.unreadOnly}),className:"p-2 rounded-lg hover:bg-dark-card transition-colors "+(S.unreadOnly?"text-brand-primary bg-brand-primary/10":"text-gray-400"),title:"Show unread only",children:e.jsx(N,{className:"w-4 h-4"})})]}),v&&w&&e.jsxs("div",{className:"mt-2 text-xs text-gray-400",children:["starting"===w.status&&"Starting sync...","syncing"===w.status&&`Syncing... ${w.progress||0}%`,"completed"===w.status&&`Synced ${w.messagesAdded||0} new emails`]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:f&&0===b.length?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(c,{className:"w-5 h-5 text-gray-400 animate-spin"})}):0===b.length?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(l,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No emails found"})]}):b.map(s=>e.jsx(z,{thread:s,isSelected:u?.id===s.id,onClick:()=>I(s.id),onStar:()=>$(s.id,!s.is_starred)},s.id))})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-dark-bg",children:u?e.jsx(M,{thread:u,messages:j,onArchive:()=>J(u.id),onTrash:()=>W(u.id),onStar:()=>$(u.id,!u.is_starred),onReply:()=>Y({replyTo:j[j.length-1]}),onLink:()=>{ce(u),ie(!0)},onClose:()=>I(null)}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(l,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"Select an email to read"})]})})}),A&&e.jsx(E,{draft:T,onUpdate:Z,onSend:ee,onClose:q}),ne&&de&&e.jsx(F,{thread:de,clients:ae,contacts:le,onLink:(e,s)=>{se(de.id,e,s),ie(!1),ce(null)},onClose:()=>{ie(!1),ce(null)}})]}):e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("div",{className:"w-16 h-16 bg-dark-card rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(l,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Connect Your Email"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Connect your email account in Settings to sync emails and link them to your clients and contacts."}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Go to ",e.jsx("span",{className:"text-brand-primary font-medium",children:"Settings â†’ Integrations"})," to connect your Gmail or Outlook account."]})]})})}function z({thread:s,isSelected:t,onClick:r,onStar:a}){const l=s.participants?.[0]||{},n=s.unread_count>0;return e.jsx("div",{onClick:r,className:"px-3 py-3 border-b border-dark-border cursor-pointer transition-colors "+(t?"bg-brand-primary/10 border-l-2 border-l-brand-primary":"hover:bg-dark-card"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),a()},className:"mt-0.5 "+(s.is_starred?"text-yellow-400":"text-gray-600 hover:text-gray-400"),children:e.jsx(u,{className:"w-4 h-4",fill:s.is_starred?"currentColor":"none"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm truncate "+(n?"font-semibold text-white":"text-gray-300"),children:l.name||l.email||"Unknown"}),s.attachment_count>0&&e.jsx(j,{className:"w-3 h-3 text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"text-xs text-gray-500 ml-auto flex-shrink-0",children:i(s.last_message_at)})]}),e.jsx("p",{className:"text-sm truncate "+(n?"text-white":"text-gray-400"),children:s.subject||"(no subject)"}),e.jsx("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:s.snippet}),(s.client_id||s.contact_id||s.project_id)&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.client_id&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs bg-blue-500/10 text-blue-400 px-2 py-0.5 rounded",children:[e.jsx(o,{className:"w-3 h-3"}),"Client"]}),s.contact_id&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs bg-green-500/10 text-green-400 px-2 py-0.5 rounded",children:[e.jsx(v,{className:"w-3 h-3"}),"Contact"]}),s.project_id&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs bg-purple-500/10 text-purple-400 px-2 py-0.5 rounded",children:[e.jsx(S,{className:"w-3 h-3"}),"Project"]})]})]})]})})}function M({thread:s,messages:t,onArchive:r,onTrash:a,onStar:l,onReply:n,onLink:i,onClose:d}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-4 py-3 border-b border-dark-border flex items-center gap-3",children:[e.jsx("button",{onClick:d,className:"p-1 rounded hover:bg-dark-card text-gray-400",children:e.jsx(w,{className:"w-5 h-5"})}),e.jsx("h2",{className:"flex-1 text-lg font-medium text-white truncate",children:s.subject||"(no subject)"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:i,className:"p-2 rounded-lg hover:bg-dark-card text-gray-400 hover:text-white",title:"Link to client/contact",children:e.jsx(k,{className:"w-4 h-4"})}),e.jsx("button",{onClick:l,className:"p-2 rounded-lg hover:bg-dark-card "+(s.is_starred?"text-yellow-400":"text-gray-400 hover:text-white"),title:s.is_starred?"Unstar":"Star",children:e.jsx(u,{className:"w-4 h-4",fill:s.is_starred?"currentColor":"none"})}),e.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-dark-card text-gray-400 hover:text-white",title:"Archive",children:e.jsx(C,{className:"w-4 h-4"})}),e.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-dark-card text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx(f,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:t.map((s,r)=>e.jsx(H,{message:s,isLast:r===t.length-1},s.id))}),e.jsx("div",{className:"p-4 border-t border-dark-border",children:e.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-4 py-2 bg-dark-card border border-dark-border rounded-lg text-gray-300 hover:text-white hover:border-gray-600 transition-colors",children:[e.jsx(A,{className:"w-4 h-4"}),"Reply"]})})]})}function H({message:t,isLast:r}){const[a,l]=s.useState(r),n=m(t.from_email);return e.jsxs("div",{className:"bg-dark-card rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("div",{onClick:()=>l(!a),className:"px-4 py-3 flex items-center gap-3 cursor-pointer hover:bg-dark-border/30",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-primary/20 flex items-center justify-center text-brand-primary font-medium",children:n.name?.charAt(0)||n.email?.charAt(0)||"?"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:n.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["<",n.email,">"]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["to ",t.to_emails?.map(e=>e.name||e.email).join(", ")||"unknown"]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:i(t.sent_at)})]}),a&&e.jsxs("div",{className:"px-4 pb-4",children:[t.email_attachments?.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-3 pt-2 border-t border-dark-border",children:t.email_attachments.map(s=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-dark-bg rounded text-sm text-gray-300",children:[e.jsx(j,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate max-w-[150px]",children:s.filename}),e.jsxs("span",{className:"text-xs text-gray-500",children:[(s.size_bytes/1024).toFixed(0),"KB"]})]},s.id))}),t.body_html?e.jsx("div",{className:"prose prose-invert prose-sm max-w-none",dangerouslySetInnerHTML:{__html:p(t.body_html)}}):e.jsx("pre",{className:"text-sm text-gray-300 whitespace-pre-wrap font-sans",children:t.body_text})]})]})}function E({draft:t,onUpdate:r,onSend:a,onClose:l}){const[n,i]=s.useState(!1),[d,o]=s.useState(""),m=e=>{d.trim()&&(r({[e]:[...t[e],{email:d.trim()}]}),o(""))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-dark-border",children:[e.jsx("h3",{className:"font-medium text-white",children:"New Message"}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-white",children:e.jsx(x,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("label",{className:"w-16 text-sm text-gray-400 pt-2",children:"To:"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex flex-wrap gap-1 mb-1",children:t.to.map((s,a)=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-dark-bg rounded text-sm",children:[s.email,e.jsx("button",{onClick:()=>{return e="to",s=a,void r({[e]:t[e].filter((e,t)=>t!==s)});var e,s},className:"text-gray-500 hover:text-white",children:e.jsx(x,{className:"w-3 h-3"})})]},a))}),e.jsx("input",{type:"email",value:d,onChange:e=>o(e.target.value),onKeyDown:e=>"Enter"===e.key&&(e.preventDefault(),m("to")),onBlur:()=>m("to"),placeholder:"Add recipient...",className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded text-white text-sm focus:outline-none focus:border-brand-primary"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"w-16 text-sm text-gray-400",children:"Subject:"}),e.jsx("input",{type:"text",value:t.subject,onChange:e=>r({subject:e.target.value}),placeholder:"Subject",className:"flex-1 px-3 py-2 bg-dark-bg border border-dark-border rounded text-white text-sm focus:outline-none focus:border-brand-primary"})]}),e.jsx("textarea",{value:t.body,onChange:e=>r({body:e.target.value}),placeholder:"Write your message...",rows:12,className:"w-full px-3 py-2 bg-dark-bg border border-dark-border rounded text-white text-sm focus:outline-none focus:border-brand-primary resize-none"})]}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-dark-border",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{className:"p-2 text-gray-400 hover:text-white hover:bg-dark-bg rounded",children:e.jsx(j,{className:"w-4 h-4"})})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:l,className:"px-4 py-2 text-gray-400 hover:text-white",children:"Cancel"}),e.jsx("button",{onClick:async()=>{i(!0);const e=await a();i(!1),e.success||alert(e.error||"Failed to send email")},disabled:n||0===t.to.length,className:"flex items-center gap-2 px-4 py-2 bg-brand-primary text-white rounded-lg hover:bg-brand-primary/90 disabled:opacity-50",children:n?e.jsxs(e.Fragment,{children:[e.jsx(c,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4"}),"Send"]})})]})]})]})})}function F({thread:t,clients:r,contacts:a,onLink:l,onClose:n}){const[i,d]=s.useState("clients"),[c,m]=s.useState(""),h=r.filter(e=>e.company?.toLowerCase().includes(c.toLowerCase())||e.contact?.toLowerCase().includes(c.toLowerCase())),p=a.filter(e=>e.name?.toLowerCase().includes(c.toLowerCase())||e.email?.toLowerCase().includes(c.toLowerCase()));return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg w-full max-w-md shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-dark-border",children:[e.jsx("h3",{className:"font-medium text-white",children:"Link Email Thread"}),e.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white",children:e.jsx(x,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex border-b border-dark-border",children:[e.jsxs("button",{onClick:()=>d("clients"),className:"flex-1 px-4 py-2 text-sm font-medium transition-colors "+("clients"===i?"text-brand-primary border-b-2 border-brand-primary":"text-gray-400 hover:text-white"),children:[e.jsx(o,{className:"w-4 h-4 inline mr-2"}),"Clients"]}),e.jsxs("button",{onClick:()=>d("contacts"),className:"flex-1 px-4 py-2 text-sm font-medium transition-colors "+("contacts"===i?"text-brand-primary border-b-2 border-brand-primary":"text-gray-400 hover:text-white"),children:[e.jsx(v,{className:"w-4 h-4 inline mr-2"}),"Contacts"]})]}),e.jsx("div",{className:"p-3 border-b border-dark-border",children:e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),e.jsx("input",{type:"text",placeholder:"Search...",value:c,onChange:e=>m(e.target.value),className:"w-full pl-9 pr-3 py-2 bg-dark-bg border border-dark-border rounded text-sm text-white placeholder-gray-500 focus:outline-none focus:border-brand-primary"})]})}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:"clients"===i?0===h.length?e.jsx("p",{className:"text-center py-4 text-gray-500",children:"No clients found"}):h.map(s=>e.jsxs("button",{onClick:()=>l("client",s.id),className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-dark-bg text-left border-b border-dark-border",children:[e.jsx("div",{className:"w-8 h-8 rounded bg-blue-500/20 flex items-center justify-center text-blue-400",children:e.jsx(o,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:s.company}),e.jsx("p",{className:"text-xs text-gray-500",children:s.contact})]})]},s.id)):0===p.length?e.jsx("p",{className:"text-center py-4 text-gray-500",children:"No contacts found"}):p.map(s=>e.jsxs("button",{onClick:()=>l("contact",s.id),className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-dark-bg text-left border-b border-dark-border",children:[e.jsx("div",{className:"w-8 h-8 rounded bg-green-500/20 flex items-center justify-center text-green-400",children:e.jsx(v,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.email})]})]},s.id))})]})})}export{T as default};
