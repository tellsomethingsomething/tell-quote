import{j as e}from"./pdf-vendor-CqWdlgKa.js";import{r as t}from"./zustand-vendor-BohoUguQ.js";import{u as s,a,b as r,e as n,c as l,f as i}from"./index-DKsXopg7.js";import{v as o,s as c}from"./validation-DQPS0e0-.js";import"./react-vendor-DRPWudcR.js";import"./supabase-vendor-DWEVVlJw.js";const d={draft:"bg-amber-400/20 text-amber-400",sent:"bg-blue-400/20 text-blue-400",under_review:"bg-yellow-400/20 text-yellow-400",approved:"bg-emerald-500/20 text-emerald-500",won:"bg-green-500/20 text-green-500",rejected:"bg-red-500/20 text-red-500",expired:"bg-gray-600/20 text-gray-500",dead:"bg-red-500/20 text-red-500"};function x({clientId:x,onBackToDashboard:m,onEditQuote:p,onNewQuote:h,onSelectOpportunity:u}){const{getClient:j,getClientQuotes:g,deleteQuote:b,updateQuoteStatus:v,deleteClient:N,updateClient:y,addContact:f,updateContact:w,deleteContact:k}=s(),{loadQuoteData:C}=a(),{settings:L}=r(),{getClientOpportunities:S,deleteOpportunity:A}=n(),M=L.users||[],D=j(x),W=g(x),I=S(x),[P,q]=t.useState("overview"),[B,H]=t.useState(!1),[z,E]=t.useState({}),[U,Q]=t.useState(!1),[R,V]=t.useState(null),[_,O]=t.useState({}),[T,$]=t.useState({}),[F,Y]=t.useState({open:!1,quoteId:null,newStatus:null}),[G,K]=t.useState(""),[J,X]=t.useState("");if(t.useEffect(()=>{const e=e=>{"Escape"===e.key&&(U?Q(!1):B&&H(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[U,B]),!D)return e.jsx("div",{className:"h-[calc(100vh-60px)] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-400",children:"Client not found"}),e.jsx("button",{onClick:m,className:"btn-ghost mt-4",children:"Back to Dashboard"})]})});const Z=(e=null)=>{e?(V(e.id),O({...e})):(V(null),O({name:"",role:"",email:"",phone:"",notes:"",isPrimary:!1,accountHolderId:""})),Q(!0)};return e.jsxs("div",{className:"h-[calc(100vh-60px)] overflow-y-auto p-6 relative",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1",children:[B?e.jsxs("form",{onSubmit:e=>{e.preventDefault(),y(D.id,z),H(!1)},className:"flex gap-2 items-center flex-wrap",children:[e.jsx("input",{className:"input py-1 px-2 text-xl font-bold w-full md:w-auto",value:z.company,onChange:e=>E({...z,company:e.target.value})}),e.jsxs("select",{value:z.region,onChange:e=>E({...z,region:e.target.value}),className:"input py-1 px-2 text-sm w-32",children:[e.jsx("option",{value:"MALAYSIA",children:"Malaysia"}),e.jsx("option",{value:"SEA",children:"SEA"}),e.jsx("option",{value:"GULF",children:"Gulf"}),e.jsx("option",{value:"CENTRAL_ASIA",children:"Central Asia"})]}),e.jsxs("div",{className:"flex gap-1 ml-auto md:ml-0",children:[e.jsx("button",{type:"submit",className:"btn-primary py-1 px-3 text-xs",children:"Save"}),e.jsx("button",{type:"button",onClick:()=>H(!1),className:"btn-ghost py-1 px-3 text-xs",children:"Cancel"})]})]}):e.jsxs("div",{className:"flex items-center gap-3 group",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:D.company}),e.jsx("button",{onClick:()=>{E({company:D.company,website:D.website,location:D.location,region:D.region||"MALAYSIA",notes:D.notes}),H(!0)},className:"opacity-0 group-hover:opacity-100 p-1 text-gray-500 hover:text-white transition-opacity",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 mt-1",children:[D.location&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsxs("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),D.location]}),D.website&&e.jsxs("a",{href:D.website.startsWith("http")?D.website:`https://${D.website}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 hover:text-accent-primary transition-colors",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"})}),D.website.replace(/^https?:\/\//,"")]}),e.jsxs("span",{children:[W.length," Projects"]})]})]}),e.jsxs("button",{onClick:()=>h(x),className:"btn-primary text-sm flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New Quote"]}),e.jsx("button",{onClick:()=>{window.confirm(`Delete ${D.company} and all its data? This cannot be undone.`)&&(N(D.id),m())},className:"p-2 text-gray-500 hover:text-red-400 hover:bg-red-400/10 rounded-lg transition-colors",title:"Delete Client",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-3 uppercase tracking-wider",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(D.tags||[]).map((t,s)=>e.jsxs("span",{className:"px-2.5 py-1 rounded-full text-xs font-medium bg-accent-primary/10 text-accent-primary border border-accent-primary/20 flex items-center gap-1",children:[t,e.jsx("button",{onClick:()=>{const e=D.tags.filter((e,t)=>t!==s);y(D.id,{tags:e})},className:"hover:text-white",children:"×"})]},s))}),e.jsx("div",{className:"flex gap-2 max-w-xs",children:e.jsx("input",{type:"text",placeholder:"Add tag...",className:"input-sm flex-1 bg-dark-card border-none",onKeyDown:e=>{if("Enter"===e.key&&e.target.value.trim()){const t=e.target.value.trim(),s=D.tags||[];s.includes(t)||y(D.id,{tags:[...s,t]}),e.target.value=""}}})})]}),e.jsx("div",{className:"border-b border-dark-border mb-6",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsx("button",{onClick:()=>q("overview"),className:"pb-3 text-sm font-medium transition-colors border-b-2 "+("overview"===P?"border-accent-primary text-white":"border-transparent text-gray-500 hover:text-gray-300"),children:"Quotes & Projects"}),e.jsxs("button",{onClick:()=>q("opportunities"),className:"pb-3 text-sm font-medium transition-colors border-b-2 "+("opportunities"===P?"border-accent-primary text-white":"border-transparent text-gray-500 hover:text-gray-300"),children:["Opportunities (",I.length,")"]}),e.jsxs("button",{onClick:()=>q("contacts"),className:"pb-3 text-sm font-medium transition-colors border-b-2 "+("contacts"===P?"border-accent-primary text-white":"border-transparent text-gray-500 hover:text-gray-300"),children:["Contacts (",D.contacts?.length||(D.contact?1:0),")"]})]})}),"overview"===P&&e.jsx("div",{className:"space-y-3",children:0===W.length?e.jsx("div",{className:"text-center py-12 border-2 border-dashed border-dark-border rounded-xl",children:e.jsx("p",{className:"text-gray-500",children:"No quotes yet for this client."})}):W.map(t=>{const s=l(t.sections||{},t.fees||{});return e.jsx("div",{onClick:()=>(e=>{C(e),p()})(t),className:"card hover:border-accent-primary/50 transition-colors cursor-pointer group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("span",{className:"font-mono font-medium text-accent-primary",children:t.quoteNumber}),e.jsxs("select",{value:t.status||"draft",onChange:e=>((e,t,s)=>{s.stopPropagation(),"rejected"===t||"expired"===t||"dead"===t?Y({open:!0,quoteId:e,newStatus:t}):v(e,t)})(t.id,e.target.value,e),onClick:e=>e.stopPropagation(),className:`text-xs px-2 py-0.5 rounded-full border-0 cursor-pointer ${d[t.status||"draft"]}`,children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"under_review",children:"Under Review"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"won",children:"Won"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"dead",children:"Dead"})]}),t.project?.startDate&&e.jsx("span",{className:"text-xs text-gray-500 bg-white/5 px-2 py-0.5 rounded",children:new Date(t.project.startDate).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mb-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),e.jsx("span",{children:D.contacts?.find(e=>e.id===t.client?.contactId)?.name||t.client?.contact||"Unknown Contact"})]}),e.jsx("p",{className:"text-sm text-gray-400",children:t.project?.title||"Untitled Project"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg font-bold text-gray-200",children:i(s.totalCharge,t.currency||"USD")}),e.jsx("div",{className:"flex items-center gap-2 mt-2 opacity-0 group-hover:opacity-100 transition-opacity justify-end",children:e.jsx("button",{onClick:e=>((e,t)=>{t.stopPropagation(),confirm("Are you sure you want to delete this quote?")&&b(e)})(t.id,e),className:"p-1 text-gray-500 hover:text-red-400 transition-colors",title:"Delete quote",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})]})},t.id)})}),"opportunities"===P&&e.jsxs("div",{className:"space-y-4",children:[I.length>0&&e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"card bg-gradient-to-br from-cyan-900/20 to-cyan-950/10 border-cyan-800/20 text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:I.filter(e=>"active"===e.status).length})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-emerald-900/20 to-emerald-950/10 border-emerald-800/20 text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Pipeline"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:i(I.filter(e=>"active"===e.status).reduce((e,t)=>e+(t.value||0),0),"USD",0)})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-amber-900/20 to-amber-950/10 border-amber-800/20 text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Weighted"}),e.jsx("p",{className:"text-2xl font-bold text-amber-400",children:i(I.filter(e=>"active"===e.status).reduce((e,t)=>e+(t.value||0)*((t.probability||0)/100),0),"USD",0)})]})]}),0===I.length?e.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-dark-border rounded-xl",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No opportunities for this client yet"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Create opportunities from the Opportunities page"})]}):I.map(t=>e.jsx("div",{onClick:()=>u&&u(t.id),className:"card hover:border-accent-primary/50 transition-colors cursor-pointer group",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-200",children:t.title||"Untitled Opportunity"}),e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded border ${(e=>{switch(e){case"won":return"text-green-400 bg-green-500/10 border-green-500/20";case"lost":return"text-red-400 bg-red-500/10 border-red-500/20";default:return"text-blue-400 bg-blue-500/10 border-blue-500/20"}})(t.status)}`,children:t.status}),t.probability>0&&e.jsxs("span",{className:"text-xs text-amber-400",children:[t.probability,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[t.country&&e.jsx("span",{children:t.country}),t.nextAction&&e.jsxs("span",{className:"text-cyan-400",children:["→ ",t.nextAction]})]})]}),e.jsxs("div",{className:"text-right flex items-center gap-4",children:[e.jsx("p",{className:"text-lg font-bold text-gray-200",children:i(t.value||0,t.currency||"USD",0)}),e.jsx("button",{onClick:e=>{e.stopPropagation(),window.confirm("Delete this opportunity?")&&A(t.id)},className:"p-1 text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",title:"Delete opportunity",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},t.id))]}),"contacts"===P&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-200",children:"Key People"}),e.jsx("button",{onClick:()=>Z(),className:"btn-secondary text-xs",children:"+ Add Contact"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[D.contacts?.map(t=>{const s=W.filter(e=>e.client?.contactId===t.id),a=s.filter(e=>"won"===e.status),r=a.length,n=r+s.filter(e=>"dead"===e.status||"rejected"===e.status).length,o=n>0?Math.round(r/n*100):null,c=a.reduce((e,t)=>e+(l(t.sections||{},t.fees||{}).totalCharge||0),0);return e.jsxs("div",{className:"card group relative",children:[e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>Z(t),className:"p-1 text-gray-400 hover:text-white",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>{return e=t.id,void(confirm("Delete this contact?")&&k(x,e));var e},className:"p-1 text-gray-400 hover:text-red-400",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold "+(t.isPrimary?"bg-accent-primary text-white":"bg-gray-700 text-gray-300"),children:t.name.charAt(0)}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-200",children:[t.name,t.isPrimary&&e.jsx("span",{className:"ml-2 text-[10px] bg-accent-primary/20 text-accent-primary px-1.5 py-0.5 rounded",children:"PRIMARY"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:t.role||"No Role"}),t.accountHolderId&&e.jsxs("p",{className:"text-xs text-accent-primary/80 flex items-center gap-1 mt-0.5",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),M.find(e=>e.id===t.accountHolderId)?.name||"Unknown"]})]})]}),s.length>0&&e.jsxs("div",{className:"mb-3 bg-white/5 rounded-lg p-2",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-bold text-white",children:s.length}),e.jsx("p",{className:"text-[10px] text-gray-500 uppercase",children:"Quotes"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-bold text-green-400",children:r}),e.jsx("p",{className:"text-[10px] text-gray-500 uppercase",children:"Won"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-bold "+(null!==o?o>=50?"text-green-400":"text-amber-400":"text-gray-500"),children:null!==o?`${o}%`:"-"}),e.jsx("p",{className:"text-[10px] text-gray-500 uppercase",children:"Win Rate"})]})]}),c>0&&e.jsxs("div",{className:"text-center pt-2 border-t border-white/10",children:[e.jsx("p",{className:"text-lg font-bold text-accent-primary",children:i(c,"USD")}),e.jsx("p",{className:"text-[10px] text-gray-500 uppercase",children:"Lifetime Value"})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-400",children:[t.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),e.jsx("a",{href:`mailto:${t.email}`,className:"hover:text-white transition-colors",children:t.email})]}),t.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),e.jsx("span",{children:t.phone})]}),t.notes&&e.jsx("div",{className:"mt-2 pt-2 border-t border-white/5",children:e.jsx("p",{className:"text-xs text-gray-500 italic",children:t.notes})})]})]},t.id)}),0===D.contacts?.length&&D.contact&&e.jsxs("div",{className:"card border-dashed border-gray-700 opacity-70",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-sm font-bold text-gray-300",children:D.contact.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-200",children:D.contact}),e.jsx("p",{className:"text-sm text-gray-500",children:"Legacy Contact"})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-400",children:[D.email&&e.jsx("p",{children:D.email}),D.phone&&e.jsx("p",{children:D.phone})]}),e.jsx("p",{className:"text-xs text-amber-500 mt-2",children:"Migrate this to a proper contact by editing."})]})]})]}),U&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black/75 backdrop-blur-md modal-backdrop",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl p-6 w-full max-w-md shadow-2xl modal-content relative",children:[e.jsx("button",{onClick:()=>{Q(!1),$({})},className:"absolute top-4 right-4 p-1 text-gray-500 hover:text-white rounded-lg hover:bg-white/10 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-xl font-bold text-gray-100 mb-1",children:R?"Edit Contact":"Add New Contact"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Add contact details for this client."}),e.jsxs("form",{onSubmit:e=>{e.preventDefault();const{isValid:t,errors:s}=o(_,{name:{required:!0,label:"Name",minLength:2}});if(!t)return void $(s);const a={..._,name:c(_.name),role:c(_.role)};R?w(x,R,a):f(x,a),Q(!1),$({})},className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2 sm:col-span-1",children:[e.jsx("label",{className:"label label-required",children:"Name"}),e.jsx("input",{type:"text",required:!0,value:_.name,onChange:e=>{O({..._,name:e.target.value}),T.name&&$({...T,name:null})},className:"input "+(T.name?"border-red-500 focus:ring-red-500":""),placeholder:"Full name"}),T.name&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:T.name})]}),e.jsxs("div",{className:"col-span-2 sm:col-span-1",children:[e.jsx("label",{className:"label",children:"Role / Title"}),e.jsx("input",{type:"text",value:_.role,onChange:e=>O({..._,role:e.target.value}),className:"input",placeholder:"e.g. Marketing Director"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{type:"email",value:_.email,onChange:e=>{O({..._,email:e.target.value}),T.email&&$({...T,email:null})},className:"input "+(T.email?"border-red-500 focus:ring-red-500":""),placeholder:"email@company.com"}),T.email&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:T.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone"}),e.jsx("input",{type:"text",value:_.phone,onChange:e=>{O({..._,phone:e.target.value}),T.phone&&$({...T,phone:null})},className:"input "+(T.phone?"border-red-500 focus:ring-red-500":""),placeholder:"+65 9123 4567"}),T.phone&&e.jsx("p",{className:"text-xs text-red-400 mt-1",children:T.phone})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Account Holder"}),e.jsxs("select",{value:_.accountHolderId||"",onChange:e=>O({..._,accountHolderId:e.target.value}),className:"input",children:[e.jsx("option",{value:"",children:"-- Unassigned --"}),M.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx("p",{className:"form-helper",children:"Assign a team member responsible for this contact"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Notes"}),e.jsx("textarea",{value:_.notes||"",onChange:e=>O({..._,notes:e.target.value}),className:"input min-h-[80px] resize-none",placeholder:"Internal notes about this contact..."}),e.jsx("p",{className:"form-helper",children:"Internal notes only - not shown on quotes"})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-dark-bg/50 rounded-lg border border-dark-border",children:[e.jsx("input",{type:"checkbox",id:"isPrimary",checked:_.isPrimary,onChange:e=>O({..._,isPrimary:e.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-dark-bg text-accent-primary focus:ring-accent-primary focus:ring-offset-0"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"isPrimary",className:"text-sm font-medium text-gray-200 cursor-pointer",children:"Set as Primary Contact"}),e.jsx("p",{className:"text-xs text-gray-500",children:"This contact will be the default for new quotes"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-800/50",children:[e.jsx("button",{type:"button",onClick:()=>{Q(!1),$({})},className:"btn-ghost",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",children:R?"Save Changes":"Add Contact"})]})]})]})}),F.open&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black/75 backdrop-blur-md modal-backdrop p-4",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl p-6 w-full max-w-md shadow-2xl",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-100 mb-2",children:"rejected"===F.newStatus?"Quote Rejected":"expired"===F.newStatus?"Quote Expired":"Quote Lost"}),e.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Help us track why this opportunity didn't close"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label label-required",children:"Reason"}),e.jsxs("select",{value:G,onChange:e=>K(e.target.value),className:"input",required:!0,children:[e.jsx("option",{value:"",children:"Select reason..."}),e.jsx("option",{value:"price",children:"Price too high"}),e.jsx("option",{value:"timing",children:"Wrong timing"}),e.jsx("option",{value:"lost_to_competitor",children:"Lost to competitor"}),e.jsx("option",{value:"no_budget",children:"No budget"}),e.jsx("option",{value:"requirements_mismatch",children:"Requirements didn't match"}),e.jsx("option",{value:"client_unresponsive",children:"Client unresponsive"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Additional Notes"}),e.jsx("textarea",{value:J,onChange:e=>X(e.target.value),placeholder:"Any additional context...",rows:3,className:"input resize-none"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-dark-border",children:[e.jsx("button",{onClick:()=>{Y({open:!1,quoteId:null,newStatus:null}),K(""),X("")},className:"btn-ghost",children:"Cancel"}),e.jsx("button",{onClick:()=>{F.quoteId&&F.newStatus&&v(F.quoteId,F.newStatus,J,G,J),Y({open:!1,quoteId:null,newStatus:null}),K(""),X("")},disabled:!G,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"Update Status"})]})]})})]})}export{x as default};
