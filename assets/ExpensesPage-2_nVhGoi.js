import{j as e}from"./pdf-vendor-CqWdlgKa.js";import{r}from"./zustand-vendor-BohoUguQ.js";import{aA as t,am as s,u as a,f as l,aB as n}from"./index-Civi5K2Q.js";import"./react-vendor-DRPWudcR.js";import"./supabase-vendor-DWEVVlJw.js";const o=e=>{if(!e)return"-";return new Date(e).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})};function d({label:r,value:t,subValue:s,icon:a,color:l}){return e.jsx("div",{className:"bg-dark-card border border-dark-border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-400",children:r}),e.jsx("div",{className:`text-2xl font-bold ${l}`,children:t}),s&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:s})]}),e.jsx("div",{className:`p-3 rounded-lg ${l.replace("text-","bg-").replace("400","500/10")}`,children:a})]})})}function i({expense:r,onEdit:t,onDelete:s,projects:a,clients:n}){const d=a.find(e=>e.id===r.projectId),i=n.find(e=>e.id===r.clientId);return e.jsxs("tr",{className:"border-b border-dark-border hover:bg-dark-card/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-gray-400",children:o(r.date)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 rounded bg-dark-bg text-xs text-gray-300",children:r.category})}),e.jsx("td",{className:"px-4 py-3 text-gray-200",children:r.description||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:d?.name||i?.name||"-"}),e.jsx("td",{className:"px-4 py-3 text-gray-400 text-sm",children:r.vendor||"-"}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-200",children:l(r.amount,r.currency)}),e.jsx("td",{className:"px-4 py-3",children:r.isBillable&&e.jsx("span",{className:"px-2 py-0.5 rounded bg-green-500/10 text-green-400 text-xs",children:"Billable"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>t(r),className:"p-1 text-gray-400 hover:text-gray-200",title:"Edit",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>s(r.id),className:"p-1 text-gray-400 hover:text-red-400",title:"Delete",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]})}function c({isOpen:t,onClose:s,expense:a,onSave:l,projects:o,clients:d}){const[i,c]=r.useState({category:"",description:"",amount:"",currency:"USD",date:(new Date).toISOString().split("T")[0],projectId:"",clientId:"",vendor:"",isBillable:!1,notes:""});r.useEffect(()=>{c(a?{category:a.category||"",description:a.description||"",amount:a.amount?.toString()||"",currency:a.currency||"USD",date:a.date||(new Date).toISOString().split("T")[0],projectId:a.projectId||"",clientId:a.clientId||"",vendor:a.vendor||"",isBillable:a.isBillable||!1,notes:a.notes||""}:{category:"",description:"",amount:"",currency:"USD",date:(new Date).toISOString().split("T")[0],projectId:"",clientId:"",vendor:"",isBillable:!1,notes:""})},[a,t]);return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-border",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-200",children:a?"Edit Expense":"Add Expense"}),e.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-gray-200",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),l({...i,amount:parseFloat(i.amount)||0,projectId:i.projectId||null,clientId:i.clientId||null})},className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Category *"}),e.jsxs("select",{value:i.category,onChange:e=>c({...i,category:e.target.value}),required:!0,className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-gray-200",children:[e.jsx("option",{value:"",children:"Select category..."}),n.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Date *"}),e.jsx("input",{type:"date",value:i.date,onChange:e=>c({...i,date:e.target.value}),required:!0,className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-gray-200"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:i.description,onChange:e=>c({...i,description:e.target.value}),placeholder:"What was this expense for?",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-gray-200"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Amount *"}),e.jsx("input",{type:"number",step:"0.01",value:i.amount,onChange:e=>c({...i,amount:e.target.value}),required:!0,placeholder:"0.00",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-gray-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Currency"}),e.jsxs("select",{value:i.currency,onChange:e=>c({...i,currency:e.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-gray-200",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"GBP",children:"GBP"}),e.jsx("option",{value:"MYR",children:"MYR"}),e.jsx("option",{value:"SGD",children:"SGD"}),e.jsx("option",{value:"AED",children:"AED"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Project"}),e.jsxs("select",{value:i.projectId,onChange:e=>c({...i,projectId:e.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-gray-200",children:[e.jsx("option",{value:"",children:"No project"}),o.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Client"}),e.jsxs("select",{value:i.clientId,onChange:e=>c({...i,clientId:e.target.value}),className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-gray-200",children:[e.jsx("option",{value:"",children:"No client"}),d.map(r=>e.jsx("option",{value:r.id,children:r.name||r.company},r.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Vendor"}),e.jsx("input",{type:"text",value:i.vendor,onChange:e=>c({...i,vendor:e.target.value}),placeholder:"Who did you pay?",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-gray-200"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"isBillable",checked:i.isBillable,onChange:e=>c({...i,isBillable:e.target.checked}),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-accent-primary"}),e.jsx("label",{htmlFor:"isBillable",className:"text-sm text-gray-300",children:"Billable to client"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Notes"}),e.jsx("textarea",{value:i.notes,onChange:e=>c({...i,notes:e.target.value}),rows:2,placeholder:"Additional notes...",className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-gray-200 resize-none"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 bg-dark-bg border border-dark-border text-gray-300 rounded-lg hover:bg-dark-border transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors",children:a?"Save Changes":"Add Expense"})]})]})]})}):null}function x(){const{expenses:o,loading:x,getStats:p,createExpense:u,updateExpense:h,deleteExpense:m,initialize:g}=t(),{projects:b}=s(),{clients:j}=a(),[v,y]=r.useState(!1),[k,N]=r.useState(null),[f,w]=r.useState("all"),[C,S]=r.useState("all"),[L,B]=r.useState("");r.useEffect(()=>{g()},[g]);const D=r.useMemo(()=>p(),[o,p]),I=r.useMemo(()=>{let e=o;if("all"!==f&&(e=e.filter(e=>e.category===f)),"all"!==C&&(e=e.filter(e=>e.projectId===C)),L){const r=L.toLowerCase();e=e.filter(e=>e.description?.toLowerCase().includes(r)||e.vendor?.toLowerCase().includes(r)||e.category?.toLowerCase().includes(r))}return e},[o,f,C,L]),M=e=>{N(e),y(!0)},E=async e=>{window.confirm("Are you sure you want to delete this expense?")&&await m(e)},A=()=>{N(null),y(!0)};return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-100",children:"Expenses"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Track project costs and spending"})]}),e.jsxs("button",{onClick:A,className:"px-4 py-2 bg-accent-primary text-white rounded-lg hover:bg-accent-primary/90 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Expense"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(d,{label:"Total Expenses",value:l(D.total,"USD",0),subValue:`${D.count} expenses`,color:"text-red-400",icon:e.jsx("svg",{className:"w-6 h-6 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsx(d,{label:"This Month",value:l(D.thisMonth,"USD",0),subValue:`${D.thisMonthCount} expenses`,color:"text-orange-400",icon:e.jsx("svg",{className:"w-6 h-6 text-orange-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx(d,{label:"Billable",value:l(D.billable,"USD",0),subValue:"Can invoice",color:"text-green-400",icon:e.jsx("svg",{className:"w-6 h-6 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx(d,{label:"Categories",value:Object.values(D.byCategory).filter(e=>e>0).length,subValue:"With expenses",color:"text-blue-400",icon:e.jsx("svg",{className:"w-6 h-6 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4 flex-wrap",children:[e.jsxs("div",{className:"relative flex-1 max-w-xs",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:"Search expenses...",value:L,onChange:e=>B(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-gray-200 placeholder-gray-500 focus:outline-none focus:border-accent-primary"})]}),e.jsxs("select",{value:f,onChange:e=>w(e.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-gray-200",children:[e.jsx("option",{value:"all",children:"All Categories"}),n.map(r=>e.jsx("option",{value:r,children:r},r))]}),e.jsxs("select",{value:C,onChange:e=>S(e.target.value),className:"bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-gray-200",children:[e.jsx("option",{value:"all",children:"All Projects"}),b.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsx("div",{className:"bg-dark-card border border-dark-border rounded-xl overflow-hidden",children:x?e.jsx("div",{className:"p-8 text-center text-gray-400",children:"Loading expenses..."}):0===I.length?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("div",{className:"text-gray-400 mb-2",children:"No expenses found"}),e.jsx("button",{onClick:A,className:"text-accent-primary hover:underline",children:"Add your first expense"})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-dark-bg/50 border-b border-dark-border",children:[e.jsx("th",{className:"text-left px-4 py-3 text-xs text-gray-400 font-medium uppercase",children:"Date"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-gray-400 font-medium uppercase",children:"Category"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-gray-400 font-medium uppercase",children:"Description"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-gray-400 font-medium uppercase",children:"Project/Client"}),e.jsx("th",{className:"text-left px-4 py-3 text-xs text-gray-400 font-medium uppercase",children:"Vendor"}),e.jsx("th",{className:"text-right px-4 py-3 text-xs text-gray-400 font-medium uppercase",children:"Amount"}),e.jsx("th",{className:"w-20"}),e.jsx("th",{className:"w-20"})]})}),e.jsx("tbody",{children:I.map(r=>e.jsx(i,{expense:r,onEdit:M,onDelete:E,projects:b,clients:j},r.id))})]})}),e.jsx(c,{isOpen:v,onClose:()=>{y(!1),N(null)},expense:k,onSave:async e=>{k?await h(k.id,e):await u(e),y(!1),N(null)},projects:b,clients:j})]})}export{x as default};
