import{j as e}from"./pdf-vendor-CqWdlgKa.js";import{r as t}from"./zustand-vendor-BohoUguQ.js";import{u as s,f as r,E as a,a as n,b as l,g as i}from"./calendarStore-DipbOHR1.js";import{aJ as d,r as o,H as c,U as x,aM as m,g as h,u as g,X as b,O as u,y as p,a5 as j}from"./index-DoA-9vkb.js";import{C as v}from"./chevron-left-mQrnTiuG.js";import{C as f}from"./chevron-right-Trm39leG.js";import{E as y}from"./ellipsis-vertical-CA9CYmmt.js";import{P as N,S as w}from"./save-CMGHOROT.js";import{T as k}from"./trash-2-CKFAddvS.js";import{M as S}from"./map-pin-D6Gxtj5m.js";import{L as C}from"./link-2-CZHKfoy3.js";import"./react-vendor-DRPWudcR.js";import"./supabase-vendor-DWEVVlJw.js";function _({currentDate:t,events:s,onDateSelect:r,selectedDate:n}){const l=t.getFullYear(),i=t.getMonth(),d=new Date(l,i,1),o=new Date(l,i+1,0),c=d.getDay(),x=o.getDate(),m=[];for(let e=0;e<c;e++){const t=new Date(l,i,-c+e+1);m.push({date:t,isCurrentMonth:!1})}for(let e=1;e<=x;e++)m.push({date:new Date(l,i,e),isCurrentMonth:!0});const h=42-m.length;for(let e=1;e<=h;e++)m.push({date:new Date(l,i+1,e),isCurrentMonth:!1});const g=new Date;g.setHours(0,0,0,0);return e.jsxs("div",{className:"grid grid-cols-7 gap-px bg-dark-border rounded-lg overflow-hidden",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(t=>e.jsx("div",{className:"bg-dark-card p-2 text-center text-xs font-medium text-gray-400",children:t},t)),m.map(({date:t,isCurrentMonth:l},i)=>{const d=(e=>{const t=e.toISOString().split("T")[0];return s.filter(e=>new Date(e.start_time).toISOString().split("T")[0]===t)})(t),o=t.getTime()===g.getTime(),c=n&&t.toISOString().split("T")[0]===n.toISOString().split("T")[0];return e.jsxs("button",{onClick:()=>r(t),className:`min-h-[100px] p-2 text-left transition-colors ${l?"bg-dark-card":"bg-dark-bg"} ${c?"ring-2 ring-brand-teal ring-inset":""} hover:bg-dark-nav`,children:[e.jsx("div",{className:"text-sm font-medium mb-1 "+(o?"w-6 h-6 rounded-full bg-brand-teal text-white flex items-center justify-center":l?"text-gray-300":"text-gray-600"),children:t.getDate()}),e.jsxs("div",{className:"space-y-1",children:[d.slice(0,3).map(t=>{const s=a[t.event_type]||a.meeting;return e.jsx("div",{className:`text-[10px] px-1 py-0.5 rounded truncate ${s.color} bg-dark-bg`,title:t.title,children:t.title},t.id)}),d.length>3&&e.jsxs("div",{className:"text-[10px] text-gray-500",children:["+",d.length-3," more"]})]})]},i)})]})}function D({event:s,onEdit:r,onDelete:d}){const[o,h]=t.useState(!1),g=a[s.event_type]||a.meeting,b=n[s.status]||n.confirmed;return e.jsxs("div",{className:"p-3 rounded-lg border border-dark-border bg-dark-card hover:border-gray-600 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:g.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white",children:s.title}),e.jsx("p",{className:`text-xs ${b.color}`,children:b.label})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>h(!o),className:"p-1 text-gray-400 hover:text-white rounded transition-colors",children:e.jsx(y,{className:"w-4 h-4"})}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>h(!1)}),e.jsxs("div",{className:"absolute right-0 mt-1 w-32 bg-dark-nav border border-dark-border rounded-lg shadow-xl z-20 py-1",children:[e.jsxs("button",{onClick:()=>{r(s),h(!1)},className:"w-full px-3 py-2 text-left text-sm text-gray-300 hover:bg-dark-card flex items-center gap-2",children:[e.jsx(N,{className:"w-4 h-4"}),"Edit"]}),e.jsxs("button",{onClick:()=>{d(s),h(!1)},className:"w-full px-3 py-2 text-left text-sm text-red-400 hover:bg-dark-card flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),"Delete"]})]})]})]})]}),e.jsxs("div",{className:"space-y-1.5 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:"w-4 h-4"}),e.jsx("span",{children:l(s.start_time,s.end_time,s.all_day)}),e.jsxs("span",{className:"text-gray-600",children:["(",i(s.start_time,s.end_time),")"]})]}),s.location&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:s.location})]}),s.attendees?.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.attendees.length," attendee",1!==s.attendees.length?"s":""]})]}),s.metadata?.onlineMeetingUrl&&e.jsxs("a",{href:s.metadata.onlineMeetingUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-brand-teal hover:underline",children:[e.jsx(m,{className:"w-4 h-4"}),"Join meeting"]})]})]})}function M({event:s,onClose:r,onSave:l}){const{opportunities:i}=h(),{clients:d}=g(),[o,c]=t.useState(!1),[x,m]=t.useState(null),[p,j]=t.useState({title:s?.title||"",description:s?.description||"",start_time:s?.start_time?new Date(s.start_time).toISOString().slice(0,16):"",end_time:s?.end_time?new Date(s.end_time).toISOString().slice(0,16):"",location:s?.location||"",event_type:s?.event_type||"meeting",status:s?.status||"confirmed",all_day:s?.all_day||!1,opportunity_id:s?.opportunity_id||"",client_id:s?.client_id||"",reminder_minutes:s?.reminder_minutes||15});return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-dark-border",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:s?"Edit Event":"New Event"}),e.jsx("button",{onClick:r,className:"p-2 text-gray-400 hover:text-white transition-colors",children:e.jsx(b,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),m(null),p.title.trim())if(p.start_time&&p.end_time){c(!0);try{await l({...p,start_time:new Date(p.start_time).toISOString(),end_time:new Date(p.end_time).toISOString(),opportunity_id:p.opportunity_id||null,client_id:p.client_id||null}),r()}catch(t){m(t.message)}finally{c(!1)}}else m("Start and end time are required");else m("Title is required")},className:"p-6 space-y-4",children:[x&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400",children:[e.jsx(u,{className:"w-5 h-5"}),e.jsx("span",{children:x})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:p.title,onChange:e=>j(t=>({...t,title:e.target.value})),placeholder:"Event title",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-brand-teal"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Start *"}),e.jsx("input",{type:"datetime-local",value:p.start_time,onChange:e=>j(t=>({...t,start_time:e.target.value})),className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-brand-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"End *"}),e.jsx("input",{type:"datetime-local",value:p.end_time,onChange:e=>j(t=>({...t,end_time:e.target.value})),className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-brand-teal"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"all_day",checked:p.all_day,onChange:e=>j(t=>({...t,all_day:e.target.checked})),className:"w-4 h-4 rounded border-dark-border bg-dark-bg text-brand-teal focus:ring-brand-teal"}),e.jsx("label",{htmlFor:"all_day",className:"text-sm text-gray-300",children:"All day event"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Type"}),e.jsx("select",{value:p.event_type,onChange:e=>j(t=>({...t,event_type:e.target.value})),className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-brand-teal",children:Object.entries(a).map(([t,s])=>e.jsxs("option",{value:t,children:[s.icon," ",s.label]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Status"}),e.jsx("select",{value:p.status,onChange:e=>j(t=>({...t,status:e.target.value})),className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-brand-teal",children:Object.entries(n).map(([t,s])=>e.jsx("option",{value:t,children:s.label},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Location"}),e.jsx("input",{type:"text",value:p.location,onChange:e=>j(t=>({...t,location:e.target.value})),placeholder:"Event location or meeting link",className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-brand-teal"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{value:p.description,onChange:e=>j(t=>({...t,description:e.target.value})),placeholder:"Event description",rows:3,className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-brand-teal resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Link to Opportunity"}),e.jsxs("select",{value:p.opportunity_id,onChange:e=>j(t=>({...t,opportunity_id:e.target.value})),className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-brand-teal",children:[e.jsx("option",{value:"",children:"None"}),i.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Link to Client"}),e.jsxs("select",{value:p.client_id,onChange:e=>j(t=>({...t,client_id:e.target.value})),className:"w-full px-4 py-2 bg-dark-bg border border-dark-border rounded-lg text-white focus:outline-none focus:border-brand-teal",children:[e.jsx("option",{value:"",children:"None"}),d.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-dark-border",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:o,className:"flex items-center gap-2 px-4 py-2 bg-brand-teal text-white rounded-lg hover:bg-brand-teal/90 transition-colors disabled:opacity-50",children:[o?e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx(w,{className:"w-4 h-4"}),s?"Save Changes":"Create Event"]})]})]})]})})}function E({provider:t,status:s,lastSync:r,isSyncing:a,onConnect:n,onDisconnect:l,onSync:i}){const d="connected"===s,o="microsoft"===t;return e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center "+(o?"bg-[#00A4EF]/20":"bg-[#4285F4]/20"),children:o?e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",fill:"none",children:[e.jsx("path",{d:"M11 11H0V0h11v11z",fill:"#F25022"}),e.jsx("path",{d:"M23 11H12V0h11v11z",fill:"#7FBA00"}),e.jsx("path",{d:"M11 23H0V12h11v11z",fill:"#00A4EF"}),e.jsx("path",{d:"M23 23H12V12h11v11z",fill:"#FFB900"})]}):e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-white",children:[o?"Microsoft":"Google"," Calendar"]}),e.jsx("p",{className:"text-xs text-gray-400",children:"connected"===s?"Connected":"syncing"===s?"Syncing...":"error"===s?"Connection error":"Not connected"})]})]}),d&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs",children:[e.jsx(p,{className:"w-3 h-3"}),"Connected"]})]}),d&&e.jsxs("div",{className:"text-xs text-gray-500 mb-3",children:["Last synced: ",(c=r,c?new Date(c).toLocaleString():"Never")]}),e.jsx("div",{className:"flex gap-2",children:d?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:i,disabled:a,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white hover:bg-dark-nav transition-colors disabled:opacity-50",children:[e.jsx(j,{className:"w-4 h-4 "+(a?"animate-spin":"")}),a?"Syncing...":"Sync Now"]}),e.jsx("button",{onClick:l,className:"px-3 py-2 text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:"Disconnect"})]}):e.jsxs("button",{onClick:n,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-white rounded-lg transition-colors "+(o?"bg-[#00A4EF] hover:bg-[#00A4EF]/90":"bg-[#4285F4] hover:bg-[#4285F4]/90"),children:[e.jsx(C,{className:"w-4 h-4"}),"Connect ",o?"Microsoft":"Google"," Calendar"]})})]});var c}function F(){const{msSyncStatus:t,googleSyncStatus:r,lastSyncAt:a,isSyncing:n,connectMicrosoft:l,disconnectMicrosoft:i,syncFromMicrosoft:d,connectGoogle:o,disconnectGoogle:c,syncFromGoogle:x}=s();return e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 px-1",children:"Calendar Sync"}),e.jsx(E,{provider:"microsoft",status:t,lastSync:a,isSyncing:n,onConnect:l,onDisconnect:i,onSync:d}),e.jsx(E,{provider:"google",status:r,lastSync:a,isSyncing:n,onConnect:o,onDisconnect:c,onSync:x})]})}function z(){const{events:a,isLoading:n,selectedDate:l,viewMode:i,loadEvents:c,createEvent:x,updateEvent:m,deleteEvent:h,setSelectedDate:g,setViewMode:b,getEventsForDate:u,initialize:p}=s(),[j,y]=t.useState(new Date),[N,w]=t.useState(!1),[k,S]=t.useState(null),[C,E]=t.useState(null);t.useEffect(()=>{p()},[]);const z=e=>{y(t=>{const s=new Date(t);return s.setMonth(s.getMonth()+e),s})},T=t.useMemo(()=>l?u(l):[],[l,a]),O=e=>{S(e),w(!0)},A=e=>{E(e)},H=j.toLocaleDateString("en-US",{month:"long",year:"numeric"});return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-white",children:"Calendar"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage events and sync with Microsoft"})]}),e.jsxs("button",{onClick:()=>{S(null),w(!0)},className:"flex items-center gap-2 px-4 py-2 bg-brand-teal text-white rounded-lg hover:bg-brand-teal/90 transition-colors",children:[e.jsx(d,{className:"w-4 h-4"}),"New Event"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:H}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>z(-1),className:"p-2 text-gray-400 hover:text-white rounded transition-colors",children:e.jsx(v,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>z(1),className:"p-2 text-gray-400 hover:text-white rounded transition-colors",children:e.jsx(f,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{const e=new Date;y(e),g(e)},className:"px-3 py-1.5 text-sm text-gray-300 hover:text-white border border-dark-border rounded-lg hover:bg-dark-nav transition-colors",children:"Today"}),e.jsx("div",{className:"flex rounded-lg border border-dark-border overflow-hidden",children:["month","week","day"].map(t=>e.jsx("button",{onClick:()=>b(t),className:"px-3 py-1.5 text-sm capitalize transition-colors "+(i===t?"bg-brand-teal text-white":"text-gray-400 hover:text-white hover:bg-dark-nav"),children:t},t))})]})]}),e.jsx("div",{className:"p-4",children:n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-brand-teal border-t-transparent rounded-full"})}):e.jsx(_,{currentDate:j,events:a,onDateSelect:g,selectedDate:l})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(F,{}),e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-medium text-white",children:l?r(l):"Select a date"}),l&&e.jsx("button",{onClick:()=>{S(null),w(!0)},className:"p-1.5 text-gray-400 hover:text-brand-teal transition-colors",title:"Add event",children:e.jsx(d,{className:"w-4 h-4"})})]}),l?T.length>0?e.jsx("div",{className:"space-y-3",children:T.map(t=>e.jsx(D,{event:t,onEdit:O,onDelete:A},t.id))}):e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(o,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"No events"})]}):e.jsxs("div",{className:"text-center py-6 text-gray-500",children:[e.jsx(o,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"Click on a date to view events"})]})]})]})]}),N&&e.jsx(M,{event:k,onClose:()=>{w(!1),S(null)},onSave:async e=>{k?await m(k.id,e):await x(e)}}),C&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg p-6 max-w-md w-full",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Delete Event"}),e.jsxs("p",{className:"text-gray-400 mb-4",children:['Are you sure you want to delete "',C.title,'"? This action cannot be undone.']}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>E(null),className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{onClick:async()=>{C&&(await h(C.id),E(null))},className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Delete"})]})]})})]})}export{z as default};
