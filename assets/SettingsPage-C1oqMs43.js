import{j as e,p as s}from"./pdf-vendor-CqWdlgKa.js";import{r as a}from"./zustand-vendor-BohoUguQ.js";import{o as t,D as r,E as l,b as n,N as i,p as c,O as d,X as o,P as x,Q as m,U as h,H as u,t as p,V as g,W as b,G as j,y,Y as f,r as v,Z as N,$ as w,a0 as k,a1 as C,a2 as S,a3 as D,a4 as P,a5 as A,a6 as L,a7 as M,a8 as T,a9 as _,aa as B,ab as F,ac as E,K as q,ad as z}from"./index-g2Iar00F.js";import{u as I}from"./calendarStore-CLIdM_k5.js";import{E as R}from"./ellipsis-vertical-D0o88_7l.js";import{T as U}from"./trash-2-BDmyaqdf.js";import{C as O}from"./copy-h2JdlwCb.js";import{S as W}from"./send-DHMMwT80.js";import{E as H}from"./eye-BetHXh0i.js";import{F as G}from"./file-text-DQLibXAv.js";import{Z as V}from"./zap-Cn6_aFrH.js";import{M as Y}from"./message-square-Dl4ZrkmU.js";import{C as K}from"./circle-x-vTOhRkP3.js";import"./react-vendor-DRPWudcR.js";import"./supabase-vendor-DWEVVlJw.js";const $=t("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),Q=t("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),J=t("file-braces",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),Z=t("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);async function X(e,s){if(!r())throw new Error("Supabase not configured");const a={};void 0!==s.name&&(a.name=s.name),void 0!==s.role&&(a.role=s.role),void 0!==s.status&&(a.status=s.status),void 0!==s.tabPermissions&&(a.tab_permissions=s.tabPermissions);const{data:t,error:n}=await l.from("user_profiles").update(a).eq("id",e).select().single();if(n)throw n;return{id:t.id,authUserId:t.auth_user_id,name:t.name,email:t.email,role:t.role,status:t.status||"active",tabPermissions:t.tab_permissions||[]}}function ee(e=12){const s="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*";let a="";for(let t=0;t<e;t++)a+=s.charAt(Math.floor(70*Math.random()));return a}const se=[{id:"dashboard",label:"Dashboard",description:"Overview and analytics"},{id:"quotes",label:"Quotes",description:"Quote management"},{id:"clients",label:"Clients",description:"Client database"},{id:"opportunities",label:"Opportunities",description:"Sales pipeline"},{id:"tasks",label:"Tasks",description:"Commercial tasks"},{id:"sop",label:"SOP",description:"Standard operating procedures"},{id:"knowledge",label:"Research",description:"Knowledge base and research"},{id:"kit",label:"Kit",description:"Equipment inventory"},{id:"rate-card",label:"Rate Card",description:"Pricing rates"},{id:"contacts",label:"Contacts",description:"Contact management"},{id:"settings",label:"Settings",description:"System configuration (Admin only)"}],ae=["dashboard","quotes","clients","opportunities","tasks"],te=[{name:"Professional Navy",primary:"#143642",accent:"#0F8B8D",line:"#143642"},{name:"Modern Blue",primary:"#1E40AF",accent:"#3B82F6",line:"#1E40AF"},{name:"Corporate Gray",primary:"#374151",accent:"#6B7280",line:"#374151"},{name:"Elegant Purple",primary:"#5B21B6",accent:"#8B5CF6",line:"#5B21B6"},{name:"Classic Green",primary:"#065F46",accent:"#10B981",line:"#065F46"}];function re(){const{settings:t,setPdfOptions:r}=n(),l=t.pdfOptions||{},[c,d]=a.useState(!1),[o,x]=a.useState("colors"),m=(e,s)=>{r({[e]:s})};return e.jsxs("div",{className:"flex flex-col h-full bg-dark-bg",children:[e.jsx("div",{className:"bg-dark-card border-b border-dark-border p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-100",children:"PDF Styling"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Customize colors and fonts for your quote PDFs"})]}),e.jsx("button",{onClick:async()=>{d(!0);try{const a=(e=>({quoteNumber:"QT-2024-001",createdAt:(new Date).toISOString(),validityDays:30,currency:"USD",client:{company:"Acme Corporation",contact:"John Smith",email:"john@acme.com",phone:"+1 555 123 4567"},project:{title:"Corporate Event Production",venue:"Grand Ballroom, Hilton Hotel",startDate:(new Date).toISOString(),endDate:new Date(Date.now()+2592e5).toISOString(),type:"Event"},preparedBy:e.users?.[0]?.id,sections:{productionTeam:{id:"productionTeam",name:"Production Team",color:"#3B82F6",subsections:{Camera:[{id:"1",name:"Camera Operator",quantity:2,days:3,cost:400,charge:600},{id:"2",name:"Camera Assistant",quantity:1,days:3,cost:250,charge:400}],Audio:[{id:"3",name:"Audio Engineer",quantity:1,days:3,cost:450,charge:650}]}},productionEquipment:{id:"productionEquipment",name:"Production Equipment",color:"#10B981",subsections:{"Camera Package":[{id:"4",name:"Sony FX6 Camera Kit",quantity:2,days:3,cost:300,charge:500}],"Audio Package":[{id:"5",name:"Wireless Mic System",quantity:4,days:3,cost:50,charge:100}]}}},sectionOrder:["productionTeam","productionEquipment"],fees:{managementFee:10,commissionFee:0,discount:0,distributeFees:!1}}))(t),r=await s(e.jsx(i,{quote:a,currency:"USD"})).toBlob(),l=URL.createObjectURL(r);window.open(l,"_blank"),setTimeout(()=>URL.revokeObjectURL(l),5e3)}catch(a){alert("Failed to generate preview. Check console for details.")}finally{d(!1)}},disabled:c,className:"btn-primary flex items-center gap-2",children:c?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Preview PDF"]})})]})}),e.jsxs("div",{className:"flex-1 overflow-hidden flex",children:[e.jsx("div",{className:"w-36 bg-dark-card border-r border-dark-border p-2 flex flex-col gap-1",children:[{id:"colors",label:"Colors",icon:"ðŸŽ¨"},{id:"fonts",label:"Fonts",icon:"âœï¸"},{id:"display",label:"Display",icon:"ðŸ‘ï¸"}].map(s=>e.jsxs("button",{onClick:()=>x(s.id),className:"w-full text-left px-3 py-2.5 rounded-lg text-sm flex items-center gap-2 transition-colors "+(o===s.id?"bg-accent-primary/20 text-accent-primary":"text-gray-400 hover:bg-white/5 hover:text-gray-200"),children:[e.jsx("span",{children:s.icon}),s.label]},s.id))}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-xl",children:["colors"===o&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-200 mb-4",children:"Color Presets"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:te.map((s,a)=>e.jsxs("button",{onClick:()=>(e=>{r({primaryColor:e.primary,accentColor:e.accent,lineColor:e.line})})(s),className:"p-3 rounded-lg border border-dark-border hover:border-gray-600 transition-all group text-left",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-5 h-5 rounded",style:{backgroundColor:s.primary}}),e.jsx("div",{className:"w-5 h-5 rounded",style:{backgroundColor:s.accent}})]}),e.jsx("span",{className:"text-xs text-gray-400 group-hover:text-gray-300",children:s.name})]},a))})]}),e.jsxs("div",{className:"border-t border-dark-border pt-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-200 mb-4",children:"Custom Colors"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(le,{label:"Primary Color (Headers, titles)",value:l.primaryColor||"#143642",onChange:e=>m("primaryColor",e)}),e.jsx(le,{label:"Accent Color (Labels)",value:l.accentColor||"#0F8B8D",onChange:e=>m("accentColor",e)}),e.jsx(le,{label:"Line Color (All lines & borders)",value:l.lineColor||"#143642",onChange:e=>m("lineColor",e)}),e.jsx(le,{label:"Text Color (Body text)",value:l.textColor||"#374151",onChange:e=>m("textColor",e)}),e.jsx(le,{label:"Muted Color (Secondary text)",value:l.mutedColor||"#6B7280",onChange:e=>m("mutedColor",e)})]})]})]}),"fonts"===o&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Font Family"}),e.jsxs("select",{value:l.fontFamily||"Helvetica",onChange:e=>m("fontFamily",e.target.value),className:"input w-full",children:[e.jsx("option",{value:"Helvetica",children:"Helvetica (Clean, Modern)"}),e.jsx("option",{value:"Times-Roman",children:"Times Roman (Classic)"}),e.jsx("option",{value:"Courier",children:"Courier (Monospace)"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Note: PDF fonts are limited to these built-in options for compatibility."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Base Font Size"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"range",min:"8",max:"12",value:l.baseFontSize||10,onChange:e=>m("baseFontSize",parseInt(e.target.value)),className:"flex-1 h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-accent-primary"}),e.jsxs("span",{className:"text-sm text-gray-300 font-mono w-8",children:[l.baseFontSize||10,"pt"]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Controls the body text size. Headers scale proportionally."})]})]}),"display"===o&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Choose what information to show on your PDF quotes."}),[{key:"showLogo",label:"Company Logo"},{key:"showCompanyAddress",label:"Company Address"},{key:"showCompanyPhone",label:"Company Phone"},{key:"showCompanyEmail",label:"Company Email"},{key:"showTaxNumber",label:"Tax Number"},{key:"showBankDetails",label:"Bank Details"}].map(({key:s,label:a})=>e.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-dark-card border border-dark-border hover:border-gray-600 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",checked:!1!==l[s],onChange:e=>m(s,e.target.checked),className:"w-5 h-5 rounded bg-dark-bg border-dark-border text-accent-primary focus:ring-accent-primary"}),e.jsx("span",{className:"text-gray-300",children:a})]},s))]})]})}),e.jsxs("div",{className:"w-80 bg-dark-card border-l border-dark-border p-4 overflow-y-auto",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-200 mb-4",children:"Color Preview"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg overflow-hidden border border-dark-border",style:{backgroundColor:l.backgroundColor||"#FFFFFF"},children:[e.jsx("div",{className:"p-3",style:{backgroundColor:l.primaryColor||"#143642"},children:e.jsx("div",{className:"text-white text-xs font-bold",children:"QUOTE"})}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsx("div",{className:"text-sm font-bold",style:{color:l.primaryColor||"#143642"},children:"Project Title"}),e.jsx("div",{className:"text-xs",style:{color:l.textColor||"#374151"},children:"Body text appears in this color"}),e.jsx("div",{className:"text-xs",style:{color:l.mutedColor||"#6B7280"},children:"Secondary info in muted color"}),e.jsx("div",{className:"text-sm font-bold mt-3 pt-2 border-t",style:{color:l.accentColor||"#0F8B8D",borderColor:(l.accentColor||"#0F8B8D")+"30"},children:"Total: $1,234.00"})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:'Click "Preview PDF" to see how your quote will look with these colors.'})]})]})]})]})}function le({label:s,value:a,onChange:t}){return e.jsxs("div",{children:[e.jsx("label",{className:"label",children:s}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"color",value:a,onChange:e=>t(e.target.value),className:"w-12 h-10 rounded cursor-pointer bg-transparent border border-dark-border"}),e.jsx("input",{type:"text",value:a,onChange:e=>t(e.target.value),placeholder:"#000000",className:"input flex-1 font-mono text-sm"})]})]})}const ne=[{id:"dashboard",label:"Dashboard"},{id:"quotes",label:"Quotes"},{id:"clients",label:"Clients"},{id:"opportunities",label:"Opportunities"},{id:"tasks",label:"Tasks"},{id:"calendar",label:"Calendar"},{id:"rate-card",label:"Rate Card"},{id:"invoices",label:"Invoices"},{id:"projects",label:"Projects"},{id:"crew",label:"Crew"},{id:"kit",label:"Equipment"}];function ie(){const{organization:s,members:t,invitations:r,membersLoading:l,invitationsLoading:n,createInvitation:i,cancelInvitation:j,resendInvitation:y,updateMemberRole:f,removeMember:v,canManageMembers:N,isOwner:w,hasFeatureAccess:k,getSubscriptionLimits:C,error:S,clearError:D}=c(),[P,A]=a.useState(!1),[L,M]=a.useState(""),[T,_]=a.useState("member"),[B,F]=a.useState([]),[E,q]=a.useState(!1),[z,I]=a.useState(null),[G,V]=a.useState(null),[Y,K]=a.useState(null),Q=C(),J=k("add_user"),X=e=>{const s=`${window.location.origin}/invite/${e}`;navigator.clipboard.writeText(s),V(e),setTimeout(()=>V(null),2e3)},ee=s=>{switch(s){case"owner":return e.jsx($,{className:"w-4 h-4 text-yellow-500"});case"admin":return e.jsx(m,{className:"w-4 h-4 text-blue-500"});case"viewer":return e.jsx(H,{className:"w-4 h-4 text-gray-500"});default:return e.jsx(h,{className:"w-4 h-4 text-gray-400"})}};return s?e.jsxs("div",{className:"space-y-8",children:[S&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400",children:[e.jsx(d,{className:"w-4 h-4"}),e.jsx("span",{children:S}),e.jsx("button",{onClick:D,className:"ml-auto",children:e.jsx(o,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Team Members"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.length," of ",-1===Q.users?"unlimited":Q.users," seats used"]})]}),N()&&e.jsxs("button",{onClick:()=>A(!0),disabled:!J,className:"btn-primary flex items-center gap-2 disabled:opacity-50",children:[e.jsx(Z,{className:"w-4 h-4"}),"Invite Member"]})]}),!J&&e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("p",{className:"text-amber-400 text-sm",children:["You've reached the member limit for your plan.",e.jsx("button",{className:"ml-2 underline hover:no-underline",children:"Upgrade to add more members"})]})}),e.jsx("div",{className:"bg-dark-card border border-dark-border rounded-lg overflow-hidden",children:l?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(x,{className:"w-6 h-6 animate-spin text-gray-500"})}):0===t.length?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No team members yet"}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-dark-bg",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Member"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Role"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Joined"}),e.jsx("th",{className:"px-4 py-3"})]})}),e.jsx("tbody",{className:"divide-y divide-dark-border",children:t.map(s=>e.jsxs("tr",{className:"hover:bg-dark-bg/50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-primary/20 flex items-center justify-center text-brand-primary font-medium",children:s.name?.charAt(0)?.toUpperCase()||"?"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-white",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.email})]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[ee(s.role),e.jsx("span",{className:"text-sm text-gray-300 capitalize",children:s.role})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+("active"===s.status?"bg-green-500/10 text-green-400":"pending"===s.status?"bg-amber-500/10 text-amber-400":"bg-gray-500/10 text-gray-400"),children:s.status})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3",children:N()&&"owner"!==s.role&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>K(Y===s.id?null:s.id),className:"p-1 hover:bg-dark-border rounded",children:e.jsx(R,{className:"w-4 h-4 text-gray-500"})}),Y===s.id&&e.jsxs("div",{className:"absolute right-0 mt-1 w-48 bg-dark-card border border-dark-border rounded-lg shadow-lg z-10",children:[w()&&"admin"!==s.role&&e.jsxs("button",{onClick:()=>{f(s.id,"admin"),K(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-dark-border flex items-center gap-2",children:[e.jsx(m,{className:"w-4 h-4"}),"Make Admin"]}),"admin"===s.role&&e.jsxs("button",{onClick:()=>{f(s.id,"member"),K(null)},className:"w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-dark-border flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4"}),"Remove Admin"]}),e.jsxs("button",{onClick:()=>{confirm(`Remove ${s.name} from the organization?`)&&v(s.id),K(null)},className:"w-full px-4 py-2 text-left text-sm text-red-400 hover:bg-dark-border flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"Remove"]})]})]})})]},s.id))})]})}),N()&&r.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-400 mb-3 flex items-center gap-2",children:[e.jsx(u,{className:"w-4 h-4"}),"Pending Invitations (",r.length,")"]}),e.jsx("div",{className:"bg-dark-card border border-dark-border rounded-lg divide-y divide-dark-border",children:r.map(s=>e.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{className:"w-4 h-4 text-gray-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-white",children:s.email}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Expires ",new Date(s.expires_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>X(s.token),className:"p-2 hover:bg-dark-border rounded text-gray-400 hover:text-white",title:"Copy invite link",children:G===s.token?e.jsx(g,{className:"w-4 h-4 text-green-500"}):e.jsx(O,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>y(s.id),className:"p-2 hover:bg-dark-border rounded text-gray-400 hover:text-white",title:"Resend invitation",children:e.jsx(W,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>j(s.id),className:"p-2 hover:bg-dark-border rounded text-gray-400 hover:text-red-400",title:"Cancel invitation",children:e.jsx(U,{className:"w-4 h-4"})})]})]},s.id))})]}),P&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl w-full max-w-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Invite Team Member"}),e.jsx("button",{onClick:()=>{A(!1),I(null)},className:"text-gray-500 hover:text-white",children:e.jsx(o,{className:"w-5 h-5"})})]}),z?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(g,{className:"w-6 h-6 text-green-500"})}),e.jsx("p",{className:"text-white mb-2",children:"Invitation Created!"}),e.jsxs("p",{className:"text-sm text-gray-400 mb-4",children:["Share this link with ",z.email,":"]}),e.jsxs("div",{className:"flex items-center gap-2 bg-dark-bg rounded-lg p-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:`${window.location.origin}/invite/${z.token}`,className:"bg-transparent text-sm text-gray-300 flex-1 outline-none"}),e.jsx("button",{onClick:()=>X(z.token),className:"p-2 hover:bg-dark-border rounded",children:G===z.token?e.jsx(g,{className:"w-4 h-4 text-green-500"}):e.jsx(O,{className:"w-4 h-4 text-gray-400"})})]}),e.jsx("button",{onClick:()=>{A(!1),I(null)},className:"btn-primary mt-6 w-full",children:"Done"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:L,onChange:e=>M(e.target.value),placeholder:"colleague@company.com",className:"input w-full",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Role"}),e.jsx("select",{value:T,onChange:e=>_(e.target.value),className:"input w-full",children:Object.entries(b).map(([s,a])=>"owner"!==s&&e.jsxs("option",{value:s,children:[a.label," - ",a.description]},s))})]}),"member"===T&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-2",children:"Permissions"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:ne.map(s=>e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:B.includes(s.id),onChange:()=>{return e=s.id,void F(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e]);var e},className:"rounded border-dark-border"}),s.label]},s.id))})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>A(!1),className:"btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(!L.trim())return;q(!0);const e=await i(L.trim(),T,B);q(!1),e&&(I(e),M(""),_("member"),F([]))},disabled:!L.trim()||E,className:"btn-primary flex-1 flex items-center justify-center gap-2",children:E?e.jsx(x,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"w-4 h-4"}),"Send Invite"]})})]})]})]})})]}):e.jsx("div",{className:"text-center py-12 text-gray-500",children:"No organization loaded"})}async function ce(){if(!r())throw new Error("Database not configured");const{data:{user:e}}=await l.auth.getUser();if(!e)throw new Error("Not authenticated");const s=c.getState().getOrganizationId(),{data:a,error:t}=await l.from("data_export_requests").insert({organization_id:s,user_id:e.id,status:"pending"}).select().single();if(t)throw t;const n=await async function(e,s){const a={exportedAt:(new Date).toISOString(),user:null,organization:null,quotes:[],clients:[],invoices:[],contacts:[],opportunities:[],settings:null};try{const{data:t}=await l.from("user_profiles").select("*").eq("auth_user_id",e).single();if(t&&(a.user={name:t.name,email:t.email,role:t.role,createdAt:t.created_at}),s){const{data:e}=await l.from("organizations").select("name, slug, created_at").eq("id",s).single();a.organization=e;const{data:t}=await l.from("quotes").select("*").eq("organization_id",s);a.quotes=t||[];const{data:r}=await l.from("clients").select("*").eq("organization_id",s);a.clients=r||[];const{data:n}=await l.from("invoices").select("*").eq("organization_id",s);a.invoices=n||[];const{data:i}=await l.from("contacts").select("*").eq("organization_id",s);a.contacts=i||[];const{data:c}=await l.from("opportunities").select("*").eq("organization_id",s);a.opportunities=c||[];const{data:d}=await l.from("settings").select("company, quote_defaults").eq("organization_id",s).single();a.settings=d}}catch(t){}return a}(e.id,s);return{requestId:a.id,data:n}}async function de(e=""){if(!r())throw new Error("Database not configured");const{data:{user:s}}=await l.auth.getUser();if(!s)throw new Error("Not authenticated");const a=c.getState().getOrganizationId(),{data:t}=await l.from("account_deletion_requests").select("*").eq("user_id",s.id).in("status",["pending","confirmed"]).single();if(t)return{alreadyRequested:!0,request:t};const n=function(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let s="";for(let a=0;a<32;a++)s+=e.charAt(Math.floor(Math.random()*e.length));return s}(),i=new Date;i.setDate(i.getDate()+30);const{data:d,error:o}=await l.from("account_deletion_requests").insert({user_id:s.id,organization_id:a,reason:e,status:"pending",confirmation_token:n,scheduled_deletion_at:i.toISOString()}).select().single();if(o)throw o;return{success:!0,request:d}}function oe(){const[s,t]=a.useState(!1),[n,i]=a.useState(!1),[c,d]=a.useState(!1),[h,p]=a.useState(""),[g,b]=a.useState(!1),[N,w]=a.useState(null),[k,C]=a.useState(null);a.useEffect(()=>{S()},[]);const S=async()=>{const e=await async function(){if(!r())return null;const{data:{user:e}}=await l.auth.getUser();if(!e)return null;const{data:s}=await l.from("account_deletion_requests").select("*").eq("user_id",e.id).in("status",["pending","confirmed"]).single();return s}();w(e)},D=N?.scheduled_deletion_at?Math.ceil((new Date(N.scheduled_deletion_at)-new Date)/864e5):null;return e.jsxs("div",{className:"space-y-8",children:[k&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400",children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{children:k}),e.jsx("button",{onClick:()=>C(null),className:"ml-auto",children:e.jsx(o,{className:"w-4 h-4"})})]}),N&&e.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(j,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-red-400 font-medium",children:"Account Deletion Scheduled"}),e.jsxs("p",{className:"text-sm text-red-400/80 mt-1",children:["Your account is scheduled for deletion in ",e.jsxs("strong",{children:[D," days"]}),"(",new Date(N.scheduled_deletion_at).toLocaleDateString(),")."]}),e.jsx("p",{className:"text-sm text-red-400/80 mt-2",children:"All your data will be permanently deleted. This action cannot be undone."}),e.jsx("button",{onClick:async()=>{try{await async function(){if(!r())throw new Error("Database not configured");const{data:{user:e}}=await l.auth.getUser();if(!e)throw new Error("Not authenticated");const{error:s}=await l.from("account_deletion_requests").update({status:"canceled"}).eq("user_id",e.id).in("status",["pending","confirmed"]);if(s)throw s;return{success:!0}}(),w(null)}catch(e){C(e.message||"Failed to cancel deletion request")}},className:"mt-3 px-4 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg text-sm font-medium",children:"Cancel Deletion Request"})]})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-white mb-4 flex items-center gap-2",children:[e.jsx(m,{className:"w-5 h-5"}),"Data Privacy"]}),e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg divide-y divide-dark-border",children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4 text-gray-500"}),"Export Your Data"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Download a copy of all your data in JSON format. This includes your quotes, clients, invoices, contacts, and settings."})]}),e.jsxs("button",{onClick:async()=>{t(!0),C(null);try{!function(e,s="my-data-export.json"){const a=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(a),r=document.createElement("a");r.href=t,r.download=s,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}((await ce()).data,`productionos-data-export-${(new Date).toISOString().split("T")[0]}.json`),i(!0),setTimeout(()=>i(!1),3e3)}catch(e){C(e.message||"Failed to export data")}finally{t(!1)}},disabled:s,className:"btn-secondary flex items-center gap-2 flex-shrink-0",children:[s?e.jsx(x,{className:"w-4 h-4 animate-spin"}):n?e.jsx(y,{className:"w-4 h-4 text-green-500"}):e.jsx(f,{className:"w-4 h-4"}),s?"Exporting...":n?"Downloaded!":"Export Data"]})]})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"flex items-start",children:e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[e.jsx(u,{className:"w-4 h-4 text-gray-500"}),"Data Retention"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Your data is stored securely and retained as long as your account is active. Deleted quotes and invoices are kept for 30 days before permanent deletion."})]})})})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-red-400 mb-4 flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),"Danger Zone"]}),e.jsx("div",{className:"bg-dark-card border border-red-500/30 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-white font-medium flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4 text-red-500"}),"Delete Account"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Permanently delete your account and all associated data. This action cannot be undone. You will have 30 days to cancel."})]}),e.jsxs("button",{onClick:()=>d(!0),disabled:!!N,className:"btn-secondary border-red-500/30 text-red-400 hover:bg-red-500/10 flex-shrink-0 disabled:opacity-50",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),N?"Deletion Pending":"Delete Account"]})]})})]}),e.jsxs("div",{className:"text-sm text-gray-500 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Your Rights:"})," Under GDPR, you have the right to access, rectify, erase, and port your personal data. You can exercise these rights using the options above."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Data Processing:"})," We process your data to provide our services. For more information, see our Privacy Policy."]})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl w-full max-w-md p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-red-500/20 rounded-full flex items-center justify-center",children:e.jsx(j,{className:"w-5 h-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white",children:"Delete Account"}),e.jsx("p",{className:"text-sm text-gray-500",children:"This action cannot be undone"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3 text-sm text-red-400",children:[e.jsx("p",{className:"font-medium mb-1",children:"Warning: This will permanently delete:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-red-400/80",children:[e.jsx("li",{children:"Your account and profile"}),e.jsx("li",{children:"All quotes, invoices, and contracts"}),e.jsx("li",{children:"All clients and contacts"}),e.jsx("li",{children:"All project data"}),e.jsx("li",{children:"Organization membership"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Why are you leaving? (Optional)"}),e.jsx("textarea",{value:h,onChange:e=>p(e.target.value),placeholder:"Help us improve by sharing your feedback...",className:"input w-full h-24 resize-none"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{children:"Your account will be deleted 30 days from confirmation"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{onClick:()=>d(!1),className:"btn-secondary flex-1",children:"Cancel"}),e.jsxs("button",{onClick:async()=>{b(!0),C(null);try{const e=await de(h);e.alreadyRequested,w(e.request),d(!1),p("")}catch(e){C(e.message||"Failed to request account deletion")}finally{b(!1)}},disabled:g,className:"flex-1 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium flex items-center justify-center gap-2",children:[g?e.jsx(x,{className:"w-4 h-4 animate-spin"}):e.jsx(U,{className:"w-4 h-4"}),"Confirm Deletion"]})]})]})]})})]})}const xe=[{id:"too_expensive",label:"Too expensive"},{id:"not_using",label:"Not using it enough"},{id:"missing_features",label:"Missing features I need"},{id:"switching_competitor",label:"Switching to a competitor"},{id:"project_ended",label:"Project/business ended"},{id:"other",label:"Other reason"}];function me(){const{organization:s,subscription:t,loadSubscription:r}=c(),[l,n]=a.useState(!0),[i,m]=a.useState(null),[u,p]=a.useState(null),[b,y]=a.useState([]),[f,F]=a.useState("monthly"),[E,q]=a.useState(null),[z,I]=a.useState(null),[R,U]=a.useState(!1),[O,W]=a.useState(""),[H,J]=a.useState(""),[Z,X]=a.useState(1),[ee,se]=a.useState(!1),[ae,te]=a.useState(!1);a.useEffect(()=>{re()},[s?.id]);const re=async()=>{if(s?.id){n(!0);try{const[e,a,r]=await Promise.all([N(s.id),w(s.id,t?.plan_id||"free"),k(s.id)]);m(e),p(a),y(r)}catch(e){I(e.message)}finally{n(!1)}}},le=()=>{U(!1),X(1),W(""),J("")},ne=async()=>{if(t?.stripe_subscription_id){te(!0),I(null);try{await B(t.stripe_subscription_id),await r(s.id)}catch(e){I(e.message||"Failed to reactivate subscription")}finally{te(!1)}}},ie=C[t?.plan_id]||C.free,ce=!t||"free"===t.plan_id;return l?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(x,{className:"w-6 h-6 animate-spin text-gray-400"})}):e.jsxs("div",{className:"space-y-8",children:[z&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-500/10 border border-red-500/20 rounded-lg text-red-400",children:[e.jsx(d,{className:"w-4 h-4"}),e.jsx("span",{children:z})]}),u?.warnings?.length>0&&e.jsx("div",{className:"p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(d,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-amber-400 font-medium",children:"Plan Limits"}),e.jsx("ul",{className:"mt-1 space-y-1",children:u.warnings.map((s,a)=>e.jsx("li",{className:"text-sm text-amber-400/80",children:s},a))}),e.jsxs("button",{onClick:()=>document.getElementById("plans-section")?.scrollIntoView({behavior:"smooth"}),className:"mt-2 text-sm text-amber-400 hover:text-amber-300 flex items-center gap-1",children:["Upgrade your plan ",e.jsx(S,{className:"w-3 h-3"})]})]})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-white mb-4 flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5"}),"Current Subscription"]}),e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"text-xl font-semibold text-white",children:ie.name}),ie.popular&&e.jsx("span",{className:"px-2 py-0.5 bg-brand-primary/20 text-brand-primary text-xs rounded-full",children:"Popular"})]}),e.jsx("p",{className:"text-gray-500 mt-1",children:ie.description}),t&&"active"!==t.status&&e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+("trialing"===t.status?"bg-blue-500/20 text-blue-400":"past_due"===t.status?"bg-red-500/20 text-red-400":(t.status,"bg-gray-500/20 text-gray-400")),children:"trialing"===t.status?"Trial":"past_due"===t.status?"Past Due":"canceled"===t.status?"Canceled":t.status})}),t?.current_period_end&&e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:t.cancel_at_period_end?`Cancels on ${new Date(t.current_period_end).toLocaleDateString()}`:`Renews on ${new Date(t.current_period_end).toLocaleDateString()}`})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-white",children:[P(ie.priceMonthly),e.jsx("span",{className:"text-sm text-gray-500 font-normal",children:"/mo"})]}),!ce&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("button",{onClick:async()=>{I(null);try{const{url:e}=await T();e&&(window.location.href=e)}catch(e){I(e.message||"Failed to open billing portal")}},className:"text-sm text-brand-primary hover:text-brand-primary/80 flex items-center gap-1 ml-auto",children:["Manage billing ",e.jsx(Q,{className:"w-3 h-3"})]}),t?.cancel_at_period_end?e.jsxs("button",{onClick:ne,disabled:ae,className:"text-sm text-green-400 hover:text-green-300 flex items-center gap-1 ml-auto",children:[ae?e.jsx(x,{className:"w-3 h-3 animate-spin"}):e.jsx(A,{className:"w-3 h-3"}),"Reactivate subscription"]}):e.jsx("button",{onClick:()=>{X(1),W(""),J(""),U(!0)},className:"text-sm text-gray-500 hover:text-red-400 flex items-center gap-1 ml-auto",children:"Cancel subscription"})]})]})]}),t?.cancel_at_period_end&&e.jsx("div",{className:"mt-4 p-4 bg-amber-500/10 border border-amber-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(j,{className:"w-5 h-5 text-amber-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-amber-400",children:"Subscription Canceling"}),e.jsxs("p",{className:"text-sm text-amber-400/80 mt-1",children:["Your subscription will end on ",new Date(t.current_period_end).toLocaleDateString(),". You'll lose access to ",ie.name," features after this date."]}),e.jsxs("button",{onClick:ne,disabled:ae,className:"mt-2 px-4 py-1.5 bg-amber-500 hover:bg-amber-400 text-black text-sm font-medium rounded flex items-center gap-2",children:[ae?e.jsx(x,{className:"w-4 h-4 animate-spin"}):e.jsx(A,{className:"w-4 h-4"}),"Keep My Subscription"]})]})]})}),i&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-dark-border grid grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-sm mb-1",children:[e.jsx(G,{className:"w-4 h-4"}),"Quotes This Month"]}),e.jsxs("div",{className:"text-xl font-semibold text-white",children:[i.quotesThisMonth,-1!==ie.limits.quotesPerMonth&&e.jsxs("span",{className:"text-gray-500 text-sm font-normal",children:["/",ie.limits.quotesPerMonth]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-sm mb-1",children:[e.jsx(L,{className:"w-4 h-4"}),"Clients"]}),e.jsxs("div",{className:"text-xl font-semibold text-white",children:[i.clientCount,-1!==ie.limits.clients&&e.jsxs("span",{className:"text-gray-500 text-sm font-normal",children:["/",ie.limits.clients]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-sm mb-1",children:[e.jsx(h,{className:"w-4 h-4"}),"Team Members"]}),e.jsxs("div",{className:"text-xl font-semibold text-white",children:[i.teamMemberCount,-1!==ie.limits.teamMembers&&e.jsxs("span",{className:"text-gray-500 text-sm font-normal",children:["/",ie.limits.teamMembers]})]})]})]})]})]}),e.jsxs("div",{id:"plans-section",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-white flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5"}),"Available Plans"]}),e.jsxs("div",{className:"flex items-center gap-2 bg-dark-card border border-dark-border rounded-lg p-1",children:[e.jsx("button",{onClick:()=>F("monthly"),className:"px-3 py-1.5 rounded text-sm font-medium transition-colors "+("monthly"===f?"bg-brand-primary text-white":"text-gray-400 hover:text-white"),children:"Monthly"}),e.jsxs("button",{onClick:()=>F("yearly"),className:"px-3 py-1.5 rounded text-sm font-medium transition-colors "+("yearly"===f?"bg-brand-primary text-white":"text-gray-400 hover:text-white"),children:["Yearly",e.jsx("span",{className:"ml-1 text-xs text-green-400",children:"Save 17%"})]})]})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.values(C).map(s=>{const a=ie.id===s.id,t="yearly"===f?s.priceYearly/12:s.priceMonthly;return e.jsxs("div",{className:"relative bg-dark-card border rounded-lg p-5 "+(s.popular?"border-brand-primary ring-1 ring-brand-primary":"border-dark-border"),children:[s.popular&&e.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 px-3 py-0.5 bg-brand-primary text-white text-xs font-medium rounded-full",children:"Most Popular"}),e.jsx("h4",{className:"text-lg font-semibold text-white",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s.description}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-3xl font-bold text-white",children:P(t)}),e.jsx("span",{className:"text-gray-500",children:"/mo"}),"yearly"===f&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Billed ",P(s.priceYearly)," yearly"]})]}),e.jsx("ul",{className:"mt-4 space-y-2",children:s.features.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-300",children:[e.jsx(g,{className:"w-4 h-4 text-green-500 flex-shrink-0 mt-0.5"}),s]},a))}),e.jsx("div",{className:"mt-6",children:a?e.jsx("button",{disabled:!0,className:"w-full px-4 py-2 bg-gray-700 text-gray-400 rounded-lg text-sm font-medium cursor-not-allowed",children:"Current Plan"}):"free"===s.id?e.jsx("button",{disabled:!0,className:"w-full px-4 py-2 bg-gray-700 text-gray-400 rounded-lg text-sm font-medium cursor-not-allowed",children:"Free Forever"}):e.jsxs("button",{onClick:()=>(async e=>{if(!E){q(e),I(null);try{const{url:s}=await M(e,f);s&&(window.location.href=s)}catch(s){I(s.message||"Failed to start checkout"),q(null)}}})(s.id),disabled:E===s.id,className:"w-full px-4 py-2 rounded-lg text-sm font-medium flex items-center justify-center gap-2 "+(s.popular?"bg-brand-primary hover:bg-brand-primary/90 text-white":"bg-dark-bg hover:bg-dark-nav text-white border border-dark-border"),children:[E===s.id?e.jsx(x,{className:"w-4 h-4 animate-spin"}):e.jsx(V,{className:"w-4 h-4"}),E===s.id?"Processing...":"Upgrade"]})})]},s.id)})})]}),b.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-white mb-4 flex items-center gap-2",children:[e.jsx(v,{className:"w-5 h-5"}),"Invoice History"]}),e.jsx("div",{className:"bg-dark-card border border-dark-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-border",children:[e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-400",children:"Date"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-400",children:"Description"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-400",children:"Amount"}),e.jsx("th",{className:"text-left px-4 py-3 text-sm font-medium text-gray-400",children:"Status"}),e.jsx("th",{className:"text-right px-4 py-3 text-sm font-medium text-gray-400"})]})}),e.jsx("tbody",{children:b.map(s=>e.jsxs("tr",{className:"border-b border-dark-border last:border-0",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:new Date(s.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm text-white",children:s.description||"Subscription"}),e.jsx("td",{className:"px-4 py-3 text-sm text-white",children:P(s.amount/100,s.currency)}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium "+("paid"===s.status?"bg-green-500/20 text-green-400":"open"===s.status?"bg-amber-500/20 text-amber-400":"bg-gray-500/20 text-gray-400"),children:s.status})}),e.jsx("td",{className:"px-4 py-3 text-right",children:s.invoice_pdf&&e.jsx("a",{href:s.invoice_pdf,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-brand-primary hover:text-brand-primary/80",children:"Download"})})]},s.id))})]})})]}),e.jsxs("div",{className:"text-sm text-gray-500 space-y-1",children:[e.jsx("p",{children:"All prices are in USD. Payments are processed securely by Stripe."}),e.jsxs("p",{children:["Need a custom plan? ",e.jsx("a",{href:"mailto:sales@productionos.com",className:"text-brand-primary hover:underline",children:"Contact our sales team"})]})]}),R&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-lg w-full max-w-md mx-4 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-border",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white",children:[1===Z&&"Why are you canceling?",2===Z&&"Any additional feedback?",3===Z&&"Confirm Cancellation"]}),e.jsx("button",{onClick:le,className:"text-gray-400 hover:text-white",children:e.jsx(o,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4",children:[1===Z&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"We're sorry to see you go. Please let us know why you're canceling so we can improve."}),xe.map(s=>e.jsxs("label",{className:"flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-colors "+(O===s.id?"border-brand-primary bg-brand-primary/10":"border-dark-border hover:border-gray-600"),children:[e.jsx("input",{type:"radio",name:"cancelReason",value:s.id,checked:O===s.id,onChange:e=>W(e.target.value),className:"sr-only"}),e.jsx("div",{className:"w-4 h-4 rounded-full border-2 flex items-center justify-center "+(O===s.id?"border-brand-primary":"border-gray-500"),children:O===s.id&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-brand-primary"})}),e.jsx("span",{className:"text-white",children:s.label})]},s.id))]}),2===Z&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Is there anything else you'd like to share? Your feedback helps us improve."}),e.jsx("textarea",{value:H,onChange:e=>J(e.target.value),placeholder:"Tell us more (optional)...",rows:4,className:"w-full bg-dark-bg border border-dark-border rounded-lg px-3 py-2 text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-brand-primary"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[e.jsx(Y,{className:"w-4 h-4"}),"Your feedback is confidential and helps us improve"]})]}),3===Z&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-red-500/10 border border-red-500/20 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(K,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-red-400",children:"Are you sure you want to cancel?"}),e.jsx("p",{className:"text-sm text-red-400/80 mt-1",children:"You'll lose access to these features:"})]})]})}),e.jsx("ul",{className:"space-y-2 text-sm",children:ie.features.slice(0,5).map((s,a)=>e.jsxs("li",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(K,{className:"w-4 h-4 text-red-500"}),s]},a))}),e.jsx("div",{className:"p-3 bg-dark-bg rounded-lg text-sm",children:e.jsxs("p",{className:"text-gray-400",children:["Your subscription will remain active until"," ",e.jsx("span",{className:"text-white font-medium",children:t?.current_period_end?new Date(t.current_period_end).toLocaleDateString():"the end of your billing period"}),". After that, you'll be moved to the Free plan."]})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-dark-border bg-dark-bg/50",children:[Z>1?e.jsx("button",{onClick:()=>X(Z-1),className:"px-4 py-2 text-gray-400 hover:text-white text-sm",children:"Back"}):e.jsx("button",{onClick:le,className:"px-4 py-2 text-gray-400 hover:text-white text-sm",children:"Never mind"}),Z<3?e.jsx("button",{onClick:()=>X(Z+1),disabled:1===Z&&!O,className:"px-4 py-2 bg-brand-primary hover:bg-brand-primary/90 text-white text-sm font-medium rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:"Continue"}):e.jsxs("button",{onClick:async()=>{if(t?.stripe_subscription_id){se(!0),I(null);try{await _(t.stripe_subscription_id),await r(s.id),le()}catch(e){I(e.message||"Failed to cancel subscription")}finally{se(!1)}}},disabled:ee,className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white text-sm font-medium rounded-lg flex items-center gap-2",children:[ee?e.jsx(x,{className:"w-4 h-4 animate-spin"}):e.jsx(K,{className:"w-4 h-4"}),ee?"Canceling...":"Cancel Subscription"]})]})]})})]})}const he=[{id:"company",label:"Company"},{id:"tax",label:"Tax & Legal"},{id:"bank",label:"Bank Details"},{id:"users",label:"Users"},{id:"team",label:"Team"},{id:"billing",label:"Billing"},{id:"integrations",label:"Integrations"},{id:"quote",label:"Quote Defaults"},{id:"terms",label:"Terms & Conditions"},{id:"customize",label:"Customization"},{id:"pdf",label:"PDF Options"},{id:"invoice",label:"Quote Templates"},{id:"ai",label:"AI Features"},{id:"activity",label:"Activity Log"},{id:"privacy",label:"Privacy & Data"}];function ue(){const{isAdmin:s,user:t,refreshProfile:n}=q(),[i,c]=a.useState([]),[d,o]=a.useState(!0),[x,m]=a.useState(null),[h,u]=a.useState(!1),[p,g]=a.useState(null),[b,j]=a.useState(!1),[y,f]=a.useState(!1),[v,N]=a.useState({name:"",email:"",password:"",role:"user",tabPermissions:[...ae]}),[w,k]=a.useState({newPassword:"",confirmPassword:""});a.useEffect(()=>{C()},[]);const C=async()=>{try{o(!0);const e=await async function(){if(!r())return[];const{data:e,error:s}=await l.from("user_profiles").select("*").order("created_at",{ascending:!0});if(s)throw s;return e.map(e=>({id:e.id,authUserId:e.auth_user_id,name:e.name,email:e.email,role:e.role,status:e.status||"active",tabPermissions:e.tab_permissions||[],createdAt:e.created_at,updatedAt:e.updated_at}))}();c(e),m(null)}catch(e){m(e.message)}finally{o(!1)}},S=async e=>{if(confirm("Are you sure you want to delete this user? This cannot be undone."))try{f(!0),await async function(e){if(!r())throw new Error("Supabase not configured");const{data:s,error:a}=await l.functions.invoke("delete-user",{body:{authUserId:e}});if(a)throw new Error(a.message||"Failed to delete user");if(s?.error)throw new Error(s.error);return!0}(e),await C()}catch(s){m(s.message)}finally{f(!1)}},D=async e=>{try{f(!0),await async function(e,s=ae){return X(e,{status:"active",tabPermissions:s})}(e),await C()}catch(s){m(s.message)}finally{f(!1)}},P=(e,s,a)=>{s.includes(e)?a(s.filter(s=>s!==e)):a([...s,e])};return d?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-accent-primary border-t-transparent rounded-full"})}):e.jsxs("div",{className:"max-w-4xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100",children:"User Management"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage team access and permissions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>j(!0),className:"btn-ghost text-sm",children:"Change My Password"}),s()&&e.jsx("button",{onClick:()=>u(!0),className:"btn-primary text-sm",children:"+ Add User"})]})]}),x&&e.jsxs("div",{className:"mb-4 p-3 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),x,e.jsx("button",{onClick:()=>m(null),className:"ml-auto text-red-400 hover:text-red-300",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.filter(e=>"pending"===e.status).length>0&&s()&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),e.jsx("h4",{className:"text-sm font-semibold text-yellow-400",children:"Pending Approval"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",i.filter(e=>"pending"===e.status).length,")"]})]}),e.jsx("div",{className:"space-y-2",children:i.filter(e=>"pending"===e.status).map(s=>{const a=s.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2);return e.jsx("div",{className:"card p-4 border-yellow-500/30 bg-yellow-500/5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-white bg-gradient-to-br from-yellow-600 to-orange-600 opacity-60",children:a}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-200",children:s.name}),e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-yellow-500/20 text-yellow-400 font-medium",children:"PENDING"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email}),e.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Requested access on ",new Date(s.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>D(s.id),disabled:y,className:"px-3 py-1.5 text-sm bg-green-500/20 text-green-400 hover:bg-green-500/30 rounded-lg transition-colors",children:"Approve"}),e.jsx("button",{onClick:()=>S(s.authUserId),disabled:y,className:"px-3 py-1.5 text-sm bg-red-500/20 text-red-400 hover:bg-red-500/30 rounded-lg transition-colors",children:"Reject"})]})]})},s.id)})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-400",children:"Active Users"}),i.filter(e=>"active"===e.status||!e.status).map(a=>{const r=a.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2),l=a.id===t?.profile?.id,n=a.tabPermissions?.length||0;return e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-white "+("admin"===a.role?"bg-gradient-to-br from-amber-500 to-orange-600":"bg-gradient-to-br from-accent-primary to-accent-secondary"),children:r}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-200",children:a.name}),"admin"===a.role&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-amber-500/20 text-amber-400 font-medium",children:"ADMIN"}),l&&e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-accent-primary/20 text-accent-primary font-medium",children:"YOU"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:a.email}),e.jsx("div",{className:"flex items-center gap-1 mt-1",children:e.jsx("span",{className:"text-xs text-gray-600",children:"admin"===a.role?"All tabs":`${n} tab${1!==n?"s":""}`})})]})]}),s()&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>g(a),className:"p-2 text-gray-500 hover:text-gray-300 hover:bg-white/5 rounded-lg transition-colors",title:"Edit user",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),!l&&e.jsx("button",{onClick:()=>S(a.authUserId),className:"p-2 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Delete user",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},a.id)}),i.filter(e=>"suspended"===e.status).length>0&&s()&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-500 mt-6",children:"Suspended Users"}),i.filter(e=>"suspended"===e.status).map(s=>{const a=s.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2);return e.jsx("div",{className:"card p-4 opacity-60",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center font-bold text-white bg-gray-600",children:a}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-400",children:s.name}),e.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-red-500/20 text-red-400 font-medium",children:"SUSPENDED"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:s.email})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>D(s.id),disabled:y,className:"px-3 py-1.5 text-sm bg-green-500/20 text-green-400 hover:bg-green-500/30 rounded-lg transition-colors",children:"Reactivate"}),e.jsx("button",{onClick:()=>S(s.authUserId),disabled:y,className:"p-2 text-gray-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})},s.id)})]}),0===i.length&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"No users found"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create your first user to get started"})]})]}),h&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#1a1f2e] border border-dark-border rounded-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsx("h4",{className:"text-lg font-bold text-gray-100",children:"Create New User"})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{type:"text",value:v.name,onChange:e=>N({...v,name:e.target.value}),className:"input w-full",placeholder:"Full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email *"}),e.jsx("input",{type:"email",value:v.email,onChange:e=>N({...v,email:e.target.value}),className:"input w-full",placeholder:"user@company.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Password *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:v.password,onChange:e=>N({...v,password:e.target.value}),className:"input flex-1",placeholder:"Initial password"}),e.jsx("button",{type:"button",onClick:()=>N({...v,password:ee()}),className:"btn-ghost text-sm",children:"Generate"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Role"}),e.jsxs("select",{value:v.role,onChange:e=>N({...v,role:e.target.value}),className:"input w-full",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Administrator"})]})]}),"admin"!==v.role&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tab Permissions"}),e.jsx("div",{className:"space-y-2 p-3 bg-dark-bg rounded-lg",children:se.filter(e=>"settings"!==e.id).map(s=>e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:v.tabPermissions.includes(s.id),onChange:()=>P(s.id,v.tabPermissions,e=>N({...v,tabPermissions:e})),className:"w-4 h-4 rounded bg-dark-card border-dark-border text-accent-primary focus:ring-accent-primary"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-300",children:s.label}),e.jsx("p",{className:"text-xs text-gray-600",children:s.description})]})]},s.id))})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>u(!1),className:"btn-ghost",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(v.name&&v.email&&v.password)try{f(!0),await async function({email:e,password:s,name:a,role:t,tabPermissions:n}){if(!r())throw new Error("Supabase not configured");const{data:i,error:c}=await l.functions.invoke("create-user",{body:{email:e,password:s,name:a,role:t,tabPermissions:n}});if(c)throw new Error(c.message||"Failed to create user");if(i?.error)throw new Error(i.error);return i.user}(v),await C(),u(!1),N({name:"",email:"",password:"",role:"user",tabPermissions:[...ae]})}catch(e){m(e.message)}finally{f(!1)}else m("Name, email, and password are required")},disabled:y,className:"btn-primary",children:y?"Creating...":"Create User"})]})]})}),p&&e.jsx(pe,{user:p,onClose:()=>g(null),onSave:async(e,s)=>{try{f(!0),await X(e,s),await C(),g(null),e===t?.profile?.id&&await n()}catch(a){m(a.message)}finally{f(!1)}},saving:y,togglePermission:P}),b&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#1a1f2e] border border-dark-border rounded-xl w-full max-w-sm",children:[e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsx("h4",{className:"text-lg font-bold text-gray-100",children:"Change Password"})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"New Password"}),e.jsx("input",{type:"password",value:w.newPassword,onChange:e=>k({...w,newPassword:e.target.value}),className:"input w-full",placeholder:"Enter new password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Confirm Password"}),e.jsx("input",{type:"password",value:w.confirmPassword,onChange:e=>k({...w,confirmPassword:e.target.value}),className:"input w-full",placeholder:"Confirm new password"})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>j(!1),className:"btn-ghost",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(w.newPassword===w.confirmPassword)if(w.newPassword.length<6)m("Password must be at least 6 characters");else try{f(!0),await async function(e){if(!r())throw new Error("Supabase not configured");const{error:s}=await l.auth.updateUser({password:e});if(s)throw s;return!0}(w.newPassword),j(!1),k({newPassword:"",confirmPassword:""}),m(null),alert("Password changed successfully")}catch(e){m(e.message)}finally{f(!1)}else m("Passwords do not match")},disabled:y,className:"btn-primary",children:y?"Changing...":"Change Password"})]})]})})]})}function pe({user:s,onClose:t,onSave:r,saving:l,togglePermission:n}){const[i,c]=a.useState({name:s.name,role:s.role,tabPermissions:[...s.tabPermissions||[]]});return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#1a1f2e] border border-dark-border rounded-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b border-dark-border",children:[e.jsx("h4",{className:"text-lg font-bold text-gray-100",children:"Edit User"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name"}),e.jsx("input",{type:"text",value:i.name,onChange:e=>c({...i,name:e.target.value}),className:"input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Role"}),e.jsxs("select",{value:i.role,onChange:e=>c({...i,role:e.target.value}),className:"input w-full",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Administrator"})]})]}),"admin"!==i.role&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tab Permissions"}),e.jsx("div",{className:"space-y-2 p-3 bg-dark-bg rounded-lg",children:se.filter(e=>"settings"!==e.id).map(s=>e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.tabPermissions.includes(s.id),onChange:()=>n(s.id,i.tabPermissions,e=>c({...i,tabPermissions:e})),className:"w-4 h-4 rounded bg-dark-card border-dark-border text-accent-primary focus:ring-accent-primary"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-300",children:s.label}),e.jsx("p",{className:"text-xs text-gray-600",children:s.description})]})]},s.id))})]})]}),e.jsxs("div",{className:"p-4 border-t border-dark-border flex justify-end gap-2",children:[e.jsx("button",{onClick:t,className:"btn-ghost",children:"Cancel"}),e.jsx("button",{onClick:()=>r(s.id,i),disabled:l,className:"btn-primary",children:l?"Saving...":"Save Changes"})]})]})})}function ge(){const{connections:s,activeConnection:t,isConnecting:r,connectionError:l,connectGoogle:n,connectMicrosoft:i,disconnectAccount:c,initialize:d}=z(),{msSyncStatus:o,googleSyncStatus:x,isSyncing:m,connectMicrosoft:h,disconnectMicrosoft:u,syncFromMicrosoft:p,connectGoogle:g,disconnectGoogle:b,syncFromGoogle:j,initialize:y}=I();a.useEffect(()=>{d(),y()},[]);const f=s?.filter(e=>"active"===e.status)||[];return e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-2",children:"Integrations"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Connect your email and calendar accounts for syncing."}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h4",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email Accounts"]}),l&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3 mb-4 text-red-400 text-sm",children:l}),f.length>0&&e.jsx("div",{className:"space-y-2 mb-4",children:f.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-dark-card border border-dark-border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:["microsoft"===s.provider?e.jsx("div",{className:"w-8 h-8 rounded flex items-center justify-center bg-[#0078D4]/20",children:e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 21 21",children:[e.jsx("rect",{x:"1",y:"1",width:"9",height:"9",fill:"#f25022"}),e.jsx("rect",{x:"1",y:"11",width:"9",height:"9",fill:"#00a4ef"}),e.jsx("rect",{x:"11",y:"1",width:"9",height:"9",fill:"#7fba00"}),e.jsx("rect",{x:"11",y:"11",width:"9",height:"9",fill:"#ffb900"})]})}):e.jsx("div",{className:"w-8 h-8 rounded flex items-center justify-center bg-red-500/20",children:e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"}),e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white",children:s.email}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-400",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-green-400"}),"Connected"]})]})]}),e.jsx("button",{onClick:()=>c(s.id),className:"text-sm text-red-400 hover:text-red-300",children:"Disconnect"})]},s.id))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:n,disabled:r,className:"flex items-center gap-2 px-4 py-2.5 bg-white text-gray-900 rounded-lg hover:bg-gray-100 transition-colors font-medium",children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),r?"Connecting...":"Add Gmail"]}),e.jsxs("button",{onClick:i,disabled:r,className:"flex items-center gap-2 px-4 py-2.5 bg-[#0078D4] text-white rounded-lg hover:bg-[#106EBE] transition-colors font-medium",children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 21 21",children:[e.jsx("rect",{x:"1",y:"1",width:"9",height:"9",fill:"#f25022"}),e.jsx("rect",{x:"1",y:"11",width:"9",height:"9",fill:"#00a4ef"}),e.jsx("rect",{x:"11",y:"1",width:"9",height:"9",fill:"#7fba00"}),e.jsx("rect",{x:"11",y:"11",width:"9",height:"9",fill:"#ffb900"})]}),r?"Connecting...":"Add Outlook"]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Calendar Sync"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 bg-dark-card border border-dark-border rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded flex items-center justify-center bg-red-500/20",children:e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"}),e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:"Google Calendar"}),e.jsx("p",{className:"text-xs "+("connected"===x?"text-green-400":"text-gray-500"),children:"connected"===x?"Connected":"Not connected"})]})]})}),e.jsx("div",{className:"flex gap-2",children:"connected"===x?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:j,disabled:m,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white hover:bg-dark-nav transition-colors",children:m?"Syncing...":"Sync Now"}),e.jsx("button",{onClick:b,className:"px-3 py-2 text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:"Disconnect"})]}):e.jsx("button",{onClick:g,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-white text-gray-900 rounded-lg hover:bg-gray-100 transition-colors",children:"Connect Google Calendar"})})]}),e.jsxs("div",{className:"p-4 bg-dark-card border border-dark-border rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded flex items-center justify-center bg-[#0078D4]/20",children:e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 21 21",children:[e.jsx("rect",{x:"1",y:"1",width:"9",height:"9",fill:"#f25022"}),e.jsx("rect",{x:"1",y:"11",width:"9",height:"9",fill:"#00a4ef"}),e.jsx("rect",{x:"11",y:"1",width:"9",height:"9",fill:"#7fba00"}),e.jsx("rect",{x:"11",y:"11",width:"9",height:"9",fill:"#ffb900"})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:"Microsoft Calendar"}),e.jsx("p",{className:"text-xs "+("connected"===o?"text-green-400":"text-gray-500"),children:"connected"===o?"Connected":"Not connected"})]})]})}),e.jsx("div",{className:"flex gap-2",children:"connected"===o?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:p,disabled:m,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-dark-bg border border-dark-border rounded-lg text-white hover:bg-dark-nav transition-colors",children:m?"Syncing...":"Sync Now"}),e.jsx("button",{onClick:u,className:"px-3 py-2 text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:"Disconnect"})]}):e.jsx("button",{onClick:h,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-[#0078D4] text-white rounded-lg hover:bg-[#106EBE] transition-colors",children:"Connect Microsoft Calendar"})})]})]})]})]})}function be(){const{settings:s,setCompanyInfo:t,setTaxInfo:r,setTaxConfig:l,setBankDetails:i,setQuoteDefaults:c,setPdfOptions:d,setAiSettings:o,addUser:x,updateUser:m,deleteUser:h,addProjectType:u,updateProjectType:p,deleteProjectType:g,moveProjectType:b,addRegion:j,updateRegion:y,deleteRegion:f,moveRegion:v,setPreferredCurrencies:N,clearActivityLog:w,exportActivityLog:k}=n(),[C,S]=a.useState("company"),[D,P]=a.useState(!1),[A,L]=a.useState({name:"",email:""}),[M,T]=a.useState(""),[_,B]=a.useState({label:"",currency:"USD"}),[q,z]=a.useState({}),[I,R]=a.useState({}),[U,O]=a.useState(!1),W=a.useRef(null),H=()=>{O(!0),W.current&&clearTimeout(W.current),W.current=setTimeout(()=>O(!1),2e3)};a.useEffect(()=>()=>{W.current&&clearTimeout(W.current)},[]);const G=e=>{t(e),H()},V=e=>{r(e),H()},Y=e=>{i(e),H()},K=e=>{c(e),H()},$=e=>{o(e),H()};return e.jsxs("div",{className:"h-[calc(100vh-60px)] flex flex-col md:flex-row",children:[e.jsxs("div",{className:"md:hidden bg-dark-card border-b border-dark-border p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-100",children:"Settings"}),U&&e.jsxs("span",{className:"text-xs text-green-400 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]})]}),e.jsx("div",{className:"flex gap-1 overflow-x-auto pb-2 -mx-3 px-3",children:he.map(s=>e.jsx("button",{onClick:()=>S(s.id),className:"flex-shrink-0 px-3 py-2 rounded-lg text-sm transition-colors min-h-[40px] "+(C===s.id?"bg-accent-primary/20 text-accent-primary":"text-gray-400 hover:bg-white/5 hover:text-gray-200"),children:s.label},s.id))})]}),e.jsxs("div",{className:"hidden md:block w-48 bg-dark-card border-r border-dark-border p-4 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-100",children:"Settings"}),U&&e.jsxs("span",{className:"text-xs text-green-400 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]})]}),e.jsx("nav",{className:"space-y-1",children:he.map(s=>e.jsx("button",{onClick:()=>S(s.id),className:"w-full text-left px-3 py-2 rounded-lg text-sm transition-colors min-h-[44px] "+(C===s.id?"bg-accent-primary/20 text-accent-primary":"text-gray-400 hover:bg-white/5 hover:text-gray-200"),children:s.label},s.id))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:["company"===C&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"Company Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company Logo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-32 h-16 bg-dark-card border border-dark-border rounded-lg flex items-center justify-center overflow-hidden",children:s.company.logo?e.jsx("img",{src:s.company.logo,alt:"Company logo",className:"max-w-full max-h-full object-contain"}):e.jsx("span",{className:"text-gray-500 text-xs",children:"No logo"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{className:"btn-secondary text-sm cursor-pointer",children:["Upload Logo",e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{const s=e.target.files?.[0];if(s){const e=new FileReader;e.onload=e=>{G({logo:e.target.result})},e.readAsDataURL(s)}}})]}),s.company.logo&&e.jsx("button",{onClick:()=>G({logo:null}),className:"text-xs text-red-400 hover:text-red-300",children:"Remove"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Recommended: PNG or SVG, max 200x100px"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company Name"}),e.jsx("input",{type:"text",value:s.company.name,onChange:e=>G({name:e.target.value}),className:"input",placeholder:"Your Company Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Address"}),e.jsx("textarea",{value:s.company.address,onChange:e=>G({address:e.target.value}),className:"input resize-none",rows:2,placeholder:"Street address"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{type:"text",value:s.company.city,onChange:e=>G({city:e.target.value}),className:"input",placeholder:"City"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Country"}),e.jsx("input",{type:"text",value:s.company.country,onChange:e=>G({country:e.target.value}),className:"input",placeholder:"Country"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone"}),e.jsx("input",{type:"tel",value:s.company.phone,onChange:e=>G({phone:e.target.value}),className:"input",placeholder:"+60 3 1234 5678"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{type:"email",value:s.company.email,onChange:e=>G({email:e.target.value}),className:"input",placeholder:"info@company.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Website"}),e.jsx("input",{type:"url",value:s.company.website,onChange:e=>G({website:e.target.value}),className:"input",placeholder:"https://www.company.com"})]})]})]}),"tax"===C&&e.jsxs("div",{className:"max-w-3xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"Tax & Legal Information"}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 border-b border-dark-border pb-2",children:"Business Registration"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tax Registration Number"}),e.jsx("input",{type:"text",value:s.taxInfo.taxNumber,onChange:e=>V({taxNumber:e.target.value}),className:"input",placeholder:"e.g. GST-123456789"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Business Registration Number"}),e.jsx("input",{type:"text",value:s.taxInfo.registrationNumber,onChange:e=>V({registrationNumber:e.target.value}),className:"input",placeholder:"e.g. 123456-A"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Licenses / Certifications"}),e.jsx("textarea",{value:s.taxInfo.licenses,onChange:e=>V({licenses:e.target.value}),className:"input resize-none",rows:2,placeholder:"List any relevant licenses or certifications"})]})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 border-b border-dark-border pb-2",children:"Tax Configuration"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Configure how tax is calculated and displayed on invoices"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Home Country"}),e.jsx("select",{value:s.taxConfig?.homeCountry||"MY",onChange:e=>l({homeCountry:e.target.value}),className:"input",children:Object.entries(F).map(([s,a])=>e.jsx("option",{value:s,children:a.name},s))})]}),e.jsx("div",{className:"flex items-center pt-6",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.taxConfig?.taxRegistered??!0,onChange:e=>l({taxRegistered:e.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-dark-bg text-accent-primary focus:ring-accent-primary"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Registered for tax collection"})]})})]}),s.taxConfig?.taxRegistered&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Domestic Tax Name"}),e.jsx("input",{type:"text",value:s.taxConfig?.domesticTaxName||"VAT",onChange:e=>l({domesticTaxName:e.target.value}),className:"input",placeholder:"VAT, GST, SST, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Domestic Tax Rate (%)"}),e.jsx("input",{type:"number",value:s.taxConfig?.domesticTaxRate||0,onChange:e=>l({domesticTaxRate:parseFloat(e.target.value)||0}),className:"input",min:"0",max:"100",step:"0.1"})]}),e.jsx("div",{className:"flex items-center pt-6",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.taxConfig?.showTaxBreakdown??!0,onChange:e=>l({showTaxBreakdown:e.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-dark-bg text-accent-primary focus:ring-accent-primary"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Show tax breakdown"})]})})]}),e.jsxs("div",{className:"p-4 bg-dark-bg/50 rounded-lg border border-dark-border",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-300 mb-3",children:"International Invoicing"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.taxConfig?.applyTaxToInternational??!1,onChange:e=>l({applyTaxToInternational:e.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-dark-bg text-accent-primary focus:ring-accent-primary"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Charge tax on international invoices"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.taxConfig?.reverseChargeEnabled??!0,onChange:e=>l({reverseChargeEnabled:e.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-dark-bg text-accent-primary focus:ring-accent-primary"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Enable reverse charge for EU B2B"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.taxConfig?.requireClientTaxId??!1,onChange:e=>l({requireClientTaxId:e.target.checked}),className:"w-4 h-4 rounded border-gray-600 bg-dark-bg text-accent-primary focus:ring-accent-primary"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Require client VAT/Tax ID for B2B invoices"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 border-b border-dark-border pb-2",children:"Invoice Wording"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Customize the text that appears on invoices for different tax scenarios"}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reverse Charge Text"}),e.jsx("textarea",{value:s.taxConfig?.reverseChargeText||"",onChange:e=>l({reverseChargeText:e.target.value}),className:"input resize-none text-sm",rows:2,placeholder:"Reverse charge: VAT to be accounted for by the recipient..."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shown on B2B invoices to EU countries where reverse charge applies"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Export Services Text"}),e.jsx("textarea",{value:s.taxConfig?.exportServicesText||"",onChange:e=>l({exportServicesText:e.target.value}),className:"input resize-none text-sm",rows:2,placeholder:"Export of services - zero rated for VAT purposes"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Shown on invoices to countries outside your tax jurisdiction"})]})]})]}),"bank"===C&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"Bank Details"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"These details will appear on your invoices. Fill in the fields relevant to your country."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bank Name"}),e.jsx("input",{type:"text",value:s.bankDetails.bankName,onChange:e=>Y({bankName:e.target.value}),className:"input",placeholder:"e.g. Maybank, HSBC, Barclays"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Default Currency"}),e.jsx("select",{value:s.bankDetails.currency,onChange:e=>Y({currency:e.target.value}),className:"input",children:E.map(s=>e.jsxs("option",{value:s.code,children:[s.code," - ",s.name]},s.code))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bank Address"}),e.jsx("textarea",{value:s.bankDetails.bankAddress||"",onChange:e=>Y({bankAddress:e.target.value}),className:"input resize-none",rows:2,placeholder:"Bank branch address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Account Name"}),e.jsx("input",{type:"text",value:s.bankDetails.accountName,onChange:e=>Y({accountName:e.target.value}),className:"input",placeholder:"Account holder name (as it appears on the account)"})]}),e.jsxs("div",{className:"border-t border-dark-border pt-4 mt-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-3",children:"Account Numbers"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Account Number"}),e.jsx("input",{type:"text",value:s.bankDetails.accountNumber,onChange:e=>Y({accountNumber:e.target.value}),className:"input",placeholder:"1234567890"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Sort Code ",e.jsx("span",{className:"text-gray-500",children:"(UK)"})]}),e.jsx("input",{type:"text",value:s.bankDetails.sortCode||"",onChange:e=>Y({sortCode:e.target.value}),className:"input",placeholder:"12-34-56"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["IBAN ",e.jsx("span",{className:"text-gray-500",children:"(International)"})]}),e.jsx("input",{type:"text",value:s.bankDetails.iban||"",onChange:e=>Y({iban:e.target.value}),className:"input",placeholder:"GB82 WEST 1234 5698 7654 32"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"SWIFT/BIC Code"}),e.jsx("input",{type:"text",value:s.bankDetails.swiftCode,onChange:e=>Y({swiftCode:e.target.value}),className:"input",placeholder:"MBBEMYKL"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Routing Number ",e.jsx("span",{className:"text-gray-500",children:"(US)"})]}),e.jsx("input",{type:"text",value:s.bankDetails.routingNumber||"",onChange:e=>Y({routingNumber:e.target.value}),className:"input",placeholder:"123456789"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Branch Code"}),e.jsx("input",{type:"text",value:s.bankDetails.branchCode||"",onChange:e=>Y({branchCode:e.target.value}),className:"input",placeholder:"Branch code"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["BSB Number ",e.jsx("span",{className:"text-gray-500",children:"(AU)"})]}),e.jsx("input",{type:"text",value:s.bankDetails.bsbNumber||"",onChange:e=>Y({bsbNumber:e.target.value}),className:"input",placeholder:"123-456"})]})]})]}),e.jsxs("div",{className:"border-t border-dark-border pt-4 mt-4",children:[e.jsx("label",{className:"label",children:"Additional Payment Instructions"}),e.jsx("textarea",{value:s.bankDetails.additionalInfo||"",onChange:e=>Y({additionalInfo:e.target.value}),className:"input resize-none",rows:3,placeholder:"Any additional payment instructions, reference requirements, or alternative payment methods..."})]})]})]}),"users"===C&&e.jsx(ue,{}),"integrations"===C&&e.jsx(ge,{}),"quote"===C&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"Quote Defaults"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Default Validity (Days)"}),e.jsx("input",{type:"number",value:s.quoteDefaults.validityDays,onChange:e=>K({validityDays:parseInt(e.target.value)||30}),className:"input w-32",min:"1",max:"365"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Terms"}),e.jsx("input",{type:"text",value:s.quoteDefaults.paymentTerms,onChange:e=>K({paymentTerms:e.target.value}),className:"input",placeholder:"e.g. 50% deposit on confirmation"})]})]})]}),"terms"===C&&e.jsxs("div",{className:"max-w-4xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-2",children:"Terms & Conditions"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"These terms will appear on a separate page in your PDF quotes. Use clear, concise language."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Full Terms & Conditions"}),e.jsx("textarea",{value:s.quoteDefaults.termsAndConditions,onChange:e=>K({termsAndConditions:e.target.value}),className:"input resize-none font-mono text-xs leading-relaxed",rows:20,placeholder:"Enter your full terms and conditions here. These will be formatted into columns on the PDF."}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Tip: Use numbered sections (1. 2. 3.) or bullet points for clarity. The PDF will display these in a multi-column layout."})]}),e.jsx("div",{className:"p-4 bg-dark-bg/50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-400",children:"When exporting a PDF, you'll have the option to include the Terms & Conditions as a second page."})})]})]}),"customize"===C&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"Customization"}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-4",children:"Project Types"}),e.jsx("div",{className:"space-y-2 mb-4",children:(s.projectTypes||[]).map((a,t)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-dark-bg/50 rounded group",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("button",{onClick:()=>{b(a.id,"up"),H()},disabled:0===t,className:"text-gray-600 hover:text-gray-300 disabled:opacity-30",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),e.jsx("button",{onClick:()=>{b(a.id,"down"),H()},disabled:t===s.projectTypes.length-1,className:"text-gray-600 hover:text-gray-300 disabled:opacity-30",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsx("input",{type:"text",value:a.label,onChange:e=>{p(a.id,e.target.value),H()},className:"flex-1 bg-transparent text-sm text-gray-300 focus:bg-dark-bg rounded px-2 py-1 border border-transparent focus:border-dark-border"}),e.jsx("button",{onClick:()=>{confirm(`Delete "${a.label}"?`)&&(g(a.id),H())},className:"p-1 text-gray-600 hover:text-red-400 opacity-0 group-hover:opacity-100",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},a.id))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:M,onChange:e=>T(e.target.value),placeholder:"New project type...",className:"input flex-1",onKeyDown:e=>{"Enter"===e.key&&M.trim()&&(u(M.trim()),T(""),H())}}),e.jsx("button",{onClick:()=>{M.trim()&&(u(M.trim()),T(""),H())},className:"btn-primary",children:"Add"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Regions"}),e.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"Define geographic regions with their currencies and countries for opportunities and quoting."}),e.jsx("div",{className:"space-y-3 mb-4",children:(s.regions||[]).map((a,t)=>e.jsxs("div",{className:"bg-dark-bg/50 rounded-lg border border-dark-border overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-2 p-3",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("button",{onClick:()=>{v(a.id,"up"),H()},disabled:0===t,className:"text-gray-600 hover:text-gray-300 disabled:opacity-30",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),e.jsx("button",{onClick:()=>{v(a.id,"down"),H()},disabled:t===s.regions.length-1,className:"text-gray-600 hover:text-gray-300 disabled:opacity-30",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsx("button",{onClick:()=>z(e=>({...e,[a.id]:!e[a.id]})),className:"p-1 text-gray-500 hover:text-gray-300",children:e.jsx("svg",{className:"w-4 h-4 transform transition-transform "+(q[a.id]?"rotate-90":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),e.jsx("input",{type:"text",value:a.label,onChange:e=>{y(a.id,{label:e.target.value}),H()},className:"flex-1 bg-transparent text-sm text-gray-300 focus:bg-dark-bg rounded px-2 py-1 border border-transparent focus:border-dark-border font-medium"}),e.jsx("select",{value:a.currency,onChange:e=>{y(a.id,{currency:e.target.value}),H()},className:"input w-28 text-sm",children:E.map(s=>e.jsx("option",{value:s.code,children:s.code},s.code))}),e.jsxs("span",{className:"text-xs text-gray-500 w-20 text-right",children:[(a.countries||[]).length," countries"]}),e.jsx("button",{onClick:()=>{confirm(`Delete "${a.label}"?`)&&(f(a.id),H())},className:"p-1 text-gray-600 hover:text-red-400",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),q[a.id]&&e.jsxs("div",{className:"border-t border-dark-border p-3 bg-dark-bg/30",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[(a.countries||[]).map((s,t)=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-dark-card rounded text-xs text-gray-300",children:[s,e.jsx("button",{onClick:()=>{const e=a.countries.filter((e,s)=>s!==t);y(a.id,{countries:e}),H()},className:"text-gray-500 hover:text-red-400",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t)),0===(a.countries||[]).length&&e.jsx("span",{className:"text-xs text-gray-500 italic",children:"No countries added"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:I[a.id]||"",onChange:e=>R(s=>({...s,[a.id]:e.target.value})),placeholder:"Add country...",className:"input flex-1 text-sm",onKeyDown:e=>{if("Enter"===e.key&&I[a.id]?.trim()){const e=[...a.countries||[],I[a.id].trim()];y(a.id,{countries:e}),R(e=>({...e,[a.id]:""})),H()}}}),e.jsx("button",{onClick:()=>{if(I[a.id]?.trim()){const e=[...a.countries||[],I[a.id].trim()];y(a.id,{countries:e}),R(e=>({...e,[a.id]:""})),H()}},className:"btn-secondary text-sm",children:"Add"})]})]})]},a.id))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:_.label,onChange:e=>B({..._,label:e.target.value}),placeholder:"New region name...",className:"input flex-1",onKeyDown:e=>{"Enter"===e.key&&_.label.trim()&&(j(_.label.trim(),_.currency,[]),B({label:"",currency:"USD"}),H())}}),e.jsx("select",{value:_.currency,onChange:e=>B({..._,currency:e.target.value}),className:"input w-28",children:E.map(s=>e.jsx("option",{value:s.code,children:s.code},s.code))}),e.jsx("button",{onClick:()=>{_.label.trim()&&(j(_.label.trim(),_.currency,[]),B({label:"",currency:"USD"}),H())},className:"btn-primary",children:"Add"})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Preferred Currencies"}),e.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"Select the currencies you commonly use. These will appear first in currency dropdowns throughout the app. Exchange rates update automatically in real-time."}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[(s.preferredCurrencies||[]).map(a=>{const t=E.find(e=>e.code===a);return e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-2 bg-accent-primary/10 border border-accent-primary/30 rounded-lg text-sm text-gray-200",children:[e.jsx("span",{className:"font-medium",children:a}),e.jsx("span",{className:"text-gray-400 text-xs",children:t?.name}),e.jsx("button",{onClick:()=>{const e=s.preferredCurrencies.filter(e=>e!==a);N(e),H()},className:"text-gray-500 hover:text-red-400 ml-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},a)}),0===(s.preferredCurrencies||[]).length&&e.jsx("span",{className:"text-xs text-gray-500 italic",children:"No preferred currencies selected"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{value:"",onChange:e=>{if(e.target.value&&!(s.preferredCurrencies||[]).includes(e.target.value)){const a=[...s.preferredCurrencies||[],e.target.value];N(a),H()}},className:"input flex-1",children:[e.jsx("option",{value:"",children:"Add currency..."}),E.filter(e=>!(s.preferredCurrencies||[]).includes(e.code)).map(s=>e.jsxs("option",{value:s.code,children:[s.code," - ",s.name]},s.code))]})}),e.jsx("p",{className:"text-xs text-amber-400/70 mt-3",children:"Note: Exchange rates are locked when quotes, invoices, and POs are created to ensure prices never change."})]}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-2",children:"Company OKRs"}),e.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"Define your company objectives to guide research priorities. These will be used to prioritize sports events and opportunities."}),e.jsx("div",{className:"space-y-4",children:(s.okrs||[]).map((s,a)=>e.jsxs("div",{className:"p-4 bg-dark-bg/50 rounded-lg border border-dark-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-accent-primary/20 text-accent-primary text-xs font-bold flex items-center justify-center",children:a+1}),e.jsxs("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:["OKR ",a+1]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs",children:"Objective"}),e.jsx("input",{type:"text",value:s.objective,onChange:e=>{n.getState().updateOkr(s.id,{objective:e.target.value}),H()},className:"input text-sm",placeholder:"e.g., Expand into GCC market"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label text-xs",children:"Key Result"}),e.jsx("textarea",{value:s.keyResult,onChange:e=>{n.getState().updateOkr(s.id,{keyResult:e.target.value}),H()},className:"input text-sm resize-none",rows:2,placeholder:"e.g., Win 3 major sports broadcast contracts by end of 2025"})]})]})]},s.id))})]})]}),"pdf"===C&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"PDF Display Options"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Choose what information to show on exported PDF quotes."}),e.jsx("div",{className:"space-y-3",children:[{key:"showLogo",label:"Show Company Logo"},{key:"showCompanyAddress",label:"Show Company Address"},{key:"showCompanyPhone",label:"Show Company Phone"},{key:"showCompanyEmail",label:"Show Company Email"},{key:"showTaxNumber",label:"Show Tax Number"},{key:"showBankDetails",label:"Show Bank Details"}].map(({key:a,label:t})=>e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s.pdfOptions[a],onChange:e=>{return s={[a]:e.target.checked},d(s),void H();var s},className:"w-5 h-5 rounded bg-dark-bg border-dark-border text-accent-primary focus:ring-accent-primary"}),e.jsx("span",{className:"text-gray-300",children:t})]},a))})]}),"invoice"===C&&e.jsx("div",{className:"h-full -m-4 md:-m-6",children:e.jsx(re,{})}),"ai"===C&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-2",children:"AI Features"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Enable AI-powered features like proposal generation and cover page images."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-3",children:"Anthropic API Key (Claude)"}),e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["For AI proposal text generation. Get your key from"," ",e.jsx("a",{href:"https://console.anthropic.com",target:"_blank",rel:"noopener noreferrer",className:"text-accent-primary hover:underline",children:"console.anthropic.com"})]}),e.jsx("input",{type:"password",value:s.aiSettings?.anthropicKey||"",onChange:e=>$({anthropicKey:e.target.value}),className:"input w-full font-mono text-sm",placeholder:"sk-ant-api..."})]}),e.jsxs("div",{className:"p-4 bg-dark-bg rounded-lg border border-dark-border",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-300 mb-3",children:"OpenAI API Key (DALL-E)"}),e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["For AI cover page image generation. Get your key from"," ",e.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-accent-primary hover:underline",children:"platform.openai.com"})]}),e.jsx("input",{type:"password",value:s.aiSettings?.openaiKey||"",onChange:e=>$({openaiKey:e.target.value}),className:"input w-full font-mono text-sm",placeholder:"sk-..."})]}),e.jsxs("div",{className:"p-4 bg-accent-primary/10 border border-accent-primary/20 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-semibold text-accent-primary mb-2",children:"AI Features"}),e.jsxs("ul",{className:"text-sm text-gray-400 space-y-1",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:s.aiSettings?.anthropicKey?"text-green-400":"text-gray-600",children:"â—"}),"Generate professional proposals (Claude)"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:s.aiSettings?.openaiKey?"text-green-400":"text-gray-600",children:"â—"}),"AI cover page backgrounds (DALL-E)"]})]})]}),e.jsx("p",{className:"text-xs text-gray-600",children:"Your API keys are stored locally in your browser and never sent to our servers."})]})]}),"activity"===C&&e.jsxs("div",{className:"max-w-4xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-2",children:"Activity Log"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Track all changes made to quotes across your team."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:k,className:"btn-ghost text-sm flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export CSV"]}),e.jsx("button",{onClick:()=>{confirm("Are you sure you want to clear all activity logs?")&&w()},className:"btn-ghost text-sm text-red-400 hover:text-red-300",children:"Clear All"})]})]}),e.jsx("div",{className:"bg-dark-card border border-dark-border rounded-lg overflow-hidden",children:s.activityLog&&0!==s.activityLog.length?e.jsx("div",{className:"divide-y divide-dark-border max-h-[600px] overflow-y-auto",children:s.activityLog.map(s=>{const a=new Date(s.timestamp),t={lock:"text-amber-400 bg-amber-500/10",unlock:"text-green-400 bg-green-500/10",create:"text-blue-400 bg-blue-500/10",update:"text-gray-400 bg-gray-500/10",delete:"text-red-400 bg-red-500/10",status_change:"text-purple-400 bg-purple-500/10"}[s.action]||"text-gray-400 bg-gray-500/10";return e.jsx("div",{className:"p-4 hover:bg-dark-bg/30 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${t}`,children:s.action?.replace("_"," ").toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-200",children:s.description||`${s.action} on ${s.field||"quote"}`}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:[s.quoteNumber&&e.jsxs("span",{className:"font-mono text-accent-primary",children:["#",s.quoteNumber]}),e.jsx("span",{children:s.userName||s.userId||"System"}),e.jsx("span",{children:a.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})})]})]})]})},s.id)})}):e.jsxs("div",{className:"p-8 text-center text-gray-500",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-3 text-gray-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-sm",children:"No activity recorded yet"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Changes to quotes will appear here"})]})}),e.jsx("p",{className:"text-xs text-gray-600 mt-4",children:"Activity log stores up to 1,000 entries. Older entries are automatically removed."})]}),"team"===C&&e.jsx(ie,{}),"billing"===C&&e.jsxs("div",{className:"max-w-4xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"Billing & Subscription"}),e.jsx(me,{})]}),"privacy"===C&&e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-100 mb-6",children:"Privacy & Data"}),e.jsx(oe,{})]})]})]})}export{be as default};
