import{j as e}from"./pdf-vendor-CqWdlgKa.js";import{r as s}from"./zustand-vendor-BohoUguQ.js";import{h as t,i as a}from"./index-ByJ_yCEx.js";import"./react-vendor-DRPWudcR.js";import"./supabase-vendor-DWEVVlJw.js";const r=[{id:"MALAYSIA",label:"Malaysia",currency:"MYR",symbol:"RM"},{id:"SEA",label:"SEA",currency:"USD",symbol:"$"},{id:"GULF",label:"GCC",currency:"USD",symbol:"$"},{id:"CENTRAL_ASIA",label:"Central Asia",currency:"USD",symbol:"$"}];function l(){const{items:l,sections:n,addItem:i,updateItem:o,updateItemPricing:c,deleteItem:d,exportToCSV:x,importFromCSV:m,addSection:h,deleteSection:u,renameSection:p,moveSection:g,resetSectionsToDefaults:j}=t(),b=a(),v=s.useRef(null),N=s.useRef(null),[f,y]=s.useState("all"),[k,C]=s.useState(""),[w,L]=s.useState(!1),[S,M]=s.useState(!1),[A,I]=s.useState(null),[P,D]=s.useState(null),[B,E]=s.useState(!1),W=s.useCallback(()=>{E(!0),N.current&&clearTimeout(N.current),N.current=setTimeout(()=>E(!1),2e3)},[]),[R,T]=s.useState({name:"",description:"",section:n[0]?.id||"other",unit:"day"}),[O,z]=s.useState("");s.useEffect(()=>{const e=e=>{"Escape"===e.key&&(P?D(null):w?L(!1):S&&M(!1))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[P,w,S]),s.useEffect(()=>()=>{N.current&&clearTimeout(N.current)},[]);const U=l.filter(e=>{const s="all"===f||e.section===f,t=!k||e.name.toLowerCase().includes(k.toLowerCase())||e.description?.toLowerCase().includes(k.toLowerCase());return s&&t}),V=(e,s,t,a)=>{c(e,s,{[t]:parseFloat(a)||0}),W()};return e.jsxs("div",{className:"h-[calc(100vh-60px)] flex flex-col bg-dark-bg",children:[e.jsxs("div",{className:"bg-dark-bg border-b border-dark-border p-3 sm:p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between sm:justify-start gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg sm:text-xl font-bold text-gray-100",children:"Rate Card"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[l.length," services"]})]}),B&&e.jsxs("span",{className:"text-xs text-green-400 flex items-center gap-1 bg-green-500/10 px-2 py-1 rounded-full",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Saved"]}),e.jsx("button",{onClick:()=>{T({name:"",description:"",section:n[0]?.id||"other",unit:"day"}),L(!0)},className:"sm:hidden btn-primary text-sm",children:"+ Add"})]}),e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto pb-1 sm:pb-0",children:[e.jsx("input",{type:"file",ref:v,className:"hidden",accept:".csv",onChange:e=>{const s=e.target.files[0];s&&m(s).then(e=>{e.success?(b.success(`Imported ${e.count} items successfully`),W()):b.error("Import failed: "+e.error)}),e.target.value=""}}),e.jsx("button",{onClick:()=>v.current?.click(),className:"btn-ghost text-sm flex-shrink-0 hidden sm:flex",children:"Import CSV"}),e.jsx("button",{onClick:x,className:"btn-ghost text-sm flex-shrink-0 hidden sm:flex",children:"Export"}),e.jsxs("button",{onClick:()=>M(!0),className:"btn-secondary text-sm flex-shrink-0",children:[e.jsx("span",{className:"hidden sm:inline",children:"Manage "}),"Categories"]}),e.jsx("button",{onClick:()=>{T({name:"",description:"",section:n[0]?.id||"other",unit:"day"}),L(!0)},className:"hidden sm:flex btn-primary text-sm flex-shrink-0",children:"+ Add Service"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4",children:[e.jsx("input",{type:"text",value:k,onChange:e=>C(e.target.value),placeholder:"Search services...",className:"input flex-1 sm:max-w-sm"}),e.jsxs("select",{value:f,onChange:e=>y(e.target.value),className:"input w-full sm:w-48",children:[e.jsx("option",{value:"all",children:"All Categories"}),n.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]})]}),S&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-md modal-backdrop",onClick:()=>M(!1),children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl p-6 w-full max-w-sm shadow-2xl modal-content relative",onClick:e=>e.stopPropagation(),children:[e.jsx("button",{onClick:()=>M(!1),className:"absolute top-4 right-4 p-1 text-gray-500 hover:text-white rounded-lg hover:bg-white/10 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-lg font-bold text-gray-100 mb-4",children:"Manage Categories"}),e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsx("input",{type:"text",value:O,onChange:e=>z(e.target.value),placeholder:"New Category Name",className:"input flex-1"}),e.jsx("button",{onClick:()=>{O.trim()&&(h(O),z(""),M(!1),W())},disabled:!O.trim(),className:"btn-primary whitespace-nowrap",children:"Add"})]}),e.jsxs("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2",children:[e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase mb-2",children:"Categories (synced with Quote subsections)"}),(()=>{const s={};return n.forEach((e,t)=>{const a=e.group||"Other";s[a]||(s[a]=[]),s[a].push({...e,originalIndex:t})}),Object.entries(s).map(([s,t])=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-[10px] font-medium text-gray-600 uppercase mb-1 px-2",children:s}),e.jsx("div",{className:"space-y-1",children:t.map(s=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-dark-bg/50 rounded hover:bg-dark-bg transition-colors group",children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("button",{onClick:()=>{g(s.id,"up"),W()},disabled:0===s.originalIndex,className:"text-gray-600 hover:text-gray-300 disabled:opacity-30 disabled:cursor-not-allowed",title:"Move up",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),e.jsx("button",{onClick:()=>{g(s.id,"down"),W()},disabled:s.originalIndex===n.length-1,className:"text-gray-600 hover:text-gray-300 disabled:opacity-30 disabled:cursor-not-allowed",title:"Move down",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),e.jsx("input",{type:"text",value:s.name,onChange:e=>{p(s.id,e.target.value),W()},className:"flex-1 bg-transparent text-sm text-gray-300 focus:bg-dark-bg rounded px-2 py-1 border border-transparent focus:border-dark-border"}),e.jsx("button",{onClick:()=>{confirm(`Delete category "${s.name}"? Items will be moved to 'Other'.`)&&(u(s.id),W())},className:"text-gray-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity p-1",title:"Delete Category",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},s.id))})]},s))})()]}),e.jsxs("div",{className:"flex justify-between items-center mt-6 pt-4 border-t border-dark-border",children:[e.jsx("button",{onClick:async()=>{confirm("Reset categories to sync with Quote subsections? This will replace all current categories.")&&(await j(),W())},className:"text-xs text-gray-500 hover:text-orange-400 transition-colors",children:"Sync with Quotes"}),e.jsx("button",{onClick:()=>M(!1),className:"btn-ghost",children:"Done"})]})]})}),w&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-md modal-backdrop",onClick:()=>L(!1),children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl p-6 w-full max-w-md shadow-2xl modal-content relative",onClick:e=>e.stopPropagation(),children:[e.jsx("button",{onClick:()=>L(!1),className:"absolute top-4 right-4 p-1 text-gray-500 hover:text-white rounded-lg hover:bg-white/10 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-lg font-bold text-gray-100 mb-4",children:"Add New Service"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Service Name *"}),e.jsx("input",{type:"text",value:R.name,onChange:e=>T({...R,name:e.target.value}),placeholder:"e.g. Camera Operator",className:"input",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("input",{type:"text",value:R.description,onChange:e=>T({...R,description:e.target.value}),placeholder:"Optional description",className:"input"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Category"}),e.jsx("select",{value:R.section,onChange:e=>T({...R,section:e.target.value}),className:"input",children:n.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Unit"}),e.jsxs("select",{value:R.unit,onChange:e=>T({...R,unit:e.target.value}),className:"input",children:[e.jsx("option",{value:"day",children:"Per Day"}),e.jsx("option",{value:"item",children:"Per Item"}),e.jsx("option",{value:"project",children:"Per Project"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-dark-border",children:[e.jsx("button",{onClick:()=>L(!1),className:"btn-ghost",children:"Cancel"}),e.jsx("button",{onClick:()=>{if(!R.name.trim())return;const e=i(R);T({name:"",description:"",section:n[0]?.id||"other",unit:"day"}),L(!1),I(e.id),W()},className:"btn-primary",children:"Add Service"})]})]})}),P&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-md modal-backdrop",onClick:()=>D(null),children:e.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl p-6 w-full max-w-md shadow-2xl modal-content relative",onClick:e=>e.stopPropagation(),children:[e.jsx("button",{onClick:()=>D(null),className:"absolute top-4 right-4 p-1 text-gray-500 hover:text-white rounded-lg hover:bg-white/10 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-lg font-bold text-gray-100 mb-4",children:"Edit Service"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Service Name *"}),e.jsx("input",{type:"text",value:P.name,onChange:e=>D({...P,name:e.target.value}),className:"input",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("input",{type:"text",value:P.description,onChange:e=>D({...P,description:e.target.value}),placeholder:"Optional description",className:"input"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Category"}),e.jsx("select",{value:P.section,onChange:e=>D({...P,section:e.target.value}),className:"input",children:n.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Unit"}),e.jsxs("select",{value:P.unit,onChange:e=>D({...P,unit:e.target.value}),className:"input",children:[e.jsx("option",{value:"day",children:"Per Day"}),e.jsx("option",{value:"item",children:"Per Item"}),e.jsx("option",{value:"project",children:"Per Project"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-dark-border",children:[e.jsx("button",{onClick:()=>D(null),className:"btn-ghost",children:"Cancel"}),e.jsx("button",{onClick:()=>{P?.name.trim()&&(o(P.id,{name:P.name,description:P.description,section:P.section,unit:P.unit}),D(null),W())},className:"btn-primary",children:"Save Changes"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:0!==U.length||k?0===U.length?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-700 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"No matches found"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Try a different search term"})]}):e.jsx("div",{className:"space-y-2",children:U.map(s=>e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>I(A===s.id?null:s.id),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-200 font-medium truncate",children:s.name}),e.jsx("span",{className:"text-xs text-gray-600 px-2 py-0.5 bg-dark-bg rounded flex-shrink-0",children:n.find(e=>e.id===s.section)?.name||"Other"})]}),s.description&&e.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),(e=>{D({id:e.id,name:e.name,description:e.description||"",section:e.section,unit:e.unit||"day"})})(s)},className:"p-1 text-gray-600 hover:text-blue-400",title:"Edit service",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:e=>{e.stopPropagation(),confirm("Delete this service?")&&(d(s.id),W())},className:"p-1 text-gray-600 hover:text-red-400",title:"Delete service",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("svg",{className:"w-5 h-5 text-gray-500 transition-transform "+(A===s.id?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),A===s.id&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-border",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 uppercase mb-3",children:"Regional Pricing"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:r.map(t=>e.jsxs("div",{className:"bg-dark-bg rounded-lg p-3",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-400 mb-2",children:[t.label," ",e.jsxs("span",{className:"text-gray-600",children:["(",t.currency,")"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-gray-600",children:["Cost (",t.symbol,")"]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:t.symbol}),e.jsx("input",{type:"number",value:s.pricing?.[t.id]?.cost||0,onChange:e=>V(s.id,t.id,"cost",e.target.value),className:"input text-sm pl-7"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs text-gray-600",children:["Charge (",t.symbol,")"]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:t.symbol}),e.jsx("input",{type:"number",value:s.pricing?.[t.id]?.charge||0,onChange:e=>V(s.id,t.id,"charge",e.target.value),className:"input text-sm pl-7"})]})]})]})]},t.id))})]})]},s.id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-700 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-400 mb-2",children:"No services yet"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Add your rates and services to use in quotes"}),e.jsx("button",{onClick:()=>L(!0),className:"btn-primary",children:"+ Add Service"})]})})]})}export{l as default};
