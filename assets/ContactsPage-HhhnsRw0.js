import{j as e}from"./pdf-vendor-CqWdlgKa.js";import{r as t}from"./zustand-vendor-BohoUguQ.js";import{u as s,C as a,g as l}from"./contactStore-DEZO6BUG.js";import{u as r,c as n}from"./index-qIMeUE46.js";import{C as i,a as o}from"./ContactForm-hqbNHC-k.js";import{A as c}from"./ActivityTimeline-Bm7xZSh3.js";import"./react-vendor-DRPWudcR.js";import"./supabase-vendor-DWEVVlJw.js";function d({contact:a,client:r,activities:n,onClose:i,onUpdate:d,onDelete:x,onCompleteTask:m,onDeleteActivity:h}){const[p,j]=t.useState(!1),[u,v]=t.useState(!1),{getFullName:g,getInitials:b}=s(),f=l(a.role),N=g(a),y=b(a),k=async e=>{await d(a.id,e),j(!1)};return p?e.jsxs("div",{className:"h-full flex flex-col bg-dark-card border-l border-dark-border",children:[e.jsx("div",{className:"p-4 border-b border-dark-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Edit Contact"}),e.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-200",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx(o,{contact:a,clientId:a.clientId,onSave:k,onCancel:()=>j(!1)})})]}):e.jsxs("div",{className:"h-full flex flex-col bg-dark-card border-l border-dark-border",children:[e.jsxs("div",{className:"p-4 border-b border-dark-border",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-white font-bold text-lg ${f.color} bg-white/10`,children:y}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:N}),a.isPrimary&&e.jsx("span",{className:"px-1.5 py-0.5 text-[10px] bg-brand-teal/20 text-brand-teal rounded",children:"Primary"})]}),a.jobTitle&&e.jsx("p",{className:"text-sm text-gray-400",children:a.jobTitle}),r&&e.jsx("p",{className:"text-xs text-gray-500",children:r.company})]})]}),e.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-gray-200",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a.role&&e.jsx("div",{className:"mt-3",children:e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${f.color} bg-white/5`,children:f.label})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-2 text-sm",children:[a.email&&e.jsxs("a",{href:`mailto:${a.email}`,className:"flex items-center gap-2 text-gray-300 hover:text-brand-teal",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),a.email]}),a.phone&&e.jsxs("a",{href:`tel:${a.phone}`,className:"flex items-center gap-2 text-gray-300 hover:text-brand-teal",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),a.phone]}),a.mobile&&a.mobile!==a.phone&&e.jsxs("a",{href:`tel:${a.mobile}`,className:"flex items-center gap-2 text-gray-300 hover:text-brand-teal",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})}),a.mobile]}),a.linkedinUrl&&e.jsxs("a",{href:a.linkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-gray-300 hover:text-blue-400",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"})}),"LinkedIn"]})]}),a.tags&&a.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mt-3",children:a.tags.map((t,s)=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-dark-border text-gray-400 rounded",children:t},s))}),a.notes&&e.jsx("div",{className:"mt-3 p-3 bg-dark-bg/50 rounded-lg",children:e.jsx("p",{className:"text-xs text-gray-400",children:a.notes})}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("button",{onClick:()=>j(!0),className:"btn btn-secondary flex-1",children:"Edit"}),e.jsx("button",{onClick:()=>v(!0),className:"p-2 text-gray-400 hover:text-red-400 transition-colors",title:"Delete contact",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),u&&e.jsxs("div",{className:"mt-3 p-3 bg-red-500/10 border border-red-500/30 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-red-400 mb-2",children:["Delete ",N,"? This cannot be undone."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{x(a.id),i()},className:"px-3 py-1.5 bg-red-500/20 text-red-400 rounded text-sm hover:bg-red-500/30",children:"Delete"}),e.jsx("button",{onClick:()=>v(!1),className:"px-3 py-1.5 text-gray-400 text-sm hover:text-gray-200",children:"Cancel"})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-3",children:["Activity History (",n.length,")"]}),e.jsx(c,{activities:n,onDelete:h,onCompleteTask:m,emptyMessage:"No activities with this contact yet",maxItems:20})]})]})}function x(){const{contacts:l,loading:o,initialize:c,updateContact:x,deleteContact:m,getFullName:h}=s(),{clients:p,getClient:j}=r(),{getContactActivities:u,deleteActivity:v,completeTask:g,initialize:b}=n(),[f,N]=t.useState(""),[y,k]=t.useState("all"),[w,C]=t.useState("all"),[L,M]=t.useState(!1),[A,S]=t.useState("name"),[D,z]=t.useState(null);t.useEffect(()=>{c(),b()},[c,b]);const I=t.useMemo(()=>{let e=l;if(f){const t=f.toLowerCase();e=e.filter(e=>h(e).toLowerCase().includes(t)||e.email?.toLowerCase().includes(t)||e.jobTitle?.toLowerCase().includes(t)||e.notes?.toLowerCase().includes(t))}return"all"!==y&&(e=e.filter(e=>e.role===y)),"all"!==w&&(e=e.filter(e=>e.clientId===w)),L&&(e=e.filter(e=>e.isPrimary)),e=[...e].sort((e,t)=>{switch(A){case"last_contacted":return new Date(t.lastContactedAt||0)-new Date(e.lastContactedAt||0);case"created":return new Date(t.createdAt)-new Date(e.createdAt);default:return h(e).localeCompare(h(t))}}),e},[l,f,y,w,L,A,h]),T=t.useMemo(()=>({total:l.length,primary:l.filter(e=>e.isPrimary).length}),[l]),B=D?u(D.id):[],W=D?.clientId?j(D.clientId):null;return o?e.jsx("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center",children:e.jsx("div",{className:"text-gray-400",children:"Loading contacts..."})}):e.jsx("div",{className:"min-h-screen bg-dark-bg",children:e.jsxs("div",{className:"flex h-screen",children:[e.jsxs("div",{className:"flex-1 flex flex-col "+(D?"hidden md:flex":""),children:[e.jsxs("div",{className:"p-4 border-b border-dark-border",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Contacts"}),e.jsxs("p",{className:"text-sm text-gray-400",children:[T.total," contacts",T.primary>0&&e.jsxs("span",{className:"text-brand-teal ml-2",children:[T.primary," primary"]})]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx("input",{type:"text",value:f,onChange:e=>N(e.target.value),placeholder:"Search contacts...",className:"input w-full"})}),e.jsxs("select",{value:y,onChange:e=>k(e.target.value),className:"input w-40",children:[e.jsx("option",{value:"all",children:"All Roles"}),a.map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))]}),e.jsxs("select",{value:w,onChange:e=>C(e.target.value),className:"input w-48",children:[e.jsx("option",{value:"all",children:"All Clients"}),p.map(t=>e.jsx("option",{value:t.id,children:t.company},t.id))]}),e.jsx("button",{onClick:()=>M(!L),className:"px-3 py-2 rounded-lg text-sm transition-colors "+(L?"bg-brand-teal/20 text-brand-teal border border-brand-teal/30":"bg-dark-card text-gray-400 border border-dark-border hover:text-gray-200"),children:"Primary Only"}),e.jsxs("select",{value:A,onChange:e=>S(e.target.value),className:"input w-40",children:[e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"last_contacted",children:"Last Contacted"}),e.jsx("option",{value:"created",children:"Recently Added"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:0===I.length?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})}),e.jsx("p",{className:"text-gray-400",children:"No contacts found"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Add contacts from the Client detail page"})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:I.map(t=>{const s=t.clientId?j(t.clientId):null;return e.jsx(i,{contact:t,onSelect:z,showClient:!0,clientName:s?.company},t.id)})})})]}),D&&e.jsx("div",{className:"w-full md:w-[450px] flex-shrink-0",children:e.jsx(d,{contact:D,client:W,activities:B,onClose:()=>z(null),onUpdate:x,onDelete:m,onCompleteTask:g,onDeleteActivity:v})})]})})}export{x as default};
