const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ClientsPage-C_z4UI-O.js","assets/pdf-vendor-CqWdlgKa.js","assets/zustand-vendor-BohoUguQ.js","assets/react-vendor-DRPWudcR.js","assets/validation-DQPS0e0-.js","assets/supabase-vendor-DWEVVlJw.js","assets/ClientDetailPage-DhOinYsB.js","assets/OpportunitiesPage-DHeY6jbG.js","assets/charts-vendor-BbtJWQl0.js","assets/OpportunityDetailPage-htXSsuKH.js","assets/RateCardPage-C1JHrsFC.js","assets/DashboardPage-Dk1q3QYi.js","assets/QuotesPage-BuOu4wRL.js","assets/SettingsPage-j9v9x1N5.js","assets/FSPage-BeF_ZTae.js","assets/CommercialTasksPage-DdFeVGxm.js","assets/SOPPage-BdUPQnlc.js","assets/KnowledgePage-C4Ffy59k.js","assets/timelineStore-CrC2_eKA.js","assets/KitListPage-ycKmqhSB.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,n,r)=>((t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r)(t,"symbol"!=typeof n?n+"":n,r);import{j as n,P as r,S as a,V as i,T as o,D as s,I as l,p as c}from"./pdf-vendor-CqWdlgKa.js";import{c as u,r as d,R as p}from"./zustand-vendor-BohoUguQ.js";import{r as m,b as f}from"./react-vendor-DRPWudcR.js";import{c as h}from"./supabase-vendor-DWEVVlJw.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var g,y,b,x,v={exports:{}},w={},k={exports:{}},S={};function j(){return y||(y=1,k.exports=(g||(g=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>a(l,n))c<i&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<i&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,s=o.now();e.unstable_now=function(){return o.now()-s}}var l=[],c=[],u=1,d=null,p=3,m=!1,f=!1,h=!1,g=!1,y="function"==typeof setTimeout?setTimeout:null,b="function"==typeof clearTimeout?clearTimeout:null,x="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var a=n(c);null!==a;){if(null===a.callback)r(c);else{if(!(a.startTime<=e))break;r(c),a.sortIndex=a.expirationTime,t(l,a)}a=n(c)}}function w(e){if(h=!1,v(e),!f)if(null!==n(l))f=!0,S||(S=!0,k());else{var t=n(c);null!==t&&D(w,t.startTime-e)}}var k,S=!1,j=-1,C=5,N=-1;function _(){return!(!g&&e.unstable_now()-N<C)}function E(){if(g=!1,S){var t=e.unstable_now();N=t;var a=!0;try{e:{f=!1,h&&(h=!1,b(j),j=-1),m=!0;var i=p;try{t:{for(v(t),d=n(l);null!==d&&!(d.expirationTime>t&&_());){var o=d.callback;if("function"==typeof o){d.callback=null,p=d.priorityLevel;var s=o(d.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof s){d.callback=s,v(t),a=!0;break t}d===n(l)&&r(l),v(t)}else r(l);d=n(l)}if(null!==d)a=!0;else{var u=n(c);null!==u&&D(w,u.startTime-t),a=!1}}break e}finally{d=null,p=i,m=!1}a=void 0}}finally{a?k():S=!1}}}if("function"==typeof x)k=function(){x(E)};else if("undefined"!=typeof MessageChannel){var L=new MessageChannel,T=L.port2;L.port1.onmessage=E,k=function(){T.postMessage(null)}}else k=function(){y(E,0)};function D(t,n){j=y(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e||(C=0<e?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},e.unstable_requestPaint=function(){g=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},e.unstable_scheduleCallback=function(r,a,i){var o=e.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?o+i:o,r){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return r={id:u++,callback:a,priorityLevel:r,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(r.sortIndex=i,t(c,r),null===n(l)&&r===n(c)&&(h?(b(j),j=-1):h=!0,D(w,i-o))):(r.sortIndex=s,t(l,r),f||m||(f=!0,S||(S=!0,k()))),r},e.unstable_shouldYield=_,e.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}}(S)),S)),k.exports}function C(){if(b)return w;b=1;var e=j(),t=m(),n=f();function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function i(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function o(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function s(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function l(e){if(i(e)!==e)throw Error(r(188))}function c(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=c(e)))return t;e=e.sibling}return null}var u=Object.assign,d=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),v=Symbol.for("react.consumer"),k=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),T=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function I(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=D&&e[D]||e["@@iterator"])?e:null}var A=Symbol.for("react.client.reference");function P(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===A?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case g:return"Fragment";case x:return"Profiler";case y:return"StrictMode";case C:return"Suspense";case N:return"SuspenseList";case L:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case h:return"Portal";case k:return e.displayName||"Context";case v:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case _:return null!==(t=e.displayName||null)?t:P(e.type)||"Memo";case E:t=e._payload,e=e._init;try{return P(e(t))}catch(n){}}return null}var O=Array.isArray,q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R={pending:!1,data:null,method:null,action:null},M=[],F=-1;function U(e){return{current:e}}function B(e){0>F||(e.current=M[F],M[F]=null,F--)}function $(e,t){F++,M[F]=e.current,e.current=t}var Q,V,W=U(null),H=U(null),G=U(null),K=U(null);function Y(e,t){switch($(G,t),$(H,e),$(W,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?xd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=vd(t=xd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(W),$(W,e)}function J(){B(W),B(H),B(G)}function X(e){null!==e.memoizedState&&$(K,e);var t=W.current,n=vd(t,e.type);t!==n&&($(H,e),$(W,n))}function Z(e){H.current===e&&(B(W),B(H)),K.current===e&&(B(K),pp._currentValue=R)}function ee(e){if(void 0===Q)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Q=t&&t[1]||"",V=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Q+e+V}var te=!1;function ne(e,t){if(!e||te)return"";te=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(a){var r=a}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(o){r=o}(n=e())&&"function"==typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"==typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var a=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");a&&a.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),o=i[0],s=i[1];if(o&&s){var l=o.split("\n"),c=s.split("\n");for(a=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;a<c.length&&!c[a].includes("DetermineComponentFrameRoot");)a++;if(r===l.length||a===c.length)for(r=l.length-1,a=c.length-1;1<=r&&0<=a&&l[r]!==c[a];)a--;for(;1<=r&&0<=a;r--,a--)if(l[r]!==c[a]){if(1!==r||1!==a)do{if(r--,0>--a||l[r]!==c[a]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=a);break}}}finally{te=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?ee(n):""}function re(e,t){switch(e.tag){case 26:case 27:case 5:return ee(e.type);case 16:return ee("Lazy");case 13:return e.child!==t&&null!==t?ee("Suspense Fallback"):ee("Suspense");case 19:return ee("SuspenseList");case 0:case 15:return ne(e.type,!1);case 11:return ne(e.type.render,!1);case 1:return ne(e.type,!0);case 31:return ee("Activity");default:return""}}function ae(e){try{var t="",n=null;do{t+=re(e,n),n=e,e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}var ie=Object.prototype.hasOwnProperty,oe=e.unstable_scheduleCallback,se=e.unstable_cancelCallback,le=e.unstable_shouldYield,ce=e.unstable_requestPaint,ue=e.unstable_now,de=e.unstable_getCurrentPriorityLevel,pe=e.unstable_ImmediatePriority,me=e.unstable_UserBlockingPriority,fe=e.unstable_NormalPriority,he=e.unstable_LowPriority,ge=e.unstable_IdlePriority,ye=e.log,be=e.unstable_setDisableYieldValue,xe=null,ve=null;function we(e){if("function"==typeof ye&&be(e),ve&&"function"==typeof ve.setStrictMode)try{ve.setStrictMode(xe,e)}catch(t){}}var ke=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Se(e)/je|0)|0},Se=Math.log,je=Math.LN2;var Ce=256,Ne=262144,_e=4194304;function Ee(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Le(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var a=0,i=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var s=134217727&r;return 0!==s?0!==(r=s&~i)?a=Ee(r):0!==(o&=s)?a=Ee(o):n||0!==(n=s&~e)&&(a=Ee(n)):0!==(s=r&~i)?a=Ee(s):0!==o?a=Ee(o):n||0!==(n=r&~e)&&(a=Ee(n)),0===a?0:0!==t&&t!==a&&0===(t&i)&&((i=a&-a)>=(n=t&-t)||32===i&&4194048&n)?t:a}function Te(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function De(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Ie(){var e=_e;return!(62914560&(_e<<=1))&&(_e=4194304),e}function Ae(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Pe(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Oe(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-ke(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n}function qe(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ke(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}function ze(e,t){var n=t&-t;return 0!==((n=42&n?1:Re(n))&(e.suspendedLanes|t))?0:n}function Re(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Me(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Fe(){var e=z.p;return 0!==e?e:void 0===(e=window.event)?32:Ep(e.type)}function Ue(e,t){var n=z.p;try{return z.p=e,t()}finally{z.p=n}}var Be=Math.random().toString(36).slice(2),$e="__reactFiber$"+Be,Qe="__reactProps$"+Be,Ve="__reactContainer$"+Be,We="__reactEvents$"+Be,He="__reactListeners$"+Be,Ge="__reactHandles$"+Be,Ke="__reactResources$"+Be,Ye="__reactMarker$"+Be;function Je(e){delete e[$e],delete e[Qe],delete e[We],delete e[He],delete e[Ge]}function Xe(e){var t=e[$e];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ve]||n[$e]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Rd(e);null!==e;){if(n=e[$e])return n;e=Rd(e)}return t}n=(e=n).parentNode}return null}function Ze(e){if(e=e[$e]||e[Ve]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function et(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(r(33))}function tt(e){var t=e[Ke];return t||(t=e[Ke]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function nt(e){e[Ye]=!0}var rt=new Set,at={};function it(e,t){ot(e,t),ot(e+"Capture",t)}function ot(e,t){for(at[e]=t,e=0;e<t.length;e++)rt.add(t[e])}var st=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),lt={},ct={};function ut(e,t,n){if(a=t,ie.call(ct,a)||!ie.call(lt,a)&&(st.test(a)?ct[a]=!0:(lt[a]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var a}function dt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function pt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function mt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ft(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){if(!e._valueTracker){var t=ft(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&void 0!==r&&"function"==typeof r.get&&"function"==typeof r.set){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function gt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ft(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function yt(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var bt=/[\n"\\]/g;function xt(e){return e.replace(bt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function vt(e,t,n,r,a,i,o,s){e.name="",null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o?e.type=o:e.removeAttribute("type"),null!=t?"number"===o?(0===t&&""===e.value||e.value!=t)&&(e.value=""+mt(t)):e.value!==""+mt(t)&&(e.value=""+mt(t)):"submit"!==o&&"reset"!==o||e.removeAttribute("value"),null!=t?kt(e,o,mt(t)):null!=n?kt(e,o,mt(n)):null!=r&&e.removeAttribute("value"),null==a&&null!=i&&(e.defaultChecked=!!i),null!=a&&(e.checked=a&&"function"!=typeof a&&"symbol"!=typeof a),null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s?e.name=""+mt(s):e.removeAttribute("name")}function wt(e,t,n,r,a,i,o,s){if(null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i&&(e.type=i),null!=t||null!=n){if(("submit"===i||"reset"===i)&&null==t)return void ht(e);n=null!=n?""+mt(n):"",t=null!=t?""+mt(t):n,s||t===e.value||(e.value=t),e.defaultValue=t}r="function"!=typeof(r=null!=r?r:a)&&"symbol"!=typeof r&&!!r,e.checked=s?e.checked:!!r,e.defaultChecked=!!r,null!=o&&"function"!=typeof o&&"symbol"!=typeof o&&"boolean"!=typeof o&&(e.name=o),ht(e)}function kt(e,t,n){"number"===t&&yt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function St(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+mt(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function jt(e,t,n){null==t||((t=""+mt(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+mt(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Ct(e,t,n,a){if(null==t){if(null!=a){if(null!=n)throw Error(r(92));if(O(a)){if(1<a.length)throw Error(r(93));a=a[0]}n=a}null==n&&(n=""),t=n}n=mt(t),e.defaultValue=n,(a=e.textContent)===n&&""!==a&&null!==a&&(e.value=a),ht(e)}function Nt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var _t=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Et(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"==typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!=typeof n||0===n||_t.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Lt(e,t,n){if(null!=t&&"object"!=typeof t)throw Error(r(62));if(e=e.style,null!=n){for(var a in n)!n.hasOwnProperty(a)||null!=t&&t.hasOwnProperty(a)||(0===a.indexOf("--")?e.setProperty(a,""):"float"===a?e.cssFloat="":e[a]="");for(var i in t)a=t[i],t.hasOwnProperty(i)&&n[i]!==a&&Et(e,i,a)}else for(var o in t)t.hasOwnProperty(o)&&Et(e,o,t[o])}function Tt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),It=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function At(e){return It.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Pt(){}var Ot=null;function qt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var zt=null,Rt=null;function Mt(e){var t=Ze(e);if(t&&(e=t.stateNode)){var n=e[Qe]||null;e:switch(e=t.stateNode,t.type){case"input":if(vt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+xt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var a=n[t];if(a!==e&&a.form===e.form){var i=a[Qe]||null;if(!i)throw Error(r(90));vt(a,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(a=n[t]).form===e.form&&gt(a)}break e;case"textarea":jt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&St(e,!!n.multiple,t,!1)}}}var Ft=!1;function Ut(e,t,n){if(Ft)return e(t,n);Ft=!0;try{return e(t)}finally{if(Ft=!1,(null!==zt||null!==Rt)&&(tu(),zt&&(t=zt,e=Rt,Rt=zt=null,Mt(t),e)))for(t=0;t<e.length;t++)Mt(e[t])}}function Bt(e,t){var n=e.stateNode;if(null===n)return null;var a=n[Qe]||null;if(null===a)return null;n=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(r(231,t,typeof n));return n}var $t=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Qt=!1;if($t)try{var Vt={};Object.defineProperty(Vt,"passive",{get:function(){Qt=!0}}),window.addEventListener("test",Vt,Vt),window.removeEventListener("test",Vt,Vt)}catch(Zp){Qt=!1}var Wt=null,Ht=null,Gt=null;function Kt(){if(Gt)return Gt;var e,t,n=Ht,r=n.length,a="value"in Wt?Wt.value:Wt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Gt=a.slice(e,1<t?1-t:void 0)}function Yt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Jt(){return!0}function Xt(){return!1}function Zt(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?Jt:Xt,this.isPropagationStopped=Xt,this}return u(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Jt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Jt)},persist:function(){},isPersistent:Jt}),t}var en,tn,nn,rn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},an=Zt(rn),on=u({},rn,{view:0,detail:0}),sn=Zt(on),ln=u({},on,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==nn&&(nn&&"mousemove"===e.type?(en=e.screenX-nn.screenX,tn=e.screenY-nn.screenY):tn=en=0,nn=e),en)},movementY:function(e){return"movementY"in e?e.movementY:tn}}),cn=Zt(ln),un=Zt(u({},ln,{dataTransfer:0})),dn=Zt(u({},on,{relatedTarget:0})),pn=Zt(u({},rn,{animationName:0,elapsedTime:0,pseudoElement:0})),mn=Zt(u({},rn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),fn=Zt(u({},rn,{data:0})),hn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=yn[e])&&!!t[e]}function xn(){return bn}var vn=Zt(u({},on,{key:function(e){if(e.key){var t=hn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Yt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?gn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?Yt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Yt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),wn=Zt(u({},ln,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=Zt(u({},on,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),Sn=Zt(u({},rn,{propertyName:0,elapsedTime:0,pseudoElement:0})),jn=Zt(u({},ln,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Cn=Zt(u({},rn,{newState:0,oldState:0})),Nn=[9,13,27,32],_n=$t&&"CompositionEvent"in window,En=null;$t&&"documentMode"in document&&(En=document.documentMode);var Ln=$t&&"TextEvent"in window&&!En,Tn=$t&&(!_n||En&&8<En&&11>=En),Dn=String.fromCharCode(32),In=!1;function An(e,t){switch(e){case"keyup":return-1!==Nn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var On=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Rn(e,t,n,r){zt?Rt?Rt.push(r):Rt=[r]:zt=r,0<(t=id(t,"onChange")).length&&(n=new an("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Mn=null,Fn=null;function Un(e){Ju(e,0)}function Bn(e){if(gt(et(e)))return e}function $n(e,t){if("change"===e)return t}var Qn=!1;if($t){var Vn;if($t){var Wn="oninput"in document;if(!Wn){var Hn=document.createElement("div");Hn.setAttribute("oninput","return;"),Wn="function"==typeof Hn.oninput}Vn=Wn}else Vn=!1;Qn=Vn&&(!document.documentMode||9<document.documentMode)}function Gn(){Mn&&(Mn.detachEvent("onpropertychange",Kn),Fn=Mn=null)}function Kn(e){if("value"===e.propertyName&&Bn(Fn)){var t=[];Rn(t,Fn,e,qt(e)),Ut(Un,t)}}function Yn(e,t,n){"focusin"===e?(Gn(),Fn=n,(Mn=t).attachEvent("onpropertychange",Kn)):"focusout"===e&&Gn()}function Jn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Bn(Fn)}function Xn(e,t){if("click"===e)return Bn(t)}function Zn(e,t){if("input"===e||"change"===e)return Bn(t)}var er="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function tr(e,t){if(er(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!ie.call(t,a)||!er(e[a],t[a]))return!1}return!0}function nr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function rr(e,t){var n,r=nr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=nr(r)}}function ar(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ar(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ir(e){for(var t=yt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=yt((e=t.contentWindow).document)}return t}function or(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var sr=$t&&"documentMode"in document&&11>=document.documentMode,lr=null,cr=null,ur=null,dr=!1;function pr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;dr||null==lr||lr!==yt(r)||("selectionStart"in(r=lr)&&or(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},ur&&tr(ur,r)||(ur=r,0<(r=id(cr,"onSelect")).length&&(t=new an("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=lr)))}function mr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var fr={animationend:mr("Animation","AnimationEnd"),animationiteration:mr("Animation","AnimationIteration"),animationstart:mr("Animation","AnimationStart"),transitionrun:mr("Transition","TransitionRun"),transitionstart:mr("Transition","TransitionStart"),transitioncancel:mr("Transition","TransitionCancel"),transitionend:mr("Transition","TransitionEnd")},hr={},gr={};function yr(e){if(hr[e])return hr[e];if(!fr[e])return e;var t,n=fr[e];for(t in n)if(n.hasOwnProperty(t)&&t in gr)return hr[e]=n[t];return e}$t&&(gr=document.createElement("div").style,"AnimationEvent"in window||(delete fr.animationend.animation,delete fr.animationiteration.animation,delete fr.animationstart.animation),"TransitionEvent"in window||delete fr.transitionend.transition);var br=yr("animationend"),xr=yr("animationiteration"),vr=yr("animationstart"),wr=yr("transitionrun"),kr=yr("transitionstart"),Sr=yr("transitioncancel"),jr=yr("transitionend"),Cr=new Map,Nr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _r(e,t){Cr.set(e,t),it(t,[e])}Nr.push("scrollEnd");var Er="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e)},Lr=[],Tr=0,Dr=0;function Ir(){for(var e=Tr,t=Dr=Tr=0;t<e;){var n=Lr[t];Lr[t++]=null;var r=Lr[t];Lr[t++]=null;var a=Lr[t];Lr[t++]=null;var i=Lr[t];if(Lr[t++]=null,null!==r&&null!==a){var o=r.pending;null===o?a.next=a:(a.next=o.next,o.next=a),r.pending=a}0!==i&&qr(n,a,i)}}function Ar(e,t,n,r){Lr[Tr++]=e,Lr[Tr++]=t,Lr[Tr++]=n,Lr[Tr++]=r,Dr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Pr(e,t,n,r){return Ar(e,t,n,r),zr(e)}function Or(e,t){return Ar(e,null,null,t),zr(e)}function qr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var a=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(r=i.alternate)&&(r.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(a=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,a&&null!==t&&(a=31-ke(n),null===(r=(e=i.hiddenUpdates)[a])?e[a]=[t]:r.push(t),t.lane=536870912|n),i):null}function zr(e){if(50<Wc)throw Wc=0,Hc=null,Error(r(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Rr={};function Mr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fr(e,t,n,r){return new Mr(e,t,n,r)}function Ur(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Br(e,t){var n=e.alternate;return null===n?((n=Fr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function $r(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Qr(e,t,n,a,i,o){var s=0;if(a=e,"function"==typeof e)Ur(e)&&(s=1);else if("string"==typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,n,W.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case L:return(e=Fr(31,n,t,i)).elementType=L,e.lanes=o,e;case g:return Vr(n.children,i,o,t);case y:s=8,i|=24;break;case x:return(e=Fr(12,n,t,2|i)).elementType=x,e.lanes=o,e;case C:return(e=Fr(13,n,t,i)).elementType=C,e.lanes=o,e;case N:return(e=Fr(19,n,t,i)).elementType=N,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case k:s=10;break e;case v:s=9;break e;case S:s=11;break e;case _:s=14;break e;case E:s=16,a=null;break e}s=29,n=Error(r(130,null===e?"null":typeof e,"")),a=null}return(t=Fr(s,n,t,i)).elementType=e,t.type=a,t.lanes=o,t}function Vr(e,t,n,r){return(e=Fr(7,e,r,t)).lanes=n,e}function Wr(e,t,n){return(e=Fr(6,e,null,t)).lanes=n,e}function Hr(e){var t=Fr(18,null,null,0);return t.stateNode=e,t}function Gr(e,t,n){return(t=Fr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Kr=new WeakMap;function Yr(e,t){if("object"==typeof e&&null!==e){var n=Kr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ae(t)},Kr.set(e,t),t)}return{value:e,source:t,stack:ae(t)}}var Jr=[],Xr=0,Zr=null,ea=0,ta=[],na=0,ra=null,aa=1,ia="";function oa(e,t){Jr[Xr++]=ea,Jr[Xr++]=Zr,Zr=e,ea=t}function sa(e,t,n){ta[na++]=aa,ta[na++]=ia,ta[na++]=ra,ra=e;var r=aa;e=ia;var a=32-ke(r)-1;r&=~(1<<a),n+=1;var i=32-ke(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,aa=1<<32-ke(t)+a|n<<a|r,ia=i+e}else aa=1<<i|n<<a|r,ia=e}function la(e){null!==e.return&&(oa(e,1),sa(e,1,0))}function ca(e){for(;e===Zr;)Zr=Jr[--Xr],Jr[Xr]=null,ea=Jr[--Xr],Jr[Xr]=null;for(;e===ra;)ra=ta[--na],ta[na]=null,ia=ta[--na],ta[na]=null,aa=ta[--na],ta[na]=null}function ua(e,t){ta[na++]=aa,ta[na++]=ia,ta[na++]=ra,aa=t.id,ia=t.overflow,ra=e}var da=null,pa=null,ma=!1,fa=null,ha=!1,ga=Error(r(519));function ya(e){throw Sa(Yr(Error(r(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),ga}function ba(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[$e]=e,t[Qe]=r,n){case"dialog":Xu("cancel",t),Xu("close",t);break;case"iframe":case"object":case"embed":Xu("load",t);break;case"video":case"audio":for(n=0;n<Ku.length;n++)Xu(Ku[n],t);break;case"source":Xu("error",t);break;case"img":case"image":case"link":Xu("error",t),Xu("load",t);break;case"details":Xu("toggle",t);break;case"input":Xu("invalid",t),wt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Xu("invalid",t);break;case"textarea":Xu("invalid",t),Ct(t,r.value,r.defaultValue,r.children)}"string"!=typeof(n=r.children)&&"number"!=typeof n&&"bigint"!=typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||dd(t.textContent,n)?(null!=r.popover&&(Xu("beforetoggle",t),Xu("toggle",t)),null!=r.onScroll&&Xu("scroll",t),null!=r.onScrollEnd&&Xu("scrollend",t),null!=r.onClick&&(t.onclick=Pt),t=!0):t=!1,t||ya(e,!0)}function xa(e){for(da=e.return;da;)switch(da.tag){case 5:case 31:case 13:return void(ha=!1);case 27:case 3:return void(ha=!0);default:da=da.return}}function va(e){if(e!==da)return!1;if(!ma)return xa(e),ma=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||wd(e.type,e.memoizedProps)),t=!t),t&&pa&&ya(e),xa(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));pa=zd(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));pa=zd(e)}else 27===n?(n=pa,Ed(e.type)?(e=qd,qd=null,pa=e):pa=n):pa=da?Od(e.stateNode.nextSibling):null;return!0}function wa(){pa=da=null,ma=!1}function ka(){var e=fa;return null!==e&&(null===Ic?Ic=e:Ic.push.apply(Ic,e),fa=null),e}function Sa(e){null===fa?fa=[e]:fa.push(e)}var ja=U(null),Ca=null,Na=null;function _a(e,t,n){$(ja,t._currentValue),t._currentValue=n}function Ea(e){e._currentValue=ja.current,B(ja)}function La(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ta(e,t,n,a){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var o=i.dependencies;if(null!==o){var s=i.child;o=o.firstContext;e:for(;null!==o;){var l=o;o=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),La(o.return,n,e),a||(s=null);break e}o=l.next}}else if(18===i.tag){if(null===(s=i.return))throw Error(r(341));s.lanes|=n,null!==(o=s.alternate)&&(o.lanes|=n),La(s,n,e),s=null}else s=i.child;if(null!==s)s.return=i;else for(s=i;null!==s;){if(s===e){s=null;break}if(null!==(i=s.sibling)){i.return=s.return,s=i;break}s=s.return}i=s}}function Da(e,t,n,a){e=null;for(var i=t,o=!1;null!==i;){if(!o)if(524288&i.flags)o=!0;else if(262144&i.flags)break;if(10===i.tag){var s=i.alternate;if(null===s)throw Error(r(387));if(null!==(s=s.memoizedProps)){var l=i.type;er(i.pendingProps.value,s.value)||(null!==e?e.push(l):e=[l])}}else if(i===K.current){if(null===(s=i.alternate))throw Error(r(387));s.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(pp):e=[pp])}i=i.return}null!==e&&Ta(t,e,n,a),t.flags|=262144}function Ia(e){for(e=e.firstContext;null!==e;){if(!er(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Aa(e){Ca=e,Na=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Pa(e){return qa(Ca,e)}function Oa(e,t){return null===Ca&&Aa(e),qa(e,t)}function qa(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Na){if(null===e)throw Error(r(308));Na=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Na=Na.next=t;return n}var za="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Ra=e.unstable_scheduleCallback,Ma=e.unstable_NormalPriority,Fa={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ua(){return{controller:new za,data:new Map,refCount:0}}function Ba(e){e.refCount--,0===e.refCount&&Ra(Ma,function(){e.controller.abort()})}var $a=null,Qa=0,Va=0,Wa=null;function Ha(){if(0===--Qa&&null!==$a){null!==Wa&&(Wa.status="fulfilled");var e=$a;$a=null,Va=0,Wa=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Ga=q.S;q.S=function(e,t){Oc=ue(),"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===$a){var n=$a=[];Qa=0,Va=Qu(),Wa={status:"pending",value:void 0,then:function(e){n.push(e)}}}Qa++,t.then(Ha,Ha)}(0,t),null!==Ga&&Ga(e,t)};var Ka=U(null);function Ya(){var e=Ka.current;return null!==e?e:gc.pooledCache}function Ja(e,t){$(Ka,null===t?Ka.current:t.pool)}function Xa(){var e=Ya();return null===e?null:{parent:Fa._currentValue,pool:e}}var Za=Error(r(460)),ei=Error(r(474)),ti=Error(r(542)),ni={then:function(){}};function ri(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ai(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Pt,Pt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw li(e=t.reason),e;default:if("string"==typeof t.status)t.then(Pt,Pt);else{if(null!==(e=gc)&&100<e.shellSuspendCounter)throw Error(r(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw li(e=t.reason),e}throw oi=t,Za}}function ii(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"==typeof t&&"function"==typeof t.then)throw oi=t,Za;throw t}}var oi=null;function si(){if(null===oi)throw Error(r(459));var e=oi;return oi=null,e}function li(e){if(e===Za||e===ti)throw Error(r(483))}var ci=null,ui=0;function di(e){var t=ui;return ui+=1,null===ci&&(ci=[]),ai(ci,e,t)}function pi(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function mi(e,t){if(t.$$typeof===d)throw Error(r(525));throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function fi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function a(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Br(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Wr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===g?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===E&&ii(a)===t.type)?(pi(t=i(t,n.props),n),t.return=e,t):(pi(t=Qr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Gr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=Vr(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function m(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=Wr(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case p:return pi(n=Qr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case h:return(t=Gr(t,e.mode,n)).return=e,t;case E:return m(e,t=ii(t),n)}if(O(t)||I(t))return(t=Vr(t,e.mode,n,null)).return=e,t;if("function"==typeof t.then)return m(e,di(t),n);if(t.$$typeof===k)return m(e,Oa(e,t),n);mi(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return null!==a?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===a?c(e,t,n,r):null;case h:return n.key===a?u(e,t,n,r):null;case E:return f(e,t,n=ii(n),r)}if(O(n)||I(n))return null!==a?null:d(e,t,n,r,null);if("function"==typeof n.then)return f(e,t,di(n),r);if(n.$$typeof===k)return f(e,t,Oa(e,n),r);mi(e,n)}return null}function y(e,t,n,r,a){if("string"==typeof r&&""!==r||"number"==typeof r||"bigint"==typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"==typeof r&&null!==r){switch(r.$$typeof){case p:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case h:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case E:return y(e,t,n,r=ii(r),a)}if(O(r)||I(r))return d(t,e=e.get(n)||null,r,a,null);if("function"==typeof r.then)return y(e,t,n,di(r),a);if(r.$$typeof===k)return y(e,t,n,Oa(t,r),a);mi(t,r)}return null}function b(l,c,u,d){if("object"==typeof u&&null!==u&&u.type===g&&null===u.key&&(u=u.props.children),"object"==typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var x=u.key;null!==c;){if(c.key===x){if((x=u.type)===g){if(7===c.tag){n(l,c.sibling),(d=i(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===x||"object"==typeof x&&null!==x&&x.$$typeof===E&&ii(x)===c.type){n(l,c.sibling),pi(d=i(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===g?((d=Vr(u.props.children,l.mode,d,u.key)).return=l,l=d):(pi(d=Qr(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return s(l);case h:e:{for(x=u.key;null!==c;){if(c.key===x){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=i(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=Gr(u,l.mode,d)).return=l,l=d}return s(l);case E:return b(l,c,u=ii(u),d)}if(O(u))return function(r,i,s,l){for(var c=null,u=null,d=i,p=i=0,h=null;null!==d&&p<s.length;p++){d.index>p?(h=d,d=null):h=d.sibling;var g=f(r,d,s[p],l);if(null===g){null===d&&(d=h);break}e&&d&&null===g.alternate&&t(r,d),i=o(g,i,p),null===u?c=g:u.sibling=g,u=g,d=h}if(p===s.length)return n(r,d),ma&&oa(r,p),c;if(null===d){for(;p<s.length;p++)null!==(d=m(r,s[p],l))&&(i=o(d,i,p),null===u?c=d:u.sibling=d,u=d);return ma&&oa(r,p),c}for(d=a(d);p<s.length;p++)null!==(h=y(d,r,p,s[p],l))&&(e&&null!==h.alternate&&d.delete(null===h.key?p:h.key),i=o(h,i,p),null===u?c=h:u.sibling=h,u=h);return e&&d.forEach(function(e){return t(r,e)}),ma&&oa(r,p),c}(l,c,u,d);if(I(u)){if("function"!=typeof(x=I(u)))throw Error(r(150));return function(i,s,l,c){if(null==l)throw Error(r(151));for(var u=null,d=null,p=s,h=s=0,g=null,b=l.next();null!==p&&!b.done;h++,b=l.next()){p.index>h?(g=p,p=null):g=p.sibling;var x=f(i,p,b.value,c);if(null===x){null===p&&(p=g);break}e&&p&&null===x.alternate&&t(i,p),s=o(x,s,h),null===d?u=x:d.sibling=x,d=x,p=g}if(b.done)return n(i,p),ma&&oa(i,h),u;if(null===p){for(;!b.done;h++,b=l.next())null!==(b=m(i,b.value,c))&&(s=o(b,s,h),null===d?u=b:d.sibling=b,d=b);return ma&&oa(i,h),u}for(p=a(p);!b.done;h++,b=l.next())null!==(b=y(p,i,h,b.value,c))&&(e&&null!==b.alternate&&p.delete(null===b.key?h:b.key),s=o(b,s,h),null===d?u=b:d.sibling=b,d=b);return e&&p.forEach(function(e){return t(i,e)}),ma&&oa(i,h),u}(l,c,u=x.call(u),d)}if("function"==typeof u.then)return b(l,c,di(u),d);if(u.$$typeof===k)return b(l,c,Oa(l,u),d);mi(l,u)}return"string"==typeof u&&""!==u||"number"==typeof u||"bigint"==typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=i(c,u)).return=l,l=d):(n(l,c),(d=Wr(u,l.mode,d)).return=l,l=d),s(l)):n(l,c)}return function(e,t,n,r){try{ui=0;var a=b(e,t,n,r);return ci=null,a}catch(o){if(o===Za||o===ti)throw o;var i=Fr(29,o,null,e.mode);return i.lanes=r,i.return=e,i}}}var hi=fi(!0),gi=fi(!1),yi=!1;function bi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function xi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function vi(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function wi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&hc){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,t=zr(e),qr(e,null,n),t}return Ar(e,r,t,n),zr(e)}function ki(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,qe(e,n)}}function Si(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var ji=!1;function Ci(){if(ji){if(null!==Wa)throw Wa}}function Ni(e,t,n,r){ji=!1;var a=e.updateQueue;yi=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?i=c:o.next=c,o=l;var d=e.alternate;null!==d&&((s=(d=d.updateQueue).lastBaseUpdate)!==o&&(null===s?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(null!==i){var p=a.baseState;for(o=0,d=c=l=null,s=i;;){var m=-536870913&s.lane,f=m!==s.lane;if(f?(bc&m)===m:(r&m)===m){0!==m&&m===Va&&(ji=!0),null!==d&&(d=d.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var h=e,g=s;m=t;var y=n;switch(g.tag){case 1:if("function"==typeof(h=g.payload)){p=h.call(y,p,m);break e}p=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null==(m="function"==typeof(h=g.payload)?h.call(y,p,m):h))break e;p=u({},p,m);break e;case 2:yi=!0}}null!==(m=s.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=a.callbacks)?a.callbacks=[m]:f.push(m))}else f={lane:m,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(c=d=f,l=p):d=d.next=f,o|=m;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(f=s).next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}null===d&&(l=p),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null===i&&(a.shared.lanes=0),Nc|=o,e.lanes=o,e.memoizedState=p}}function _i(e,t){if("function"!=typeof e)throw Error(r(191,e));e.call(t)}function Ei(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)_i(n[e],t)}var Li=U(null),Ti=U(0);function Di(e,t){$(Ti,e=jc),$(Li,t),jc=e|t.baseLanes}function Ii(){$(Ti,jc),$(Li,Li.current)}function Ai(){jc=Ti.current,B(Li),B(Ti)}var Pi=U(null),Oi=null;function qi(e){var t=e.alternate;$(Ui,1&Ui.current),$(Pi,e),null===Oi&&(null===t||null!==Li.current||null!==t.memoizedState)&&(Oi=e)}function zi(e){$(Ui,Ui.current),$(Pi,e),null===Oi&&(Oi=e)}function Ri(e){22===e.tag?($(Ui,Ui.current),$(Pi,e),null===Oi&&(Oi=e)):Mi()}function Mi(){$(Ui,Ui.current),$(Pi,Pi.current)}function Fi(e){B(Pi),Oi===e&&(Oi=null),B(Ui)}var Ui=U(0);function Bi(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Ad(n)||Pd(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(128&t.flags)return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $i=0,Qi=null,Vi=null,Wi=null,Hi=!1,Gi=!1,Ki=!1,Yi=0,Ji=0,Xi=null,Zi=0;function eo(){throw Error(r(321))}function to(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!er(e[n],t[n]))return!1;return!0}function no(e,t,n,r,a,i){return $i=i,Qi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,q.H=null===e||null===e.memoizedState?bs:xs,Ki=!1,i=n(r,a),Ki=!1,Gi&&(i=ao(t,n,r,a)),ro(e),i}function ro(e){q.H=ys;var t=null!==Vi&&null!==Vi.next;if($i=0,Wi=Vi=Qi=null,Hi=!1,Ji=0,Xi=null,t)throw Error(r(300));null===e||Os||null!==(e=e.dependencies)&&Ia(e)&&(Os=!0)}function ao(e,t,n,a){Qi=e;var i=0;do{if(Gi&&(Xi=null),Ji=0,Gi=!1,25<=i)throw Error(r(301));if(i+=1,Wi=Vi=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}q.H=vs,o=t(n,a)}while(Gi);return o}function io(){var e=q.H,t=e.useState()[0];return t="function"==typeof t.then?po(t):t,e=e.useState()[0],(null!==Vi?Vi.memoizedState:null)!==e&&(Qi.flags|=1024),t}function oo(){var e=0!==Yi;return Yi=0,e}function so(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function lo(e){if(Hi){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Hi=!1}$i=0,Wi=Vi=Qi=null,Gi=!1,Ji=Yi=0,Xi=null}function co(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Wi?Qi.memoizedState=Wi=e:Wi=Wi.next=e,Wi}function uo(){if(null===Vi){var e=Qi.alternate;e=null!==e?e.memoizedState:null}else e=Vi.next;var t=null===Wi?Qi.memoizedState:Wi.next;if(null!==t)Wi=t,Vi=e;else{if(null===e){if(null===Qi.alternate)throw Error(r(467));throw Error(r(310))}e={memoizedState:(Vi=e).memoizedState,baseState:Vi.baseState,baseQueue:Vi.baseQueue,queue:Vi.queue,next:null},null===Wi?Qi.memoizedState=Wi=e:Wi=Wi.next=e}return Wi}function po(e){var t=Ji;return Ji+=1,null===Xi&&(Xi=[]),e=ai(Xi,e,t),t=Qi,null===(null===Wi?t.memoizedState:Wi.next)&&(t=t.alternate,q.H=null===t||null===t.memoizedState?bs:xs),e}function mo(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return po(e);if(e.$$typeof===k)return Pa(e)}throw Error(r(438,String(e)))}function fo(e){var t=null,n=Qi.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Qi.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Qi.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=T;return t.index++,n}function ho(e,t){return"function"==typeof t?t(e):t}function go(e){return yo(uo(),Vi,e)}function yo(e,t,n){var a=e.queue;if(null===a)throw Error(r(311));a.lastRenderedReducer=n;var i=e.baseQueue,o=a.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}t.baseQueue=i=o,a.pending=null}if(o=e.baseState,null===i)e.memoizedState=o;else{var l=s=null,c=null,u=t=i.next,d=!1;do{var p=-536870913&u.lane;if(p!==u.lane?(bc&p)===p:($i&p)===p){var m=u.revertLane;if(0===m)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),p===Va&&(d=!0);else{if(($i&m)===m){u=u.next,m===Va&&(d=!0);continue}p={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=p,s=o):c=c.next=p,Qi.lanes|=m,Nc|=m}p=u.action,Ki&&n(o,p),o=u.hasEagerState?u.eagerState:n(o,p)}else m={lane:p,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=m,s=o):c=c.next=m,Qi.lanes|=p,Nc|=p;u=u.next}while(null!==u&&u!==t);if(null===c?s=o:c.next=l,!er(o,e.memoizedState)&&(Os=!0,d&&null!==(n=Wa)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=c,a.lastRenderedState=o}return null===i&&(a.lanes=0),[e.memoizedState,a.dispatch]}function bo(e){var t=uo(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var a=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);er(o,t.memoizedState)||(Os=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,a]}function xo(e,t,n){var a=Qi,i=uo(),o=ma;if(o){if(void 0===n)throw Error(r(407));n=n()}else n=t();var s=!er((Vi||i).memoizedState,n);if(s&&(i.memoizedState=n,Os=!0),i=i.queue,Qo(ko.bind(null,a,i,e),[e]),i.getSnapshot!==t||s||null!==Wi&&1&Wi.memoizedState.tag){if(a.flags|=2048,Mo(9,{destroy:void 0},wo.bind(null,a,i,n,t),null),null===gc)throw Error(r(349));o||127&$i||vo(a,t,n)}return n}function vo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Qi.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Qi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function wo(e,t,n,r){t.value=n,t.getSnapshot=r,So(t)&&jo(e)}function ko(e,t,n){return n(function(){So(t)&&jo(e)})}function So(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!er(e,n)}catch(r){return!0}}function jo(e){var t=Or(e,2);null!==t&&Yc(t,e,2)}function Co(e){var t=co();if("function"==typeof e){var n=e;if(e=n(),Ki){we(!0);try{n()}finally{we(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ho,lastRenderedState:e},t}function No(e,t,n,r){return e.baseState=n,yo(e,Vi,"function"==typeof r?r:ho)}function _o(e,t,n,a,i){if(fs(e))throw Error(r(485));if(null!==(e=t.action)){var o={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==q.T?n(!0):o.isTransition=!1,a(o),null===(n=t.pending)?(o.next=t.pending=o,Eo(t,o)):(o.next=n.next,t.pending=n.next=o)}}function Eo(e,t){var n=t.action,r=t.payload,a=e.state;if(t.isTransition){var i=q.T,o={};q.T=o;try{var s=n(a,r),l=q.S;null!==l&&l(o,s),Lo(e,t,s)}catch(c){Do(e,t,c)}finally{null!==i&&null!==o.types&&(i.types=o.types),q.T=i}}else try{Lo(e,t,i=n(a,r))}catch(u){Do(e,t,u)}}function Lo(e,t,n){null!==n&&"object"==typeof n&&"function"==typeof n.then?n.then(function(n){To(e,t,n)},function(n){return Do(e,t,n)}):To(e,t,n)}function To(e,t,n){t.status="fulfilled",t.value=n,Io(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Eo(e,n)))}function Do(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Io(t),t=t.next}while(t!==r)}e.action=null}function Io(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ao(e,t){return t}function Po(e,t){if(ma){var n=gc.formState;if(null!==n){e:{var r=Qi;if(ma){if(pa){t:{for(var a=pa,i=ha;8!==a.nodeType;){if(!i){a=null;break t}if(null===(a=Od(a.nextSibling))){a=null;break t}}a="F!"===(i=a.data)||"F"===i?a:null}if(a){pa=Od(a.nextSibling),r="F!"===a.data;break e}}ya(r)}r=!1}r&&(t=n[0])}}return(n=co()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ao,lastRenderedState:t},n.queue=r,n=ds.bind(null,Qi,r),r.dispatch=n,r=Co(!1),i=ms.bind(null,Qi,!1,r.queue),a={state:t,dispatch:null,action:e,pending:null},(r=co()).queue=a,n=_o.bind(null,Qi,a,i,n),a.dispatch=n,r.memoizedState=e,[t,n,!1]}function Oo(e){return qo(uo(),Vi,e)}function qo(e,t,n){if(t=yo(e,t,Ao)[0],e=go(ho)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var r=po(t)}catch(o){if(o===Za)throw ti;throw o}else r=t;var a=(t=uo()).queue,i=a.dispatch;return n!==t.memoizedState&&(Qi.flags|=2048,Mo(9,{destroy:void 0},zo.bind(null,a,n),null)),[r,i,e]}function zo(e,t){e.action=t}function Ro(e){var t=uo(),n=Vi;if(null!==n)return qo(t,n,e);uo(),t=t.memoizedState;var r=(n=uo()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Mo(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=Qi.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Qi.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fo(){return uo().memoizedState}function Uo(e,t,n,r){var a=co();Qi.flags|=e,a.memoizedState=Mo(1|t,{destroy:void 0},n,void 0===r?null:r)}function Bo(e,t,n,r){var a=uo();r=void 0===r?null:r;var i=a.memoizedState.inst;null!==Vi&&null!==r&&to(r,Vi.memoizedState.deps)?a.memoizedState=Mo(t,i,n,r):(Qi.flags|=e,a.memoizedState=Mo(1|t,i,n,r))}function $o(e,t){Uo(8390656,8,e,t)}function Qo(e,t){Bo(2048,8,e,t)}function Vo(e){var t=uo().memoizedState;return function(e){Qi.flags|=4;var t=Qi.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Qi.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(2&hc)throw Error(r(440));return t.impl.apply(void 0,arguments)}}function Wo(e,t){return Bo(4,2,e,t)}function Ho(e,t){return Bo(4,4,e,t)}function Go(e,t){if("function"==typeof t){e=e();var n=t(e);return function(){"function"==typeof n?n():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Ko(e,t,n){n=null!=n?n.concat([e]):null,Bo(4,4,Go.bind(null,t,e),n)}function Yo(){}function Jo(e,t){var n=uo();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&to(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Xo(e,t){var n=uo();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&to(t,r[1]))return r[0];if(r=e(),Ki){we(!0);try{e()}finally{we(!1)}}return n.memoizedState=[r,t],r}function Zo(e,t,n){return void 0===n||1073741824&$i&&!(261930&bc)?e.memoizedState=t:(e.memoizedState=n,e=Kc(),Qi.lanes|=e,Nc|=e,n)}function es(e,t,n,r){return er(n,t)?n:null!==Li.current?(e=Zo(e,n,r),er(e,t)||(Os=!0),e):42&$i&&(!(1073741824&$i)||261930&bc)?(e=Kc(),Qi.lanes|=e,Nc|=e,t):(Os=!0,e.memoizedState=n)}function ts(e,t,n,r,a){var i=z.p;z.p=0!==i&&8>i?i:8;var o,s,l,c=q.T,u={};q.T=u,ms(e,!1,t,n);try{var d=a(),p=q.S;if(null!==p&&p(u,d),null!==d&&"object"==typeof d&&"function"==typeof d.then)ps(e,t,(o=r,s=[],l={status:"pending",value:null,reason:null,then:function(e){s.push(e)}},d.then(function(){l.status="fulfilled",l.value=o;for(var e=0;e<s.length;e++)(0,s[e])(o)},function(e){for(l.status="rejected",l.reason=e,e=0;e<s.length;e++)(0,s[e])(void 0)}),l),Gc());else ps(e,t,r,Gc())}catch(m){ps(e,t,{then:function(){},status:"rejected",reason:m},Gc())}finally{z.p=i,null!==c&&null!==u.types&&(c.types=u.types),q.T=c}}function ns(){}function rs(e,t,n,a){if(5!==e.tag)throw Error(r(476));var i=as(e).queue;ts(e,i,t,R,null===n?ns:function(){return is(e),n(a)})}function as(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:R,baseState:R,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ho,lastRenderedState:R},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ho,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function is(e){var t=as(e);null===t.next&&(t=e.alternate.memoizedState),ps(e,t.next.queue,{},Gc())}function os(){return Pa(pp)}function ss(){return uo().memoizedState}function ls(){return uo().memoizedState}function cs(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Gc(),r=wi(t,e=vi(n),n);return null!==r&&(Yc(r,t,n),ki(r,t,n)),t={cache:Ua()},void(e.payload=t)}t=t.return}}function us(e,t,n){var r=Gc();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},fs(e)?hs(t,n):null!==(n=Pr(e,t,n,r))&&(Yc(n,e,r),gs(n,t,r))}function ds(e,t,n){ps(e,t,n,Gc())}function ps(e,t,n,r){var a={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(fs(e))hs(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,er(s,o))return Ar(e,t,a,0),null===gc&&Ir(),!1}catch(l){}if(null!==(n=Pr(e,t,a,r)))return Yc(n,e,r),gs(n,t,r),!0}return!1}function ms(e,t,n,a){if(a={lane:2,revertLane:Qu(),gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},fs(e)){if(t)throw Error(r(479))}else null!==(t=Pr(e,n,a,2))&&Yc(t,e,2)}function fs(e){var t=e.alternate;return e===Qi||null!==t&&t===Qi}function hs(e,t){Gi=Hi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function gs(e,t,n){if(4194048&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,qe(e,n)}}var ys={readContext:Pa,use:mo,useCallback:eo,useContext:eo,useEffect:eo,useImperativeHandle:eo,useLayoutEffect:eo,useInsertionEffect:eo,useMemo:eo,useReducer:eo,useRef:eo,useState:eo,useDebugValue:eo,useDeferredValue:eo,useTransition:eo,useSyncExternalStore:eo,useId:eo,useHostTransitionStatus:eo,useFormState:eo,useActionState:eo,useOptimistic:eo,useMemoCache:eo,useCacheRefresh:eo};ys.useEffectEvent=eo;var bs={readContext:Pa,use:mo,useCallback:function(e,t){return co().memoizedState=[e,void 0===t?null:t],e},useContext:Pa,useEffect:$o,useImperativeHandle:function(e,t,n){n=null!=n?n.concat([e]):null,Uo(4194308,4,Go.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Uo(4194308,4,e,t)},useInsertionEffect:function(e,t){Uo(4,2,e,t)},useMemo:function(e,t){var n=co();t=void 0===t?null:t;var r=e();if(Ki){we(!0);try{e()}finally{we(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=co();if(void 0!==n){var a=n(t);if(Ki){we(!0);try{n(t)}finally{we(!1)}}}else a=t;return r.memoizedState=r.baseState=a,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:a},r.queue=e,e=e.dispatch=us.bind(null,Qi,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},co().memoizedState=e},useState:function(e){var t=(e=Co(e)).queue,n=ds.bind(null,Qi,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Yo,useDeferredValue:function(e,t){return Zo(co(),e,t)},useTransition:function(){var e=Co(!1);return e=ts.bind(null,Qi,e.queue,!0,!1),co().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var a=Qi,i=co();if(ma){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===gc)throw Error(r(349));127&bc||vo(a,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,$o(ko.bind(null,a,o,e),[e]),a.flags|=2048,Mo(9,{destroy:void 0},wo.bind(null,a,o,n,t),null),n},useId:function(){var e=co(),t=gc.identifierPrefix;if(ma){var n=ia;t="_"+t+"R_"+(n=(aa&~(1<<32-ke(aa)-1)).toString(32)+n),0<(n=Yi++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Zi++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:os,useFormState:Po,useActionState:Po,useOptimistic:function(e){var t=co();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ms.bind(null,Qi,!0,n),n.dispatch=t,[e,t]},useMemoCache:fo,useCacheRefresh:function(){return co().memoizedState=cs.bind(null,Qi)},useEffectEvent:function(e){var t=co(),n={impl:e};return t.memoizedState=n,function(){if(2&hc)throw Error(r(440));return n.impl.apply(void 0,arguments)}}},xs={readContext:Pa,use:mo,useCallback:Jo,useContext:Pa,useEffect:Qo,useImperativeHandle:Ko,useInsertionEffect:Wo,useLayoutEffect:Ho,useMemo:Xo,useReducer:go,useRef:Fo,useState:function(){return go(ho)},useDebugValue:Yo,useDeferredValue:function(e,t){return es(uo(),Vi.memoizedState,e,t)},useTransition:function(){var e=go(ho)[0],t=uo().memoizedState;return["boolean"==typeof e?e:po(e),t]},useSyncExternalStore:xo,useId:ss,useHostTransitionStatus:os,useFormState:Oo,useActionState:Oo,useOptimistic:function(e,t){return No(uo(),0,e,t)},useMemoCache:fo,useCacheRefresh:ls};xs.useEffectEvent=Vo;var vs={readContext:Pa,use:mo,useCallback:Jo,useContext:Pa,useEffect:Qo,useImperativeHandle:Ko,useInsertionEffect:Wo,useLayoutEffect:Ho,useMemo:Xo,useReducer:bo,useRef:Fo,useState:function(){return bo(ho)},useDebugValue:Yo,useDeferredValue:function(e,t){var n=uo();return null===Vi?Zo(n,e,t):es(n,Vi.memoizedState,e,t)},useTransition:function(){var e=bo(ho)[0],t=uo().memoizedState;return["boolean"==typeof e?e:po(e),t]},useSyncExternalStore:xo,useId:ss,useHostTransitionStatus:os,useFormState:Ro,useActionState:Ro,useOptimistic:function(e,t){var n=uo();return null!==Vi?No(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:fo,useCacheRefresh:ls};function ws(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:u({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}vs.useEffectEvent=Vo;var ks={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Gc(),a=vi(r);a.payload=t,null!=n&&(a.callback=n),null!==(t=wi(e,a,r))&&(Yc(t,e,r),ki(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Gc(),a=vi(r);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=wi(e,a,r))&&(Yc(t,e,r),ki(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Gc(),r=vi(n);r.tag=2,null!=t&&(r.callback=t),null!==(t=wi(e,r,n))&&(Yc(t,e,n),ki(t,e,n))}};function Ss(e,t,n,r,a,i,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!tr(n,r)||!tr(a,i))}function js(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ks.enqueueReplaceState(t,t.state,null)}function Cs(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var a in n===t&&(n=u({},n)),e)void 0===n[a]&&(n[a]=e[a]);return n}function Ns(e){Er(e)}function _s(e){}function Es(e){Er(e)}function Ls(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Ts(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Ds(e,t,n){return(n=vi(n)).tag=3,n.payload={element:null},n.callback=function(){Ls(e,t)},n}function Is(e){return(e=vi(e)).tag=3,e}function As(e,t,n,r){var a=n.type.getDerivedStateFromError;if("function"==typeof a){var i=r.value;e.payload=function(){return a(i)},e.callback=function(){Ts(t,n,r)}}var o=n.stateNode;null!==o&&"function"==typeof o.componentDidCatch&&(e.callback=function(){Ts(t,n,r),"function"!=typeof a&&(null===Rc?Rc=new Set([this]):Rc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Ps=Error(r(461)),Os=!1;function qs(e,t,n,r){t.child=null===e?gi(t,null,n,r):hi(t,e.child,n,r)}function zs(e,t,n,r,a){n=n.render;var i=t.ref;if("ref"in r){var o={};for(var s in r)"ref"!==s&&(o[s]=r[s])}else o=r;return Aa(t),r=no(e,t,n,o,i,a),s=oo(),null===e||Os?(ma&&s&&la(t),t.flags|=1,qs(e,t,r,a),t.child):(so(e,t,a),ol(e,t,a))}function Rs(e,t,n,r,a){if(null===e){var i=n.type;return"function"!=typeof i||Ur(i)||void 0!==i.defaultProps||null!==n.compare?((e=Qr(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ms(e,t,i,r,a))}if(i=e.child,!sl(e,a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:tr)(o,r)&&e.ref===t.ref)return ol(e,t,a)}return t.flags|=1,(e=Br(i,r)).ref=t.ref,e.return=t,t.child=e}function Ms(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(tr(i,r)&&e.ref===t.ref){if(Os=!1,t.pendingProps=r=i,!sl(e,a))return t.lanes=e.lanes,ol(e,t,a);131072&e.flags&&(Os=!0)}}return Ws(e,t,n,r,a)}function Fs(e,t,n,r){var a=r.children,i=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(128&t.flags){if(i=null!==i?i.baseLanes|n:n,null!==e){for(r=t.child=e.child,a=0;null!==r;)a=a|r.lanes|r.childLanes,r=r.sibling;r=a&~i}else r=0,t.child=null;return Bs(e,t,i,n,r)}if(!(536870912&n))return r=t.lanes=536870912,Bs(e,t,null!==i?i.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ja(0,null!==i?i.cachePool:null),null!==i?Di(t,i):Ii(),Ri(t)}else null!==i?(Ja(0,i.cachePool),Di(t,i),Mi(),t.memoizedState=null):(null!==e&&Ja(0,null),Ii(),Mi());return qs(e,t,a,n),t.child}function Us(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Bs(e,t,n,r,a){var i=Ya();return i=null===i?null:{parent:Fa._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&Ja(0,null),Ii(),Ri(t),null!==e&&Da(e,t,r,!0),t.childLanes=a,null}function $s(e,t){return(t=tl({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Qs(e,t,n){return hi(t,e.child,null,n),(e=$s(t,t.pendingProps)).flags|=2,Fi(t),t.memoizedState=null,e}function Vs(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof n&&"object"!=typeof n)throw Error(r(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Ws(e,t,n,r,a){return Aa(t),n=no(e,t,n,r,void 0,a),r=oo(),null===e||Os?(ma&&r&&la(t),t.flags|=1,qs(e,t,n,a),t.child):(so(e,t,a),ol(e,t,a))}function Hs(e,t,n,r,a,i){return Aa(t),t.updateQueue=null,n=ao(t,r,n,a),ro(e),r=oo(),null===e||Os?(ma&&r&&la(t),t.flags|=1,qs(e,t,n,i),t.child):(so(e,t,i),ol(e,t,i))}function Gs(e,t,n,r,a){if(Aa(t),null===t.stateNode){var i=Rr,o=n.contextType;"object"==typeof o&&null!==o&&(i=Pa(o)),i=new n(r,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=ks,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=r,i.state=t.memoizedState,i.refs={},bi(t),o=n.contextType,i.context="object"==typeof o&&null!==o?Pa(o):Rr,i.state=t.memoizedState,"function"==typeof(o=n.getDerivedStateFromProps)&&(ws(t,n,o,r),i.state=t.memoizedState),"function"==typeof n.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(o=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),o!==i.state&&ks.enqueueReplaceState(i,i.state,null),Ni(t,r,i,a),Ci(),i.state=t.memoizedState),"function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){i=t.stateNode;var s=t.memoizedProps,l=Cs(n,s);i.props=l;var c=i.context,u=n.contextType;o=Rr,"object"==typeof u&&null!==u&&(o=Pa(u));var d=n.getDerivedStateFromProps;u="function"==typeof d||"function"==typeof i.getSnapshotBeforeUpdate,s=t.pendingProps!==s,u||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(s||c!==o)&&js(t,i,r,o),yi=!1;var p=t.memoizedState;i.state=p,Ni(t,r,i,a),Ci(),c=t.memoizedState,s||p!==c||yi?("function"==typeof d&&(ws(t,n,d,r),c=t.memoizedState),(l=yi||Ss(t,n,l,r,p,c,o))?(u||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=o,r=l):("function"==typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,xi(e,t),u=Cs(n,o=t.memoizedProps),i.props=u,d=t.pendingProps,p=i.context,c=n.contextType,l=Rr,"object"==typeof c&&null!==c&&(l=Pa(c)),(c="function"==typeof(s=n.getDerivedStateFromProps)||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(o!==d||p!==l)&&js(t,i,r,l),yi=!1,p=t.memoizedState,i.state=p,Ni(t,r,i,a),Ci();var m=t.memoizedState;o!==d||p!==m||yi||null!==e&&null!==e.dependencies&&Ia(e.dependencies)?("function"==typeof s&&(ws(t,n,s,r),m=t.memoizedState),(u=yi||Ss(t,n,u,r,p,m,l)||null!==e&&null!==e.dependencies&&Ia(e.dependencies))?(c||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(r,m,l),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,m,l)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),i.props=r,i.state=m,i.context=l,r=u):("function"!=typeof i.componentDidUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return i=r,Vs(e,t),r=!!(128&t.flags),i||r?(i=t.stateNode,n=r&&"function"!=typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&r?(t.child=hi(t,e.child,null,a),t.child=hi(t,null,n,a)):qs(e,t,n,a),t.memoizedState=i.state,e=t.child):e=ol(e,t,a),e}function Ks(e,t,n,r){return wa(),t.flags|=256,qs(e,t,n,r),t.child}var Ys={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Js(e){return{baseLanes:e,cachePool:Xa()}}function Xs(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Lc),e}function Zs(e,t,n){var a,i=t.pendingProps,o=!1,s=!!(128&t.flags);if((a=s)||(a=(null===e||null!==e.memoizedState)&&!!(2&Ui.current)),a&&(o=!0,t.flags&=-129),a=!!(32&t.flags),t.flags&=-33,null===e){if(ma){if(o?qi(t):Mi(),(e=pa)?null!==(e=null!==(e=Id(e,ha))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ra?{id:aa,overflow:ia}:null,retryLane:536870912,hydrationErrors:null},(n=Hr(e)).return=t,t.child=n,da=t,pa=null):e=null,null===e)throw ya(t);return Pd(e)?t.lanes=32:t.lanes=536870912,null}var l=i.children;return i=i.fallback,o?(Mi(),l=tl({mode:"hidden",children:l},o=t.mode),i=Vr(i,o,n,null),l.return=t,i.return=t,l.sibling=i,t.child=l,(i=t.child).memoizedState=Js(n),i.childLanes=Xs(e,a,n),t.memoizedState=Ys,Us(null,i)):(qi(t),el(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(s)256&t.flags?(qi(t),t.flags&=-257,t=nl(e,t,n)):null!==t.memoizedState?(Mi(),t.child=e.child,t.flags|=128,t=null):(Mi(),l=i.fallback,o=t.mode,i=tl({mode:"visible",children:i.children},o),(l=Vr(l,o,n,null)).flags|=2,i.return=t,l.return=t,i.sibling=l,t.child=i,hi(t,e.child,null,n),(i=t.child).memoizedState=Js(n),i.childLanes=Xs(e,a,n),t.memoizedState=Ys,t=Us(null,i));else if(qi(t),Pd(l)){if(a=l.nextSibling&&l.nextSibling.dataset)var u=a.dgst;a=u,(i=Error(r(419))).stack="",i.digest=a,Sa({value:i,source:null,stack:null}),t=nl(e,t,n)}else if(Os||Da(e,t,n,!1),a=0!==(n&e.childLanes),Os||a){if(null!==(a=gc)&&(0!==(i=ze(a,n))&&i!==c.retryLane))throw c.retryLane=i,Or(e,i),Yc(a,e,i),Ps;Ad(l)||lu(),t=nl(e,t,n)}else Ad(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,pa=Od(l.nextSibling),da=t,ma=!0,fa=null,ha=!1,null!==e&&ua(t,e),(t=el(t,i.children)).flags|=4096);return t}return o?(Mi(),l=i.fallback,o=t.mode,u=(c=e.child).sibling,(i=Br(c,{mode:"hidden",children:i.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=Br(u,l):(l=Vr(l,o,n,null)).flags|=2,l.return=t,i.return=t,i.sibling=l,t.child=i,Us(null,i),i=t.child,null===(l=e.child.memoizedState)?l=Js(n):(null!==(o=l.cachePool)?(c=Fa._currentValue,o=o.parent!==c?{parent:c,pool:c}:o):o=Xa(),l={baseLanes:l.baseLanes|n,cachePool:o}),i.memoizedState=l,i.childLanes=Xs(e,a,n),t.memoizedState=Ys,Us(e.child,i)):(qi(t),e=(n=e.child).sibling,(n=Br(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(a=t.deletions)?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=n,t.memoizedState=null,n)}function el(e,t){return(t=tl({mode:"visible",children:t},e.mode)).return=e,e.child=t}function tl(e,t){return(e=Fr(22,e,null,t)).lanes=0,e}function nl(e,t,n){return hi(t,e.child,null,n),(e=el(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function rl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),La(e.return,t,n)}function al(e,t,n,r,a,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,treeForkCount:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a,o.treeForkCount=i)}function il(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;r=r.children;var o=Ui.current,s=!!(2&o);if(s?(o=1&o|2,t.flags|=128):o&=1,$(Ui,o),qs(e,t,r,n),r=ma?ea:0,!s&&null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&rl(e,n,t);else if(19===e.tag)rl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===Bi(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),al(t,!1,a,n,i,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===Bi(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}al(t,!0,n,null,i,r);break;case"together":al(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function ol(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Nc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Da(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=Br(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Br(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function sl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ia(e))}function ll(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Os=!0;else{if(!(sl(e,n)||128&t.flags))return Os=!1,function(e,t,n){switch(t.tag){case 3:Y(t,t.stateNode.containerInfo),_a(0,Fa,e.memoizedState.cache),wa();break;case 27:case 5:X(t);break;case 4:Y(t,t.stateNode.containerInfo);break;case 10:_a(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,zi(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(qi(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Zs(e,t,n):(qi(t),null!==(e=ol(e,t,n))?e.sibling:null);qi(t);break;case 19:var a=!!(128&e.flags);if((r=0!==(n&t.childLanes))||(Da(e,t,n,!1),r=0!==(n&t.childLanes)),a){if(r)return il(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),$(Ui,Ui.current),r)break;return null;case 22:return t.lanes=0,Fs(e,t,n,t.pendingProps);case 24:_a(0,Fa,e.memoizedState.cache)}return ol(e,t,n)}(e,t,n);Os=!!(131072&e.flags)}else Os=!1,ma&&1048576&t.flags&&sa(t,ea,t.index);switch(t.lanes=0,t.tag){case 16:e:{var a=t.pendingProps;if(e=ii(t.elementType),t.type=e,"function"!=typeof e){if(null!=e){var i=e.$$typeof;if(i===S){t.tag=11,t=zs(null,t,e,a,n);break e}if(i===_){t.tag=14,t=Rs(null,t,e,a,n);break e}}throw t=P(e)||e,Error(r(306,t,""))}Ur(e)?(a=Cs(e,a),t.tag=1,t=Gs(null,t,e,a,n)):(t.tag=0,t=Ws(null,t,e,a,n))}return t;case 0:return Ws(e,t,t.type,t.pendingProps,n);case 1:return Gs(e,t,a=t.type,i=Cs(a,t.pendingProps),n);case 3:e:{if(Y(t,t.stateNode.containerInfo),null===e)throw Error(r(387));a=t.pendingProps;var o=t.memoizedState;i=o.element,xi(e,t),Ni(t,a,null,n);var s=t.memoizedState;if(a=s.cache,_a(0,Fa,a),a!==o.cache&&Ta(t,[Fa],n,!0),Ci(),a=s.element,o.isDehydrated){if(o={element:a,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ks(e,t,a,n);break e}if(a!==i){Sa(i=Yr(Error(r(424)),t)),t=Ks(e,t,a,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(pa=Od(e.firstChild),da=t,ma=!0,fa=null,ha=!0,n=gi(t,null,a,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(wa(),a===i){t=ol(e,t,n);break e}qs(e,t,a,n)}t=t.child}return t;case 26:return Vs(e,t),null===e?(n=Hd(t.type,null,t.pendingProps,null))?t.memoizedState=n:ma||(n=t.type,e=t.pendingProps,(a=bd(G.current).createElement(n))[$e]=t,a[Qe]=e,fd(a,n,e),nt(a),t.stateNode=a):t.memoizedState=Hd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return X(t),null===e&&ma&&(a=t.stateNode=Md(t.type,t.pendingProps,G.current),da=t,ha=!0,i=pa,Ed(t.type)?(qd=i,pa=Od(a.firstChild)):pa=i),qs(e,t,t.pendingProps.children,n),Vs(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ma&&((i=a=pa)&&(null!==(a=function(e,t,n,r){for(;1===e.nodeType;){var a=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ye])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==a.rel||e.getAttribute("href")!==(null==a.href||""===a.href?null:a.href)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin)||e.getAttribute("title")!==(null==a.title?null:a.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==a.src?null:a.src)||e.getAttribute("type")!==(null==a.type?null:a.type)||e.getAttribute("crossorigin")!==(null==a.crossOrigin?null:a.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==a.name?null:""+a.name;if("hidden"===a.type&&e.getAttribute("name")===i)return e}if(null===(e=Od(e.nextSibling)))break}return null}(a,t.type,t.pendingProps,ha))?(t.stateNode=a,da=t,pa=Od(a.firstChild),ha=!1,i=!0):i=!1),i||ya(t)),X(t),i=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,a=o.children,wd(i,o)?a=null:null!==s&&wd(i,s)&&(t.flags|=32),null!==t.memoizedState&&(i=no(e,t,io,null,null,n),pp._currentValue=i),Vs(e,t),qs(e,t,a,n),t.child;case 6:return null===e&&ma&&((e=n=pa)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Od(e.nextSibling)))return null}return e}(n,t.pendingProps,ha))?(t.stateNode=n,da=t,pa=null,e=!0):e=!1),e||ya(t)),null;case 13:return Zs(e,t,n);case 4:return Y(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=hi(t,null,a,n):qs(e,t,a,n),t.child;case 11:return zs(e,t,t.type,t.pendingProps,n);case 7:return qs(e,t,t.pendingProps,n),t.child;case 8:case 12:return qs(e,t,t.pendingProps.children,n),t.child;case 10:return a=t.pendingProps,_a(0,t.type,a.value),qs(e,t,a.children,n),t.child;case 9:return i=t.type._context,a=t.pendingProps.children,Aa(t),a=a(i=Pa(i)),t.flags|=1,qs(e,t,a,n),t.child;case 14:return Rs(e,t,t.type,t.pendingProps,n);case 15:return Ms(e,t,t.type,t.pendingProps,n);case 19:return il(e,t,n);case 31:return function(e,t,n){var a=t.pendingProps,i=!!(128&t.flags);if(t.flags&=-129,null===e){if(ma){if("hidden"===a.mode)return e=$s(t,a),t.lanes=536870912,Us(null,e);if(zi(t),(e=pa)?null!==(e=null!==(e=Id(e,ha))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ra?{id:aa,overflow:ia}:null,retryLane:536870912,hydrationErrors:null},(n=Hr(e)).return=t,t.child=n,da=t,pa=null):e=null,null===e)throw ya(t);return t.lanes=536870912,null}return $s(t,a)}var o=e.memoizedState;if(null!==o){var s=o.dehydrated;if(zi(t),i)if(256&t.flags)t.flags&=-257,t=Qs(e,t,n);else{if(null===t.memoizedState)throw Error(r(558));t.child=e.child,t.flags|=128,t=null}else if(Os||Da(e,t,n,!1),i=0!==(n&e.childLanes),Os||i){if(null!==(a=gc)&&0!==(s=ze(a,n))&&s!==o.retryLane)throw o.retryLane=s,Or(e,s),Yc(a,e,s),Ps;lu(),t=Qs(e,t,n)}else e=o.treeContext,pa=Od(s.nextSibling),da=t,ma=!0,fa=null,ha=!1,null!==e&&ua(t,e),(t=$s(t,a)).flags|=4096;return t}return(e=Br(e.child,{mode:a.mode,children:a.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Fs(e,t,n,t.pendingProps);case 24:return Aa(t),a=Pa(Fa),null===e?(null===(i=Ya())&&(i=gc,o=Ua(),i.pooledCache=o,o.refCount++,null!==o&&(i.pooledCacheLanes|=n),i=o),t.memoizedState={parent:a,cache:i},bi(t),_a(0,Fa,i)):(0!==(e.lanes&n)&&(xi(e,t),Ni(t,null,null,n),Ci()),i=e.memoizedState,o=t.memoizedState,i.parent!==a?(i={parent:a,cache:a},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),_a(0,Fa,a)):(a=o.cache,_a(0,Fa,a),a!==i.cache&&Ta(t,[Fa],n,!0))),qs(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(r(156,t.tag))}function cl(e){e.flags|=4}function ul(e,t,n,r,a){if((t=!!(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&a)===a)if(e.stateNode.complete)e.flags|=8192;else{if(!iu())throw oi=ni,ei;e.flags|=8192}}else e.flags&=-16777217}function dl(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!op(t)){if(!iu())throw oi=ni,ei;e.flags|=8192}}function pl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Ie():536870912,e.lanes|=t,Tc|=t)}function ml(e,t){if(!ma)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function fl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=65011712&a.subtreeFlags,r|=65011712&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function hl(e,t,n){var a=t.pendingProps;switch(ca(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return fl(t),null;case 3:return n=t.stateNode,a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Ea(Fa),J(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(va(t)?cl(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,ka())),fl(t),null;case 26:var i=t.type,o=t.memoizedState;return null===e?(cl(t),null!==o?(fl(t),dl(t,o)):(fl(t),ul(t,i,0,0,n))):o?o!==e.memoizedState?(cl(t),fl(t),dl(t,o)):(fl(t),t.flags&=-16777217):((e=e.memoizedProps)!==a&&cl(t),fl(t),ul(t,i,0,0,n)),null;case 27:if(Z(t),n=G.current,i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==a&&cl(t);else{if(!a){if(null===t.stateNode)throw Error(r(166));return fl(t),null}e=W.current,va(t)?ba(t):(e=Md(i,a,n),t.stateNode=e,cl(t))}return fl(t),null;case 5:if(Z(t),i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==a&&cl(t);else{if(!a){if(null===t.stateNode)throw Error(r(166));return fl(t),null}if(o=W.current,va(t))ba(t);else{var s=bd(G.current);switch(o){case 1:o=s.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:o=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":o=s.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":o=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(o=s.createElement("div")).innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o="string"==typeof a.is?s.createElement("select",{is:a.is}):s.createElement("select"),a.multiple?o.multiple=!0:a.size&&(o.size=a.size);break;default:o="string"==typeof a.is?s.createElement(i,{is:a.is}):s.createElement(i)}}o[$e]=t,o[Qe]=a;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)o.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=o;e:switch(fd(o,i,a),i){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&cl(t)}}return fl(t),ul(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==a&&cl(t);else{if("string"!=typeof a&&null===t.stateNode)throw Error(r(166));if(e=G.current,va(t)){if(e=t.stateNode,n=t.memoizedProps,a=null,null!==(i=da))switch(i.tag){case 27:case 5:a=i.memoizedProps}e[$e]=t,(e=!!(e.nodeValue===n||null!==a&&!0===a.suppressHydrationWarning||dd(e.nodeValue,n)))||ya(t,!0)}else(e=bd(e).createTextNode(a))[$e]=t,t.stateNode=e}return fl(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(a=va(t),null!==n){if(null===e){if(!a)throw Error(r(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(r(557));e[$e]=t}else wa(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;fl(t),e=!1}else n=ka(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(Fi(t),t):(Fi(t),null);if(128&t.flags)throw Error(r(558))}return fl(t),null;case 13:if(a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=va(t),null!==a&&null!==a.dehydrated){if(null===e){if(!i)throw Error(r(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(r(317));i[$e]=t}else wa(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;fl(t),i=!1}else i=ka(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(Fi(t),t):(Fi(t),null)}return Fi(t),128&t.flags?(t.lanes=n,t):(n=null!==a,e=null!==e&&null!==e.memoizedState,n&&(i=null,null!==(a=t.child).alternate&&null!==a.alternate.memoizedState&&null!==a.alternate.memoizedState.cachePool&&(i=a.alternate.memoizedState.cachePool.pool),o=null,null!==a.memoizedState&&null!==a.memoizedState.cachePool&&(o=a.memoizedState.cachePool.pool),o!==i&&(a.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),pl(t,t.updateQueue),fl(t),null);case 4:return J(),null===e&&td(t.stateNode.containerInfo),fl(t),null;case 10:return Ea(t.type),fl(t),null;case 19:if(B(Ui),null===(a=t.memoizedState))return fl(t),null;if(i=!!(128&t.flags),null===(o=a.rendering))if(i)ml(a,!1);else{if(0!==Cc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(o=Bi(e))){for(t.flags|=128,ml(a,!1),e=o.updateQueue,t.updateQueue=e,pl(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)$r(n,e),n=n.sibling;return $(Ui,1&Ui.current|2),ma&&oa(t,a.treeForkCount),t.child}e=e.sibling}null!==a.tail&&ue()>qc&&(t.flags|=128,i=!0,ml(a,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=Bi(o))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,pl(t,e),ml(a,!0),null===a.tail&&"hidden"===a.tailMode&&!o.alternate&&!ma)return fl(t),null}else 2*ue()-a.renderingStartTime>qc&&536870912!==n&&(t.flags|=128,i=!0,ml(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=a.last)?e.sibling=o:t.child=o,a.last=o)}return null!==a.tail?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=ue(),e.sibling=null,n=Ui.current,$(Ui,i?1&n|2:1&n),ma&&oa(t,a.treeForkCount),e):(fl(t),null);case 22:case 23:return Fi(t),Ai(),a=null!==t.memoizedState,null!==e?null!==e.memoizedState!==a&&(t.flags|=8192):a&&(t.flags|=8192),a?!!(536870912&n)&&!(128&t.flags)&&(fl(t),6&t.subtreeFlags&&(t.flags|=8192)):fl(t),null!==(n=t.updateQueue)&&pl(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),a=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(a=t.memoizedState.cachePool.pool),a!==n&&(t.flags|=2048),null!==e&&B(Ka),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ea(Fa),fl(t),null;case 25:case 30:return null}throw Error(r(156,t.tag))}function gl(e,t){switch(ca(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ea(Fa),J(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Z(t),null;case 31:if(null!==t.memoizedState){if(Fi(t),null===t.alternate)throw Error(r(340));wa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Fi(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));wa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return B(Ui),null;case 4:return J(),null;case 10:return Ea(t.type),null;case 22:case 23:return Fi(t),Ai(),null!==e&&B(Ka),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ea(Fa),null;default:return null}}function yl(e,t){switch(ca(t),t.tag){case 3:Ea(Fa),J();break;case 26:case 27:case 5:Z(t);break;case 4:J();break;case 31:null!==t.memoizedState&&Fi(t);break;case 13:Fi(t);break;case 19:B(Ui);break;case 10:Ea(t.type);break;case 22:case 23:Fi(t),Ai(),null!==e&&B(Ka);break;case 24:Ea(Fa)}}function bl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var a=r.next;n=a;do{if((n.tag&e)===e){r=void 0;var i=n.create,o=n.inst;r=i(),o.destroy=r}n=n.next}while(n!==a)}}catch(s){Cu(t,t.return,s)}}function xl(e,t,n){try{var r=t.updateQueue,a=null!==r?r.lastEffect:null;if(null!==a){var i=a.next;r=i;do{if((r.tag&e)===e){var o=r.inst,s=o.destroy;if(void 0!==s){o.destroy=void 0,a=t;var l=n,c=s;try{c()}catch(u){Cu(a,l,u)}}}r=r.next}while(r!==i)}}catch(u){Cu(t,t.return,u)}}function vl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ei(t,n)}catch(r){Cu(e,e.return,r)}}}function wl(e,t,n){n.props=Cs(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){Cu(e,t,r)}}function kl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"==typeof n?e.refCleanup=n(r):n.current=r}}catch(a){Cu(e,t,a)}}function Sl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"==typeof r)try{r()}catch(a){Cu(e,t,a)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof n)try{n(null)}catch(i){Cu(e,t,i)}else n.current=null}function jl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(a){Cu(e,e.return,a)}}function Cl(e,t,n){try{var a=e.stateNode;!function(e,t,n,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,o=null,s=null,l=null,c=null,u=null,d=null;for(f in n){var p=n[f];if(n.hasOwnProperty(f)&&null!=p)switch(f){case"checked":case"value":break;case"defaultValue":c=p;default:a.hasOwnProperty(f)||pd(e,t,f,null,a,p)}}for(var m in a){var f=a[m];if(p=n[m],a.hasOwnProperty(m)&&(null!=f||null!=p))switch(m){case"type":o=f;break;case"name":i=f;break;case"checked":u=f;break;case"defaultChecked":d=f;break;case"value":s=f;break;case"defaultValue":l=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(r(137,t));break;default:f!==p&&pd(e,t,m,f,a,p)}}return void vt(e,s,l,c,u,d,o,i);case"select":for(o in f=s=l=m=null,n)if(c=n[o],n.hasOwnProperty(o)&&null!=c)switch(o){case"value":break;case"multiple":f=c;default:a.hasOwnProperty(o)||pd(e,t,o,null,a,c)}for(i in a)if(o=a[i],c=n[i],a.hasOwnProperty(i)&&(null!=o||null!=c))switch(i){case"value":m=o;break;case"defaultValue":l=o;break;case"multiple":s=o;default:o!==c&&pd(e,t,i,o,a,c)}return t=l,n=s,a=f,void(null!=m?St(e,!!n,m,!1):!!a!=!!n&&(null!=t?St(e,!!n,t,!0):St(e,!!n,n?[]:"",!1)));case"textarea":for(l in f=m=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!a.hasOwnProperty(l))switch(l){case"value":case"children":break;default:pd(e,t,l,null,a,i)}for(s in a)if(i=a[s],o=n[s],a.hasOwnProperty(s)&&(null!=i||null!=o))switch(s){case"value":m=i;break;case"defaultValue":f=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(r(91));break;default:i!==o&&pd(e,t,s,i,a,o)}return void jt(e,m,f);case"option":for(var h in n)if(m=n[h],n.hasOwnProperty(h)&&null!=m&&!a.hasOwnProperty(h))if("selected"===h)e.selected=!1;else pd(e,t,h,null,a,m);for(c in a)if(m=a[c],f=n[c],a.hasOwnProperty(c)&&m!==f&&(null!=m||null!=f))if("selected"===c)e.selected=m&&"function"!=typeof m&&"symbol"!=typeof m;else pd(e,t,c,m,a,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)m=n[g],n.hasOwnProperty(g)&&null!=m&&!a.hasOwnProperty(g)&&pd(e,t,g,null,a,m);for(u in a)if(m=a[u],f=n[u],a.hasOwnProperty(u)&&m!==f&&(null!=m||null!=f))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(r(137,t));break;default:pd(e,t,u,m,a,f)}return;default:if(Tt(t)){for(var y in n)m=n[y],n.hasOwnProperty(y)&&void 0!==m&&!a.hasOwnProperty(y)&&md(e,t,y,void 0,a,m);for(d in a)m=a[d],f=n[d],!a.hasOwnProperty(d)||m===f||void 0===m&&void 0===f||md(e,t,d,m,a,f);return}}for(var b in n)m=n[b],n.hasOwnProperty(b)&&null!=m&&!a.hasOwnProperty(b)&&pd(e,t,b,null,a,m);for(p in a)m=a[p],f=n[p],!a.hasOwnProperty(p)||m===f||null==m&&null==f||pd(e,t,p,m,a,f)}(a,e.type,n,t),a[Qe]=t}catch(i){Cu(e,e.return,i)}}function Nl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Ed(e.type)||4===e.tag}function _l(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Nl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Ed(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function El(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Pt));else if(4!==r&&(27===r&&Ed(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(El(e,t,n),e=e.sibling;null!==e;)El(e,t,n),e=e.sibling}function Ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&Ed(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Ll(e,t,n),e=e.sibling;null!==e;)Ll(e,t,n),e=e.sibling}function Tl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,a=t.attributes;a.length;)t.removeAttributeNode(a[0]);fd(t,r,n),t[$e]=e,t[Qe]=n}catch(i){Cu(e,e.return,i)}}var Dl=!1,Il=!1,Al=!1,Pl="function"==typeof WeakSet?WeakSet:Set,Ol=null;function ql(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Yl(e,n),4&r&&bl(5,n);break;case 1:if(Yl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(o){Cu(n,n.return,o)}else{var a=Cs(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(a,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){Cu(n,n.return,s)}}64&r&&vl(n),512&r&&kl(n,n.return);break;case 3:if(Yl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Ei(e,t)}catch(o){Cu(n,n.return,o)}}break;case 27:null===t&&4&r&&Tl(n);case 26:case 5:Yl(e,n),null===t&&4&r&&jl(n),512&r&&kl(n,n.return);break;case 12:Yl(e,n);break;case 31:Yl(e,n),4&r&&Bl(e,n);break;case 13:Yl(e,n),4&r&&$l(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=Lu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||Dl)){t=null!==t&&null!==t.memoizedState||Il,a=Dl;var i=Il;Dl=r,(Il=t)&&!i?Xl(e,n,!!(8772&n.subtreeFlags)):Yl(e,n),Dl=a,Il=i}break;case 30:break;default:Yl(e,n)}}function zl(e){var t=e.alternate;null!==t&&(e.alternate=null,zl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Je(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Rl=null,Ml=!1;function Fl(e,t,n){for(n=n.child;null!==n;)Ul(e,t,n),n=n.sibling}function Ul(e,t,n){if(ve&&"function"==typeof ve.onCommitFiberUnmount)try{ve.onCommitFiberUnmount(xe,n)}catch(i){}switch(n.tag){case 26:Il||Sl(n,t),Fl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Il||Sl(n,t);var r=Rl,a=Ml;Ed(n.type)&&(Rl=n.stateNode,Ml=!1),Fl(e,t,n),Fd(n.stateNode),Rl=r,Ml=a;break;case 5:Il||Sl(n,t);case 6:if(r=Rl,a=Ml,Rl=null,Fl(e,t,n),Ml=a,null!==(Rl=r))if(Ml)try{(9===Rl.nodeType?Rl.body:"HTML"===Rl.nodeName?Rl.ownerDocument.body:Rl).removeChild(n.stateNode)}catch(o){Cu(n,t,o)}else try{Rl.removeChild(n.stateNode)}catch(o){Cu(n,t,o)}break;case 18:null!==Rl&&(Ml?(Ld(9===(e=Rl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Wp(e)):Ld(Rl,n.stateNode));break;case 4:r=Rl,a=Ml,Rl=n.stateNode.containerInfo,Ml=!0,Fl(e,t,n),Rl=r,Ml=a;break;case 0:case 11:case 14:case 15:xl(2,n,t),Il||xl(4,n,t),Fl(e,t,n);break;case 1:Il||(Sl(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount&&wl(n,t,r)),Fl(e,t,n);break;case 21:Fl(e,t,n);break;case 22:Il=(r=Il)||null!==n.memoizedState,Fl(e,t,n),Il=r;break;default:Fl(e,t,n)}}function Bl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Wp(e)}catch(n){Cu(t,t.return,n)}}}function $l(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Wp(e)}catch(n){Cu(t,t.return,n)}}function Ql(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Pl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Pl),t;default:throw Error(r(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=Tu.bind(null,e,t);t.then(r,r)}})}function Vl(e,t){var n=t.deletions;if(null!==n)for(var a=0;a<n.length;a++){var i=n[a],o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 27:if(Ed(l.type)){Rl=l.stateNode,Ml=!1;break e}break;case 5:Rl=l.stateNode,Ml=!1;break e;case 3:case 4:Rl=l.stateNode.containerInfo,Ml=!0;break e}l=l.return}if(null===Rl)throw Error(r(160));Ul(o,s,i),Rl=null,Ml=!1,null!==(o=i.alternate)&&(o.return=null),i.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Hl(t,e),t=t.sibling}var Wl=null;function Hl(e,t){var n=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Vl(t,e),Gl(e),4&a&&(xl(3,e,e.return),bl(3,e),xl(5,e,e.return));break;case 1:Vl(t,e),Gl(e),512&a&&(Il||null===n||Sl(n,n.return)),64&a&&Dl&&(null!==(e=e.updateQueue)&&(null!==(a=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?a:n.concat(a))));break;case 26:var i=Wl;if(Vl(t,e),Gl(e),512&a&&(Il||null===n||Sl(n,n.return)),4&a){var o=null!==n?n.memoizedState:null;if(a=e.memoizedState,null===n)if(null===a)if(null===e.stateNode){e:{a=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(a){case"title":(!(o=i.getElementsByTagName("title")[0])||o[Ye]||o[$e]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=i.createElement(a),i.head.insertBefore(o,i.querySelector("head > title"))),fd(o,a,n),o[$e]=e,nt(o),a=o;break e;case"link":var s=ap("link","href",i).get(a+(n.href||""));if(s)for(var l=0;l<s.length;l++)if((o=s[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(l,1);break t}fd(o=i.createElement(a),a,n),i.head.appendChild(o);break;case"meta":if(s=ap("meta","content",i).get(a+(n.content||"")))for(l=0;l<s.length;l++)if((o=s[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(l,1);break t}fd(o=i.createElement(a),a,n),i.head.appendChild(o);break;default:throw Error(r(468,a))}o[$e]=e,nt(o),a=o}e.stateNode=a}else ip(i,e.type,e.stateNode);else e.stateNode=Zd(i,a,e.memoizedProps);else o!==a?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===a?ip(i,e.type,e.stateNode):Zd(i,a,e.memoizedProps)):null===a&&null!==e.stateNode&&Cl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Vl(t,e),Gl(e),512&a&&(Il||null===n||Sl(n,n.return)),null!==n&&4&a&&Cl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Vl(t,e),Gl(e),512&a&&(Il||null===n||Sl(n,n.return)),32&e.flags){i=e.stateNode;try{Nt(i,"")}catch(h){Cu(e,e.return,h)}}4&a&&null!=e.stateNode&&Cl(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&a&&(Al=!0);break;case 6:if(Vl(t,e),Gl(e),4&a){if(null===e.stateNode)throw Error(r(162));a=e.memoizedProps,n=e.stateNode;try{n.nodeValue=a}catch(h){Cu(e,e.return,h)}}break;case 3:if(rp=null,i=Wl,Wl=$d(t.containerInfo),Vl(t,e),Wl=i,Gl(e),4&a&&null!==n&&n.memoizedState.isDehydrated)try{Wp(t.containerInfo)}catch(h){Cu(e,e.return,h)}Al&&(Al=!1,Kl(e));break;case 4:a=Wl,Wl=$d(e.stateNode.containerInfo),Vl(t,e),Gl(e),Wl=a;break;case 12:default:Vl(t,e),Gl(e);break;case 31:case 19:Vl(t,e),Gl(e),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,Ql(e,a)));break;case 13:Vl(t,e),Gl(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==n&&null!==n.memoizedState)&&(Pc=ue()),4&a&&(null!==(a=e.updateQueue)&&(e.updateQueue=null,Ql(e,a)));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=Dl,d=Il;if(Dl=u||i,Il=d||c,Vl(t,e),Il=d,Dl=u,Gl(e),8192&a)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||Dl||Il||Jl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(o=c.stateNode,i)"function"==typeof(s=o.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{l=c.stateNode;var p=c.memoizedProps.style,m=null!=p&&p.hasOwnProperty("display")?p.display:null;l.style.display=null==m||"boolean"==typeof m?"":(""+m).trim()}}catch(h){Cu(c,c.return,h)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(h){Cu(c,c.return,h)}}}else if(18===t.tag){if(null===n){c=t;try{var f=c.stateNode;i?Td(f,!0):Td(c.stateNode,!1)}catch(h){Cu(c,c.return,h)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&a&&(null!==(a=e.updateQueue)&&(null!==(n=a.retryQueue)&&(a.retryQueue=null,Ql(e,n))));case 30:case 21:}}function Gl(e){var t=e.flags;if(2&t){try{for(var n,a=e.return;null!==a;){if(Nl(a)){n=a;break}a=a.return}if(null==n)throw Error(r(160));switch(n.tag){case 27:var i=n.stateNode;Ll(e,_l(e),i);break;case 5:var o=n.stateNode;32&n.flags&&(Nt(o,""),n.flags&=-33),Ll(e,_l(e),o);break;case 3:case 4:var s=n.stateNode.containerInfo;El(e,_l(e),s);break;default:throw Error(r(161))}}catch(l){Cu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Kl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Kl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Yl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)ql(e,t.alternate,t),t=t.sibling}function Jl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:xl(4,t,t.return),Jl(t);break;case 1:Sl(t,t.return);var n=t.stateNode;"function"==typeof n.componentWillUnmount&&wl(t,t.return,n),Jl(t);break;case 27:Fd(t.stateNode);case 26:case 5:Sl(t,t.return),Jl(t);break;case 22:null===t.memoizedState&&Jl(t);break;default:Jl(t)}e=e.sibling}}function Xl(e,t,n){for(n=n&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,a=e,i=t,o=i.flags;switch(i.tag){case 0:case 11:case 15:Xl(a,i,n),bl(4,i);break;case 1:if(Xl(a,i,n),"function"==typeof(a=(r=i).stateNode).componentDidMount)try{a.componentDidMount()}catch(c){Cu(r,r.return,c)}if(null!==(a=(r=i).updateQueue)){var s=r.stateNode;try{var l=a.shared.hiddenCallbacks;if(null!==l)for(a.shared.hiddenCallbacks=null,a=0;a<l.length;a++)_i(l[a],s)}catch(c){Cu(r,r.return,c)}}n&&64&o&&vl(i),kl(i,i.return);break;case 27:Tl(i);case 26:case 5:Xl(a,i,n),n&&null===r&&4&o&&jl(i),kl(i,i.return);break;case 12:Xl(a,i,n);break;case 31:Xl(a,i,n),n&&4&o&&Bl(a,i);break;case 13:Xl(a,i,n),n&&4&o&&$l(a,i);break;case 22:null===i.memoizedState&&Xl(a,i,n),kl(i,i.return);break;case 30:break;default:Xl(a,i,n)}t=t.sibling}}function Zl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Ba(n))}function ec(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ba(e))}function tc(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)nc(e,t,n,r),t=t.sibling}function nc(e,t,n,r){var a=t.flags;switch(t.tag){case 0:case 11:case 15:tc(e,t,n,r),2048&a&&bl(9,t);break;case 1:case 31:case 13:default:tc(e,t,n,r);break;case 3:tc(e,t,n,r),2048&a&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ba(e)));break;case 12:if(2048&a){tc(e,t,n,r),e=t.stateNode;try{var i=t.memoizedProps,o=i.id,s=i.onPostCommit;"function"==typeof s&&s(o,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){Cu(t,t.return,l)}}else tc(e,t,n,r);break;case 23:break;case 22:i=t.stateNode,o=t.alternate,null!==t.memoizedState?2&i._visibility?tc(e,t,n,r):ac(e,t):2&i._visibility?tc(e,t,n,r):(i._visibility|=2,rc(e,t,n,r,!!(10256&t.subtreeFlags)||!1)),2048&a&&Zl(o,t);break;case 24:tc(e,t,n,r),2048&a&&ec(t.alternate,t)}}function rc(e,t,n,r,a){for(a=a&&(!!(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var i=e,o=t,s=n,l=r,c=o.flags;switch(o.tag){case 0:case 11:case 15:rc(i,o,s,l,a),bl(8,o);break;case 23:break;case 22:var u=o.stateNode;null!==o.memoizedState?2&u._visibility?rc(i,o,s,l,a):ac(i,o):(u._visibility|=2,rc(i,o,s,l,a)),a&&2048&c&&Zl(o.alternate,o);break;case 24:rc(i,o,s,l,a),a&&2048&c&&ec(o.alternate,o);break;default:rc(i,o,s,l,a)}t=t.sibling}}function ac(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,a=r.flags;switch(r.tag){case 22:ac(n,r),2048&a&&Zl(r.alternate,r);break;case 24:ac(n,r),2048&a&&ec(r.alternate,r);break;default:ac(n,r)}t=t.sibling}}var ic=8192;function oc(e,t,n){if(e.subtreeFlags&ic)for(e=e.child;null!==e;)sc(e,t,n),e=e.sibling}function sc(e,t,n){switch(e.tag){case 26:oc(e,t,n),e.flags&ic&&null!==e.memoizedState&&function(e,t,n,r){if(!("stylesheet"!==n.type||"string"==typeof r.media&&!1===matchMedia(r.media).matches||4&n.state.loading)){if(null===n.instance){var a=Gd(r.href),i=t.querySelector(Kd(a));if(i)return null!==(t=i._p)&&"object"==typeof t&&"function"==typeof t.then&&(e.count++,e=lp.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=i,void nt(i);i=t.ownerDocument||t,r=Yd(r),(a=Ud.get(a))&&tp(r,a),nt(i=i.createElement("link"));var o=i;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),fd(i,"link",r),n.instance=i}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&!(3&n.state.loading)&&(e.count++,n=lp.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Wl,e.memoizedState,e.memoizedProps);break;case 5:default:oc(e,t,n);break;case 3:case 4:var r=Wl;Wl=$d(e.stateNode.containerInfo),oc(e,t,n),Wl=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=ic,ic=16777216,oc(e,t,n),ic=r):oc(e,t,n))}}function lc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function cc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ol=r,pc(r,e)}lc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)uc(e),e=e.sibling}function uc(e){switch(e.tag){case 0:case 11:case 15:cc(e),2048&e.flags&&xl(9,e,e.return);break;case 3:case 12:default:cc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,dc(e)):cc(e)}}function dc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ol=r,pc(r,e)}lc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:xl(8,t,t.return),dc(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,dc(t));break;default:dc(t)}e=e.sibling}}function pc(e,t){for(;null!==Ol;){var n=Ol;switch(n.tag){case 0:case 11:case 15:xl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Ba(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Ol=r;else e:for(n=e;null!==Ol;){var a=(r=Ol).sibling,i=r.return;if(zl(r),r===n){Ol=null;break e}if(null!==a){a.return=i,Ol=a;break e}Ol=i}}}var mc={getCacheForType:function(e){var t=Pa(Fa),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Pa(Fa).controller.signal}},fc="function"==typeof WeakMap?WeakMap:Map,hc=0,gc=null,yc=null,bc=0,xc=0,vc=null,wc=!1,kc=!1,Sc=!1,jc=0,Cc=0,Nc=0,_c=0,Ec=0,Lc=0,Tc=0,Dc=null,Ic=null,Ac=!1,Pc=0,Oc=0,qc=1/0,zc=null,Rc=null,Mc=0,Fc=null,Uc=null,Bc=0,$c=0,Qc=null,Vc=null,Wc=0,Hc=null;function Gc(){return 2&hc&&0!==bc?bc&-bc:null!==q.T?Qu():Fe()}function Kc(){if(0===Lc)if(536870912&bc&&!ma)Lc=536870912;else{var e=Ne;!(3932160&(Ne<<=1))&&(Ne=262144),Lc=e}return null!==(e=Pi.current)&&(e.flags|=32),Lc}function Yc(e,t,n){(e!==gc||2!==xc&&9!==xc)&&null===e.cancelPendingCommit||(ru(e,0),eu(e,bc,Lc,!1)),Pe(e,n),2&hc&&e===gc||(e===gc&&(!(2&hc)&&(_c|=n),4===Cc&&eu(e,bc,Lc,!1)),zu(e))}function Jc(e,t,n){if(6&hc)throw Error(r(327));for(var a=!n&&!(127&t)&&0===(t&e.expiredLanes)||Te(e,t),i=a?function(e,t){var n=hc;hc|=2;var a=ou(),i=su();gc!==e||bc!==t?(zc=null,qc=ue()+500,ru(e,t)):kc=Te(e,t);e:for(;;)try{if(0!==xc&&null!==yc){t=yc;var o=vc;t:switch(xc){case 1:xc=0,vc=null,fu(e,t,o,1);break;case 2:case 9:if(ri(o)){xc=0,vc=null,mu(t);break}t=function(){2!==xc&&9!==xc||gc!==e||(xc=7),zu(e)},o.then(t,t);break e;case 3:xc=7;break e;case 4:xc=5;break e;case 7:ri(o)?(xc=0,vc=null,mu(t)):(xc=0,vc=null,fu(e,t,o,7));break;case 5:var s=null;switch(yc.tag){case 26:s=yc.memoizedState;case 5:case 27:var l=yc;if(s?op(s):l.stateNode.complete){xc=0,vc=null;var c=l.sibling;if(null!==c)yc=c;else{var u=l.return;null!==u?(yc=u,hu(u)):yc=null}break t}}xc=0,vc=null,fu(e,t,o,5);break;case 6:xc=0,vc=null,fu(e,t,o,6);break;case 8:nu(),Cc=6;break e;default:throw Error(r(462))}}du();break}catch(d){au(e,d)}return Na=Ca=null,q.H=a,q.A=i,hc=n,null!==yc?0:(gc=null,bc=0,Ir(),Cc)}(e,t):cu(e,t,!0),o=a;;){if(0===i){kc&&!a&&eu(e,t,0,!1);break}if(n=e.current.alternate,!o||Zc(n)){if(2===i){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var l=e;i=Dc;var c=l.current.memoizedState.isDehydrated;if(c&&(ru(l,s).flags|=256),2!==(s=cu(l,s,!1))){if(Sc&&!c){l.errorRecoveryDisabledLanes|=o,_c|=o,i=4;break e}o=Ic,Ic=i,null!==o&&(null===Ic?Ic=o:Ic.push.apply(Ic,o))}i=s}if(o=!1,2!==i)continue}}if(1===i){ru(e,0),eu(e,t,0,!0);break}e:{switch(a=e,o=i){case 0:case 1:throw Error(r(345));case 4:if((4194048&t)!==t)break;case 6:eu(a,t,Lc,!wc);break e;case 2:Ic=null;break;case 3:case 5:break;default:throw Error(r(329))}if((62914560&t)===t&&10<(i=Pc+300-ue())){if(eu(a,t,Lc,!wc),0!==Le(a,0,!0))break e;Bc=t,a.timeoutHandle=Sd(Xc.bind(null,a,n,Ic,zc,Ac,t,Lc,_c,Tc,wc,o,"Throttled",-0,0),i)}else Xc(a,n,Ic,zc,Ac,t,Lc,_c,Tc,wc,o,null,-0,0)}break}i=cu(e,t,!1),o=!1}zu(e)}function Xc(e,t,n,r,a,i,o,s,l,c,u,d,p,m){if(e.timeoutHandle=-1,8192&(d=t.subtreeFlags)||!(16785408&~d)){sc(t,i,d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pt});var f=(62914560&i)===i?Pc-ue():(4194048&i)===i?Oc-ue():0;if(null!==(f=function(e,t){return e.stylesheets&&0===e.count&&up(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&up(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sp&&(sp=62500*function(){if("function"==typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var a=n[r],i=a.transferSize,o=a.initiatorType,s=a.duration;if(i&&s&&hd(o)){for(o=0,s=a.responseEnd,r+=1;r<n.length;r++){var l=n[r],c=l.startTime;if(c>s)break;var u=l.transferSize,d=l.initiatorType;u&&hd(d)&&(o+=u*((l=l.responseEnd)<s?1:(s-c)/(l-c)))}if(--r,t+=8*(i+o)/(a.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"==typeof(e=navigator.connection.downlink)?e:5}());var a=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&up(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sp?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(a)}}:null}(d,f)))return Bc=i,e.cancelPendingCommit=f(yu.bind(null,e,t,i,n,r,a,o,s,l,u,d,null,p,m)),void eu(e,i,o,!c)}yu(e,t,i,n,r,a,o,s,l)}function Zc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!er(i(),a))return!1}catch(o){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function eu(e,t,n,r){t&=~Ec,t&=~_c,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var a=t;0<a;){var i=31-ke(a),o=1<<i;r[i]=-1,a&=~o}0!==n&&Oe(e,n,t)}function tu(){return!!(6&hc)||(Ru(0),!1)}function nu(){if(null!==yc){if(0===xc)var e=yc.return;else Na=Ca=null,lo(e=yc),ci=null,ui=0,e=yc;for(;null!==e;)yl(e.alternate,e),e=e.return;yc=null}}function ru(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,jd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Bc=0,nu(),gc=e,yc=n=Br(e.current,null),bc=t,xc=0,vc=null,wc=!1,kc=Te(e,t),Sc=!1,Tc=Lc=Ec=_c=Nc=Cc=0,Ic=Dc=null,Ac=!1,8&t&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var a=31-ke(r),i=1<<a;t|=e[a],r&=~i}return jc=t,Ir(),n}function au(e,t){Qi=null,q.H=ys,t===Za||t===ti?(t=si(),xc=3):t===ei?(t=si(),xc=4):xc=t===Ps?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,vc=t,null===yc&&(Cc=1,Ls(e,Yr(t,e.current)))}function iu(){var e=Pi.current;return null===e||((4194048&bc)===bc?null===Oi:!!((62914560&bc)===bc||536870912&bc)&&e===Oi)}function ou(){var e=q.H;return q.H=ys,null===e?ys:e}function su(){var e=q.A;return q.A=mc,e}function lu(){Cc=4,wc||(4194048&bc)!==bc&&null!==Pi.current||(kc=!0),!(134217727&Nc)&&!(134217727&_c)||null===gc||eu(gc,bc,Lc,!1)}function cu(e,t,n){var r=hc;hc|=2;var a=ou(),i=su();gc===e&&bc===t||(zc=null,ru(e,t)),t=!1;var o=Cc;e:for(;;)try{if(0!==xc&&null!==yc){var s=yc,l=vc;switch(xc){case 8:nu(),o=6;break e;case 3:case 2:case 9:case 6:null===Pi.current&&(t=!0);var c=xc;if(xc=0,vc=null,fu(e,s,l,c),n&&kc){o=0;break e}break;default:c=xc,xc=0,vc=null,fu(e,s,l,c)}}uu(),o=Cc;break}catch(u){au(e,u)}return t&&e.shellSuspendCounter++,Na=Ca=null,hc=r,q.H=a,q.A=i,null===yc&&(gc=null,bc=0,Ir()),o}function uu(){for(;null!==yc;)pu(yc)}function du(){for(;null!==yc&&!le();)pu(yc)}function pu(e){var t=ll(e.alternate,e,jc);e.memoizedProps=e.pendingProps,null===t?hu(e):yc=t}function mu(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Hs(n,t,t.pendingProps,t.type,void 0,bc);break;case 11:t=Hs(n,t,t.pendingProps,t.type.render,t.ref,bc);break;case 5:lo(t);default:yl(n,t),t=ll(n,t=yc=$r(t,jc),jc)}e.memoizedProps=e.pendingProps,null===t?hu(e):yc=t}function fu(e,t,n,a){Na=Ca=null,lo(t),ci=null,ui=0;var i=t.return;try{if(function(e,t,n,a,i){if(n.flags|=32768,null!==a&&"object"==typeof a&&"function"==typeof a.then){if(null!==(t=n.alternate)&&Da(t,n,i,!0),null!==(n=Pi.current)){switch(n.tag){case 31:case 13:return null===Oi?lu():null===n.alternate&&0===Cc&&(Cc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,a===ni?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([a]):t.add(a),Nu(e,a,i)),!1;case 22:return n.flags|=65536,a===ni?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([a])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([a]):n.add(a),Nu(e,a,i)),!1}throw Error(r(435,n.tag))}return Nu(e,a,i),lu(),!1}if(ma)return null!==(t=Pi.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,a!==ga&&Sa(Yr(e=Error(r(422),{cause:a}),n))):(a!==ga&&Sa(Yr(t=Error(r(423),{cause:a}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,a=Yr(a,n),Si(e,i=Ds(e.stateNode,a,i)),4!==Cc&&(Cc=2)),!1;var o=Error(r(520),{cause:a});if(o=Yr(o,n),null===Dc?Dc=[o]:Dc.push(o),4!==Cc&&(Cc=2),null===t)return!0;a=Yr(a,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,Si(n,e=Ds(n.stateNode,a,e)),!1;case 1:if(t=n.type,o=n.stateNode,!(128&n.flags||"function"!=typeof t.getDerivedStateFromError&&(null===o||"function"!=typeof o.componentDidCatch||null!==Rc&&Rc.has(o))))return n.flags|=65536,i&=-i,n.lanes|=i,As(i=Is(i),e,n,a),Si(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,bc))return Cc=1,Ls(e,Yr(n,e.current)),void(yc=null)}catch(o){if(null!==i)throw yc=i,o;return Cc=1,Ls(e,Yr(n,e.current)),void(yc=null)}32768&t.flags?(ma||1===a?e=!0:kc||536870912&bc?e=!1:(wc=e=!0,(2===a||9===a||3===a||6===a)&&(null!==(a=Pi.current)&&13===a.tag&&(a.flags|=16384))),gu(t,e)):hu(t)}function hu(e){var t=e;do{if(32768&t.flags)return void gu(t,wc);e=t.return;var n=hl(t.alternate,t,jc);if(null!==n)return void(yc=n);if(null!==(t=t.sibling))return void(yc=t);yc=t=e}while(null!==t);0===Cc&&(Cc=5)}function gu(e,t){do{var n=gl(e.alternate,e);if(null!==n)return n.flags&=32767,void(yc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(yc=e);yc=e=n}while(null!==e);Cc=6,yc=null}function yu(e,t,n,a,i,o,s,l,c){e.cancelPendingCommit=null;do{ku()}while(0!==Mc);if(6&hc)throw Error(r(327));if(null!==t){if(t===e.current)throw Error(r(177));if(o=t.lanes|t.childLanes,function(e,t,n,r,a,i){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=o&~n;0<n;){var u=31-ke(n),d=1<<u;s[u]=0,l[u]=-1;var p=c[u];if(null!==p)for(c[u]=null,u=0;u<p.length;u++){var m=p[u];null!==m&&(m.lane&=-536870913)}n&=~d}0!==r&&Oe(e,r,0),0!==i&&0===a&&0!==e.tag&&(e.suspendedLanes|=i&~(o&~t))}(e,n,o|=Dr,s,l,c),e===gc&&(yc=gc=null,bc=0),Uc=t,Fc=e,Bc=n,$c=o,Qc=i,Vc=a,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,oe(fe,function(){return Su(),null})):(e.callbackNode=null,e.callbackPriority=0),a=!!(13878&t.flags),13878&t.subtreeFlags||a){a=q.T,q.T=null,i=z.p,z.p=2,s=hc,hc|=4;try{!function(e,t){if(e=e.containerInfo,gd=wp,or(e=ir(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(a&&0!==a.rangeCount){n=a.anchorNode;var i=a.anchorOffset,o=a.focusNode;a=a.focusOffset;try{n.nodeType,o.nodeType}catch(g){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,p=e,m=null;t:for(;;){for(var f;p!==n||0!==i&&3!==p.nodeType||(l=s+i),p!==o||0!==a&&3!==p.nodeType||(c=s+a),3===p.nodeType&&(s+=p.nodeValue.length),null!==(f=p.firstChild);)m=p,p=f;for(;;){if(p===e)break t;if(m===n&&++u===i&&(l=s),m===o&&++d===a&&(c=s),null!==(f=p.nextSibling))break;m=(p=m).parentNode}p=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(yd={focusedElem:e,selectionRange:n},wp=!1,Ol=t;null!==Ol;)if(e=(t=Ol).child,1028&t.subtreeFlags&&null!==e)e.return=t,Ol=e;else for(;null!==Ol;){switch(o=(t=Ol).alternate,e=t.flags,t.tag){case 0:if(4&e&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(i=e[n]).ref.impl=i.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==o){e=void 0,n=t,i=o.memoizedProps,o=o.memoizedState,a=n.stateNode;try{var h=Cs(n.type,i);e=a.getSnapshotBeforeUpdate(h,o),a.__reactInternalSnapshotBeforeUpdate=e}catch(y){Cu(n,n.return,y)}}break;case 3:if(1024&e)if(9===(n=(e=t.stateNode.containerInfo).nodeType))Dd(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Dd(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(r(163))}if(null!==(e=t.sibling)){e.return=t.return,Ol=e;break}Ol=t.return}}(e,t)}finally{hc=s,z.p=i,q.T=a}}Mc=1,bu(),xu(),vu()}}function bu(){if(1===Mc){Mc=0;var e=Fc,t=Uc,n=!!(13878&t.flags);if(13878&t.subtreeFlags||n){n=q.T,q.T=null;var r=z.p;z.p=2;var a=hc;hc|=4;try{Hl(t,e);var i=yd,o=ir(e.containerInfo),s=i.focusedElem,l=i.selectionRange;if(o!==s&&s&&s.ownerDocument&&ar(s.ownerDocument.documentElement,s)){if(null!==l&&or(s)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in s)s.selectionStart=c,s.selectionEnd=Math.min(u,s.value.length);else{var d=s.ownerDocument||document,p=d&&d.defaultView||window;if(p.getSelection){var m=p.getSelection(),f=s.textContent.length,h=Math.min(l.start,f),g=void 0===l.end?h:Math.min(l.end,f);!m.extend&&h>g&&(o=g,g=h,h=o);var y=rr(s,h),b=rr(s,g);if(y&&b&&(1!==m.rangeCount||m.anchorNode!==y.node||m.anchorOffset!==y.offset||m.focusNode!==b.node||m.focusOffset!==b.offset)){var x=d.createRange();x.setStart(y.node,y.offset),m.removeAllRanges(),h>g?(m.addRange(x),m.extend(b.node,b.offset)):(x.setEnd(b.node,b.offset),m.addRange(x))}}}}for(d=[],m=s;m=m.parentNode;)1===m.nodeType&&d.push({element:m,left:m.scrollLeft,top:m.scrollTop});for("function"==typeof s.focus&&s.focus(),s=0;s<d.length;s++){var v=d[s];v.element.scrollLeft=v.left,v.element.scrollTop=v.top}}wp=!!gd,yd=gd=null}finally{hc=a,z.p=r,q.T=n}}e.current=t,Mc=2}}function xu(){if(2===Mc){Mc=0;var e=Fc,t=Uc,n=!!(8772&t.flags);if(8772&t.subtreeFlags||n){n=q.T,q.T=null;var r=z.p;z.p=2;var a=hc;hc|=4;try{ql(e,t.alternate,t)}finally{hc=a,z.p=r,q.T=n}}Mc=3}}function vu(){if(4===Mc||3===Mc){Mc=0,ce();var e=Fc,t=Uc,n=Bc,r=Vc;10256&t.subtreeFlags||10256&t.flags?Mc=5:(Mc=0,Uc=Fc=null,wu(e,e.pendingLanes));var a=e.pendingLanes;if(0===a&&(Rc=null),Me(n),t=t.stateNode,ve&&"function"==typeof ve.onCommitFiberRoot)try{ve.onCommitFiberRoot(xe,t,void 0,!(128&~t.current.flags))}catch(l){}if(null!==r){t=q.T,a=z.p,z.p=2,q.T=null;try{for(var i=e.onRecoverableError,o=0;o<r.length;o++){var s=r[o];i(s.value,{componentStack:s.stack})}}finally{q.T=t,z.p=a}}3&Bc&&ku(),zu(e),a=e.pendingLanes,261930&n&&42&a?e===Hc?Wc++:(Wc=0,Hc=e):Wc=0,Ru(0)}}function wu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ba(t)))}function ku(){return bu(),xu(),vu(),Su()}function Su(){if(5!==Mc)return!1;var e=Fc,t=$c;$c=0;var n=Me(Bc),a=q.T,i=z.p;try{z.p=32>n?32:n,q.T=null,n=Qc,Qc=null;var o=Fc,s=Bc;if(Mc=0,Uc=Fc=null,Bc=0,6&hc)throw Error(r(331));var l=hc;if(hc|=4,uc(o.current),nc(o,o.current,s,n),hc=l,Ru(0,!1),ve&&"function"==typeof ve.onPostCommitFiberRoot)try{ve.onPostCommitFiberRoot(xe,o)}catch(c){}return!0}finally{z.p=i,q.T=a,wu(e,t)}}function ju(e,t,n){t=Yr(n,t),null!==(e=wi(e,t=Ds(e.stateNode,t,2),2))&&(Pe(e,2),zu(e))}function Cu(e,t,n){if(3===e.tag)ju(e,e,n);else for(;null!==t;){if(3===t.tag){ju(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Rc||!Rc.has(r))){e=Yr(n,e),null!==(r=wi(t,n=Is(2),2))&&(As(n,r,t,e),Pe(r,2),zu(r));break}}t=t.return}}function Nu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fc;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(Sc=!0,a.add(n),e=_u.bind(null,e,t,n),t.then(e,e))}function _u(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,gc===e&&(bc&n)===n&&(4===Cc||3===Cc&&(62914560&bc)===bc&&300>ue()-Pc?!(2&hc)&&ru(e,0):Ec|=n,Tc===bc&&(Tc=0)),zu(e)}function Eu(e,t){0===t&&(t=Ie()),null!==(e=Or(e,t))&&(Pe(e,t),zu(e))}function Lu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Eu(e,n)}function Tu(e,t){var n=0;switch(e.tag){case 31:case 13:var a=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:a=e.stateNode;break;case 22:a=e.stateNode._retryCache;break;default:throw Error(r(314))}null!==a&&a.delete(t),Eu(e,n)}var Du=null,Iu=null,Au=!1,Pu=!1,Ou=!1,qu=0;function zu(e){e!==Iu&&null===e.next&&(null===Iu?Du=Iu=e:Iu=Iu.next=e),Pu=!0,Au||(Au=!0,Nd(function(){6&hc?oe(pe,Mu):Fu()}))}function Ru(e,t){if(!Ou&&Pu){Ou=!0;do{for(var n=!1,r=Du;null!==r;){if(0!==e){var a=r.pendingLanes;if(0===a)var i=0;else{var o=r.suspendedLanes,s=r.pingedLanes;i=(1<<31-ke(42|e)+1)-1,i=201326741&(i&=a&~(o&~s))?201326741&i|1:i?2|i:0}0!==i&&(n=!0,$u(r,i))}else i=bc,!(3&(i=Le(r,r===gc?i:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Te(r,i)||(n=!0,$u(r,i));r=r.next}}while(n);Ou=!1}}function Mu(){Fu()}function Fu(){Pu=Au=!1;var e=0;0!==qu&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==kd&&(kd=e,!0);return kd=null,!1}()&&(e=qu);for(var t=ue(),n=null,r=Du;null!==r;){var a=r.next,i=Uu(r,t);0===i?(r.next=null,null===n?Du=a:n.next=a,null===a&&(Iu=n)):(n=r,(0!==e||3&i)&&(Pu=!0)),r=a}0!==Mc&&5!==Mc||Ru(e),0!==qu&&(qu=0)}function Uu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var o=31-ke(i),s=1<<o,l=a[o];-1===l?0!==(s&n)&&0===(s&r)||(a[o]=De(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}if(n=bc,n=Le(e,e===(t=gc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===xc||9===xc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&se(r),e.callbackNode=null,e.callbackPriority=0;if(!(3&n)||Te(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&se(r),Me(n)){case 2:case 8:n=me;break;case 32:default:n=fe;break;case 268435456:n=ge}return r=Bu.bind(null,e),n=oe(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&se(r),e.callbackPriority=2,e.callbackNode=null,2}function Bu(e,t){if(0!==Mc&&5!==Mc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(ku()&&e.callbackNode!==n)return null;var r=bc;return 0===(r=Le(e,e===gc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Jc(e,r,t),Uu(e,ue()),null!=e.callbackNode&&e.callbackNode===n?Bu.bind(null,e):null)}function $u(e,t){if(ku())return null;Jc(e,t,!0)}function Qu(){if(0===qu){var e=Va;0===e&&(e=Ce,!(261888&(Ce<<=1))&&(Ce=256)),qu=e}return qu}function Vu(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:At(""+e)}function Wu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Hu=0;Hu<Nr.length;Hu++){var Gu=Nr[Hu];_r(Gu.toLowerCase(),"on"+(Gu[0].toUpperCase()+Gu.slice(1)))}_r(br,"onAnimationEnd"),_r(xr,"onAnimationIteration"),_r(vr,"onAnimationStart"),_r("dblclick","onDoubleClick"),_r("focusin","onFocus"),_r("focusout","onBlur"),_r(wr,"onTransitionRun"),_r(kr,"onTransitionStart"),_r(Sr,"onTransitionCancel"),_r(jr,"onTransitionEnd"),ot("onMouseEnter",["mouseout","mouseover"]),ot("onMouseLeave",["mouseout","mouseover"]),ot("onPointerEnter",["pointerout","pointerover"]),ot("onPointerLeave",["pointerout","pointerover"]),it("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),it("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),it("onBeforeInput",["compositionend","keypress","textInput","paste"]),it("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),it("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),it("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ku));function Ju(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&a.isPropagationStopped())break e;i=s,a.currentTarget=c;try{i(a)}catch(u){Er(u)}a.currentTarget=null,i=l}else for(o=0;o<r.length;o++){if(l=(s=r[o]).instance,c=s.currentTarget,s=s.listener,l!==i&&a.isPropagationStopped())break e;i=s,a.currentTarget=c;try{i(a)}catch(u){Er(u)}a.currentTarget=null,i=l}}}}function Xu(e,t){var n=t[We];void 0===n&&(n=t[We]=new Set);var r=e+"__bubble";n.has(r)||(nd(t,e,2,!1),n.add(r))}function Zu(e,t,n){var r=0;t&&(r|=4),nd(n,e,r,t)}var ed="_reactListening"+Math.random().toString(36).slice(2);function td(e){if(!e[ed]){e[ed]=!0,rt.forEach(function(t){"selectionchange"!==t&&(Yu.has(t)||Zu(t,!1,e),Zu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[ed]||(t[ed]=!0,Zu("selectionchange",!1,t))}}function nd(e,t,n,r){switch(Ep(t)){case 2:var a=kp;break;case 8:a=Sp;break;default:a=jp}n=a.bind(null,t,n,e),a=void 0,!Qt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function rd(e,t,n,r,a){var o=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var l=r.stateNode.containerInfo;if(l===a)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&s.stateNode.containerInfo===a)return;s=s.return}for(;null!==l;){if(null===(s=Xe(l)))return;if(5===(c=s.tag)||6===c||26===c||27===c){r=o=s;continue e}l=l.parentNode}}r=r.return}Ut(function(){var r=o,a=qt(n),s=[];e:{var l=Cr.get(e);if(void 0!==l){var c=an,u=e;switch(e){case"keypress":if(0===Yt(n))break e;case"keydown":case"keyup":c=vn;break;case"focusin":u="focus",c=dn;break;case"focusout":u="blur",c=dn;break;case"beforeblur":case"afterblur":c=dn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=cn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=un;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=kn;break;case br:case xr:case vr:c=pn;break;case jr:c=Sn;break;case"scroll":case"scrollend":c=sn;break;case"wheel":c=jn;break;case"copy":case"cut":case"paste":c=mn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=wn;break;case"toggle":case"beforetoggle":c=Cn}var d=!!(4&t),p=!d&&("scroll"===e||"scrollend"===e),m=d?null!==l?l+"Capture":null:l;d=[];for(var f,h=r;null!==h;){var g=h;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===m||null!=(g=Bt(h,m))&&d.push(ad(h,g,f)),p)break;h=h.return}0<d.length&&(l=new c(l,u,null,n,a),s.push({event:l,listeners:d}))}}if(!(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||n===Ot||!(u=n.relatedTarget||n.fromElement)||!Xe(u)&&!u[Ve])&&(c||l)&&(l=a.window===a?a:(l=a.ownerDocument)?l.defaultView||l.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Xe(u):null)&&(p=i(u),d=u.tag,u!==p||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=cn,g="onMouseLeave",m="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(d=wn,g="onPointerLeave",m="onPointerEnter",h="pointer"),p=null==c?l:et(c),f=null==u?l:et(u),(l=new d(g,h+"leave",c,n,a)).target=p,l.relatedTarget=f,g=null,Xe(a)===r&&((d=new d(m,h+"enter",u,n,a)).target=f,d.relatedTarget=p,g=d),p=g,c&&u)e:{for(d=od,h=u,f=0,g=m=c;g;g=d(g))f++;g=0;for(var y=h;y;y=d(y))g++;for(;0<f-g;)m=d(m),f--;for(;0<g-f;)h=d(h),g--;for(;f--;){if(m===h||null!==h&&m===h.alternate){d=m;break e}m=d(m),h=d(h)}d=null}else d=null;null!==c&&sd(s,l,c,d,!1),null!==u&&null!==p&&sd(s,p,u,d,!0)}if("select"===(c=(l=r?et(r):window).nodeName&&l.nodeName.toLowerCase())||"input"===c&&"file"===l.type)var b=$n;else if(zn(l))if(Qn)b=Zn;else{b=Jn;var x=Yn}else!(c=l.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==l.type&&"radio"!==l.type?r&&Tt(r.elementType)&&(b=$n):b=Xn;switch(b&&(b=b(e,r))?Rn(s,b,n,a):(x&&x(e,l,r),"focusout"===e&&r&&"number"===l.type&&null!=r.memoizedProps.value&&kt(l,"number",l.value)),x=r?et(r):window,e){case"focusin":(zn(x)||"true"===x.contentEditable)&&(lr=x,cr=r,ur=null);break;case"focusout":ur=cr=lr=null;break;case"mousedown":dr=!0;break;case"contextmenu":case"mouseup":case"dragend":dr=!1,pr(s,n,a);break;case"selectionchange":if(sr)break;case"keydown":case"keyup":pr(s,n,a)}var v;if(_n)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else On?An(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(Tn&&"ko"!==n.locale&&(On||"onCompositionStart"!==w?"onCompositionEnd"===w&&On&&(v=Kt()):(Ht="value"in(Wt=a)?Wt.value:Wt.textContent,On=!0)),0<(x=id(r,w)).length&&(w=new fn(w,e,null,n,a),s.push({event:w,listeners:x}),v?w.data=v:null!==(v=Pn(n))&&(w.data=v))),(v=Ln?function(e,t){switch(e){case"compositionend":return Pn(t);case"keypress":return 32!==t.which?null:(In=!0,Dn);case"textInput":return(e=t.data)===Dn&&In?null:e;default:return null}}(e,n):function(e,t){if(On)return"compositionend"===e||!_n&&An(e,t)?(e=Kt(),Gt=Ht=Wt=null,On=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(w=id(r,"onBeforeInput")).length&&(x=new fn("onBeforeInput","beforeinput",null,n,a),s.push({event:x,listeners:w}),x.data=v)),function(e,t,n,r,a){if("submit"===t&&n&&n.stateNode===a){var i=Vu((a[Qe]||null).action),o=r.submitter;o&&null!==(t=(t=o[Qe]||null)?Vu(t.formAction):o.getAttribute("formAction"))&&(i=t,o=null);var s=new an("action","action",null,r,a);e.push({event:s,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==qu){var e=o?Wu(a,o):new FormData(a);rs(n,{pending:!0,data:e,method:a.method,action:i},null,e)}}else"function"==typeof i&&(s.preventDefault(),e=o?Wu(a,o):new FormData(a),rs(n,{pending:!0,data:e,method:a.method,action:i},i,e))},currentTarget:a}]})}}(s,e,r,n,a)}Ju(s,t)})}function ad(e,t,n){return{instance:e,listener:t,currentTarget:n}}function id(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;if(5!==(a=a.tag)&&26!==a&&27!==a||null===i||(null!=(a=Bt(e,n))&&r.unshift(ad(e,a,i)),null!=(a=Bt(e,t))&&r.push(ad(e,a,i))),3===e.tag)return r;e=e.return}return[]}function od(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function sd(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(s=s.tag,null!==l&&l===r)break;5!==s&&26!==s&&27!==s||null===c||(l=c,a?null!=(c=Bt(n,i))&&o.unshift(ad(n,c,l)):a||null!=(c=Bt(n,i))&&o.push(ad(n,c,l))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var ld=/\r\n?/g,cd=/\u0000|\uFFFD/g;function ud(e){return("string"==typeof e?e:""+e).replace(ld,"\n").replace(cd,"")}function dd(e,t){return t=ud(t),ud(e)===t}function pd(e,t,n,a,i,o){switch(n){case"children":"string"==typeof a?"body"===t||"textarea"===t&&""===a||Nt(e,a):("number"==typeof a||"bigint"==typeof a)&&"body"!==t&&Nt(e,""+a);break;case"className":dt(e,"class",a);break;case"tabIndex":dt(e,"tabindex",a);break;case"dir":case"role":case"viewBox":case"width":case"height":dt(e,n,a);break;case"style":Lt(e,a,o);break;case"data":if("object"!==t){dt(e,"data",a);break}case"src":case"href":if(""===a&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==a||"function"==typeof a||"symbol"==typeof a||"boolean"==typeof a){e.removeAttribute(n);break}a=At(""+a),e.setAttribute(n,a);break;case"action":case"formAction":if("function"==typeof a){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof o&&("formAction"===n?("input"!==t&&pd(e,t,"name",i.name,i,null),pd(e,t,"formEncType",i.formEncType,i,null),pd(e,t,"formMethod",i.formMethod,i,null),pd(e,t,"formTarget",i.formTarget,i,null)):(pd(e,t,"encType",i.encType,i,null),pd(e,t,"method",i.method,i,null),pd(e,t,"target",i.target,i,null))),null==a||"symbol"==typeof a||"boolean"==typeof a){e.removeAttribute(n);break}a=At(""+a),e.setAttribute(n,a);break;case"onClick":null!=a&&(e.onclick=Pt);break;case"onScroll":null!=a&&Xu("scroll",e);break;case"onScrollEnd":null!=a&&Xu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!=typeof a||!("__html"in a))throw Error(r(61));if(null!=(n=a.__html)){if(null!=i.children)throw Error(r(60));e.innerHTML=n}}break;case"multiple":e.multiple=a&&"function"!=typeof a&&"symbol"!=typeof a;break;case"muted":e.muted=a&&"function"!=typeof a&&"symbol"!=typeof a;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==a||"function"==typeof a||"boolean"==typeof a||"symbol"==typeof a){e.removeAttribute("xlink:href");break}n=At(""+a),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=a&&"function"!=typeof a&&"symbol"!=typeof a?e.setAttribute(n,""+a):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":a&&"function"!=typeof a&&"symbol"!=typeof a?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===a?e.setAttribute(n,""):!1!==a&&null!=a&&"function"!=typeof a&&"symbol"!=typeof a?e.setAttribute(n,a):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=a&&"function"!=typeof a&&"symbol"!=typeof a&&!isNaN(a)&&1<=a?e.setAttribute(n,a):e.removeAttribute(n);break;case"rowSpan":case"start":null==a||"function"==typeof a||"symbol"==typeof a||isNaN(a)?e.removeAttribute(n):e.setAttribute(n,a);break;case"popover":Xu("beforetoggle",e),Xu("toggle",e),ut(e,"popover",a);break;case"xlinkActuate":pt(e,"http://www.w3.org/1999/xlink","xlink:actuate",a);break;case"xlinkArcrole":pt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",a);break;case"xlinkRole":pt(e,"http://www.w3.org/1999/xlink","xlink:role",a);break;case"xlinkShow":pt(e,"http://www.w3.org/1999/xlink","xlink:show",a);break;case"xlinkTitle":pt(e,"http://www.w3.org/1999/xlink","xlink:title",a);break;case"xlinkType":pt(e,"http://www.w3.org/1999/xlink","xlink:type",a);break;case"xmlBase":pt(e,"http://www.w3.org/XML/1998/namespace","xml:base",a);break;case"xmlLang":pt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",a);break;case"xmlSpace":pt(e,"http://www.w3.org/XML/1998/namespace","xml:space",a);break;case"is":ut(e,"is",a);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&ut(e,n=Dt.get(n)||n,a)}}function md(e,t,n,a,i,o){switch(n){case"style":Lt(e,a,o);break;case"dangerouslySetInnerHTML":if(null!=a){if("object"!=typeof a||!("__html"in a))throw Error(r(61));if(null!=(n=a.__html)){if(null!=i.children)throw Error(r(60));e.innerHTML=n}}break;case"children":"string"==typeof a?Nt(e,a):("number"==typeof a||"bigint"==typeof a)&&Nt(e,""+a);break;case"onScroll":null!=a&&Xu("scroll",e);break;case"onScrollEnd":null!=a&&Xu("scrollend",e);break;case"onClick":null!=a&&(e.onclick=Pt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:at.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"==typeof(o=null!=(o=e[Qe]||null)?o[n]:null)&&e.removeEventListener(t,o,i),"function"!=typeof a)?n in e?e[n]=a:!0===a?e.setAttribute(n,""):ut(e,n,a):("function"!=typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,a,i)))}}function fd(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Xu("error",e),Xu("load",e);var a,i=!1,o=!1;for(a in n)if(n.hasOwnProperty(a)){var s=n[a];if(null!=s)switch(a){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,t));default:pd(e,t,a,s,n,null)}}return o&&pd(e,t,"srcSet",n.srcSet,n,null),void(i&&pd(e,t,"src",n.src,n,null));case"input":Xu("invalid",e);var l=a=s=o=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var d=n[i];if(null!=d)switch(i){case"name":o=d;break;case"type":s=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":a=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(r(137,t));break;default:pd(e,t,i,d,n,null)}}return void wt(e,a,l,c,u,s,o,!1);case"select":for(o in Xu("invalid",e),i=s=a=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":a=l;break;case"defaultValue":s=l;break;case"multiple":i=l;default:pd(e,t,o,l,n,null)}return t=a,n=s,e.multiple=!!i,void(null!=t?St(e,!!i,t,!1):null!=n&&St(e,!!i,n,!0));case"textarea":for(s in Xu("invalid",e),a=o=i=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":i=l;break;case"defaultValue":o=l;break;case"children":a=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(r(91));break;default:pd(e,t,s,l,n,null)}return void Ct(e,i,o,a);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!=typeof i&&"symbol"!=typeof i;else pd(e,t,c,i,n,null);return;case"dialog":Xu("beforetoggle",e),Xu("toggle",e),Xu("cancel",e),Xu("close",e);break;case"iframe":case"object":Xu("load",e);break;case"video":case"audio":for(i=0;i<Ku.length;i++)Xu(Ku[i],e);break;case"image":Xu("error",e),Xu("load",e);break;case"details":Xu("toggle",e);break;case"embed":case"source":case"link":Xu("error",e),Xu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,t));default:pd(e,t,u,i,n,null)}return;default:if(Tt(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(i=n[d])&&md(e,t,d,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&pd(e,t,l,i,n,null))}function hd(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var gd=null,yd=null;function bd(e){return 9===e.nodeType?e:e.ownerDocument}function xd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function wd(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var kd=null;var Sd="function"==typeof setTimeout?setTimeout:void 0,jd="function"==typeof clearTimeout?clearTimeout:void 0,Cd="function"==typeof Promise?Promise:void 0,Nd="function"==typeof queueMicrotask?queueMicrotask:void 0!==Cd?function(e){return Cd.resolve(null).then(e).catch(_d)}:Sd;function _d(e){setTimeout(function(){throw e})}function Ed(e){return"head"===e}function Ld(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)||"/&"===n){if(0===r)return e.removeChild(a),void Wp(t);r--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)Fd(e.ownerDocument.documentElement);else if("head"===n){Fd(n=e.ownerDocument.head);for(var i=n.firstChild;i;){var o=i.nextSibling,s=i.nodeName;i[Ye]||"SCRIPT"===s||"STYLE"===s||"LINK"===s&&"stylesheet"===i.rel.toLowerCase()||n.removeChild(i),i=o}}else"body"===n&&Fd(e.ownerDocument.body);n=a}while(n);Wp(t)}function Td(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r}while(n)}function Dd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Dd(n),Je(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Id(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Od(e.nextSibling)))return null}return e}function Ad(e){return"$?"===e.data||"$~"===e.data}function Pd(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Od(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var qd=null;function zd(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Od(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Rd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Md(e,t,n){switch(t=bd(n),e){case"html":if(!(e=t.documentElement))throw Error(r(452));return e;case"head":if(!(e=t.head))throw Error(r(453));return e;case"body":if(!(e=t.body))throw Error(r(454));return e;default:throw Error(r(451))}}function Fd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Je(e)}var Ud=new Map,Bd=new Set;function $d(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Qd=z.d;z.d={f:function(){var e=Qd.f(),t=tu();return e||t},r:function(e){var t=Ze(e);null!==t&&5===t.tag&&"form"===t.type?is(t):Qd.r(e)},D:function(e){Qd.D(e),Wd("dns-prefetch",e,null)},C:function(e,t){Qd.C(e,t),Wd("preconnect",e,t)},L:function(e,t,n){Qd.L(e,t,n);var r=Vd;if(r&&e&&t){var a='link[rel="preload"][as="'+xt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(a+='[imagesrcset="'+xt(n.imageSrcSet)+'"]',"string"==typeof n.imageSizes&&(a+='[imagesizes="'+xt(n.imageSizes)+'"]')):a+='[href="'+xt(e)+'"]';var i=a;switch(t){case"style":i=Gd(e);break;case"script":i=Jd(e)}Ud.has(i)||(e=u({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Ud.set(i,e),null!==r.querySelector(a)||"style"===t&&r.querySelector(Kd(i))||"script"===t&&r.querySelector(Xd(i))||(fd(t=r.createElement("link"),"link",e),nt(t),r.head.appendChild(t)))}},m:function(e,t){Qd.m(e,t);var n=Vd;if(n&&e){var r=t&&"string"==typeof t.as?t.as:"script",a='link[rel="modulepreload"][as="'+xt(r)+'"][href="'+xt(e)+'"]',i=a;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Jd(e)}if(!Ud.has(i)&&(e=u({rel:"modulepreload",href:e},t),Ud.set(i,e),null===n.querySelector(a))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Xd(i)))return}fd(r=n.createElement("link"),"link",e),nt(r),n.head.appendChild(r)}}},X:function(e,t){Qd.X(e,t);var n=Vd;if(n&&e){var r=tt(n).hoistableScripts,a=Jd(e),i=r.get(a);i||((i=n.querySelector(Xd(a)))||(e=u({src:e,async:!0},t),(t=Ud.get(a))&&np(e,t),nt(i=n.createElement("script")),fd(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}},S:function(e,t,n){Qd.S(e,t,n);var r=Vd;if(r&&e){var a=tt(r).hoistableStyles,i=Gd(e);t=t||"default";var o=a.get(i);if(!o){var s={loading:0,preload:null};if(o=r.querySelector(Kd(i)))s.loading=5;else{e=u({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Ud.get(i))&&tp(e,n);var l=o=r.createElement("link");nt(l),fd(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){s.loading|=1}),l.addEventListener("error",function(){s.loading|=2}),s.loading|=4,ep(o,t,r)}o={type:"stylesheet",instance:o,count:1,state:s},a.set(i,o)}}},M:function(e,t){Qd.M(e,t);var n=Vd;if(n&&e){var r=tt(n).hoistableScripts,a=Jd(e),i=r.get(a);i||((i=n.querySelector(Xd(a)))||(e=u({src:e,async:!0,type:"module"},t),(t=Ud.get(a))&&np(e,t),nt(i=n.createElement("script")),fd(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(a,i))}}};var Vd="undefined"==typeof document?null:document;function Wd(e,t,n){var r=Vd;if(r&&"string"==typeof t&&t){var a=xt(t);a='link[rel="'+e+'"][href="'+a+'"]',"string"==typeof n&&(a+='[crossorigin="'+n+'"]'),Bd.has(a)||(Bd.add(a),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(a)&&(fd(t=r.createElement("link"),"link",e),nt(t),r.head.appendChild(t)))}}function Hd(e,t,n,a){var i,o,s,l,c=(c=G.current)?$d(c):null;if(!c)throw Error(r(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof n.precedence&&"string"==typeof n.href?(t=Gd(n.href),(a=(n=tt(c).hoistableStyles).get(t))||(a={type:"style",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"==typeof n.href&&"string"==typeof n.precedence){e=Gd(n.href);var u=tt(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Kd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Ud.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Ud.set(e,n),u||(i=c,o=e,s=n,l=d.state,i.querySelector('link[rel="preload"][as="style"]['+o+"]")?l.loading=1:(o=i.createElement("link"),l.preload=o,o.addEventListener("load",function(){return l.loading|=1}),o.addEventListener("error",function(){return l.loading|=2}),fd(o,"link",s),nt(o),i.head.appendChild(o))))),t&&null===a)throw Error(r(528,""));return d}if(t&&null!==a)throw Error(r(529,""));return null;case"script":return t=n.async,"string"==typeof(n=n.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Jd(n),(a=(n=tt(c).hoistableScripts).get(t))||(a={type:"script",instance:null,count:0,state:null},n.set(t,a)),a):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,e))}}function Gd(e){return'href="'+xt(e)+'"'}function Kd(e){return'link[rel="stylesheet"]['+e+"]"}function Yd(e){return u({},e,{"data-precedence":e.precedence,precedence:null})}function Jd(e){return'[src="'+xt(e)+'"]'}function Xd(e){return"script[async]"+e}function Zd(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var a=e.querySelector('style[data-href~="'+xt(n.href)+'"]');if(a)return t.instance=a,nt(a),a;var i=u({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return nt(a=(e.ownerDocument||e).createElement("style")),fd(a,"style",i),ep(a,n.precedence,e),t.instance=a;case"stylesheet":i=Gd(n.href);var o=e.querySelector(Kd(i));if(o)return t.state.loading|=4,t.instance=o,nt(o),o;a=Yd(n),(i=Ud.get(i))&&tp(a,i),nt(o=(e.ownerDocument||e).createElement("link"));var s=o;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),fd(o,"link",a),t.state.loading|=4,ep(o,n.precedence,e),t.instance=o;case"script":return o=Jd(n.src),(i=e.querySelector(Xd(o)))?(t.instance=i,nt(i),i):(a=n,(i=Ud.get(o))&&np(a=u({},n),i),nt(i=(e=e.ownerDocument||e).createElement("script")),fd(i,"link",a),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(r(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(a=t.instance,t.state.loading|=4,ep(a,n.precedence,e));return t.instance}function ep(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),a=r.length?r[r.length-1]:null,i=a,o=0;o<r.length;o++){var s=r[o];if(s.dataset.precedence===t)i=s;else if(i!==a)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function tp(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function np(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var rp=null;function ap(e,t,n){if(null===rp){var r=new Map,a=rp=new Map;a.set(n,r)}else(r=(a=rp).get(n))||(r=new Map,a.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),a=0;a<n.length;a++){var i=n[a];if(!(i[Ye]||i[$e]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var o=i.getAttribute(t)||"";o=e+o;var s=r.get(o);s?s.push(i):r.set(o,[i])}}return r}function ip(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function op(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var sp=0;function lp(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)up(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var cp=null;function up(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,cp=new Map,t.forEach(dp,e),cp=null,lp.call(e))}function dp(e,t){if(!(4&t.state.loading)){var n=cp.get(e);if(n)var r=n.get(null);else{n=new Map,cp.set(e,n);for(var a=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<a.length;i++){var o=a[i];"LINK"!==o.nodeName&&"not all"===o.getAttribute("media")||(n.set(o.dataset.precedence,o),r=o)}r&&n.set(null,r)}o=(a=t.instance).getAttribute("data-precedence"),(i=n.get(o)||r)===r&&n.set(null,a),n.set(o,a),this.count++,r=lp.bind(this),a.addEventListener("load",r),a.addEventListener("error",r),i?i.parentNode.insertBefore(a,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(a,e.firstChild),t.state.loading|=4}}var pp={$$typeof:k,Provider:null,Consumer:null,_currentValue:R,_currentValue2:R,_threadCount:0};function mp(e,t,n,r,a,i,o,s,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.hiddenUpdates=Ae(null),this.identifierPrefix=r,this.onUncaughtError=a,this.onCaughtError=i,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function fp(e,t,n,r,a,i,o,s,l,c,u,d){return e=new mp(e,t,n,o,l,c,u,d,s),t=1,!0===i&&(t|=24),i=Fr(3,null,null,t),e.current=i,i.stateNode=e,(t=Ua()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:r,isDehydrated:n,cache:t},bi(i),e}function hp(e){return e?e=Rr:Rr}function gp(e,t,n,r,a,i){a=hp(a),null===r.context?r.context=a:r.pendingContext=a,(r=vi(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(r.callback=i),null!==(n=wi(e,r,t))&&(Yc(n,0,t),ki(n,e,t))}function yp(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function bp(e,t){yp(e,t),(e=e.alternate)&&yp(e,t)}function xp(e){if(13===e.tag||31===e.tag){var t=Or(e,67108864);null!==t&&Yc(t,0,67108864),bp(e,67108864)}}function vp(e){if(13===e.tag||31===e.tag){var t=Gc(),n=Or(e,t=Re(t));null!==n&&Yc(n,0,t),bp(e,t)}}var wp=!0;function kp(e,t,n,r){var a=q.T;q.T=null;var i=z.p;try{z.p=2,jp(e,t,n,r)}finally{z.p=i,q.T=a}}function Sp(e,t,n,r){var a=q.T;q.T=null;var i=z.p;try{z.p=8,jp(e,t,n,r)}finally{z.p=i,q.T=a}}function jp(e,t,n,r){if(wp){var a=Cp(r);if(null===a)rd(e,t,r,Np,n),zp(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Tp=Rp(Tp,e,t,n,r,a),!0;case"dragenter":return Dp=Rp(Dp,e,t,n,r,a),!0;case"mouseover":return Ip=Rp(Ip,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Ap.set(i,Rp(Ap.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Pp.set(i,Rp(Pp.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(zp(e,r),4&t&&-1<qp.indexOf(e)){for(;null!==a;){var i=Ze(a);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var o=Ee(i.pendingLanes);if(0!==o){var s=i;for(s.pendingLanes|=2,s.entangledLanes|=2;o;){var l=1<<31-ke(o);s.entanglements[1]|=l,o&=~l}zu(i),!(6&hc)&&(qc=ue()+500,Ru(0))}}break;case 31:case 13:null!==(s=Or(i,2))&&Yc(s,0,2),tu(),bp(i,2)}if(null===(i=Cp(r))&&rd(e,t,r,Np,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else rd(e,t,r,null,n)}}function Cp(e){return _p(e=qt(e))}var Np=null;function _p(e){if(Np=null,null!==(e=Xe(e))){var t=i(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=o(t)))return e;e=null}else if(31===n){if(null!==(e=s(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Np=e,null}function Ep(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(de()){case pe:return 2;case me:return 8;case fe:case he:return 32;case ge:return 268435456;default:return 32}default:return 32}}var Lp=!1,Tp=null,Dp=null,Ip=null,Ap=new Map,Pp=new Map,Op=[],qp="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function zp(e,t){switch(e){case"focusin":case"focusout":Tp=null;break;case"dragenter":case"dragleave":Dp=null;break;case"mouseover":case"mouseout":Ip=null;break;case"pointerover":case"pointerout":Ap.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pp.delete(t.pointerId)}}function Rp(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=Ze(t))&&xp(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Mp(e){var t=Xe(e.target);if(null!==t){var n=i(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=o(n)))return e.blockedOn=t,void Ue(e.priority,function(){vp(n)})}else if(31===t){if(null!==(t=s(n)))return e.blockedOn=t,void Ue(e.priority,function(){vp(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Fp(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Cp(e.nativeEvent);if(null!==n)return null!==(t=Ze(n))&&xp(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Ot=r,n.target.dispatchEvent(r),Ot=null,t.shift()}return!0}function Up(e,t,n){Fp(e)&&n.delete(t)}function Bp(){Lp=!1,null!==Tp&&Fp(Tp)&&(Tp=null),null!==Dp&&Fp(Dp)&&(Dp=null),null!==Ip&&Fp(Ip)&&(Ip=null),Ap.forEach(Up),Pp.forEach(Up)}function $p(t,n){t.blockedOn===n&&(t.blockedOn=null,Lp||(Lp=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Bp)))}var Qp=null;function Vp(t){Qp!==t&&(Qp=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Qp===t&&(Qp=null);for(var e=0;e<t.length;e+=3){var n=t[e],r=t[e+1],a=t[e+2];if("function"!=typeof r){if(null===_p(r||n))continue;break}var i=Ze(n);null!==i&&(t.splice(e,3),e-=3,rs(i,{pending:!0,data:a,method:n.method,action:r},r,a))}}))}function Wp(e){function t(t){return $p(t,e)}null!==Tp&&$p(Tp,e),null!==Dp&&$p(Dp,e),null!==Ip&&$p(Ip,e),Ap.forEach(t),Pp.forEach(t);for(var n=0;n<Op.length;n++){var r=Op[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Op.length&&null===(n=Op[0]).blockedOn;)Mp(n),null===n.blockedOn&&Op.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var a=n[r],i=n[r+1],o=a[Qe]||null;if("function"==typeof i)o||Vp(n);else if(o){var s=null;if(i&&i.hasAttribute("formAction")){if(a=i,o=i[Qe]||null)s=o.formAction;else if(null!==_p(a))continue}else s=o.action;"function"==typeof s?n[r+1]=s:(n.splice(r,3),r-=3),Vp(n)}}}function Hp(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return a=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==a&&(a(),a=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"==typeof navigation){var r=!1,a=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==a&&(a(),a=null)}}}function Gp(e){this._internalRoot=e}function Kp(e){this._internalRoot=e}Kp.prototype.render=Gp.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));gp(t.current,Gc(),e,t,null,null)},Kp.prototype.unmount=Gp.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;gp(e.current,2,null,e,null,null),tu(),t[Ve]=null}},Kp.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Op.length&&0!==t&&t<Op[n].priority;n++);Op.splice(n,0,e),0===n&&Mp(e)}};var Yp=t.version;if("19.2.3"!==Yp)throw Error(r(527,Yp,"19.2.3"));z.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=i(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,a=t;;){var o=n.return;if(null===o)break;var s=o.alternate;if(null===s){if(null!==(a=o.return)){n=a;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===n)return l(o),e;if(s===a)return l(o),t;s=s.sibling}throw Error(r(188))}if(n.return!==a.return)n=o,a=s;else{for(var c=!1,u=o.child;u;){if(u===n){c=!0,n=o,a=s;break}if(u===a){c=!0,a=o,n=s;break}u=u.sibling}if(!c){for(u=s.child;u;){if(u===n){c=!0,n=s,a=o;break}if(u===a){c=!0,a=s,n=o;break}u=u.sibling}if(!c)throw Error(r(189))}}if(n.alternate!==a)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?c(e):null)?null:e.stateNode};var Jp={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.3"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Xp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xp.isDisabled&&Xp.supportsFiber)try{xe=Xp.inject(Jp),ve=Xp}catch(em){}}return w.createRoot=function(e,t){if(!a(e))throw Error(r(299));var n=!1,i="",o=Ns,s=_s,l=Es;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onUncaughtError&&(o=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=fp(e,1,!1,null,0,n,i,null,o,s,l,Hp),e[Ve]=t.current,td(e),new Gp(t)},w.hydrateRoot=function(e,t,n){if(!a(e))throw Error(r(299));var i=!1,o="",s=Ns,l=_s,c=Es,u=null;return null!=n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onUncaughtError&&(s=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.formState&&(u=n.formState)),(t=fp(e,1,!0,t,0,i,o,u,s,l,c,Hp)).context=hp(null),n=t.current,(o=vi(i=Re(i=Gc()))).callback=null,wi(n,o,i),n=i,t.current.lanes=n,Pe(t,n),zu(t),e[Ve]=t.current,td(e),new Kp(t)},w.version="19.2.3",w}var N=(x||(x=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){}}(),v.exports=C()),v.exports);const _={},E=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),a=n?.nonce||n?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in _)return;_[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,a&&r.setAttribute("nonce",a),document.head.appendChild(r),t?new Promise((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})},L=e=>(t,n,r)=>{const a=r.subscribe;r.subscribe=(e,t,n)=>{let i=e;if(t){const a=(null==n?void 0:n.equalityFn)||Object.is;let o=e(r.getState());i=n=>{const r=e(n);if(!a(o,r)){const e=o;t(o=r,e)}},(null==n?void 0:n.fireImmediately)&&t(o,o)}return a(i)};return e(t,n,r)},T={productionTeam:{id:"productionTeam",name:"Production Team",color:"#3B82F6",subsections:["Production","Technical Crew","Production Management"]},productionEquipment:{id:"productionEquipment",name:"Production Equipment",color:"#06B6D4",subsections:["Video","Audio","Cameras","Graphics","VT","Cabling","Other"]},creative:{id:"creative",name:"Creative",color:"#EC4899",subsections:["Services"]},logistics:{id:"logistics",name:"Logistics",color:"#F59E0B",subsections:["Services"]},expenses:{id:"expenses",name:"Expenses",color:"#10B981",subsections:["Services"]}},D=["productionTeam","productionEquipment","creative","logistics","expenses"],I={USD:{code:"USD",symbol:"$",name:"US Dollar"},GBP:{code:"GBP",symbol:"",name:"British Pound"},MYR:{code:"MYR",symbol:"RM",name:"Malaysian Ringgit"},IDR:{code:"IDR",symbol:"Rp",name:"Indonesian Rupiah"},KWD:{code:"KWD",symbol:"KD",name:"Kuwaiti Dinar"},AED:{code:"AED",symbol:".",name:"UAE Dirham"},SGD:{code:"SGD",symbol:"S$",name:"Singapore Dollar"},THB:{code:"THB",symbol:"",name:"Thai Baht"},QAR:{code:"QAR",symbol:"QR",name:"Qatari Riyal"},SAR:{code:"SAR",symbol:"SR",name:"Saudi Riyal"}},A={USD:1,GBP:.79,MYR:4.47,IDR:15850,KWD:.31,AED:3.67,SGD:1.34,THB:34.5,QAR:3.64,SAR:3.75},P={MALAYSIA:{id:"MALAYSIA",name:"Malaysia",defaultCurrency:"MYR",countries:["Malaysia"]},SEA:{id:"SEA",name:"Southeast Asia",defaultCurrency:"USD",countries:["Singapore","Indonesia","Thailand","Vietnam","Philippines"]},GULF:{id:"GULF",name:"Gulf States",defaultCurrency:"KWD",countries:["UAE","Kuwait","Saudi Arabia","Qatar","Bahrain","Oman"]},CENTRAL_ASIA:{id:"CENTRAL_ASIA",name:"Central Asia",defaultCurrency:"USD",countries:["Kazakhstan","Uzbekistan","Tajikistan"]}},O="tell_quote_current";function q(e){try{return localStorage.setItem(O,JSON.stringify(e)),!0}catch(t){return!1}}function z(){return`TP-${(new Date).getFullYear()}-${Math.floor(9e3*Math.random())+1e3}`}const R="exchange_rates_cache";async function M(){const e=function(){try{const e=localStorage.getItem(R);if(e){const{rates:t,timestamp:n}=JSON.parse(e);if(Date.now()-n<36e5)return{rates:t,timestamp:n}}}catch(e){}return null}();if(e)return e;try{const e=await fetch("https://api.exchangerate-api.com/v4/latest/USD");if(!e.ok)throw new Error("Failed to fetch rates");const t=await e.json(),n={};return Object.keys(I).forEach(e=>{n[e]=t.rates[e]||A[e]}),function(e){try{localStorage.setItem(R,JSON.stringify({rates:e,timestamp:Date.now()}))}catch(t){}}(n),{rates:n,timestamp:Date.now()}}catch(t){return{rates:A,timestamp:null}}}function F(e,t,n,r){if(t===n)return e;return e/(r[t]||A[t])*(r[n]||A[n])}function U(e,t,n={}){const{showSymbol:r=!0,decimals:a=2}=n,i=I[t];if(!i)return`${e.toFixed(a)}`;const o="IDR"===t?0:a,s=new Intl.NumberFormat("en-US",{minimumFractionDigits:o,maximumFractionDigits:o}).format(e);return r?`${i.symbol}${s}`:s}function B(e){return{MALAYSIA:"MYR",SEA:"USD",GULF:"USD",CENTRAL_ASIA:"USD"}[e]||"USD"}function $(e){return I[e]?.symbol||e}const Q=h("https://deitlnfumugxcbxqqivk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRlaXRsbmZ1bXVneGNieHFxaXZrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU1NDgxMzMsImV4cCI6MjA4MTEyNDEzM30.unFRnnjTCuxoaAyjfWK1UNjgubq9MYjElXbTN77mjEc",{auth:{storage:window.localStorage,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"x-application-name":"tell-quote-tool"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}}}),V=()=>!!Q,W="kit-images";const H=(e,t=1.5)=>({MALAYSIA:{cost:.85*e,charge:.85*e*t},SEA:{cost:e,charge:e*t},GULF:{cost:1.2*e,charge:1.2*e*t},CENTRAL_ASIA:{cost:1.1*e,charge:1.1*e*t}}),G=[{name:"Project Manager",description:"Remote project management",section:"prod_mgmt_remote",unit:"day",pricing:H(300)},{name:"Technical Project Manager",description:"Remote technical project management",section:"prod_mgmt_remote",unit:"day",pricing:H(300)},{name:"Consultant - TE",description:"Technical engineering consultant",section:"prod_mgmt_remote",unit:"day",pricing:H(500)},{name:"Graphics System - VMix",description:"VMix graphics system package",section:"event_graphics",unit:"day",pricing:H(33.8)},{name:"Graphics Design",description:"Graphics design services",section:"event_graphics",unit:"day",pricing:H(150)},{name:"Graphics Integration",description:"Graphics integration and setup",section:"event_graphics",unit:"day",pricing:H(50)},{name:"Photo Editing",description:"Photo editing services",section:"event_graphics",unit:"item",pricing:H(10)},{name:"Graphics Operator",description:"On-site graphics operator",section:"event_graphics",unit:"day",pricing:H(100)},{name:"Graphics Producer - On Site",description:"On-site graphics producer",section:"event_graphics",unit:"day",pricing:H(400)},{name:"Graphics Engineer",description:"Graphics engineering and technical support",section:"event_graphics",unit:"day",pricing:H(150)},{name:"Technical Producer - Int",description:"International technical producer",section:"prod_staffing",unit:"day",pricing:H(500)},{name:"Technical Director - Int",description:"International technical director",section:"prod_staffing",unit:"day",pricing:H(450)},{name:"Producer - Int On Site",description:"International producer on-site",section:"prod_staffing",unit:"day",pricing:H(500)},{name:"Producer - Remote Int",description:"International remote producer",section:"prod_staffing",unit:"day",pricing:H(300)},{name:"Sound Engineer - Int",description:"International sound engineer",section:"prod_staffing",unit:"day",pricing:H(500)},{name:"Sound Engineer - SEA",description:"South East Asia sound engineer",section:"prod_staffing",unit:"day",pricing:H(350)},{name:"Talent - Int",description:"International talent/presenter",section:"prod_staffing",unit:"day",pricing:H(500)},{name:"Field Producer/Floor Manager - Int",description:"International field producer/floor manager",section:"prod_staffing",unit:"day",pricing:H(450)},{name:"Field Producer/Floor Manager - SEA",description:"South East Asia field producer/floor manager",section:"prod_staffing",unit:"day",pricing:H(250)},{name:"Camera Operator - Int",description:"International camera operator",section:"prod_staffing",unit:"day",pricing:H(450)},{name:"Camera Operator - SEA",description:"South East Asia camera operator",section:"prod_staffing",unit:"day",pricing:H(250)},{name:"SPR Equipment - Silver Package",description:"SPR equipment silver package",section:"spr_equipment",unit:"day",pricing:H(700)},{name:"DJ Cam",description:"DJ camera setup",section:"extras",unit:"day",pricing:H(75)},{name:"Wireless Camera System",description:"Wireless camera system",section:"extras",unit:"day",pricing:H(250)},{name:"Comms",description:"Communications equipment",section:"extras",unit:"day",pricing:H(250)}],K="tell_rate_card",Y="tell_rate_card_sections",J="tell_rate_card_sync_queue";function X(){try{const e=localStorage.getItem(J);return e?JSON.parse(e):[]}catch(e){return[]}}function Z(e){try{localStorage.setItem(J,JSON.stringify(e))}catch(t){}}const ee={MALAYSIA:"MYR",SEA:"USD",GULF:"USD",CENTRAL_ASIA:"USD"},te=()=>({}),ne=(e,t)=>{if(!e)return t||{};const n={...t||{}};return Object.entries(e).forEach(([e,t])=>{if(!n[e]&&t&&(t.cost||t.charge)){const r=ee[e]||"USD";n[e]={cost:{amount:t.cost||0,baseCurrency:r},charge:{amount:t.charge||0,baseCurrency:r}}}}),n},re=[{id:"prod_production",name:"Production",group:"Production Team"},{id:"prod_technical",name:"Technical Crew",group:"Production Team"},{id:"prod_management",name:"Production Management",group:"Production Team"},{id:"equip_video",name:"Video",group:"Production Equipment"},{id:"equip_audio",name:"Audio",group:"Production Equipment"},{id:"equip_cameras",name:"Cameras",group:"Production Equipment"},{id:"equip_graphics",name:"Graphics",group:"Production Equipment"},{id:"equip_vt",name:"VT",group:"Production Equipment"},{id:"equip_cabling",name:"Cabling",group:"Production Equipment"},{id:"equip_other",name:"Other Equipment",group:"Production Equipment"},{id:"creative",name:"Creative",group:"Creative"},{id:"logistics",name:"Logistics",group:"Logistics"},{id:"expenses",name:"Expenses",group:"Expenses"}];function ae(){try{const e=localStorage.getItem(K);return e?JSON.parse(e):[]}catch(e){return[]}}function ie(){try{const e=localStorage.getItem(Y);return e?JSON.parse(e):re}catch(e){return re}}function oe(e){try{localStorage.setItem(K,JSON.stringify(e))}catch(t){}}function se(e){try{localStorage.setItem(Y,JSON.stringify(e))}catch(t){}}function le(){return`${Date.now()}-${Math.random().toString(36).substring(2,11)}`}const ce=u(L((e,t)=>({items:ae(),sections:ie(),loading:!1,syncStatus:"idle",syncError:null,pendingSyncCount:X().length,addToSyncQueue:(t,n,r)=>{const a=X();a.push({action:t,id:n,data:r,timestamp:Date.now()}),Z(a),e(e=>({pendingSyncCount:e.pendingSyncCount+1}))},processSyncQueue:async()=>{if(!V())return;const t=X();if(0===t.length)return;const n=[];for(const e of t)try{"insert"===e.action?await Q.from("rate_cards").insert(e.data):"update"===e.action?await Q.from("rate_cards").update(e.data).eq("id",e.id):"delete"===e.action&&await Q.from("rate_cards").delete().eq("id",e.id)}catch(r){n.push({...e,retries:(e.retries||0)+1,lastError:r.message})}Z(n),e({pendingSyncCount:n.length})},getUnsyncedCount:()=>t().items.filter(e=>!e._synced).length,clearSyncError:()=>{e({syncError:null,syncStatus:"idle"})},initialize:async()=>{if(V()){e({loading:!0,syncStatus:"syncing"});try{const{data:n,error:r}=await Q.from("rate_cards").select("*").order("created_at",{ascending:!0});if(r)throw r;const{data:a,error:i}=await Q.from("rate_card_sections").select("*").order("sort_order",{ascending:!0});if(i)throw i;const o=(n||[]).map(e=>{const t=ne(e.pricing,e.currency_pricing);return{id:e.id,name:e.name,description:e.description||"",section:e.section,unit:e.unit||"day",pricing:t,createdAt:e.created_at,updatedAt:e.updated_at,_synced:!0}}),s=a&&a.length>0?a.map(e=>({id:e.id,name:e.name,group:e.group_name||"Other"})):re;if(!a||0===a.length)for(let e=0;e<re.length;e++){const t=re[e];await Q.from("rate_card_sections").upsert({id:t.id,name:t.name,sort_order:e,group_name:t.group})}oe(o),se(s),e({items:o,sections:s,loading:!1,syncStatus:"success",syncError:null}),await t().processSyncQueue()}catch(n){e({loading:!1,syncStatus:"error",syncError:n.message})}}else e({loading:!1,syncStatus:"idle"})},addSection:async n=>{const r={id:n.toLowerCase().replace(/\s+/g,"_")+"_"+Math.random().toString(36).substring(2,7),name:n};if(e(e=>{const t=[...e.sections,r];return se(t),{sections:t}}),V())try{await Q.from("rate_card_sections").insert({id:r.id,name:r.name,sort_order:t().sections.length})}catch(a){}return r},deleteSection:async n=>{if(t().items.some(e=>e.section===n)&&e(e=>{const t=e.items.map(e=>e.section===n?{...e,section:"extras",updatedAt:(new Date).toISOString()}:e);return oe(t),V()&&t.filter(e=>"extras"===e.section).forEach(e=>{Q.from("rate_cards").update({section:"extras"}).eq("id",e.id)}),{items:t}}),e(e=>{const t=e.sections.filter(e=>e.id!==n);return se(t),{sections:t}}),V())try{await Q.from("rate_card_sections").delete().eq("id",n)}catch(r){}},renameSection:async(t,n)=>{if(e(e=>{const r=e.sections.map(e=>e.id===t?{...e,name:n}:e);return se(r),{sections:r}}),V())try{await Q.from("rate_card_sections").update({name:n}).eq("id",t)}catch(r){}},moveSection:async(t,n)=>{e(e=>{const r=[...e.sections],a=r.findIndex(e=>e.id===t);if(-1===a)return e;const i="up"===n?a-1:a+1;return i<0||i>=r.length?e:([r[a],r[i]]=[r[i],r[a]],se(r),V()&&r.forEach((e,t)=>{Q.from("rate_card_sections").update({sort_order:t}).eq("id",e.id)}),{sections:r})})},addItem:async t=>{const n=t.pricing?ne(t.pricing,null):{},r={id:le(),name:t.name||"",description:t.description||"",section:t.section||"extras",unit:t.unit||"day",pricing:n,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};if(V())try{const{data:e,error:t}=await Q.from("rate_cards").insert({name:r.name,description:r.description,section:r.section,unit:r.unit,currency_pricing:r.pricing}).select().single();if(t)throw t;r.id=e.id}catch(a){}return e(e=>{const t=[...e.items,r];return oe(t),{items:t}}),r},updateItem:async(t,n)=>{if(e(e=>{const r=e.items.map(e=>e.id===t?{...e,...n,updatedAt:(new Date).toISOString()}:e);return oe(r),{items:r}}),V())try{const e={};void 0!==n.name&&(e.name=n.name),void 0!==n.description&&(e.description=n.description),void 0!==n.section&&(e.section=n.section),void 0!==n.unit&&(e.unit=n.unit),void 0!==n.pricing&&(e.pricing=n.pricing),Object.keys(e).length>0&&await Q.from("rate_cards").update(e).eq("id",t)}catch(r){}},updateItemPricing:async(t,n,r,a,i)=>{let o=null;const s=i||ee[n]||"USD";if(e(e=>{const i=e.items.map(e=>{if(e.id!==t)return e;const i=e.pricing?.[n]||{};return o={...e,pricing:{...e.pricing||{},[n]:{...i,[r]:{amount:parseFloat(a)||0,baseCurrency:s}}},updatedAt:(new Date).toISOString()},o});return oe(i),{items:i}}),V()&&o)try{await Q.from("rate_cards").update({currency_pricing:o.pricing}).eq("id",t)}catch(l){}},deleteItem:async t=>{if(e(e=>{const n=e.items.filter(e=>e.id!==t);return oe(n),{items:n}}),V())try{await Q.from("rate_cards").delete().eq("id",t)}catch(n){}},getItemsBySection:e=>t().items.filter(t=>t.section===e),searchItems:e=>{const n=e.toLowerCase();return t().items.filter(e=>e.name.toLowerCase().includes(n)||e.description.toLowerCase().includes(n))},duplicateItem:e=>{const n=t().items.find(t=>t.id===e);return n?t().addItem({...n,name:`${n.name} (Copy)`}):null},seedRateCard:async()=>{const n=new Set(t().items.map(e=>e.name.toLowerCase())),r=G.filter(e=>!n.has(e.name.toLowerCase())).map(e=>({...e,id:le(),pricing:ne(e.pricing,e.currencyPricing),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}));if(0===r.length)return{success:!0,added:0,message:"All items already exist"};if(V())try{const e=r.map(e=>({name:e.name,description:e.description,section:e.section,unit:e.unit,currency_pricing:e.pricing})),{data:t,error:n}=await Q.from("rate_cards").insert(e).select();if(n)throw n;t&&t.forEach((e,t)=>{r[t]&&(r[t].id=e.id)})}catch(a){}return e(e=>{const t=[...e.items,...r];return oe(t),{items:t}}),e({sections:re}),se(re),{success:!0,added:r.length}},resetSectionsToDefaults:async()=>{if(V())try{await Q.from("rate_card_sections").delete().neq("id","");for(let e=0;e<re.length;e++){const t=re[e];await Q.from("rate_card_sections").upsert({id:t.id,name:t.name,sort_order:e,group_name:t.group})}}catch(t){}return e({sections:re}),se(re),{success:!0}},importFromCSV:async n=>{try{const r=(await n.text()).split("\n");if(r.length<2)throw new Error("Invalid CSV format");const a=r[0].split(",").map(e=>e.trim()),i=["MALAYSIA","SEA","GULF","CENTRAL_ASIA"],o=e=>a.indexOf(e),s=[],l=[];for(let e=1;e<r.length;e++){const n=r[e].trim();if(!n||n.startsWith("#"))continue;const a=[];let c=!1,u="";for(let e=0;e<n.length;e++){const t=n[e];'"'===t?c&&'"'===n[e+1]?(u+='"',e++):c=!c:","!==t||c?u+=t:(a.push(u),u="")}a.push(u);const d={id:a[o("id")]||le(),section:a[o("section")]||"extras",name:a[o("name")]||"",description:a[o("description")]||"",unit:a[o("unit")]||"day",pricing:te(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};i.forEach(e=>{const t=ee[e]||"USD",n=o(`${e}_cost`),r=o(`${e}_charge`),i=o(`${e}_cost_amount`),s=o(`${e}_cost_currency`),l=o(`${e}_charge_amount`),c=o(`${e}_charge_currency`),u=-1!==i&&a[i]?parseFloat(a[i])||0:-1!==n&&parseFloat(a[n])||0,p=-1!==s&&a[s]?a[s]:t,m=-1!==l&&a[l]?parseFloat(a[l])||0:-1!==r&&parseFloat(a[r])||0,f=-1!==c&&a[c]?a[c]:t;(u||m)&&(d.pricing[e]={cost:{amount:u,baseCurrency:p},charge:{amount:m,baseCurrency:f}})});t().items.some(e=>e.id===d.id)?l.push(d):s.push(d)}if(V()){if(s.length>0){const e=s.map(e=>({name:e.name,description:e.description,section:e.section,unit:e.unit,currency_pricing:e.pricing})),{data:t}=await Q.from("rate_cards").insert(e).select();t&&t.forEach((e,t)=>{s[t]&&(s[t].id=e.id)})}for(const e of l)await Q.from("rate_cards").update({name:e.name,description:e.description,section:e.section,unit:e.unit,currency_pricing:e.pricing}).eq("id",e.id)}return e(e=>{let t=[...e.items];return l.forEach(e=>{t=t.map(t=>t.id===e.id?e:t)}),t=[...t,...s],oe(t),{items:t}}),{success:!0,count:s.length+l.length}}catch(r){return{success:!1,error:r.message}}},exportToCSV:()=>{const{items:e}=t(),n=["MALAYSIA","SEA","GULF","CENTRAL_ASIA"],r=["id","section","name","description","unit"];n.forEach(e=>{r.push(`${e}_cost`),r.push(`${e}_charge`)}),n.forEach(e=>{r.push(`${e}_cost_amount`),r.push(`${e}_cost_currency`),r.push(`${e}_charge_amount`),r.push(`${e}_charge_currency`)});let a=r.join(",")+"\n";e.forEach(e=>{const t=[e.id,e.section||"",`"${(e.name||"").replace(/"/g,'""')}"`,`"${(e.description||"").replace(/"/g,'""')}"`,e.unit||"day"];n.forEach(n=>{const r=e.pricing?.[n];t.push(r?.cost?.amount||0),t.push(r?.charge?.amount||0)}),n.forEach(n=>{const r=e.pricing?.[n];t.push(r?.cost?.amount||""),t.push(r?.cost?.baseCurrency||""),t.push(r?.charge?.amount||""),t.push(r?.charge?.baseCurrency||"")}),a+=t.join(",")+"\n"});const i=new Blob([a],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(i),s=document.createElement("a");s.href=o,s.download=`rate-card-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o)},exportTemplate:()=>{const{sections:e}=t(),n=["id","section","name","description","unit"];["MALAYSIA","SEA","GULF","CENTRAL_ASIA"].forEach(e=>{n.push(`${e}_cost`),n.push(`${e}_charge`)});let r=n.join(",")+"\n";r+="# INSTRUCTIONS: Fill in your services below. Delete example rows before importing.\n",r+='# Leave "id" empty for new items. Unit options: day, item, project\n',r+=`# Available sections: ${e.map(e=>e.id+" ("+e.name+")").join(", ")}\n`,r+="#\n",e.slice(0,3).forEach((e,t)=>{const n=100+50*t,a=1.5*n;r+=`,${e.id},"Example ${e.name} Item","Description here",day,${n},${a},${1.2*n},${1.2*a},${1.5*n},${1.5*a},${1.3*n},${1.3*a}\n`});const a=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download="rate-card-template.csv",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)},exportPublicRateCard:(e="SEA")=>{const{items:n,sections:r}=t();let a=["Category","Service","Description","Unit","Day Rate","Currency"].join(",")+"\n";const i={};r.forEach(e=>{i[e.id]=e.name});[...n].sort((e,t)=>r.findIndex(t=>t.id===e.section)-r.findIndex(e=>e.id===t.section)).forEach(t=>{const n=t.pricing?.[e],r=n?.charge?.amount||0,o=n?.charge?.baseCurrency||"USD";if(r>0){const e=[i[t.section]||t.section||"General",`"${(t.name||"").replace(/"/g,'""')}"`,`"${(t.description||"").replace(/"/g,'""')}"`,t.unit||"day",r,o];a+=e.join(",")+"\n"}});const o=new Blob([a],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(o),l=document.createElement("a");l.href=s,l.download=`tell-productions-rate-card-${e.toLowerCase()}-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s)}}))),ue="tell_activity_logs",de="tell_activity_sync_queue";function pe(){try{const e=localStorage.getItem(de);return e?JSON.parse(e):[]}catch(e){return[]}}function me(e){try{localStorage.setItem(de,JSON.stringify(e))}catch(t){}}function fe(){try{const e=localStorage.getItem(ue);return e?JSON.parse(e):[]}catch(e){return[]}}function he(e){try{localStorage.setItem(ue,JSON.stringify(e))}catch(t){}}const ge={call:{label:"Call",icon:"phone",color:"text-green-400",bgColor:"bg-green-400/10"},email:{label:"Email",icon:"mail",color:"text-blue-400",bgColor:"bg-blue-400/10"},meeting:{label:"Meeting",icon:"users",color:"text-purple-400",bgColor:"bg-purple-400/10"},note:{label:"Note",icon:"file-text",color:"text-gray-400",bgColor:"bg-gray-400/10"},task:{label:"Task",icon:"check-square",color:"text-amber-400",bgColor:"bg-amber-400/10"},quote_sent:{label:"Quote Sent",icon:"send",color:"text-cyan-400",bgColor:"bg-cyan-400/10"},quote_won:{label:"Quote Won",icon:"trophy",color:"text-emerald-400",bgColor:"bg-emerald-400/10"},quote_lost:{label:"Quote Lost",icon:"x-circle",color:"text-red-400",bgColor:"bg-red-400/10"},follow_up:{label:"Follow-up",icon:"clock",color:"text-orange-400",bgColor:"bg-orange-400/10"},other:{label:"Other",icon:"more-horizontal",color:"text-gray-400",bgColor:"bg-gray-400/10"}},ye=u(L((e,t)=>({activities:fe(),loading:!1,syncStatus:"idle",syncError:null,pendingSyncCount:pe().length,clearSyncError:()=>{e({syncError:null,syncStatus:"idle"})},getUnsyncedCount:()=>{const e=pe(),n=t().activities.filter(e=>!1===e._synced);return e.length+n.length},addToSyncQueue:(t,n,r)=>{const a=pe();a.push({action:t,id:n,data:r,timestamp:Date.now()}),me(a),e({pendingSyncCount:a.length})},processSyncQueue:async()=>{if(!V())return;const t=pe();if(0===t.length)return;e({syncStatus:"syncing"});const n=[];for(const e of t)try{if("create"===e.action){const{error:t}=await Q.from("activity_logs").insert(e.data);if(t)throw t}else if("update"===e.action){const{error:t}=await Q.from("activity_logs").update(e.data).eq("id",e.id);if(t)throw t}else if("delete"===e.action){const{error:t}=await Q.from("activity_logs").delete().eq("id",e.id);if(t)throw t}}catch(r){n.push(e)}me(n),e({syncStatus:n.length>0?"error":"success",syncError:n.length>0?`${n.length} items failed to sync`:null,pendingSyncCount:n.length})},syncAllToSupabase:async()=>{const{processSyncQueue:e}=t();await e()},initialize:async()=>{if(V()){e({loading:!0,syncStatus:"syncing"});try{const{data:n,error:r}=await Q.from("activity_logs").select("*").order("activity_date",{ascending:!1}).limit(500);if(r)throw r;const a=(n||[]).map(e=>({id:e.id,clientId:e.client_id,contactId:e.contact_id,opportunityId:e.opportunity_id,quoteId:e.quote_id,type:e.type,title:e.title,description:e.description,loggedBy:e.logged_by,loggedByName:e.logged_by_name,activityDate:e.activity_date,followUpDate:e.follow_up_date,followUpCompleted:e.follow_up_completed,createdAt:e.created_at,_synced:!0}));e({activities:a,loading:!1,syncStatus:"success",syncError:null}),he(a);pe().length>0&&t().processSyncQueue()}catch(n){e({loading:!1,syncStatus:"error",syncError:n.message})}}else e({loading:!1,syncStatus:"idle"})},getClientActivities:e=>t().activities.filter(t=>t.clientId===e),getOpportunityActivities:e=>t().activities.filter(t=>t.opportunityId===e),getContactActivities:(e,n)=>t().activities.filter(t=>t.clientId===e&&t.contactId===n),getUpcomingFollowUps:(e=7)=>{const n=new Date((new Date).getTime()+24*e*60*60*1e3);return t().activities.filter(e=>e.followUpDate&&!e.followUpCompleted&&new Date(e.followUpDate)<=n).sort((e,t)=>new Date(e.followUpDate)-new Date(t.followUpDate))},getOverdueFollowUps:()=>{const e=new Date;return t().activities.filter(t=>t.followUpDate&&!t.followUpCompleted&&new Date(t.followUpDate)<e).sort((e,t)=>new Date(e.followUpDate)-new Date(t.followUpDate))},addActivity:async n=>{const{activities:r,addToSyncQueue:a}=t(),i={id:`${Date.now()}-${Math.random().toString(36).substring(2,11)}`,...n,activityDate:n.activityDate||(new Date).toISOString(),createdAt:(new Date).toISOString(),_synced:!1},o=[i,...r];if(e({activities:o}),he(o),V()){const n={client_id:i.clientId,contact_id:i.contactId,opportunity_id:i.opportunityId,quote_id:i.quoteId,type:i.type,title:i.title,description:i.description,logged_by:i.loggedBy,logged_by_name:i.loggedByName,activity_date:i.activityDate,follow_up_date:i.followUpDate,follow_up_completed:i.followUpCompleted||!1};try{const{data:r,error:a}=await Q.from("activity_logs").insert(n).select().single();if(a)throw a;if(r){const n={...i,id:r.id,_synced:!0},a=t().activities.map(e=>e.id===i.id?n:e);e({activities:a,syncStatus:"success",syncError:null}),he(a)}}catch(s){a("create",i.id,n),e({syncStatus:"error",syncError:s.message})}}return i},updateActivity:async(n,r)=>{const{activities:a,addToSyncQueue:i}=t(),o=a.map(e=>e.id===n?{...e,...r,_synced:!1}:e);if(e({activities:o}),he(o),V()){const a={};void 0!==r.title&&(a.title=r.title),void 0!==r.description&&(a.description=r.description),void 0!==r.type&&(a.type=r.type),void 0!==r.activityDate&&(a.activity_date=r.activityDate),void 0!==r.followUpDate&&(a.follow_up_date=r.followUpDate),void 0!==r.followUpCompleted&&(a.follow_up_completed=r.followUpCompleted);try{const{error:r}=await Q.from("activity_logs").update(a).eq("id",n);if(r)throw r;const i=t().activities.map(e=>e.id===n?{...e,_synced:!0}:e);e({activities:i,syncStatus:"success",syncError:null}),he(i)}catch(s){i("update",n,a),e({syncStatus:"error",syncError:s.message})}}},completeFollowUp:async e=>{await t().updateActivity(e,{followUpCompleted:!0})},deleteActivity:async n=>{const{activities:r,addToSyncQueue:a}=t(),i=r.filter(e=>e.id!==n);if(e({activities:i}),he(i),V())try{const{error:t}=await Q.from("activity_logs").delete().eq("id",n);if(t)throw t;e({syncStatus:"success",syncError:null})}catch(o){a("delete",n,null),e({syncStatus:"error",syncError:o.message})}}})));ye.subscribe(e=>e.activities,e=>he(e));const be="tell_clients",xe="tell_saved_quotes",ve="tell_clients_sync_queue";function we(){try{const e=localStorage.getItem(be);return e?JSON.parse(e):[]}catch(e){return[]}}function ke(){try{const e=localStorage.getItem(xe);return e?JSON.parse(e):[]}catch(e){return[]}}function Se(e){try{localStorage.setItem(be,JSON.stringify(e))}catch(t){}}function je(e){try{localStorage.setItem(xe,JSON.stringify(e))}catch(t){}}function Ce(){try{const e=localStorage.getItem(ve);return e?JSON.parse(e):[]}catch(e){return[]}}function Ne(e){try{localStorage.setItem(ve,JSON.stringify(e))}catch(t){}}function _e(){return`${Date.now()}-${Math.random().toString(36).substring(2,11)}`}const Ee=u(L((e,t)=>({clients:we(),savedQuotes:ke(),loading:!1,syncStatus:"idle",syncError:null,pendingSyncCount:Ce().length,initialize:async()=>{if(V()){e({loading:!0,syncStatus:"syncing"});try{const{data:r,error:a}=await Q.from("clients").select("*").order("created_at",{ascending:!1});if(a)throw a;const{data:i,error:o}=await Q.from("quotes").select("*").order("created_at",{ascending:!1});if(o)throw o;const s=(r||[]).map(e=>({id:e.id,company:e.company,contact:e.contact,email:e.email,phone:e.phone,website:e.website,location:e.location,address:e.address,region:e.region,notes:e.notes,tags:e.tags||[],contacts:e.contacts||[],paymentTerms:e.payment_terms,preferredCurrency:e.preferred_currency,industry:e.industry,createdAt:e.created_at,updatedAt:e.updated_at,_synced:!0})),{clients:l,migratedCount:c}=function(e){let t=0;return{clients:e.map(e=>{if(e.contacts&&e.contacts.length>0)return e;if(!(e.contact||e.email||e.phone))return e;const n={id:_e(),name:e.contact||"Primary Contact",email:e.email||"",phone:e.phone||"",role:"",isPrimary:!0,createdAt:(new Date).toISOString()};return t++,{...e,contacts:[n],_contactsMigrated:!0}}),migratedCount:t}}(s);if(c>0)for(const e of l.filter(e=>e._contactsMigrated))try{await Q.from("clients").update({contacts:e.contacts}).eq("id",e.id),delete e._contactsMigrated}catch(n){}const u=(i||[]).map(e=>{let t=null;if(e.client?.clientId&&(t=l.find(t=>t.id===e.client.clientId)),!t&&e.client?.company){const n=e.client.company.toLowerCase();t=l.find(e=>e.company?.toLowerCase()===n)}return{id:e.id,quoteNumber:e.quote_number,quoteDate:e.quote_date,validityDays:e.validity_days,status:e.status,currency:e.currency,region:e.region,preparedBy:e.prepared_by,client:e.client||{},clientId:t?.id||e.client?.clientId||null,project:e.project||{},sections:e.sections||{},fees:e.fees||{},proposal:e.proposal||{},createdAt:e.created_at,updatedAt:e.updated_at,_synced:!0}}),d=we(),p=ke(),m=d.filter(e=>!e._synced&&!l.find(t=>t.id===e.id)),f=p.filter(e=>!e._synced&&!u.find(t=>t.id===e.id||t.quoteNumber===e.quoteNumber));for(const e of m)try{const{data:t,error:n}=await Q.from("clients").insert({company:e.company,contact:e.contact,email:e.email,phone:e.phone,website:e.website,location:e.location,address:e.address,region:e.region,notes:e.notes,tags:e.tags,contacts:e.contacts,payment_terms:e.paymentTerms,preferred_currency:e.preferredCurrency,industry:e.industry}).select().single();!n&&t&&l.push({...e,id:t.id,_synced:!0})}catch(n){}for(const e of f)try{const{data:t,error:n}=await Q.from("quotes").insert({quote_number:e.quoteNumber,quote_date:e.quoteDate,validity_days:e.validityDays,status:e.status,currency:e.currency,region:e.region,prepared_by:e.preparedBy,client:e.client,project:e.project,sections:e.sections,fees:e.fees,proposal:e.proposal}).select().single();!n&&t&&u.push({...e,id:t.id,_synced:!0})}catch(n){}Se(l),je(u),e({clients:l,savedQuotes:u,loading:!1,syncStatus:"success",syncError:null}),await t().processSyncQueue()}catch(n){e({loading:!1,syncStatus:"error",syncError:n.message})}}else e({loading:!1,syncStatus:"idle"})},processSyncQueue:async()=>{if(!V())return;const t=Ce();if(0===t.length)return;const n=[];for(const e of t)try{"clients"===e.table?"insert"===e.action?await Q.from("clients").insert(e.data):"update"===e.action?await Q.from("clients").update(e.data).eq("id",e.id):"delete"===e.action&&await Q.from("clients").delete().eq("id",e.id):"quotes"===e.table&&("insert"===e.action?await Q.from("quotes").insert(e.data):"update"===e.action?await Q.from("quotes").update(e.data).eq("id",e.id):"delete"===e.action&&await Q.from("quotes").delete().eq("id",e.id))}catch(r){n.push({...e,retries:(e.retries||0)+1,lastError:r.message})}Ne(n),e({pendingSyncCount:n.length})},addToSyncQueue:(t,n,r,a)=>{const i=Ce();i.push({table:t,action:n,id:r,data:a,timestamp:Date.now()}),Ne(i),e(e=>({pendingSyncCount:e.pendingSyncCount+1}))},getUnsyncedCount:()=>t().clients.filter(e=>!e._synced).length+t().savedQuotes.filter(e=>!e._synced).length,syncAllToSupabase:async()=>{if(!V())return{success:!1,error:"Supabase not configured"};e({syncStatus:"syncing"});let n=0,r=0;for(const i of t().clients)if(!i._synced)try{const t={company:i.company,contact:i.contact,email:i.email,phone:i.phone,website:i.website,location:i.location,address:i.address,region:i.region,notes:i.notes,tags:i.tags,contacts:i.contacts,payment_terms:i.paymentTerms,preferred_currency:i.preferredCurrency,industry:i.industry},{data:r}=await Q.from("clients").select("id").eq("id",i.id).single();if(r)await Q.from("clients").update(t).eq("id",i.id);else{const{data:n}=await Q.from("clients").insert(t).select().single();n&&e(e=>({clients:e.clients.map(e=>e.id===i.id?{...e,id:n.id,_synced:!0}:e)}))}n++}catch(a){r++}for(const i of t().savedQuotes)if(!i._synced)try{const t={quote_number:i.quoteNumber,quote_date:i.quoteDate,validity_days:i.validityDays,status:i.status,currency:i.currency,region:i.region,prepared_by:i.preparedBy,client:i.client,project:i.project,sections:i.sections,fees:i.fees,proposal:i.proposal},{data:r}=await Q.from("quotes").select("id").eq("quote_number",i.quoteNumber).single();if(r)await Q.from("quotes").update(t).eq("id",r.id);else{const{data:n}=await Q.from("quotes").insert(t).select().single();n&&e(e=>({savedQuotes:e.savedQuotes.map(e=>e.id===i.id?{...e,id:n.id,_synced:!0}:e)}))}n++}catch(a){r++}return e(e=>({clients:e.clients.map(e=>({...e,_synced:!0})),savedQuotes:e.savedQuotes.map(e=>({...e,_synced:!0})),syncStatus:r>0?"error":"success",syncError:r>0?`${r} items failed to sync`:null})),Se(t().clients),je(t().savedQuotes),{success:0===r,synced:n,errors:r}},clearSyncError:()=>{e({syncError:null,syncStatus:"idle"})},addClient:async n=>{const r={id:_e(),company:n.company||"",contact:n.contact||"",email:n.email||"",phone:n.phone||"",website:n.website||"",location:n.location||"",address:n.address||"",region:n.region||"MALAYSIA",notes:n.notes||"",contacts:n.contacts||[],tags:n.tags||[],paymentTerms:n.paymentTerms||"net30",preferredCurrency:n.preferredCurrency||"USD",industry:n.industry||"",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),_synced:!1};if(r.contacts.length||!r.contact&&!r.email||r.contacts.push({id:_e(),name:r.contact,email:r.email,phone:r.phone,role:"Primary",isPrimary:!0}),e(e=>{const t=[...e.clients,r];return Se(t),{clients:t}}),V())try{const{data:t,error:n}=await Q.from("clients").insert({company:r.company,contact:r.contact,email:r.email,phone:r.phone,website:r.website,location:r.location,address:r.address,region:r.region,notes:r.notes,tags:r.tags,contacts:r.contacts,payment_terms:r.paymentTerms,preferred_currency:r.preferredCurrency,industry:r.industry}).select().single();if(n)throw n;e(e=>{const n=e.clients.map(e=>e.id===r.id?{...e,id:t.id,_synced:!0}:e);return Se(n),{clients:n,syncStatus:"success",syncError:null}}),r.id=t.id}catch(a){t().addToSyncQueue("clients","insert",r.id,{company:r.company,contact:r.contact,email:r.email,phone:r.phone,website:r.website,location:r.location,address:r.address,region:r.region,notes:r.notes,tags:r.tags,contacts:r.contacts}),e({syncStatus:"error",syncError:`Failed to sync client: ${a.message}`})}return r},updateClient:async(n,r)=>{if(e(e=>{const t=e.clients.map(e=>e.id===n?{...e,...r,updatedAt:(new Date).toISOString(),_synced:!1}:e);return Se(t),{clients:t}}),V())try{const t={};void 0!==r.company&&(t.company=r.company),void 0!==r.contact&&(t.contact=r.contact),void 0!==r.email&&(t.email=r.email),void 0!==r.phone&&(t.phone=r.phone),void 0!==r.website&&(t.website=r.website),void 0!==r.location&&(t.location=r.location),void 0!==r.address&&(t.address=r.address),void 0!==r.region&&(t.region=r.region),void 0!==r.notes&&(t.notes=r.notes),void 0!==r.tags&&(t.tags=r.tags),void 0!==r.contacts&&(t.contacts=r.contacts),void 0!==r.paymentTerms&&(t.payment_terms=r.paymentTerms),void 0!==r.preferredCurrency&&(t.preferred_currency=r.preferredCurrency),void 0!==r.industry&&(t.industry=r.industry);const{error:a}=await Q.from("clients").update(t).eq("id",n);if(a)throw a;e(e=>{const t=e.clients.map(e=>e.id===n?{...e,_synced:!0}:e);return Se(t),{clients:t,syncStatus:"success",syncError:null}})}catch(a){t().addToSyncQueue("clients","update",n,r),e({syncStatus:"error",syncError:`Failed to sync update: ${a.message}`})}},deleteClient:async n=>{if(e(e=>{const t=e.clients.filter(e=>e.id!==n),r=e.savedQuotes.filter(e=>e.clientId!==n);return Se(t),je(r),{clients:t,savedQuotes:r}}),V())try{const{error:t}=await Q.from("clients").delete().eq("id",n);if(t)throw t;e({syncStatus:"success",syncError:null})}catch(r){t().addToSyncQueue("clients","delete",n,null),e({syncStatus:"error",syncError:`Failed to sync delete: ${r.message}`})}},getClient:e=>t().clients.find(t=>t.id===e),getClientHealth:(e,n=[],r=[])=>{if(!t().clients.find(t=>t.id===e))return{status:"at-risk",score:0,factors:{}};const a=n.filter(t=>t.clientId===e),i=r.filter(t=>t.clientId===e);let o=0,s=null;if(a.length>0){const e=a.reduce((e,t)=>{const n=new Date(t.activityDate||t.createdAt);return n>e?n:e},new Date(0));s=Math.floor((Date.now()-e)/864e5),o=s<=7?40:s<=14?35:s<=30?25:s<=60?15:s<=90?5:0}let l=0,c=0;const u=i.filter(e=>"won"===e.status).length,d=i.filter(e=>["won","dead","rejected","expired"].includes(e.status)).length;d>0?(c=Math.round(u/d*100),l=c>=60?30:c>=40?20:c>=20?10:5):i.length>0&&(l=15);let p=0;const m=Date.now()-7776e6,f=i.filter(e=>new Date(e.savedAt||e.createdAt).getTime()>m).length;p=f>=3?30:2===f?25:1===f?15:0;const h=o+l+p;let g;return g=h>=60?"good":h>=30?"warning":"at-risk",{status:g,score:h,factors:{daysSinceActivity:s,activityScore:o,winRate:c,winRateScore:l,recentQuotes:f,engagementScore:p}}},getOrCreateClient:async e=>{const{clients:n}=t(),r=e.clientId?n.find(t=>t.id===e.clientId):n.find(t=>t.company?.toLowerCase()===e.company?.toLowerCase());return r||await t().addClient(e)},addContact:async(e,n)=>{const r=t().clients.find(t=>t.id===e);if(!r)return;const a=r.contacts||[],i=0===a.length||n.isPrimary,o={id:_e(),...n,isPrimary:i},s=i?a.map(e=>({...e,isPrimary:!1})):a;await t().updateClient(e,{contacts:[...s,o]})},updateContact:async(e,n,r)=>{const a=t().clients.find(t=>t.id===e);if(!a)return;let i=[...a.contacts||[]];r.isPrimary&&(i=i.map(e=>({...e,isPrimary:!1}))),i=i.map(e=>e.id===n?{...e,...r}:e),await t().updateClient(e,{contacts:i})},deleteContact:async(e,n)=>{const r=t().clients.find(t=>t.id===e);if(!r)return;const a=(r.contacts||[]).find(e=>e.id===n);let i=(r.contacts||[]).filter(e=>e.id!==n);a?.isPrimary&&i.length>0&&(i=i.map((e,t)=>({...e,isPrimary:0===t}))),await t().updateClient(e,{contacts:i})},saveQuote:async(n,r=null)=>{const{getOrCreateClient:a}=t();let i=r||n.client?.clientId;if(!i&&n.client?.company){i=(await a(n.client)).id}const o={...n,id:n.id||_e(),clientId:i,status:n.status||"draft",savedAt:(new Date).toISOString(),_synced:!1};if(e(e=>{const t=e.savedQuotes.findIndex(e=>e.quoteNumber===n.quoteNumber);let r;return t>=0?(r=[...e.savedQuotes],r[t]=o):r=[...e.savedQuotes,o],je(r),{savedQuotes:r}}),V())try{const t={quote_number:o.quoteNumber,quote_date:o.quoteDate,validity_days:o.validityDays,status:o.status,currency:o.currency,region:o.region,prepared_by:o.preparedBy,client:o.client,project:o.project,sections:o.sections,fees:o.fees,proposal:o.proposal},{data:n}=await Q.from("quotes").select("id").eq("quote_number",o.quoteNumber).single();let r=o.id;if(n)await Q.from("quotes").update(t).eq("id",n.id),r=n.id;else{const{data:e,error:n}=await Q.from("quotes").insert(t).select().single();if(n)throw n;e&&(r=e.id)}e(e=>{const t=e.savedQuotes.map(e=>e.quoteNumber===o.quoteNumber?{...e,id:r,_synced:!0}:e);return je(t),{savedQuotes:t,syncStatus:"success",syncError:null}}),o.id=r}catch(s){t().addToSyncQueue("quotes","insert",o.id,{quote_number:o.quoteNumber,quote_date:o.quoteDate,validity_days:o.validityDays,status:o.status,currency:o.currency,region:o.region,prepared_by:o.preparedBy,client:o.client,project:o.project,sections:o.sections,fees:o.fees,proposal:o.proposal}),e({syncStatus:"error",syncError:`Failed to sync quote: ${s.message}`})}return o},getClientQuotes:e=>t().savedQuotes.filter(t=>t.clientId===e),getQuote:e=>t().savedQuotes.find(t=>t.id===e),getQuoteByNumber:e=>t().savedQuotes.find(t=>t.quoteNumber===e),deleteQuote:async n=>{if(e(e=>{const t=e.savedQuotes.filter(e=>e.id!==n);return je(t),{savedQuotes:t}}),V())try{const{error:t}=await Q.from("quotes").delete().eq("id",n);if(t)throw t;e({syncStatus:"success",syncError:null})}catch(r){t().addToSyncQueue("quotes","delete",n,null),e({syncStatus:"error",syncError:`Failed to sync delete: ${r.message}`})}},updateQuoteStatus:async(n,r,a="",i=null,o="")=>{const s=t().savedQuotes.find(e=>e.id===n),l=s?.status;if(e(e=>{const t=e.savedQuotes.map(e=>{if(e.id!==n)return e;const t=[...e.statusHistory||[],{status:r,timestamp:(new Date).toISOString(),userId:"default",note:a}];return{...e,status:r,statusHistory:t,lostReason:i||e.lostReason,lostReasonNotes:o||e.lostReasonNotes,updatedAt:(new Date).toISOString(),_synced:!1}});return je(t),{savedQuotes:t}}),s&&l!==r){const e={sent:"quote_sent",won:"quote_won",dead:"quote_lost"}[r]||"note",l={sent:"Quote Sent",won:"Quote Won",dead:"Quote Lost",draft:"Quote Drafted"}[r]||`Quote Status: ${r}`;let c=`Quote ${s.quoteNumber||"N/A"} marked as ${r}`;"dead"===r&&i&&(c+=`. Reason: ${i}`,o&&(c+=` - ${o}`)),a&&(c+=`. Note: ${a}`);const u=s.clientId||t().clients.find(e=>e.company===s.client?.company)?.id;ye.getState().addActivity({clientId:u,quoteId:n,type:e,title:l,description:c,loggedBy:"system",loggedByName:"System"})}if(V())try{const a=t().savedQuotes.find(e=>e.id===n),{error:i}=await Q.from("quotes").update({status:r,project:{...a?.project||{},_statusHistory:a?.statusHistory,_lostReason:a?.lostReason,_lostReasonNotes:a?.lostReasonNotes}}).eq("id",n);if(i)throw i;e(e=>{const t=e.savedQuotes.map(e=>e.id===n?{...e,_synced:!0}:e);return je(t),{savedQuotes:t,syncStatus:"success",syncError:null}})}catch(c){e({syncStatus:"error",syncError:`Failed to sync status: ${c.message}`})}},updateQuote:async(t,n)=>{if(e(e=>{const r=e.savedQuotes.map(e=>e.id===t?{...e,...n,updatedAt:(new Date).toISOString(),_synced:!1}:e);return je(r),{savedQuotes:r}}),V())try{const r={};if(n.status&&(r.status=n.status),n.client&&(r.client=n.client),n.project&&(r.project=n.project),n.sections&&(r.sections=n.sections),n.fees&&(r.fees=n.fees),Object.keys(r).length>0){const{error:n}=await Q.from("quotes").update(r).eq("id",t);if(n)throw n;e(e=>{const n=e.savedQuotes.map(e=>e.id===t?{...e,_synced:!0}:e);return je(n),{savedQuotes:n,syncStatus:"success",syncError:null}})}}catch(r){e({syncStatus:"error",syncError:`Failed to sync update: ${r.message}`})}},exportData:()=>{const{clients:e,savedQuotes:n}=t(),r={version:1,exportedAt:(new Date).toISOString(),clients:e,savedQuotes:n},a=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=`tell-productions-backup-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)},importData:async n=>{try{const r=await n.text(),a=JSON.parse(r);if(!a.clients||!a.savedQuotes)throw new Error("Invalid backup file format");const i=a.clients.map(e=>({...e,_synced:!1})),o=a.savedQuotes.map(e=>({...e,_synced:!1}));return e({clients:i,savedQuotes:o}),Se(i),je(o),await t().syncAllToSupabase(),{success:!0,clientCount:i.length,quoteCount:o.length}}catch(r){return{success:!1,error:r.message}}},getClientStats:e=>{const n=t().savedQuotes.filter(t=>t.clientId===e);if(!n.length)return null;const r=n.filter(e=>"won"===e.status),a=n.filter(e=>"dead"===e.status||"rejected"===e.status),i=r.length+a.length;return{totalQuotes:n.length,wonCount:r.length,lostCount:a.length,winRate:i>0?Math.round(r.length/i*100):0}},getStats:()=>{const{clients:e,savedQuotes:n}=t();return{totalClients:e.length,totalQuotes:n.length,draftQuotes:n.filter(e=>"draft"===e.status).length,sentQuotes:n.filter(e=>"sent"===e.status).length,approvedQuotes:n.filter(e=>"approved"===e.status||"won"===e.status).length}},getFinancialStats:()=>{const{savedQuotes:e}=t();let n=0,r=0,a=0;return e.forEach(e=>{"won"===e.status?(n++,a++):"dead"!==e.status&&"rejected"!==e.status||(r++,a++)}),{winRate:a>0?Math.round(n/a*100):0,wonCount:n,lostCount:r}}})));function Le(){return[navigator.userAgent,navigator.language,screen.colorDepth,screen.width,screen.height,(new Date).getTimezoneOffset()].join("|")}async function Te(e){const t=(new TextEncoder).encode(e);if(window.crypto&&window.crypto.subtle)try{const e=await window.crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(e))}catch(n){}return function(e){const t=[];for(let n=0;n<32;n++){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)+n,r&=r;t.push(Math.abs(r)%256)}return t}(e)}async function De(e){if(!e)return"";try{const t=Le(),n=await Te(t),r=(new TextEncoder).encode(e),a=new Uint8Array(r.length);for(let e=0;e<r.length;e++)a[e]=r[e]^n[e%n.length];return btoa(String.fromCharCode(...a))}catch(t){return e}}async function Ie(e){if(!e)return"";try{const t=Le(),n=await Te(t),r=new Uint8Array(atob(e).split("").map(e=>e.charCodeAt(0))),a=new Uint8Array(r.length);for(let e=0;e<r.length;e++)a[e]=r[e]^n[e%n.length];return(new TextDecoder).decode(a)}catch(t){return e}}async function Ae(e,t){const n={...e};for(const r of t)n[r]&&(n[r]=await De(String(n[r])));return n}async function Pe(e,t){const n={...e};for(const r of t)n[r]&&(n[r]=await Ie(n[r]));return n}function Oe(e,t=""){if(!e)return!1;const n=/^[a-zA-Z0-9_-]+$/.test(e);return!(t&&!e.startsWith(t))&&(n&&e.length>=20&&e.length<=200)}function qe(e,t={}){(new Date).toISOString()}const ze="tell_settings",Re=["anthropicKey","openaiKey"],Me=["accountNumber","swiftCode"],Fe={theme:"dark",company:{name:"Tell Productions Sdn Bhd",address:"",city:"",country:"Malaysia",phone:"",email:"",website:"",logo:null},taxInfo:{taxNumber:"",registrationNumber:"",licenses:""},bankDetails:{bankName:"",accountName:"",accountNumber:"",swiftCode:"",currency:"MYR"},quoteDefaults:{validityDays:30,paymentTerms:"50% deposit on confirmation, balance on completion",termsAndConditions:" This quote is valid for 30 days from the date of issue.\n 50% deposit required upon confirmation.\n Final payment due within 14 days of project completion.\n Any additional requirements may incur extra charges.\n Cancellation within 7 days of project start may incur fees."},users:[{id:"default",name:"Tom",email:"",role:"admin"}],pdfOptions:{showCompanyAddress:!0,showCompanyPhone:!0,showCompanyEmail:!0,showTaxNumber:!1,showBankDetails:!1,showLogo:!0,primaryColor:"#143642",accentColor:"#0F8B8D",lineColor:"#143642",textColor:"#374151",mutedColor:"#6B7280",backgroundColor:"#FFFFFF"},aiSettings:{anthropicKey:"",openaiKey:""},projectTypes:[{id:"broadcast",label:"Broadcast"},{id:"streaming",label:"Streaming"},{id:"graphics",label:"Graphics"},{id:"sports_presentation",label:"Sports Presentation"},{id:"technical_consultancy",label:"Technical Management & Consultancy"},{id:"other",label:"Other"}],regions:[{id:"MALAYSIA",label:"Malaysia",currency:"MYR"},{id:"SEA",label:"South East Asia",currency:"USD"},{id:"GULF",label:"Gulf States",currency:"USD"},{id:"CENTRAL_ASIA",label:"Central Asia",currency:"USD"}],opsPreferences:{expandedCountries:{},hiddenCountries:{},dashboardCurrency:"USD"},dashboardPreferences:{currency:"USD",collapsedColumns:{},pipelineMinimized:!1},quotesPreferences:{displayCurrency:"USD",sortBy:"updatedAt",sortDir:"desc"},clientsPreferences:{currency:"USD"},activityLog:[]};async function Ue(){try{const e=localStorage.getItem(ze);if(e){const t=Be(JSON.parse(e));return t.aiSettings&&(t.aiSettings=await Pe(t.aiSettings,Re)),t.bankDetails&&(t.bankDetails=await Pe(t.bankDetails,Me)),t}return Fe}catch(e){return Fe}}function Be(e){return{...Fe,...e,theme:e.theme||Fe.theme,company:{...Fe.company,...e.company},taxInfo:{...Fe.taxInfo,...e.taxInfo},bankDetails:{...Fe.bankDetails,...e.bankDetails},quoteDefaults:{...Fe.quoteDefaults,...e.quoteDefaults},pdfOptions:{...Fe.pdfOptions,...e.pdfOptions},aiSettings:{...Fe.aiSettings,...e.aiSettings},opsPreferences:{...Fe.opsPreferences,...e.opsPreferences},dashboardPreferences:{...Fe.dashboardPreferences,...e.dashboardPreferences},quotesPreferences:{...Fe.quotesPreferences,...e.quotesPreferences},clientsPreferences:{...Fe.clientsPreferences,...e.clientsPreferences},users:e.users||Fe.users,projectTypes:e.projectTypes||Fe.projectTypes,regions:e.regions||Fe.regions,activityLog:e.activityLog||Fe.activityLog}}async function $e(e){try{const t=JSON.parse(JSON.stringify(e));t.aiSettings&&(t.aiSettings=await Ae(t.aiSettings,Re)),t.bankDetails&&(t.bankDetails=await Ae(t.bankDetails,Me)),localStorage.setItem(ze,JSON.stringify(t)),qe(0,{encrypted:!0})}catch(t){}}let Qe=null;async function Ve(e,t){if(!V())return{success:!0};try{const t=await Ae(e.aiSettings||{},Re);if(Qe){const{error:n}=await Q.from("settings").update({company:e.company,quote_defaults:e.quoteDefaults,terms_and_conditions:e.quoteDefaults?.termsAndConditions||"",users:e.users,ai_settings:t,ops_preferences:e.opsPreferences,dashboard_preferences:e.dashboardPreferences,quotes_preferences:e.quotesPreferences,clients_preferences:e.clientsPreferences}).eq("id",Qe);if(n)throw n;return qe(0,{encrypted:!0}),{success:!0}}return{success:!0}}catch(n){return{success:!1,error:n.message}}}let We=Fe;Ue().then(e=>{We=e,He.setState({settings:e,loading:!1})});const He=u(L((e,t)=>({settings:We,loading:!0,syncStatus:"idle",syncError:null,clearSyncError:()=>{e({syncError:null,syncStatus:"idle"})},setTheme:async n=>{const r={...t().settings,theme:n};await $e(r),e({settings:r}),"light"===n?(document.documentElement.classList.add("light"),document.documentElement.classList.remove("dark")):(document.documentElement.classList.add("dark"),document.documentElement.classList.remove("light"))},initialize:async()=>{if(!V()){const t=await Ue();return void e({settings:t,loading:!1,syncStatus:"idle"})}e({loading:!0,syncStatus:"syncing"});try{const{data:t,error:n}=await Q.from("settings").select("*").limit(1).single();if(n)throw n;if(t){Qe=t.id;const n=t.ai_settings?await Pe(t.ai_settings,Re):Fe.aiSettings,r=Be({...await Ue(),company:t.company||Fe.company,quoteDefaults:{...Fe.quoteDefaults,...t.quote_defaults,termsAndConditions:t.terms_and_conditions||Fe.quoteDefaults.termsAndConditions},users:t.users||Fe.users,aiSettings:n,opsPreferences:t.ops_preferences||Fe.opsPreferences,dashboardPreferences:t.dashboard_preferences||Fe.dashboardPreferences,quotesPreferences:t.quotes_preferences||Fe.quotesPreferences,clientsPreferences:t.clients_preferences||Fe.clientsPreferences});await $e(r),e({settings:r,loading:!1,syncStatus:"success",syncError:null})}else{const t=await Ue();e({settings:t,loading:!1,syncStatus:"success",syncError:null})}}catch(t){const n=await Ue();e({settings:n,loading:!1,syncStatus:"error",syncError:t.message})}},setCompanyInfo:async n=>{const r=t(),a={...r.settings,company:{...r.settings.company,...n}};await $e(a),Ve(a),e({settings:a})},setTaxInfo:async n=>{const r=t(),a={...r.settings,taxInfo:{...r.settings.taxInfo,...n}};await $e(a),e({settings:a})},setBankDetails:async n=>{const r=t(),a={...r.settings,bankDetails:{...r.settings.bankDetails,...n}};await $e(a),e({settings:a}),qe(0,{encrypted:!0})},setQuoteDefaults:async n=>{const r=t(),a={...r.settings,quoteDefaults:{...r.settings.quoteDefaults,...n}};await $e(a),Ve(a),e({settings:a})},setPdfOptions:async n=>{const r=t(),a={...r.settings,pdfOptions:{...r.settings.pdfOptions,...n}};await $e(a),e({settings:a})},setOpsPreferences:async n=>{const r=t(),a={...r.settings,opsPreferences:{...r.settings.opsPreferences,...n}};await $e(a),Ve(a),e({settings:a})},setDashboardPreferences:async n=>{const r=t(),a={...r.settings,dashboardPreferences:{...r.settings.dashboardPreferences,...n}};await $e(a),Ve(a),e({settings:a})},setQuotesPreferences:async n=>{const r=t(),a={...r.settings,quotesPreferences:{...r.settings.quotesPreferences,...n}};await $e(a),Ve(a),e({settings:a})},setClientsPreferences:async n=>{const r=t(),a={...r.settings,clientsPreferences:{...r.settings.clientsPreferences,...n}};await $e(a),Ve(a),e({settings:a})},setAiSettings:async n=>{const r=t();n.anthropicKey&&Oe(n.anthropicKey,"sk-ant-"),n.openaiKey&&Oe(n.openaiKey,"sk-"),n.anthropicKey||n.openaiKey;const a={...r.settings,aiSettings:{...r.settings.aiSettings,...n}};await $e(a),Ve(a),e({settings:a}),qe(0,{hasAnthropicKey:!!n.anthropicKey,hasOpenaiKey:!!n.openaiKey,encrypted:!0})},addUser:async n=>{const r=t(),a={id:`${Date.now()}-${Math.random().toString(36).substring(2,11)}`,name:n.name||"",email:n.email||"",role:n.role||"user"},i={...r.settings,users:[...r.settings.users,a]};await $e(i),Ve(i),e({settings:i})},updateUser:async(n,r)=>{const a=t(),i={...a.settings,users:a.settings.users.map(e=>e.id===n?{...e,...r}:e)};await $e(i),Ve(i),e({settings:i})},deleteUser:async n=>{const r=t(),a={...r.settings,users:r.settings.users.filter(e=>e.id!==n)};await $e(a),Ve(a),e({settings:a})},getUser:e=>t().settings.users.find(t=>t.id===e),addProjectType:async n=>{const r=t(),a=n.toLowerCase().replace(/\s+/g,"_")+"_"+Math.random().toString(36).substring(2,7),i={...r.settings,projectTypes:[...r.settings.projectTypes,{id:a,label:n}]};await $e(i),e({settings:i})},updateProjectType:async(n,r)=>{const a=t(),i={...a.settings,projectTypes:a.settings.projectTypes.map(e=>e.id===n?{...e,label:r}:e)};await $e(i),e({settings:i})},deleteProjectType:async n=>{const r=t(),a={...r.settings,projectTypes:r.settings.projectTypes.filter(e=>e.id!==n)};await $e(a),e({settings:a})},moveProjectType:async(n,r)=>{const a=t(),i=[...a.settings.projectTypes],o=i.findIndex(e=>e.id===n);if(-1===o)return;const s="up"===r?o-1:o+1;if(s<0||s>=i.length)return;[i[o],i[s]]=[i[s],i[o]];const l={...a.settings,projectTypes:i};await $e(l),e({settings:l})},addRegion:async(n,r="USD")=>{const a=t(),i=n.toUpperCase().replace(/\s+/g,"_"),o={...a.settings,regions:[...a.settings.regions,{id:i,label:n,currency:r}]};await $e(o),e({settings:o})},updateRegion:async(n,r)=>{const a=t(),i={...a.settings,regions:a.settings.regions.map(e=>e.id===n?{...e,...r}:e)};await $e(i),e({settings:i})},deleteRegion:async n=>{const r=t(),a={...r.settings,regions:r.settings.regions.filter(e=>e.id!==n)};await $e(a),e({settings:a})},moveRegion:async(n,r)=>{const a=t(),i=[...a.settings.regions],o=i.findIndex(e=>e.id===n);if(-1===o)return;const s="up"===r?o-1:o+1;if(s<0||s>=i.length)return;[i[o],i[s]]=[i[s],i[o]];const l={...a.settings,regions:i};await $e(l),e({settings:l})},exportSettings:async()=>{const{settings:e}=t(),n={...e,aiSettings:{anthropicKey:e.aiSettings.anthropicKey?"***REDACTED***":"",openaiKey:e.aiSettings.openaiKey?"***REDACTED***":""},bankDetails:{...e.bankDetails,accountNumber:e.bankDetails.accountNumber?"***REDACTED***":"",swiftCode:e.bankDetails.swiftCode?"***REDACTED***":""}},r=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),a=URL.createObjectURL(r),i=document.createElement("a");i.href=a,i.download=`settings-${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a),qe(0,{sanitized:!0})},addActivityLog:async n=>{const r=t(),a={id:`${Date.now()}-${Math.random().toString(36).substring(2,11)}`,timestamp:(new Date).toISOString(),...n},i={...r.settings,activityLog:[a,...r.settings.activityLog||[]].slice(0,1e3)};await $e(i),e({settings:i})},clearActivityLog:async()=>{const n={...t().settings,activityLog:[]};await $e(n),e({settings:n})},exportActivityLog:()=>{const{settings:e}=t(),n=e.activityLog||[];if(0===n.length)return void alert("No activity logs to export");const r=n.map(e=>[e.timestamp,e.userName||e.userId||"",e.quoteNumber||"",e.action||"",e.category||"",e.field||"",e.description||"","object"==typeof e.oldValue?JSON.stringify(e.oldValue):e.oldValue||"","object"==typeof e.newValue?JSON.stringify(e.newValue):e.newValue||""]),a=[["Timestamp","User","Quote #","Action","Category","Field","Description","Old Value","New Value"].join(","),...r.map(e=>e.map(e=>`"${String(e).replace(/"/g,'""')}"`).join(","))].join("\n"),i=new Blob([a],{type:"text/csv;charset=utf-8;"}),o=URL.createObjectURL(i),s=document.createElement("a");s.href=o,s.download=`activity-log-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o)},resetSettings:async()=>{e({settings:Fe}),await $e(Fe)}}))),Ge="tell_auth_session",Ke="tell_auth_attempts",Ye=864e5;function Je(){try{const e=localStorage.getItem(Ge);if(!e)return null;const t=JSON.parse(e);return t.expiresAt&&new Date(t.expiresAt)<new Date?(localStorage.removeItem(Ge),qe(0,{email:t.email}),null):t}catch(e){return null}}function Xe(e){try{e?(localStorage.setItem(Ge,JSON.stringify(e)),qe(0,{email:e.email,expiresAt:e.expiresAt})):localStorage.removeItem(Ge)}catch(t){}}function Ze(){try{const e=localStorage.getItem(Ke);return e?JSON.parse(e):{attempts:0,lockedUntil:null}}catch{return{attempts:0,lockedUntil:null}}}function et(e){try{localStorage.setItem(Ke,JSON.stringify(e))}catch(t){}}function tt(){const e=Ze();return!!(e.lockedUntil&&new Date(e.lockedUntil)>new Date)||(e.lockedUntil&&new Date(e.lockedUntil)<=new Date?(et({attempts:0,lockedUntil:null}),!1):e.attempts>=5)}function nt(e){const t=Ze();if(e)et({attempts:0,lockedUntil:null}),qe();else{const e=t.attempts+1,n={attempts:e,lockedUntil:null};e>=5?(n.lockedUntil=new Date(Date.now()+9e5).toISOString(),qe(0,{attempts:e,lockedUntil:n.lockedUntil})):qe(0,{attempts:e,remaining:5-e}),et(n)}}function rt(){const e=Ze();if(!e.lockedUntil)return 0;const t=new Date(e.lockedUntil)-new Date;return Math.max(0,Math.ceil(t/1e3))}async function at(e){if(!V())return null;try{const{data:t,error:n}=await Q.from("user_profiles").select("*").eq("auth_user_id",e).single();return n?null:{id:t.id,authUserId:t.auth_user_id,name:t.name,email:t.email,role:t.role,status:t.status||"active",tabPermissions:t.tab_permissions||[]}}catch(t){return null}}const it=u((e,t)=>({isAuthenticated:!!Je(),user:Je(),error:null,isLoading:!1,rateLimited:!1,lockoutTimeRemaining:0,initialize:async()=>{if(V())try{const{data:{session:t}}=await Q.auth.getSession();if(t){const n=await at(t.user.id),r={email:t.user.email,userId:t.user.id,expiresAt:new Date(Date.now()+Ye).toISOString(),provider:"supabase",profile:n};Xe(r),e({isAuthenticated:!0,user:r,error:null}),qe(0,{email:t.user.email})}Q.auth.onAuthStateChange(async(t,n)=>{if("SIGNED_IN"===t&&n){const t=await at(n.user.id),r={email:n.user.email,userId:n.user.id,expiresAt:new Date(Date.now()+Ye).toISOString(),provider:"supabase",profile:t};Xe(r),e({isAuthenticated:!0,user:r,error:null})}else"SIGNED_OUT"===t&&(Xe(null),e({isAuthenticated:!1,user:null,error:null}))})}catch(t){}},signup:async(t,n,r)=>{e({isLoading:!0,error:null});try{const{data:a,error:i}=await Q.auth.signUp({email:n,password:r,options:{data:{name:t}}});if(i)return e({error:i.message||"Signup failed",isLoading:!1}),!1;if(a.user){const{error:r}=await Q.from("user_profiles").insert({auth_user_id:a.user.id,name:t,email:n,role:"user",status:"pending",tab_permissions:[]});return await Q.auth.signOut(),e({isLoading:!1}),qe(0,{email:n}),!0}return!1}catch(a){return e({error:"An error occurred during signup",isLoading:!1}),!1}},loginWithSupabase:async(t,n)=>{if(tt()){const t=rt();return e({error:`Too many failed attempts. Account locked for ${Math.ceil(t/60)} minutes.`,rateLimited:!0,lockoutTimeRemaining:t}),!1}e({isLoading:!0,error:null});try{const{data:r,error:a}=await Q.auth.signInWithPassword({email:t,password:n});if(a)return nt(!1),e({error:a.message||"Login failed",isLoading:!1}),!1;if(r.session){const t=await at(r.user.id);if(t){if("pending"===t.status)return await Q.auth.signOut(),e({error:"Your account is pending approval. Please wait for an administrator to activate your account.",isLoading:!1}),!1;if("suspended"===t.status)return await Q.auth.signOut(),e({error:"Your account has been suspended. Please contact an administrator.",isLoading:!1}),!1}nt(!0);const n={email:r.user.email,userId:r.user.id,expiresAt:new Date(Date.now()+Ye).toISOString(),provider:"supabase",profile:t};return Xe(n),e({isAuthenticated:!0,user:n,error:null,isLoading:!1}),!0}return!1}catch(r){return nt(!1),e({error:"An error occurred during login",isLoading:!1}),!1}},loginWithPassword:async t=>{if(tt()){const t=rt();return e({error:`Too many failed attempts. Try again in ${Math.ceil(t/60)} minutes.`,rateLimited:!0,lockoutTimeRemaining:t}),!1}if(e({isLoading:!0,error:null}),await new Promise(e=>setTimeout(e,300)),"tell2024"===t){nt(!0);const t={email:"local@tellproductions.com",userId:"local-user",expiresAt:new Date(Date.now()+Ye).toISOString(),provider:"password"};return Xe(t),e({isAuthenticated:!0,user:t,error:null,isLoading:!1}),qe(),!0}return nt(!1),e({error:"Incorrect password",isLoading:!1}),!1},login:async(e,n=null)=>V()&&n?t().loginWithSupabase(e,n):t().loginWithPassword(e),logout:async()=>{if(V())try{await Q.auth.signOut()}catch(t){}Xe(null),e({isAuthenticated:!1,user:null,error:null}),qe()},validateSession:()=>{const t=Je();return t?!(t.expiresAt&&new Date(t.expiresAt)<new Date)||(Xe(null),e({isAuthenticated:!1,user:null,error:"Session expired. Please login again."}),!1):(e({isAuthenticated:!1,user:null}),!1)},extendSession:()=>{const t=Je();if(!t)return;const n={...t,expiresAt:new Date(Date.now()+Ye).toISOString()};Xe(n),e({user:n})},clearError:()=>{e({error:null})},getRemainingAttempts:()=>{const e=Ze();return Math.max(0,5-e.attempts)},isSupabaseAuth:()=>V(),hasPermission:e=>{const{user:n}=t();return n?.profile?"admin"===n.profile.role||(n.profile.tabPermissions?.includes(e)??!1):"password"===n?.provider},isAdmin:()=>{const{user:e}=t();return"admin"===e?.profile?.role||"password"===e?.provider},getCurrentUserProfile:()=>{const{user:e}=t();return e?.profile||null},refreshProfile:async()=>{const{user:n}=t();if(!n?.userId||"password"===n.provider)return;const r=await at(n.userId);if(r){const t={...n,profile:r};Xe(t),e({user:t})}}}));if("undefined"!=typeof window){let e;it.getState().validateSession();const t=()=>{clearTimeout(e),e=setTimeout(()=>{it.getState().isAuthenticated&&it.getState().extendSession()},6e4)};window.addEventListener("mousemove",t),window.addEventListener("keydown",t)}let ot=null,st=null;function lt(e){if(q(e),!e.id)return;const{savedQuotes:t,updateQuote:n}=Ee.getState();t.some(t=>t.id===e.id)&&n(e.id,e)}async function ct(e){if(!e||!e.quoteNumber)return{synced:!1};if(!V())return{synced:!1,reason:"supabase not configured"};const t=JSON.stringify(e);if(t===st)return{synced:!1,reason:"no changes"};try{const n={quote_number:e.quoteNumber,quote_date:e.quoteDate,validity_days:e.validityDays,status:e.status||"draft",currency:e.currency,region:e.region,prepared_by:e.preparedBy,client:e.client,project:{...e.project,_sectionOrder:e.sectionOrder,_sectionNames:e.sectionNames},sections:e.sections,fees:e.fees,proposal:e.proposal};let r=e.id;if(e.id)await Q.from("quotes").update(n).eq("id",e.id);else{const{data:t}=await Q.from("quotes").select("id").eq("quote_number",e.quoteNumber).limit(1),a=t?.[0];if(a)await Q.from("quotes").update(n).eq("id",a.id),r=a.id;else{const{data:e,error:t}=await Q.from("quotes").insert(n).select().single();!t&&e&&(r=e.id)}}if(st=t,r&&!e.id){ft.getState().setQuoteId(r);const{saveQuote:t}=Ee.getState();t({...e,id:r})}return{synced:!0,id:r}}catch(n){return{synced:!1,error:n.message}}}function ut(){ot&&(clearInterval(ot),ot=null,window.removeEventListener("beforeunload",ut))}function dt(e){const t=ft.getState().quote,{addActivityLog:n}=He.getState(),{user:r}=it.getState(),a=r?.profile||{id:r?.userId||"unknown",name:r?.email?.split("@")[0]||"Unknown User"};n({userId:a.id,userName:a.name,quoteId:t.id,quoteNumber:t.quoteNumber,projectName:t.project?.title||"",...e})}function pt(){const e={};return D.forEach(t=>{const n=T[t],r={};n.subsections.forEach(e=>{r[e]=[]}),e[t]={...n,subsections:r,customSubsections:[],isExpanded:!0}}),e}function mt(){return{quoteNumber:z(),currency:"USD",region:"SEA",quoteDate:(new Date).toISOString().split("T")[0],validityDays:30,status:"draft",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),client:{company:"",contactId:null,contact:"",role:"",email:"",phone:"",notes:""},project:{title:"",type:"broadcast",venue:"",startDate:"",endDate:"",description:""},fees:{managementFee:0,commissionFee:0,discount:0,distributeFees:!1},preparedBy:"default",sectionOrder:D,sectionNames:{},sections:pt(),proposal:{coverImage:null,proposalText:"",isGenerated:!1},statusHistory:[],nextFollowUpDate:null,lostReason:null,lostReasonNotes:"",internalNotes:"",isLocked:!1,lockedAt:null,lockedBy:null}}const ft=u(L(e=>({quote:mt(),rates:A,ratesLoading:!1,ratesUpdated:null,activeSection:null,initialize:async()=>{const t=function(){try{const e=localStorage.getItem(O);return e?JSON.parse(e):null}catch(e){return null}}();t&&e({quote:t}),e({ratesLoading:!0});const{rates:n,timestamp:r}=await M();e({rates:n,ratesUpdated:r,ratesLoading:!1}),ot||(ot=setInterval(()=>{ct(ft.getState().quote)},3e4),window.addEventListener("beforeunload",ut))},setQuoteId:t=>{e(e=>{const n={...e.quote,id:t};return q(n),{quote:n}})},syncToSupabase:async()=>ct(ft.getState().quote),resetQuote:()=>{const t=mt();e({quote:t}),q(t)},loadQuoteData:t=>{const n={...mt(),...t,updatedAt:(new Date).toISOString()};e({quote:n}),q(n)},setQuoteNumber:t=>{e(e=>{const n={...e.quote,quoteNumber:t,updatedAt:(new Date).toISOString()};return lt(n),{quote:n}})},setCurrency:t=>{e(e=>{if(e.quote.isLocked)return e;const n=e.quote.currency;if(n===t)return e;const r=e.rates,a={...e.quote.sections};Object.keys(a).forEach(e=>{const i=a[e],o={...i.subsections};Object.keys(o).forEach(e=>{o[e]=o[e].map(e=>({...e,cost:Math.round(100*F(e.cost,n,t,r))/100,charge:Math.round(100*F(e.charge,n,t,r))/100}))}),a[e]={...i,subsections:o}});const i={...e.quote,currency:t,sections:a,updatedAt:(new Date).toISOString()};return lt(i),{quote:i}})},setRegion:t=>{if(ft.getState().quote.isLocked)return;const n=P[t]?.defaultCurrency||"USD",r=ce.getState().items;e(e=>{const a={...e.quote.sections};Object.keys(a).forEach(e=>{const n=a[e];Object.keys(n.subsections).forEach(e=>{n.subsections[e]=n.subsections[e].map(e=>{const n=e.rateCardItemId?r.find(t=>t.id===e.rateCardItemId):r.find(t=>t.name===e.name);if(n){const r=n.pricing?.[t],a=r?.cost?.amount??e.cost,i=r?.charge?.amount??e.charge;return{...e,cost:a,charge:i,rateCardItemId:e.rateCardItemId||n.id}}return e})})});const i={...e.quote,region:t,currency:n,sections:a,updatedAt:(new Date).toISOString()};return lt(i),{quote:i}})},setQuoteDate:t=>{e(e=>{if(e.quote.isLocked)return e;const n={...e.quote,quoteDate:t,updatedAt:(new Date).toISOString()};return lt(n),{quote:n}})},setValidityDays:t=>{e(e=>{if(e.quote.isLocked)return e;const n={...e.quote,validityDays:parseInt(t),updatedAt:(new Date).toISOString()};return lt(n),{quote:n}})},setClientDetails:t=>{e(e=>{if(e.quote.isLocked)return e;const n=e.quote.client,r={...e.quote,client:{...e.quote.client,...t},updatedAt:(new Date).toISOString()};return lt(r),Object.keys(t).forEach(e=>{n[e]!==t[e]&&dt({action:"update",category:"client",field:`client.${e}`,oldValue:n[e],newValue:t[e],description:`Changed client ${e} from "${n[e]||"(empty)"}" to "${t[e]||"(empty)"}"`})}),{quote:r}})},setProjectDetails:t=>{e(e=>{if(e.quote.isLocked)return e;const n=e.quote.project,r={...e.quote,project:{...e.quote.project,...t},updatedAt:(new Date).toISOString()};return lt(r),Object.keys(t).forEach(e=>{n[e]!==t[e]&&dt({action:"update",category:"project",field:`project.${e}`,oldValue:n[e],newValue:t[e],description:`Changed project ${e} from "${n[e]||"(empty)"}" to "${t[e]||"(empty)"}"`})}),{quote:r}})},setFees:t=>{e(e=>{if(e.quote.isLocked)return e;const n=e.quote.fees,r={...e.quote,fees:{...e.quote.fees,...t},updatedAt:(new Date).toISOString()};return lt(r),Object.keys(t).forEach(e=>{n[e]!==t[e]&&dt({action:"update",category:"fees",field:`fees.${e}`,oldValue:n[e],newValue:t[e],description:`Changed ${e} from ${n[e]} to ${t[e]}`})}),{quote:r}})},setPreparedBy:t=>{e(e=>{if(e.quote.isLocked)return e;const n={...e.quote,preparedBy:t,updatedAt:(new Date).toISOString()};return lt(n),{quote:n}})},toggleSection:t=>{e(e=>{const n={...e.quote.sections};n[t]={...n[t],isExpanded:!n[t].isExpanded};return{quote:{...e.quote,sections:n}}})},moveSection:(t,n)=>{e(e=>{if(e.quote.isLocked)return e;const r=[...e.quote.sectionOrder||D],a=r.indexOf(t);if(-1===a)return e;const i="up"===n?a-1:a+1;if(i<0||i>=r.length)return e;[r[a],r[i]]=[r[i],r[a]];const o={...e.quote,sectionOrder:r,updatedAt:(new Date).toISOString()};return lt(o),{quote:o}})},updateSectionName:(t,n)=>{e(e=>{if(e.quote.isLocked)return e;const r={...e.quote.sectionNames};n.trim()?r[t]=n.trim():delete r[t];const a={...e.quote,sectionNames:r,updatedAt:(new Date).toISOString()};return lt(a),{quote:a}})},addLineItem:(t,n,r)=>{e(e=>{if(e.quote.isLocked)return e;const a={...e.quote.sections},i={...a[t]},o={...i.subsections},s={id:`${Date.now()}-${Math.random().toString(36).substring(2,11)}`,name:r.name||"",quantity:r.quantity||1,days:r.days||1,cost:r.cost||0,charge:r.charge||0,rateCardItemId:r.rateCardItemId||null,kitItemId:r.kitItemId||null,...r};o[n]=[...o[n]||[],s],i.subsections=o,a[t]=i;const l={...e.quote,sections:a,updatedAt:(new Date).toISOString()};return lt(l),dt({action:"create",category:"lineItem",field:`${t}.${n}`,newValue:s,description:`Added line item "${s.name||"Unnamed"}" to ${n}`}),{quote:l}})},updateLineItem:(t,n,r,a)=>{e(e=>{if(e.quote.isLocked)return e;const i={...e.quote.sections},o={...i[t]},s={...o.subsections},l=s[n].find(e=>e.id===r);s[n]=s[n].map(e=>e.id===r?{...e,...a}:e),o.subsections=s,i[t]=o;const c={...e.quote,sections:i,updatedAt:(new Date).toISOString()};return lt(c),l&&Object.keys(a).forEach(e=>{l[e]!==a[e]&&dt({action:"update",category:"lineItem",field:`lineItem.${e}`,oldValue:l[e],newValue:a[e],description:`Updated "${l.name||"Unnamed"}" ${e}: ${l[e]}  ${a[e]}`})}),{quote:c}})},deleteLineItem:(t,n,r)=>{e(e=>{if(e.quote.isLocked)return e;const a={...e.quote.sections},i={...a[t]},o={...i.subsections},s=o[n].find(e=>e.id===r);o[n]=o[n].filter(e=>e.id!==r),i.subsections=o,a[t]=i;const l={...e.quote,sections:a,updatedAt:(new Date).toISOString()};return lt(l),s&&dt({action:"delete",category:"lineItem",field:`${t}.${n}`,oldValue:s,description:`Deleted line item "${s.name||"Unnamed"}" from ${n}`}),{quote:l}})},moveLineItem:(t,n,r,a,i)=>{e(e=>{if(e.quote.isLocked)return e;const o={...e.quote.sections},s=e=>({...o[e].subsections}),l=s(t),c=t===a?l:s(a),u=l[n].find(e=>e.id===r);if(!u)return{quote:e.quote};l[n]=l[n].filter(e=>e.id!==r),c[i]=[...c[i]||[],u],o[t]={...o[t],subsections:l},t!==a&&(o[a]={...o[a],subsections:c});const d={...e.quote,sections:o,updatedAt:(new Date).toISOString()};return lt(d),{quote:d}})},addCustomSubsection:(t,n)=>{e(e=>{if(e.quote.isLocked)return e;const r={...e.quote.sections},a={...r[t]};a.customSubsections.includes(n)||(a.customSubsections=[...a.customSubsections,n],a.subsections={...a.subsections,[n]:[]}),r[t]=a;const i={...e.quote,sections:r,updatedAt:(new Date).toISOString()};return lt(i),{quote:i}})},reorderSubsections:(t,n)=>{e(e=>{if(e.quote.isLocked)return e;const r={...e.quote.sections},a={...r[t]};a.subsectionOrder=n,r[t]=a;const i={...e.quote,sections:r,updatedAt:(new Date).toISOString()};return lt(i),{quote:i}})},updateSubsectionName:(t,n,r)=>{e(e=>{if(e.quote.isLocked)return e;const a={...e.quote.sections},i={...a[t]},o={...i.subsectionNames||{}};r.trim()&&r.trim()!==n?o[n]=r.trim():delete o[n],i.subsectionNames=o,a[t]=i;const s={...e.quote,sections:a,updatedAt:(new Date).toISOString()};return lt(s),{quote:s}})},refreshRates:async()=>{e({ratesLoading:!0}),localStorage.removeItem("exchange_rates_cache");const{rates:t,timestamp:n}=await M();e({rates:t,ratesUpdated:n,ratesLoading:!1})},setProposal:t=>{e(e=>{if(e.quote.isLocked)return e;const n={...e.quote,proposal:{...e.quote.proposal,...t},updatedAt:(new Date).toISOString()};return lt(n),{quote:n}})},updateQuoteStatus:(t,n="",r="default")=>{e(e=>{const a=e.quote.status,i=[...e.quote.statusHistory||[],{status:t,timestamp:(new Date).toISOString(),userId:r,note:n}],o={...e.quote,status:t,statusHistory:i,updatedAt:(new Date).toISOString()};return lt(o),dt({action:"status_change",category:"status",field:"status",oldValue:a,newValue:t,description:`Changed status from "${a}" to "${t}"${n?` (${n})`:""}`}),{quote:o}})},setNextFollowUpDate:t=>{e(e=>{const n={...e.quote,nextFollowUpDate:t,updatedAt:(new Date).toISOString()};return lt(n),{quote:n}})},setLostReason:(t,n="")=>{e(e=>{const r={...e.quote,lostReason:t,lostReasonNotes:n,updatedAt:(new Date).toISOString()};return lt(r),{quote:r}})},setInternalNotes:t=>{e(e=>{const n={...e.quote,internalNotes:t,updatedAt:(new Date).toISOString()};return lt(n),{quote:n}})},lockQuote:(t="default")=>{e(e=>{const n={...e.quote,isLocked:!0,lockedAt:(new Date).toISOString(),lockedBy:t,updatedAt:(new Date).toISOString()};return lt(n),dt({action:"lock",category:"lock",field:"isLocked",oldValue:!1,newValue:!0,description:"Locked quote for editing"}),{quote:n}})},unlockQuote:(t="default")=>{e(e=>{const t={...e.quote,isLocked:!1,lockedAt:null,lockedBy:null,updatedAt:(new Date).toISOString()};return lt(t),dt({action:"unlock",category:"lock",field:"isLocked",oldValue:!0,newValue:!1,description:"Unlocked quote for editing"}),{quote:t}})}})));function ht({activeTab:e,onTabChange:t}){const r=it(e=>e.hasPermission),a=[{id:"dashboard",label:"Dashboard",icon:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"},{id:"quotes",label:"Quotes",icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},{id:"clients",label:"Clients",icon:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"},{id:"opportunities",label:"Ops",icon:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"},{id:"tasks",label:"Tasks",icon:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"},{id:"sop",label:"SOP",icon:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"},{id:"knowledge",label:"Research",icon:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"},{id:"kit",label:"Kit",icon:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"},{id:"rate-card",label:"Rates",icon:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"},{id:"settings",label:"Settings",icon:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z"}],i=d.useMemo(()=>a.filter(e=>r(e.id)),[r]);return n.jsxs("nav",{className:"flex justify-center w-full","aria-label":"Main navigation",children:[n.jsx("div",{className:"hidden md:inline-flex bg-gray-900/80 p-1 rounded-xl border border-gray-800/80 gap-1",children:i.map(r=>n.jsx("button",{onClick:()=>t(r.id),className:"px-5 py-2 min-h-[44px] rounded-lg text-sm font-medium transition-all duration-200 "+(e===r.id?"bg-accent-primary/20 text-accent-primary border border-accent-primary/30":"text-gray-400 hover:text-gray-200 hover:bg-white/5 border border-transparent"),"aria-current":e===r.id?"page":void 0,children:r.label},r.id))}),n.jsx("div",{className:"md:hidden inline-flex bg-gray-900/80 p-1 rounded-xl border border-gray-800/80 gap-0.5",children:i.map(r=>n.jsxs("button",{onClick:()=>t(r.id),className:"px-2 py-1.5 min-w-[52px] min-h-[52px] rounded-lg transition-all duration-200 flex flex-col items-center justify-center gap-0.5 "+(e===r.id?"bg-accent-primary/20 text-accent-primary border border-accent-primary/30":"text-gray-400 hover:text-gray-200 hover:bg-white/5 border border-transparent"),"aria-current":e===r.id?"page":void 0,"aria-label":r.label,children:[n.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:r.icon})}),n.jsx("span",{className:"text-[9px] font-medium leading-none",children:r.label})]},r.id))})]})}const gt=d.createContext(null);function yt(){const e=d.useContext(gt);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}function bt({children:e}){const[t,r]=d.useState([]),a=d.useCallback((e,t="info",n=4e3)=>{const a=Date.now()+Math.random();return r(n=>[...n,{id:a,message:e,type:t}]),n>0&&setTimeout(()=>{r(e=>e.filter(e=>e.id!==a))},n),a},[]),i=d.useCallback(e=>{r(t=>t.filter(t=>t.id!==e))},[]),o={info:(e,t)=>a(e,"info",t),success:(e,t)=>a(e,"success",t),error:(e,t)=>a(e,"error",t),warning:(e,t)=>a(e,"warning",t)};return n.jsxs(gt.Provider,{value:o,children:[e,n.jsx(xt,{toasts:t,onRemove:i})]})}function xt({toasts:e,onRemove:t}){return 0===e.length?null:n.jsx("div",{className:"fixed bottom-4 right-4 left-4 sm:left-auto z-[100] flex flex-col gap-2 max-w-sm sm:max-w-md mx-auto sm:mx-0",role:"region","aria-label":"Notifications","aria-live":"polite",children:e.map(e=>n.jsx(vt,{toast:e,onRemove:t},e.id))})}function vt({toast:e,onRemove:t}){const[r,a]=d.useState(!1),i=()=>{a(!0),setTimeout(()=>t(e.id),200)};return n.jsxs("div",{role:"alert","aria-atomic":"true",className:`\n                ${{info:"bg-blue-500/90 border-blue-400",success:"bg-green-500/90 border-green-400",error:"bg-red-500/90 border-red-400",warning:"bg-yellow-500/90 border-yellow-400"}[e.type]}\n                border rounded-lg px-4 py-3 text-white shadow-lg\n                flex items-start gap-3 w-full\n                transition-all duration-200 ease-out\n                ${r?"opacity-0 translate-x-4 sm:translate-x-4":"opacity-100 translate-x-0"}\n                animate-slide-in-right\n            `,children:[n.jsx("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:{info:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",success:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",error:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",warning:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"}[e.type]})}),n.jsx("span",{className:"flex-1 text-sm leading-relaxed",children:e.message}),n.jsx("button",{onClick:i,onKeyDown:e=>{"Escape"!==e.key&&"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),i())},className:"text-white/70 hover:text-white transition-colors min-w-[32px] min-h-[32px] flex items-center justify-center -mr-1","aria-label":"Dismiss notification",title:"Dismiss (Esc)",children:n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}const wt="tell_quote_templates",kt="tell_quote_templates_sync_queue";function St(){try{const e=localStorage.getItem(kt);return e?JSON.parse(e):[]}catch(e){return[]}}function jt(e){try{localStorage.setItem(kt,JSON.stringify(e))}catch(t){}}function Ct(){try{const e=localStorage.getItem(wt);return e?JSON.parse(e):[]}catch(e){return[]}}function Nt(e){try{localStorage.setItem(wt,JSON.stringify(e))}catch(t){}}const _t=u(L((e,t)=>({templates:Ct(),loading:!1,syncStatus:"idle",syncError:null,pendingSyncCount:St().length,clearSyncError:()=>{e({syncError:null,syncStatus:"idle"})},getUnsyncedCount:()=>{const e=St(),n=t().templates.filter(e=>!1===e._synced);return e.length+n.length},addToSyncQueue:(t,n,r)=>{const a=St();a.push({action:t,id:n,data:r,timestamp:Date.now()}),jt(a),e({pendingSyncCount:a.length})},processSyncQueue:async()=>{if(!V())return;const t=St();if(0===t.length)return;e({syncStatus:"syncing"});const n=[];for(const e of t)try{if("create"===e.action){const{error:t}=await Q.from("quote_templates").insert(e.data);if(t)throw t}else if("update"===e.action){const{error:t}=await Q.from("quote_templates").update(e.data).eq("id",e.id);if(t)throw t}else if("delete"===e.action){const{error:t}=await Q.from("quote_templates").delete().eq("id",e.id);if(t)throw t}}catch(r){n.push(e)}jt(n),e({syncStatus:n.length>0?"error":"success",syncError:n.length>0?`${n.length} items failed to sync`:null,pendingSyncCount:n.length})},syncAllToSupabase:async()=>{const{processSyncQueue:e}=t();await e()},initialize:async()=>{if(V()){e({loading:!0,syncStatus:"syncing"});try{const{data:n,error:r}=await Q.from("quote_templates").select("*").order("created_at",{ascending:!1});if(r)throw r;const a=(n||[]).map(e=>({id:e.id,name:e.name,description:e.description,category:e.category,sections:e.sections,currency:e.currency,region:e.region,fees:e.fees,projectDefaults:e.project_defaults,createdAt:e.created_at,updatedAt:e.updated_at,usageCount:e.usage_count||0,_synced:!0}));e({templates:a,loading:!1,syncStatus:"success",syncError:null}),Nt(a);St().length>0&&t().processSyncQueue()}catch(n){e({loading:!1,syncStatus:"error",syncError:n.message})}}else e({loading:!1,syncStatus:"idle"})},getTemplate:e=>t().templates.find(t=>t.id===e),getTemplatesByCategory:e=>t().templates.filter(t=>t.category===e),createTemplate:async n=>{const{templates:r,addToSyncQueue:a}=t(),i={id:`tmpl_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,name:n.name,description:n.description||"",category:n.category||"general",sections:n.sections,currency:n.currency||"USD",region:n.region||"SEA",fees:n.fees||{managementFee:0,commissionFee:0,discountPercent:0},projectDefaults:n.projectDefaults||{},createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),usageCount:0,_synced:!1},o=[i,...r];if(e({templates:o}),Nt(o),V()){const n={id:i.id,name:i.name,description:i.description,category:i.category,sections:i.sections,currency:i.currency,region:i.region,fees:i.fees,project_defaults:i.projectDefaults,usage_count:0};try{const{error:r}=await Q.from("quote_templates").insert(n);if(r)throw r;const a=t().templates.map(e=>e.id===i.id?{...e,_synced:!0}:e);e({templates:a,syncStatus:"success",syncError:null}),Nt(a)}catch(s){a("create",i.id,n),e({syncStatus:"error",syncError:s.message})}}return i},updateTemplate:async(n,r)=>{const{templates:a,addToSyncQueue:i}=t(),o=a.map(e=>e.id===n?{...e,...r,updatedAt:(new Date).toISOString(),_synced:!1}:e);if(e({templates:o}),Nt(o),V()){const a={name:r.name,description:r.description,category:r.category,sections:r.sections,currency:r.currency,region:r.region,fees:r.fees,project_defaults:r.projectDefaults,updated_at:(new Date).toISOString()};Object.keys(a).forEach(e=>{void 0===a[e]&&delete a[e]});try{const{error:r}=await Q.from("quote_templates").update(a).eq("id",n);if(r)throw r;const i=t().templates.map(e=>e.id===n?{...e,_synced:!0}:e);e({templates:i,syncStatus:"success",syncError:null}),Nt(i)}catch(s){i("update",n,a),e({syncStatus:"error",syncError:s.message})}}},deleteTemplate:async n=>{const{templates:r,addToSyncQueue:a}=t(),i=r.filter(e=>e.id!==n);if(e({templates:i}),Nt(i),V())try{const{error:t}=await Q.from("quote_templates").delete().eq("id",n);if(t)throw t;e({syncStatus:"success",syncError:null})}catch(o){a("delete",n,null),e({syncStatus:"error",syncError:o.message})}},incrementUsageCount:async n=>{const{templates:r}=t(),a=r.find(e=>e.id===n);if(!a)return;const i=(a.usageCount||0)+1,o=r.map(e=>e.id===n?{...e,usageCount:i}:e);if(e({templates:o}),Nt(o),V())try{await Q.from("quote_templates").update({usage_count:i}).eq("id",n)}catch(s){}}})));_t.subscribe(e=>e.templates,e=>Nt(e));const Et=[{id:"broadcast",label:"Broadcast"},{id:"streaming",label:"Streaming"},{id:"corporate",label:"Corporate Event"},{id:"sports",label:"Sports"},{id:"concert",label:"Concert/Live"},{id:"general",label:"General"}];function Lt({isOpen:e,onClose:t}){const r=ft(e=>e.quote),a=_t(e=>e.createTemplate),[i,o]=d.useState(""),[s,l]=d.useState(""),[c,u]=d.useState("general"),[p,m]=d.useState(!1),[f,h]=d.useState(!1),[g,y]=d.useState(!0);if(!e)return null;const b=Object.values(r.sections||{}).reduce((e,t)=>e+Object.values(t.subsections||{}).reduce((e,t)=>e+(t.items?.length||0),0),0);return n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[n.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>t(!1)}),n.jsxs("div",{className:"relative bg-dark-card border border-dark-border rounded-xl shadow-2xl w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-border",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-brand-teal to-brand-navy flex items-center justify-center",children:n.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-white",children:"Save as Template"}),n.jsxs("p",{className:"text-xs text-gray-400",children:[b," items will be saved"]})]})]}),n.jsx("button",{onClick:()=>t(!1),className:"p-2 hover:bg-white/5 rounded-lg transition-colors",children:n.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Template Name *"}),n.jsx("input",{type:"text",value:i,onChange:e=>o(e.target.value),placeholder:"e.g., Sports Broadcast Package",className:"input",autoFocus:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Category"}),n.jsx("select",{value:c,onChange:e=>u(e.target.value),className:"input",children:Et.map(e=>n.jsx("option",{value:e.id,children:e.label},e.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1.5",children:"Description"}),n.jsx("textarea",{value:s,onChange:e=>l(e.target.value),placeholder:"Brief description of when to use this template...",className:"input min-h-[80px] resize-none",rows:3})]}),n.jsxs("div",{className:"space-y-2 pt-2 border-t border-dark-border",children:[n.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[n.jsx("input",{type:"checkbox",checked:g,onChange:e=>y(e.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-dark-bg text-brand-teal focus:ring-brand-teal"}),n.jsx("span",{className:"text-sm text-gray-300 group-hover:text-white transition-colors",children:"Include fee percentages"})]}),n.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[n.jsx("input",{type:"checkbox",checked:f,onChange:e=>h(e.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-dark-bg text-brand-teal focus:ring-brand-teal"}),n.jsx("span",{className:"text-sm text-gray-300 group-hover:text-white transition-colors",children:"Include project type & description"})]})]}),n.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3",children:n.jsx("p",{className:"text-xs text-blue-300",children:"Templates save your line items, sections, currency, and region. Client details and dates are not included."})})]}),n.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t border-dark-border",children:[n.jsx("button",{onClick:()=>t(!1),className:"btn btn-ghost",children:"Cancel"}),n.jsx("button",{onClick:async()=>{if(i.trim()){m(!0);try{const e={name:i.trim(),description:s.trim(),category:c,sections:r.sections,currency:r.currency,region:r.region,fees:g?{managementFee:r.managementFee||0,commissionFee:r.commissionFee||0,discountPercent:r.discountPercent||0}:{managementFee:0,commissionFee:0,discountPercent:0},projectDefaults:f?{projectType:r.project?.projectType,description:r.project?.description}:{}};await a(e),t(!0)}catch(e){}finally{m(!1)}}},disabled:!i.trim()||p,className:"btn btn-primary",children:p?n.jsxs(n.Fragment,{children:[n.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):n.jsxs(n.Fragment,{children:[n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save Template"]})})]})]})]})}function Tt(){const{settings:e,setTheme:t}=He(),r="light"!==e.theme;return n.jsx("button",{onClick:()=>t(r?"light":"dark"),className:"min-w-[44px] min-h-[44px] p-2 rounded-lg hover:bg-white/10 transition-colors flex items-center justify-center",title:r?"Switch to light mode":"Switch to dark mode",children:r?n.jsx("svg",{className:"w-5 h-5 text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}):n.jsx("svg",{className:"w-5 h-5 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})})}function Dt(){return n.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 focus:z-[100] focus:px-4 focus:py-2 focus:bg-brand-teal focus:text-white focus:rounded-lg focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-dark-bg transition-all",children:"Skip to main content"})}function It({view:e="editor",onGoToClients:t,onGoToRateCard:r,onGoToSettings:a,onGoToDashboard:i,onGoToQuotes:o,onGoToFS:s,onGoToOpportunities:l,onGoToTasks:c,onGoToSOP:u,onGoToKnowledge:p}){const{quote:m,ratesLoading:f,refreshRates:h}=ft(),{saveQuote:g}=Ee(),{logout:y,user:b}=it(),x=yt(),v=b?.profile?.name||b?.email?.split("@")[0]||"User",w="admin"===b?.profile?.role?"Administrator":"User",k=v.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)||"U",[S,j]=d.useState(!1),[C,N]=d.useState(!1),[_,E]=d.useState(!1),[L,T]=d.useState(!1);if("clients"===e||"client-detail"===e||"dashboard"===e||"quotes"===e||"rate-card"===e||"settings"===e||"opportunities"===e||"opportunity-detail"===e||"tasks"===e||"sop"===e||"knowledge"===e){const d="opportunity-detail"===e?"opportunities":"client-detail"===e?"clients":e;return n.jsxs(n.Fragment,{children:[n.jsx(Dt,{}),n.jsxs("header",{className:"min-h-[60px] bg-dark-bg/95 backdrop-blur-md border-b border-dark-border flex items-center justify-between px-3 sm:px-6 z-20 sticky top-0",children:[n.jsx("div",{className:"hidden sm:flex items-center gap-4",children:n.jsx("button",{onClick:i,className:"flex items-center hover:opacity-80 transition-all duration-200 min-h-[44px]",title:"Go to Dashboard",children:n.jsx("img",{src:"/tell-logo.svg",alt:"Tell",className:"h-7"})})}),n.jsx("div",{className:"flex-1 flex justify-center sm:absolute sm:left-1/2 sm:transform sm:-translate-x-1/2",children:n.jsx(ht,{activeTab:d,onTabChange:e=>{"dashboard"===e&&i(),"quotes"===e&&o(),"clients"===e&&t(),"opportunities"===e&&l(),"tasks"===e&&c(),"sop"===e&&u(),"knowledge"===e&&p(),"rate-card"===e&&r(),"settings"===e&&a()}})}),n.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 relative",children:[n.jsx(Tt,{}),n.jsxs("button",{onClick:s,className:"min-w-[44px] min-h-[44px] px-2 sm:px-3 py-1.5 rounded-lg bg-gradient-to-r from-teal-600/20 to-cyan-600/20 border border-teal-500/30 text-teal-400 text-xs font-bold hover:from-teal-600/30 hover:to-cyan-600/30 hover:border-teal-500/50 transition-all flex items-center justify-center gap-1.5",title:"Full Screen Analytics",children:[n.jsx("svg",{className:"w-4 h-4 sm:w-3.5 sm:h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),n.jsx("span",{className:"hidden sm:inline",children:"FS"})]}),n.jsx("button",{onClick:()=>E(!_),className:"min-w-[44px] min-h-[44px] w-10 h-10 sm:w-8 sm:h-8 rounded-full bg-gray-800 border border-gray-700 flex items-center justify-center text-xs text-gray-400 hover:border-gray-600 hover:text-gray-300 transition-colors",title:v,children:k}),_&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>E(!1)}),n.jsxs("div",{className:"absolute right-0 top-full mt-2 w-52 bg-[#1a1f2e] border border-dark-border rounded-lg shadow-2xl z-50 dropdown-menu overflow-hidden",children:[n.jsxs("div",{className:"px-4 py-3 border-b border-dark-border",children:[n.jsx("p",{className:"text-sm font-medium text-gray-200 truncate",children:v}),n.jsx("p",{className:"text-xs text-gray-500",children:w})]}),n.jsxs("button",{onClick:()=>{E(!1),y()},className:"w-full px-4 py-2.5 text-left text-sm text-gray-400 hover:bg-red-500/10 hover:text-red-400 transition-colors flex items-center gap-2",children:[n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sign Out"]})]})]})]})]})]})}return n.jsxs(n.Fragment,{children:[n.jsx(Dt,{}),n.jsx("header",{className:"sticky top-0 z-50 bg-dark-bg/95 backdrop-blur-md border-b border-dark-border",children:n.jsx("div",{className:"max-w-[1920px] mx-auto px-2 sm:px-4 py-2 sm:py-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2 sm:gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[n.jsx("button",{onClick:i,className:"min-w-[44px] min-h-[44px] p-2 rounded-lg hover:bg-white/5 transition-colors flex items-center justify-center",title:"Back to Dashboard",children:n.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),n.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[n.jsx("img",{src:"/tell-logo.svg",alt:"Tell",className:"h-5 sm:h-6 hidden xs:block"}),n.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[n.jsx("span",{className:"text-[10px] sm:text-xs font-mono text-accent-primary",children:m.quoteNumber}),n.jsx("span",{className:"text-[10px] text-gray-500 border border-gray-800 rounded px-1 hidden sm:inline",children:"default"===m.preparedBy?"Admin":"User"})]})]})]}),n.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[n.jsx(Tt,{}),n.jsx("div",{className:"px-2 sm:px-3 py-1 min-h-[32px] rounded-full text-[10px] sm:text-xs font-bold uppercase tracking-wider border flex items-center "+("won"===m.status?"bg-green-500/20 text-green-400 border-green-500/30":"sent"===m.status?"bg-blue-500/20 text-blue-400 border-blue-500/30":"dead"===m.status?"bg-red-500/20 text-red-500 border-red-500/30":"bg-gray-700/50 text-gray-400 border-gray-600"),children:m.status||"Draft"}),n.jsx("button",{onClick:h,disabled:f,className:"btn-ghost min-w-[44px] min-h-[44px] p-2 hidden sm:flex items-center justify-center",title:"Refresh exchange rates",children:n.jsx("svg",{className:"w-4 h-4 "+(f?"animate-spin":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),n.jsxs("button",{onClick:()=>T(!0),className:"btn-ghost min-w-[44px] min-h-[44px] text-sm flex items-center justify-center gap-1",title:"Save as template",children:[n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})}),n.jsx("span",{className:"hidden sm:inline",children:"Template"})]}),n.jsxs("button",{onClick:()=>{j(!0);try{const e=g(m);e?.id&&!m.id&&ft.getState().loadQuoteData({...m,id:e.id}),N(!0),setTimeout(()=>N(!1),2e3)}catch{x.error("Failed to save quote.")}finally{j(!1)}},disabled:S,className:"btn-ghost min-w-[44px] min-h-[44px] text-sm flex items-center justify-center gap-1 "+(C?"text-green-400":""),title:"Save quote to library",children:[C?n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),n.jsx("span",{className:"hidden sm:inline",children:C?"Saved!":"Save"})]})]})]})})}),n.jsx(Lt,{isOpen:L,onClose:e=>{T(!1),e&&x.success("Template saved successfully!")}})]})}function At(){const{quote:e,setClientDetails:t}=ft(),{clients:r,updateContact:a}=Ee(),{client:i}=e,[o,s]=d.useState(!1),[l,c]=d.useState(""),u=i.company?r.filter(e=>e?.company?.toLowerCase()?.includes(i.company.toLowerCase())):r;d.useEffect(()=>{const e=e=>{"Escape"===e.key&&o&&s(!1)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[o]);const p=(e,n)=>{t({[e]:n})},m=i?.clientId?r.find(e=>e.id===i.clientId):r.find(e=>e?.company?.toLowerCase()===i?.company?.toLowerCase()),f=(e,t)=>{p(e,t),m&&i.contactId&&a(m.id,i.contactId,{[e]:t})};return n.jsxs("div",{className:"card",children:[n.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[n.jsx("svg",{className:"w-4 h-4 text-accent-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"Client Details"]}),n.jsxs("div",{className:"space-y-5",children:[n.jsxs("div",{className:"relative",children:[n.jsx("label",{className:"label",children:"Company Name"}),n.jsx("input",{type:"text",value:i.company,onChange:e=>p("company",e.target.value),onFocus:()=>!e.isLocked&&s(!0),placeholder:"Type to search or add new client...",className:"input",disabled:e.isLocked}),o&&u.length>0&&n.jsx("div",{className:"absolute z-50 top-full left-0 right-0 mt-1 bg-[#1a1a24] border border-dark-border rounded-lg shadow-xl max-h-64 overflow-y-auto",children:u.map((e,r)=>n.jsxs("button",{onClick:()=>(e=>{const n=e.contacts?.find(e=>e.isPrimary)||e.contacts?.[0];t({clientId:e.id,company:e.company,contactId:n?.id||null,contact:n?.name||e.contact||"",email:n?.email||e.email||"",phone:n?.phone||e.phone||"",role:n?.role||""}),s(!1)})(e),className:"w-full px-3 py-2.5 text-left hover:bg-accent-primary/20 transition-colors flex items-center gap-3 "+(r!==u.length-1?"border-b border-dark-border/50":""),children:[n.jsx("div",{className:"w-8 h-8 rounded-md bg-gray-700 flex items-center justify-center text-xs font-bold text-gray-300 shrink-0",children:e.company.substring(0,2).toUpperCase()}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm text-gray-200 font-medium truncate",children:e.company}),e.contact&&n.jsx("p",{className:"text-xs text-gray-500 truncate",children:e.contact})]})]},e.id))}),o&&n.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>s(!1)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Contact Person"}),m&&m.contacts?.length>0?n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("select",{value:i.contactId||"",onChange:e=>(e=>{if(!m)return;const n=m.contacts?.find(t=>t.id===e);n&&t({contactId:n.id,contact:n.name,role:n.role||"",email:n.email,phone:n.phone,notes:n.notes||""})})(e.target.value),className:"input flex-1",disabled:e.isLocked,children:[n.jsx("option",{value:"",children:"Select Contact..."}),m.contacts.map(e=>n.jsxs("option",{value:e.id,children:[e.name," ",e.isPrimary?"(Primary)":""," - ",e.role||"No Role"]},e.id))]}),n.jsx("input",{type:"text",value:i.contact,onChange:e=>p("contact",e.target.value),placeholder:"Or type name...",className:"input w-1/3",disabled:e.isLocked})]}):n.jsx("input",{type:"text",value:i.contact,onChange:e=>p("contact",e.target.value),placeholder:"e.g. Ahmad Rahman",className:"input",disabled:e.isLocked})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"label",children:["Role on Project ",n.jsx("span",{className:"text-gray-600 font-normal",children:"(for this quote)"})]}),n.jsx("input",{type:"text",value:i.role||"",onChange:e=>p("role",e.target.value),placeholder:"e.g. Executive Producer, Client Liaison",className:"input",disabled:e.isLocked})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Email"}),n.jsx("input",{type:"email",value:i.email,onChange:e=>f("email",e.target.value),placeholder:"email@company.com",className:"input",disabled:e.isLocked})]}),n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Phone"}),n.jsx("input",{type:"tel",value:i.phone,onChange:e=>f("phone",e.target.value),placeholder:"+65 9123 4567",className:"input",disabled:e.isLocked})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"label",children:["Notes",i.contactId&&n.jsx("span",{className:"text-accent-primary font-normal ml-1",children:"(synced to contact)"}),!i.contactId&&n.jsx("span",{className:"text-gray-600 font-normal ml-1",children:"(internal only)"})]}),n.jsx("textarea",{value:i.notes||"",onChange:e=>f("notes",e.target.value),placeholder:"Notes about this contact...",rows:2,className:"input resize-none text-sm",disabled:e.isLocked})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"label",children:["Event Tags ",n.jsx("span",{className:"text-gray-600 font-normal",children:"(for this quote)"})]}),n.jsx("div",{className:"flex flex-wrap gap-1.5 mb-2",children:(i.tags||[]).map((r,a)=>n.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-accent-primary/20 text-accent-primary rounded text-xs",children:[r,!e.isLocked&&n.jsx("button",{onClick:()=>(e=>{const n=i.tags||[];t({tags:n.filter(t=>t!==e)})})(r),className:"hover:text-white transition-colors",children:n.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},a))}),n.jsx("input",{type:"text",value:l,onChange:e=>c(e.target.value),onKeyDown:e=>{if("Enter"===e.key&&l.trim()){e.preventDefault();const n=i.tags||[];n.includes(l.trim())||t({tags:[...n,l.trim()]}),c("")}},placeholder:"Type and press Enter to add...",className:"input text-sm",disabled:e.isLocked})]})]})]})}function Pt({onGoToSettings:e}){const{quote:t,setProjectDetails:r,setPreparedBy:a,setQuoteDate:i,setValidityDays:o,setRegion:s,setNextFollowUpDate:l,setInternalNotes:c,lockQuote:u,unlockQuote:p}=ft(),[m,f]=d.useState(!1),[h,g]=d.useState(!1),{settings:y}=He(),b=y.projectTypes||[],x=y.regions||[],{project:v}=t,w=y.users||[],k=(e,t)=>{r({[e]:t})},S=w.find(e=>e.id===t.preparedBy)||w[0],j=t.lockedBy?w.find(e=>e.id===t.lockedBy):null;return n.jsxs("div",{className:"card",children:[t.isLocked&&n.jsxs("div",{className:"mb-4 p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2 text-amber-400",children:[n.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),n.jsxs("span",{className:"text-sm font-medium",children:["This quote is locked",j&&n.jsxs("span",{className:"text-amber-500/70",children:[" by ",j.name]}),t.lockedAt&&n.jsxs("span",{className:"text-amber-500/70",children:[" on ",new Date(t.lockedAt).toLocaleDateString()]})]})]}),n.jsx("button",{onClick:()=>{p(S?.id||"default")},className:"text-xs px-3 py-1 bg-amber-500/20 hover:bg-amber-500/30 text-amber-400 rounded-lg transition-colors",children:"Unlock"})]}),n.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-4 flex items-center gap-2",children:[n.jsx("svg",{className:"w-4 h-4 text-accent-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z"})}),"Project Details"]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Prepared By"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("select",{value:t.preparedBy||"default",onChange:e=>a(e.target.value),className:"input flex-1",disabled:t.isLocked,children:[n.jsx("option",{value:"default",disabled:!0,children:"Select User"}),w.map(e=>n.jsx("option",{value:e.id,children:e.name},e.id))]}),n.jsx("button",{className:"btn-ghost px-2",title:"Manage Users in Settings",onClick:e,children:n.jsxs("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Quote Date"}),n.jsx("input",{type:"date",value:t.quoteDate,onChange:e=>i(e.target.value),className:"input",disabled:t.isLocked})]}),n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Valid Until"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("select",{value:t.validityDays,onChange:e=>o(e.target.value),className:"input flex-1",disabled:t.isLocked,children:[n.jsx("option",{value:"7",children:"7 Days"}),n.jsx("option",{value:"14",children:"14 Days"}),n.jsx("option",{value:"30",children:"30 Days"}),n.jsx("option",{value:"60",children:"60 Days"}),n.jsx("option",{value:"90",children:"90 Days"})]}),n.jsx("div",{className:"flex items-center justify-center px-3 bg-dark-bg/50 border border-dark-border rounded-lg text-sm text-gray-400 min-w-[100px]",children:(()=>{if(!t.quoteDate)return"-";const e=new Date(t.quoteDate);return e.setDate(e.getDate()+(parseInt(t.validityDays)||30)),e.toLocaleDateString()})()})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Project Title"}),n.jsx("input",{type:"text",value:v.title,onChange:e=>k("title",e.target.value),placeholder:"e.g. Shopee Cup Semi-Final",className:"input",disabled:t.isLocked})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Project Type"}),n.jsx("select",{value:v.type,onChange:e=>k("type",e.target.value),className:"input",disabled:t.isLocked,children:b.map(e=>n.jsx("option",{value:e.id,children:e.label},e.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Region (Rates)"}),n.jsx("select",{value:t.region||x[0]?.id||"SEA",onChange:e=>s(e.target.value),className:"input",disabled:t.isLocked,children:x.map(e=>n.jsx("option",{value:e.id,children:e.label},e.id))})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Currency"}),n.jsx("select",{value:t.currency||"USD",onChange:e=>{ft.getState().setCurrency(e.target.value)},className:"input",disabled:t.isLocked,children:Object.values(I).map(e=>n.jsxs("option",{value:e.code,children:[e.symbol," ",e.code," - ",e.name]},e.code))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Venue"}),n.jsx("input",{type:"text",value:v.venue,onChange:e=>k("venue",e.target.value),placeholder:"e.g. Jalan Besar Stadium",className:"input",disabled:t.isLocked})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Start Date"}),n.jsx("input",{type:"date",value:v.startDate,onChange:e=>{const t=e.target.value;k("startDate",t),v.endDate&&t>v.endDate&&k("endDate",t)},className:"input",disabled:t.isLocked})]}),n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"End Date"}),n.jsx("input",{type:"date",value:v.endDate,onChange:e=>k("endDate",e.target.value),min:v.startDate||"",className:"input",disabled:t.isLocked})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Description"}),n.jsx("textarea",{value:v.description,onChange:e=>k("description",e.target.value),placeholder:"Brief project description...",rows:2,className:"input resize-none",disabled:t.isLocked})]}),n.jsxs("div",{children:[n.jsx("label",{className:"label",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx("svg",{className:"w-4 h-4 text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),"Follow-up Reminder"]})}),n.jsx("input",{type:"date",value:t.nextFollowUpDate||"",onChange:e=>l(e.target.value||null),className:"input",disabled:t.isLocked}),n.jsx("p",{className:"form-helper",children:"Set a reminder date to follow up on this quote"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"label",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Internal Notes",n.jsx("span",{className:"text-xs text-gray-500 font-normal",children:"(Not shown in PDF)"})]})}),n.jsx("textarea",{value:t.internalNotes||"",onChange:e=>c(e.target.value),placeholder:"Team notes, context, reminders...",rows:3,className:"input resize-none",disabled:t.isLocked}),n.jsx("p",{className:"form-helper",children:"Useful for handoff context between team members"})]}),n.jsxs("div",{className:"border-t border-dark-border pt-4",children:[n.jsxs("button",{onClick:()=>f(!m),className:"w-full flex items-center justify-between text-sm text-gray-400 hover:text-gray-300 transition-colors",children:[n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Activity Log",t.statusHistory?.length>0&&n.jsx("span",{className:"text-xs bg-gray-700 px-1.5 py-0.5 rounded",children:t.statusHistory.length})]}),n.jsx("svg",{className:"w-4 h-4 transition-transform "+(m?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),m&&n.jsx("div",{className:"mt-3 space-y-2 max-h-64 overflow-y-auto",children:t.statusHistory&&0!==t.statusHistory.length?[...t.statusHistory].reverse().map((e,t)=>{const r=w.find(t=>t.id===e.userId),a=new Date(e.timestamp);return n.jsxs("div",{className:"flex items-start gap-3 text-sm p-2 rounded bg-dark-bg/50",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-600 mt-1.5 shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("span",{className:"text-gray-300",children:"Status changed to"}),n.jsx("span",{className:`font-semibold uppercase text-xs ${{draft:"text-gray-400",sent:"text-blue-400",under_review:"text-amber-400",approved:"text-emerald-400",won:"text-green-400",rejected:"text-red-400",expired:"text-gray-500",dead:"text-red-500"}[e.status]||"text-gray-400"}`,children:e.status?.replace("_"," ")})]}),e.note&&n.jsxs("p",{className:"text-gray-500 text-xs mt-1",children:['"',e.note,'"']}),n.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[r?.name||"System","  ",a.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]},t)}):n.jsx("p",{className:"text-sm text-gray-500 italic",children:"No activity recorded yet"})})]}),!t.isLocked&&n.jsxs("div",{className:"border-t border-dark-border pt-4",children:[n.jsxs("button",{onClick:()=>g(!0),className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-dark-bg/50 hover:bg-dark-bg border border-dark-border rounded-lg text-sm text-gray-400 hover:text-gray-300 transition-colors",children:[n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Lock Quote"]}),n.jsx("p",{className:"form-helper text-center mt-2",children:"Locking prevents accidental edits to this quote"})]})]}),h&&n.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black/75 backdrop-blur-md modal-backdrop p-4",children:n.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl p-6 w-full max-w-sm shadow-2xl",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"p-2 bg-amber-500/20 rounded-lg",children:n.jsx("svg",{className:"w-6 h-6 text-amber-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:"Lock Quote?"})]}),n.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Locking this quote will prevent any further edits. You can unlock it later if needed."}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>g(!1),className:"flex-1 px-4 py-2 bg-dark-bg hover:bg-dark-bg/80 border border-dark-border rounded-lg text-sm text-gray-300 transition-colors",children:"Cancel"}),n.jsx("button",{onClick:()=>{u(S?.id||"default"),g(!1)},className:"flex-1 px-4 py-2 bg-amber-500/20 hover:bg-amber-500/30 border border-amber-500/30 rounded-lg text-sm text-amber-400 font-medium transition-colors",children:"Lock Quote"})]})]})})]})}function Ot(){const{quote:e,setFees:t}=ft(),r=e.fees||{managementFee:0,commissionFee:0,discount:0},a=(e,n)=>{if(""===n)return void t({[e]:""});const r=parseFloat(n);if(isNaN(r))return;const a=Math.min(100,Math.max(0,r));t({[e]:a})},i=(e,n)=>{(""===n||isNaN(parseFloat(n)))&&t({[e]:0})};return n.jsxs("div",{className:"card",children:[n.jsxs("h3",{className:"text-sm font-semibold text-gray-300 mb-3 flex items-center gap-2",children:[n.jsx("svg",{className:"w-4 h-4 text-accent-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"Fees & Adjustments"]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Management %"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"number",value:r.managementFee,onChange:e=>a("managementFee",e.target.value),onBlur:e=>i("managementFee",e.target.value),min:"0",max:"100",step:"0.5",className:"input pr-8 text-center",disabled:e.isLocked}),n.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"})]}),n.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Added to charge"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Commission %"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"number",value:r.commissionFee,onChange:e=>a("commissionFee",e.target.value),onBlur:e=>i("commissionFee",e.target.value),min:"0",max:"100",step:"0.5",className:"input pr-8 text-center",disabled:e.isLocked}),n.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"})]}),n.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Added to charge"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"label",children:"Discount %"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"number",value:r.discount,onChange:e=>a("discount",e.target.value),onBlur:e=>i("discount",e.target.value),min:"0",max:"100",step:"0.5",className:"input pr-8 text-center",disabled:e.isLocked}),n.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500",children:"%"})]}),n.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Off final total"})]})]}),n.jsx("div",{className:"mt-4 pt-4 border-t border-gray-800",children:n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[n.jsx("input",{type:"checkbox",checked:r.distributeFees||!1,onChange:e=>t({distributeFees:e.target.checked}),className:"checkbox border-gray-600 rounded bg-gray-900 group-hover:border-accent-primary transition-colors",disabled:e.isLocked}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm font-medium text-gray-300 group-hover:text-white transition-colors",children:"Distribute Fees into Unit Rates"}),n.jsx("p",{className:"text-xs text-gray-500",children:"Hides separate fee line items on PDF by inflating unit prices"})]})]})})]})}function qt(e){if(!e)return{totalCost:0,totalCharge:0};const t=Number(e.quantity)||1,n=Number(e.days)||1;return{totalCost:(Number(e.cost)||0)*t*n,totalCharge:(Number(e.charge)||0)*t*n}}function zt(e){if(!e)return 0;const{totalCost:t,totalCharge:n}=qt(e);return function(e,t){const n=Number(e)||0,r=Number(t)||0;return 0===r?0:(r-n)/r*100}(t,n)}function Rt(e){if(!e||"object"!=typeof e)return{totalCost:0,totalCharge:0};let t=0,n=0;return Object.values(e).forEach(e=>{const r=function(e){return e&&Array.isArray(e)?e.reduce((e,t)=>{if(!t)return e;const{totalCost:n,totalCharge:r}=qt(t);return{totalCost:e.totalCost+n,totalCharge:e.totalCharge+r}},{totalCost:0,totalCharge:0}):{totalCost:0,totalCharge:0}}(e);t+=r.totalCost,n+=r.totalCharge}),{totalCost:t,totalCharge:n}}function Mt(e,t={}){const n=function(e){if(!e||"object"!=typeof e)return{totalCost:0,totalCharge:0};let t=0,n=0;return Object.values(e).forEach(e=>{if(e?.subsections){const r=Rt(e.subsections);t+=r.totalCost,n+=r.totalCharge}}),{totalCost:t,totalCharge:n}}(e),r=t.managementFee||0,a=t.commissionFee||0,i=t.discount||0,o=n.totalCharge*r/100,s=n.totalCharge*a/100,l=n.totalCharge+o+s,c=l*i/100,u=l-c,d=n.totalCost;return{baseCost:n.totalCost,baseCharge:n.totalCharge,managementAmount:o,commissionAmount:s,chargeWithFees:l,discountAmount:c,totalCost:d,totalCharge:u,profit:u-d,margin:u>0?(u-d)/u*100:0,getDistributedRate:e=>{if(!t.distributeFees)return e;return e*(1+(r+a)/100)}}}function Ft({item:e,sectionId:t,subsectionName:r}){const{quote:a,updateLineItem:i,deleteLineItem:o,rates:s}=ft(),{items:l,sections:c}=ce(),[u,p]=d.useState(!1),[m,f]=d.useState([]),[h,g]=d.useState(-1),y=d.useRef(null),b=qt(e),x=zt(e),v=function(e){return e>=30?"text-green-400":e>=20?"text-amber-400":"text-red-400"}(x),w=e.rateCardItemId?l.find(t=>t.id===e.rateCardItemId):null,k=(()=>{if(!w)return null;const e=w?.pricing?.[a.region];return{cost:e?.cost?.amount??0,charge:e?.charge?.amount??0}})(),S=k&&(e.cost!==k.cost||e.charge!==k.charge),j=B(a.region),C="MALAYSIA"===a.region?b.totalCharge:F(b.totalCharge,j,a.currency,s),N=(n,a)=>{i(t,r,e.id,{[n]:a})},_=e=>{if(N("name",e),e.length>=2){const t=(e=>{const t=e.toLowerCase();return l.filter(e=>e.name.toLowerCase().includes(t)).slice(0,8)})(e);f(t),p(t.length>0),g(-1)}else p(!1)},E=e=>{const t=c.find(t=>t.id===e);return t?.name||e},L=n=>{const o=n?.pricing?.[a.region],s=o?.cost?.amount??0,l=o?.charge?.amount??0;i(t,r,e.id,{name:n.name,cost:s,charge:l,rateCardItemId:n.id}),p(!1),g(-1)};return d.useEffect(()=>{const e=e=>{y.current&&!y.current.contains(e.target)&&(p(!1),g(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),n.jsxs("div",{draggable:!a.isLocked,onDragStart:n=>{a.isLocked||(n.dataTransfer.setData("application/json",JSON.stringify({sectionId:t,subsectionName:r,itemId:e.id})),n.dataTransfer.effectAllowed="move")},className:"group bg-dark-card border border-dark-border rounded-lg p-2 hover:border-gray-700 transition-colors "+(a.isLocked?"cursor-default opacity-75":"cursor-move"),role:"article","aria-label":`Line item: ${e.name||"Unnamed item"}`,children:[n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsxs("div",{className:"relative flex-1 min-w-[140px] sm:min-w-[180px]",ref:y,children:[n.jsx("label",{htmlFor:`item-name-${e.id}`,className:"sr-only",children:"Item name"}),n.jsx("input",{id:`item-name-${e.id}`,type:"text",value:e.name,onChange:e=>_(e.target.value),onKeyDown:e=>{if(u)switch(e.key){case"ArrowDown":e.preventDefault(),g(e=>e<m.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),g(e=>e>0?e-1:m.length-1);break;case"Enter":e.preventDefault(),h>=0&&m[h]&&L(m[h]);break;case"Escape":p(!1),g(-1)}},placeholder:"Item name...",className:"input-sm w-full text-sm","aria-autocomplete":"list","aria-controls":u?`autocomplete-${e.id}`:void 0,"aria-expanded":u,disabled:a.isLocked}),u&&n.jsx("div",{id:`autocomplete-${e.id}`,className:"absolute z-20 top-full left-0 right-0 mt-1 bg-dark-card border border-dark-border rounded-lg shadow-xl overflow-hidden",role:"listbox","aria-label":"Item suggestions",children:m.map((e,t)=>n.jsxs("button",{onClick:()=>L(e),className:"w-full px-3 py-2 text-left text-sm hover:bg-white/10 transition-colors flex justify-between items-center "+(t===h?"bg-white/10":""),role:"option","aria-selected":t===h,children:[n.jsx("span",{className:"text-gray-200",children:e.name}),n.jsx("span",{className:"text-xs text-gray-500",children:E(e.section)})]},e.id||t))}),S&&!a.isLocked&&n.jsx("button",{onClick:()=>{k&&i(t,r,e.id,{cost:k.cost,charge:k.charge})},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-amber-400 hover:text-amber-300 hover:bg-amber-500/10 rounded transition-colors",title:`Price differs from rate card (Cost: ${$(a.currency)}${k.cost}, Charge: ${$(a.currency)}${k.charge}). Click to refresh.`,"aria-label":"Refresh price from rate card",children:n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),n.jsxs("div",{className:"w-14 sm:w-16",children:[n.jsx("label",{htmlFor:`quantity-${e.id}`,className:"sr-only",children:"Quantity"}),n.jsx("input",{id:`quantity-${e.id}`,type:"number",value:e.quantity,onChange:e=>N("quantity",""===e.target.value?"":parseFloat(e.target.value)),onBlur:t=>{(""===t.target.value||isNaN(e.quantity))&&N("quantity",1)},onFocus:e=>e.target.select(),min:"1",className:"input-sm w-full text-left text-sm",title:"Qty","aria-label":"Quantity",placeholder:"Qty",disabled:a.isLocked})]}),n.jsxs("div",{className:"w-14 sm:w-16",children:[n.jsx("label",{htmlFor:`days-${e.id}`,className:"sr-only",children:"Days"}),n.jsx("input",{id:`days-${e.id}`,type:"number",value:e.days,onChange:e=>N("days",""===e.target.value?"":parseFloat(e.target.value)),onBlur:t=>{(""===t.target.value||isNaN(e.days))&&N("days",1)},onFocus:e=>e.target.select(),min:"0.5",step:"0.5",className:"input-sm w-full text-left text-sm",title:"Days","aria-label":"Number of days",placeholder:"Days",disabled:a.isLocked})]}),n.jsxs("div",{className:"w-24 hidden lg:block relative",children:[n.jsx("label",{htmlFor:`cost-${e.id}`,className:"sr-only",children:"Cost per unit"}),n.jsxs("div",{className:"relative",children:[n.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-gray-500",children:$(a.currency)}),n.jsx("input",{id:`cost-${e.id}`,type:"number",value:e.cost,onChange:e=>N("cost",""===e.target.value?"":parseFloat(e.target.value)),onBlur:t=>{(""===t.target.value||isNaN(e.cost))&&N("cost",0)},onFocus:e=>e.target.select(),min:"0",className:"input-sm w-full pl-6 text-left text-sm text-gray-500",title:"Cost","aria-label":`Cost per unit in ${a.currency}`,disabled:a.isLocked})]})]}),n.jsxs("div",{className:"w-20 sm:w-24 relative",children:[n.jsx("label",{htmlFor:`charge-${e.id}`,className:"sr-only",children:"Charge per unit"}),n.jsxs("div",{className:"relative",children:[n.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-gray-400",children:$(a.currency)}),n.jsx("input",{id:`charge-${e.id}`,type:"number",value:e.charge,onChange:e=>N("charge",""===e.target.value?"":parseFloat(e.target.value)),onBlur:t=>{(""===t.target.value||isNaN(e.charge))&&N("charge",0)},onFocus:e=>e.target.select(),min:"0",className:"input-sm w-full pl-5 sm:pl-6 text-left text-sm",title:"Charge","aria-label":`Charge per unit in ${a.currency}`,disabled:a.isLocked})]})]}),n.jsx("div",{className:"w-20 sm:w-24 text-right flex items-center justify-end",role:"status","aria-live":"polite","aria-label":`Total: ${U(C,a.currency)}`,children:n.jsx("span",{className:"text-xs sm:text-sm font-semibold text-gray-100",children:U(C,a.currency)})}),n.jsx("div",{className:"w-14 text-right hidden lg:flex items-center justify-end",role:"status","aria-live":"polite","aria-label":`Margin: ${x.toFixed(0)}%`,children:n.jsxs("span",{className:"text-xs font-bold px-1.5 py-0.5 rounded "+(x>=30?"bg-green-500/10 text-green-400":x>=15?"bg-amber-500/10 text-amber-400":"bg-red-500/10 text-red-400"),children:[x.toFixed(0),"%"]})}),!a.isLocked&&n.jsx("button",{onClick:()=>{o(t,r,e.id)},className:"p-2 min-w-[36px] min-h-[36px] text-gray-600 hover:text-red-400 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity flex items-center justify-center",title:"Delete item","aria-label":`Delete ${e.name||"item"}`,children:n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),n.jsxs("div",{className:"flex lg:hidden items-center justify-between mt-2 pt-2 border-t border-dark-border text-xs text-gray-500",children:[n.jsxs("span",{"aria-label":`Cost: ${$(a.currency)}${e.cost}`,children:["Cost: ",$(a.currency),e.cost]}),n.jsxs("span",{className:v,"aria-label":`Margin: ${x.toFixed(0)}%`,children:["Margin: ",x.toFixed(0),"%"]})]})]})}function Ut({sectionId:e,subsectionName:t,color:r,isDragging:a}){const{quote:i,addLineItem:o,updateSubsectionName:s}=ft(),{items:l}=ce(),c=i.sections[e],u=c?.subsections?.[t]||[],[p,m]=d.useState(!1),[f,h]=d.useState(!1),[g,y]=d.useState(""),[b,x]=d.useState(""),v=d.useRef(null),w=c?.subsectionNames?.[t]||t;d.useEffect(()=>{f&&v.current&&(v.current.focus(),v.current.select())},[f]);const k=()=>{s(e,t,g),h(!1)},S=()=>{h(!1),y("")},j=((e,t)=>{if("creative"===e)return"creative";if("logistics"===e)return"logistics";if("expenses"===e)return"expenses";if("productionTeam"===e)return{Production:"prod_production","Technical Crew":"prod_technical","Production Management":"prod_management"}[t]||"prod_production";if("productionEquipment"===e)return{Video:"equip_video",Audio:"equip_audio",Cameras:"equip_cameras",Graphics:"equip_graphics",VT:"equip_vt",Cabling:"equip_cabling",Other:"equip_other"}[t]||"equip_other";return"other"})(e,t),C=l.filter(e=>e.section===j),N=b.trim()?C.filter(e=>e.name.toLowerCase().includes(b.toLowerCase())):C.slice(0,8),_=(e,t)=>{if(!t.trim())return e;const r=new RegExp(`(${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return e.split(r).map((e,t)=>r.test(e)?n.jsx("mark",{className:"bg-accent-primary/30 text-accent-primary px-0.5 rounded",children:e},t):e)},E=(n=null)=>{const r=i.region,a=n?.pricing?.[r],s=a?.cost?.amount??0,l=a?.charge?.amount??0;o(e,t,{name:n?.name||"",cost:s,charge:l,quantity:1,days:1,isPercentage:n?.isPercentage||!1,percentValue:n?.percentValue||0,rateCardItemId:n?.id||null}),m(!1)},L=["creative","logistics","expenses"].includes(e)&&"Services"===t;return n.jsxs("div",{className:"bg-dark-bg/50 rounded-md p-2 transition-colors hover:bg-dark-bg/70",onDragOver:e=>{i.isLocked||(e.preventDefault(),e.currentTarget.classList.add("bg-accent-primary/10"))},onDragLeave:e=>{i.isLocked||(e.preventDefault(),e.currentTarget.classList.remove("bg-accent-primary/10"))},onDrop:n=>{if(i.isLocked)return;n.preventDefault(),n.currentTarget.classList.remove("bg-accent-primary/10");const r=JSON.parse(n.dataTransfer.getData("application/json"));!r||r.sectionId===e&&r.subsectionName===t||ft.getState().moveLineItem(r.sectionId,r.subsectionName,r.itemId,e,t)},children:[!L&&n.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[n.jsx("svg",{className:"w-3 h-3 text-gray-600 flex-shrink-0 cursor-grab",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8h16M4 16h16"})}),f?n.jsxs("div",{className:"flex items-center gap-1",onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),draggable:!1,children:[n.jsx("input",{ref:v,type:"text",value:g,onChange:e=>y(e.target.value),onKeyDown:e=>{"Enter"===e.key&&k(),"Escape"===e.key&&S()},className:"input-sm text-xs py-0.5 w-32","aria-label":"Subsection name",draggable:!1}),n.jsx("button",{onClick:k,className:"p-0.5 text-green-400 hover:text-green-300","aria-label":"Save",children:n.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),n.jsx("button",{onClick:S,className:"p-0.5 text-gray-400 hover:text-gray-300","aria-label":"Cancel",children:n.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):n.jsx("h4",{className:"text-xs font-medium text-gray-400 cursor-text hover:text-gray-300",onClick:e=>{e.stopPropagation(),y(w),h(!0)},onMouseDown:e=>e.stopPropagation(),draggable:!1,title:"Click to rename",children:w}),n.jsxs("span",{className:"text-[10px] text-gray-600",children:[u.length," items"]})]}),u.length>0&&n.jsxs("div",{className:"space-y-1 mb-1",children:[n.jsxs("div",{className:"flex flex-wrap items-center gap-2 px-2 py-0.5 text-[10px] text-gray-500 border-b border-dark-border",children:[n.jsx("div",{className:"flex-1 min-w-[180px]",children:"Item"}),n.jsx("div",{className:"w-16 text-left",children:"Qty"}),n.jsx("div",{className:"w-16 text-left",children:"Days"}),n.jsx("div",{className:"w-24 text-left hidden lg:block",children:"Cost"}),n.jsx("div",{className:"w-24 text-left",children:"Charge"}),n.jsx("div",{className:"w-24 text-right",children:"Total"}),n.jsx("div",{className:"w-14 text-right hidden lg:block",children:"Margin"}),n.jsx("div",{className:"w-6"})]}),u.map(r=>n.jsx(Ft,{item:r,sectionId:e,subsectionName:t},r.id))]}),!i.isLocked&&(p?n.jsxs("div",{className:"bg-dark-card rounded-lg p-2 space-y-2",children:[C.length>0&&n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Quick Add"}),C.length>8&&n.jsx("input",{type:"text",value:b,onChange:e=>x(e.target.value),placeholder:"Search items...",className:"input-sm text-xs py-0.5 px-2 w-32"})]}),n.jsxs("div",{className:"flex flex-wrap gap-2 max-h-32 overflow-y-auto",children:[N.map(e=>n.jsxs("button",{onClick:()=>E(e),className:"text-xs px-2.5 py-1.5 bg-dark-bg hover:bg-white/10 rounded-md transition-colors text-gray-400 hover:text-gray-200 border border-dark-border hover:border-gray-600",children:["+ ",_(e.name,b)]},e.name)),b&&0===N.length&&n.jsx("span",{className:"text-xs text-gray-500 italic",children:"No matching items"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>E(),className:"text-xs px-3 py-1.5 bg-accent-primary/20 hover:bg-accent-primary/30 text-accent-primary rounded transition-colors",children:"+ Custom Item"}),n.jsx("button",{onClick:()=>{m(!1),x("")},className:"text-xs px-3 py-1.5 text-gray-500 hover:text-gray-300",children:"Cancel"})]})]}):n.jsxs("button",{onClick:()=>m(!0),className:"w-full py-1.5 text-xs text-gray-500 hover:text-gray-300 hover:bg-white/5 rounded transition-colors flex items-center justify-center gap-1",style:{borderColor:r},children:[n.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Item"]}))]})}const Bt=d.memo(function({sectionId:e,index:t,totalSections:r}){const{quote:a,toggleSection:i,moveSection:o,updateSectionName:s,moveSubsection:l,rates:c}=ft(),u=a.sections[e],p=T[e],[m,f]=d.useState(!1),[h,g]=d.useState(""),[y,b]=d.useState(!1),[x,v]=d.useState(""),[w,k]=d.useState(null),[S,j]=d.useState(null),C=d.useRef(null),N=a.sectionNames?.[e]||p?.name||"";if(d.useEffect(()=>{y&&C.current&&(C.current.focus(),C.current.select())},[y]),!u||!p)return null;const _=Rt(u.subsections),E=B(a.region),L=U("MALAYSIA"===a.region?_.totalCharge:F(_.totalCharge,E,a.currency,c),a.currency),D=[...p.subsections,...u.customSubsections||[]],I=u.subsectionOrder||D,A=Object.values(u.subsections).reduce((e,t)=>e+t.length,0),P=()=>{k(null),j(null)},O=()=>{if(h.trim()){const{addCustomSubsection:t}=ft.getState();t(e,h.trim()),g(""),f(!1)}},q=()=>{s(e,x),b(!1)},z=()=>{b(!1),v("")};return n.jsxs("div",{className:"card overflow-hidden",style:{borderLeftColor:p.color,borderLeftWidth:"3px"},role:"region","aria-labelledby":`section-${e}-title`,children:[n.jsxs("div",{role:"button",tabIndex:0,className:"section-header -m-4 mb-0 w-full cursor-pointer",onClick:()=>i(e),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),i(e))},"aria-expanded":u.isExpanded,"aria-controls":`section-${e}-content`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:p.color},"aria-hidden":"true"}),y?n.jsxs("div",{className:"flex items-center gap-2",onClick:e=>e.stopPropagation(),children:[n.jsx("input",{ref:C,type:"text",value:x,onChange:e=>v(e.target.value),onKeyDown:e=>{"Enter"===e.key&&q(),"Escape"===e.key&&z()},className:"input-sm text-sm font-semibold py-0.5","aria-label":"Section name"}),n.jsx("button",{onClick:q,className:"p-1 text-green-400 hover:text-green-300","aria-label":"Save name",children:n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),n.jsx("button",{onClick:z,className:"p-1 text-gray-400 hover:text-gray-300","aria-label":"Cancel",children:n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):n.jsx("h3",{id:`section-${e}-title`,className:"font-semibold text-gray-200 cursor-pointer hover:text-white",onClick:e=>{e.stopPropagation(),v(N),b(!0)},title:"Click to rename",children:N}),n.jsxs("span",{className:"text-xs text-gray-500 bg-dark-card px-2 py-0.5 rounded flex-shrink-0",children:[A," items"]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"flex items-center gap-1",onClick:e=>e.stopPropagation(),children:[n.jsx("button",{onClick:t=>{t.stopPropagation(),o(e,"up")},disabled:0===t,className:"p-1 rounded transition-colors "+(0===t?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-white hover:bg-white/10"),"aria-label":"Move section up",children:n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),n.jsx("button",{onClick:t=>{t.stopPropagation(),o(e,"down")},disabled:t===r-1,className:"p-1 rounded transition-colors "+(t===r-1?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-white hover:bg-white/10"),"aria-label":"Move section down",children:n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),n.jsx("span",{className:"text-sm font-medium text-gray-300",children:L}),n.jsx("svg",{className:"w-5 h-5 text-gray-400 transition-transform duration-200 "+(u.isExpanded?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),u.isExpanded&&n.jsxs("div",{id:`section-${e}-content`,className:"mt-3 space-y-2",children:[I.map((t,r)=>n.jsx("div",{draggable:!a.isLocked,onDragStart:e=>!a.isLocked&&((e,t)=>{k(t),e.dataTransfer.setData("subsection",t),e.dataTransfer.effectAllowed="move"})(e,t),onDragOver:e=>!a.isLocked&&((e,t)=>{e.preventDefault(),w&&w!==t&&j(t)})(e,t),onDrop:n=>!a.isLocked&&((t,n)=>{if(t.preventDefault(),w&&w!==n){const t=[...I],r=t.indexOf(w),a=t.indexOf(n);if(-1!==r&&-1!==a){t.splice(r,1),t.splice(a,0,w);const{reorderSubsections:n}=ft.getState();n(e,t)}}k(null),j(null)})(n,t),onDragEnd:P,className:`transition-all duration-150 ${w===t?"opacity-50 scale-[0.98]":""} ${S===t?"ring-2 ring-accent-primary/50 rounded-lg":""}`,children:n.jsx(Ut,{sectionId:e,subsectionName:t,color:p.color,isDragging:w===t})},t)),!a.isLocked&&(m?n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-dark-bg rounded-lg",children:[n.jsx("label",{htmlFor:`new-subsection-${e}`,className:"sr-only",children:"New subsection name"}),n.jsx("input",{id:`new-subsection-${e}`,type:"text",value:h,onChange:e=>g(e.target.value),placeholder:"Subsection name...",className:"input-sm flex-1",autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&O(),"Escape"===e.key&&(f(!1),g(""))},"aria-label":"New subsection name"}),n.jsx("button",{onClick:O,className:"btn-primary text-xs py-1 px-2","aria-label":"Add subsection",children:"Add"}),n.jsx("button",{onClick:()=>{f(!1),g("")},className:"btn-ghost text-xs py-1 px-2","aria-label":"Cancel adding subsection",children:"Cancel"})]}):n.jsxs("button",{onClick:()=>f(!0),className:"w-full py-2 text-sm text-gray-500 hover:text-gray-300 hover:bg-white/5 rounded-lg transition-colors flex items-center justify-center gap-1","aria-label":"Add new subsection",children:[n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Subsection"]}))]})]})});function $t({onGoToSettings:e}){const t=ft(e=>e.quote.sectionOrder||D);return n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 h-[calc(100vh-60px)]",children:[n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[n.jsx(At,{}),n.jsx(Pt,{onGoToSettings:e})]}),n.jsx(Ot,{}),n.jsx("div",{className:"space-y-2",children:t.map((e,r)=>n.jsx(Bt,{sectionId:e,index:r,totalSections:t.length},e))})]})}const Qt="#FFFFFF",Vt="#1E293B",Wt="#334155",Ht="#64748B",Gt="#0F8B8D",Kt="#E2E8F0",Yt=a.create({page:{backgroundColor:Qt,paddingTop:30,paddingBottom:40,paddingHorizontal:30,fontFamily:"Helvetica",color:Vt,fontSize:6},header:{marginBottom:12,paddingBottom:8,borderBottomWidth:1,borderBottomColor:Kt},title:{fontSize:10,color:Vt,letterSpacing:1,textTransform:"uppercase",marginBottom:2},company:{fontSize:7,color:Gt,marginBottom:1},address:{fontSize:6,color:Ht},intro:{fontSize:5.5,color:Wt,marginBottom:10,lineHeight:1.4},columnsContainer:{flexDirection:"row",gap:16},column:{flex:1},section:{marginBottom:6},sectionTitle:{fontSize:6.5,color:Vt,fontFamily:"Helvetica-Bold",marginBottom:2},subsectionTitle:{fontSize:6,color:Wt,fontFamily:"Helvetica-Bold",marginTop:2,marginBottom:1},text:{fontSize:5.5,color:Wt,lineHeight:1.35,textAlign:"justify"},listItem:{fontSize:5.5,color:Wt,lineHeight:1.35,marginLeft:6},footer:{position:"absolute",bottom:0,left:0,right:0,paddingVertical:10,paddingHorizontal:30,borderTopWidth:1,borderTopColor:Kt,backgroundColor:Qt},footerContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},footerLeft:{flexDirection:"row",alignItems:"center"},footerLogo:{fontSize:8,color:Vt,letterSpacing:2,marginRight:6},footerDivider:{width:1,height:8,backgroundColor:Kt,marginRight:6},footerText:{fontSize:6,color:Ht},footerRight:{flexDirection:"row",alignItems:"center"},footerQuote:{fontSize:6,color:Gt},footerPageNum:{fontSize:6,color:Ht,marginLeft:10}});function Jt({quoteNumber:e,companyWebsite:t}){return n.jsxs(r,{size:"A4",style:Yt.page,children:[n.jsxs(i,{style:Yt.header,children:[n.jsx(o,{style:Yt.title,children:"General Terms and Conditions"}),n.jsx(o,{style:Yt.company,children:"TELL PRODUCTIONS SDN BHD"}),n.jsx(o,{style:Yt.address,children:"8-3, Jalan Jalil 1, Bukit Jalil, 57000 Kuala Lumpur, Malaysia"})]}),n.jsx(o,{style:Yt.intro,children:'These General Terms and Conditions ("Terms") apply to all services provided by Tell Productions Sdn Bhd ("the Company", "we", "us", "our") to any client ("the Client", "you", "your"). By engaging our services, you agree to be bound by these Terms.'}),n.jsxs(i,{style:Yt.columnsContainer,children:[n.jsxs(i,{style:Yt.column,children:[n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"1. DEFINITIONS"}),n.jsx(o,{style:Yt.text,children:'"Agreement" means the contract formed between the Company and the Client comprising any quotation, proposal, statement of work, and these Terms; "Deliverables" means any tangible outputs provided to the Client including but not limited to broadcast feeds, recordings, graphics, and technical documentation; "Equipment" means all technical equipment, hardware, software, and infrastructure provided or operated by the Company; "Event" means the sporting event, broadcast, live production, or other activity for which Services are provided; "Fees" means all charges payable by the Client for the Services as set out in any quotation or statement of work; "Footage" means all video, audio, graphics, and visual content captured, created, or produced by the Company; "Services" means the event delivery, technical services, broadcast services, streaming, graphics, presentation, and related services provided by the Company.'})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"2. SERVICES"}),n.jsx(o,{style:Yt.subsectionTitle,children:"2.1 Scope"}),n.jsx(o,{style:Yt.text,children:"The Company shall provide the Services as described in the relevant quotation or statement of work. Services may include event delivery, outside broadcast, live streaming, graphics operation, vision mixing, audio, presentation services, and technical crew provision. Any services not expressly included are excluded and require separate agreement."}),n.jsx(o,{style:Yt.subsectionTitle,children:"2.2 Professional Standards"}),n.jsx(o,{style:Yt.text,children:"The Company shall perform the Services with reasonable skill and care in accordance with generally accepted industry standards for professional broadcast and event technical services."}),n.jsx(o,{style:Yt.subsectionTitle,children:"2.3 Technical Standards"}),n.jsx(o,{style:Yt.text,children:"Unless otherwise specified, technical deliverables shall comply with: (a) EBU R128 loudness standards where applicable; (b) minimum HD resolution (19201080); and (c) industry-standard formats appropriate for the delivery method."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"3. CLIENT OBLIGATIONS"}),n.jsx(o,{style:Yt.text,children:"The Client shall: provide accurate and complete information regarding the Event and requirements; ensure appropriate venue access, power supply, internet connectivity, and working conditions for the Company's personnel and Equipment; obtain all necessary rights, licences, permits, and permissions for the Event; provide timely approvals and decisions as reasonably required; ensure safe working conditions and compliance with health and safety requirements; not interfere with or direct the Company's personnel or Equipment without prior agreement. If the Company's performance is delayed or prevented by any act or omission of the Client, the Company shall not be liable for any resulting delay, and the Client shall remain liable for all Fees."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"4. PAYMENT"}),n.jsx(o,{style:Yt.subsectionTitle,children:"4.1 Payment Schedule"}),n.jsx(o,{style:Yt.text,children:"Unless otherwise agreed in writing, Fees shall be payable as follows: 50% upon confirmation of booking (non-refundable deposit); 50% prior to the Event date or within fourteen (14) days of invoice, whichever is earlier."}),n.jsx(o,{style:Yt.subsectionTitle,children:"4.2 Payment Terms"}),n.jsx(o,{style:Yt.text,children:"All invoices are payable within thirty (30) days of the invoice date unless otherwise specified. All amounts are exclusive of applicable taxes, which shall be charged in addition where required by law."}),n.jsx(o,{style:Yt.subsectionTitle,children:"4.3 Late Payment"}),n.jsx(o,{style:Yt.text,children:"If any invoice is not paid when due, the Client shall pay interest on the overdue amount at the rate of 1.5% per month (18% per annum) from the due date until payment in full. The Company may suspend Services and withhold Deliverables until all overdue amounts have been paid."}),n.jsx(o,{style:Yt.subsectionTitle,children:"4.4 Additional Costs"}),n.jsx(o,{style:Yt.text,children:"Travel, accommodation, transport, equipment hire, and other expenses shall be charged in addition to the Fees unless expressly included in the quotation. Any additional services requested during the Event shall be charged at the Company's prevailing rates."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"5. INTELLECTUAL PROPERTY AND FOOTAGE"}),n.jsx(o,{style:Yt.subsectionTitle,children:"5.1 Ownership of Footage"}),n.jsx(o,{style:Yt.text,children:"All Footage created by the Company remains the exclusive property of the Company. The Company retains all copyright and intellectual property rights in all Footage unless expressly agreed otherwise in writing."}),n.jsx(o,{style:Yt.subsectionTitle,children:"5.2 Conditional Licence"}),n.jsx(o,{style:Yt.text,children:"Subject to full payment of all Fees, the Company grants the Client a non-exclusive licence to use the Deliverables for the purposes specified in the Agreement. This licence is conditional upon payment and shall be automatically revoked if payment is not received in full."}),n.jsx(o,{style:Yt.subsectionTitle,children:"5.3 Retention Until Payment"}),n.jsx(o,{style:Yt.text,children:"Until all Fees have been paid in full: the Company retains full ownership and copyright of all Footage and Deliverables; the Client has no right to use, distribute, broadcast, or exploit any Footage or Deliverables; the Company may withhold delivery of any Footage or Deliverables; and any unauthorised use shall constitute copyright infringement."}),n.jsx(o,{style:Yt.subsectionTitle,children:"5.4 Assignment of Rights"}),n.jsx(o,{style:Yt.text,children:"Transfer or assignment of copyright in Footage to the Client shall only occur if: (a) expressly agreed in writing; (b) specified in the statement of work or quotation; and (c) all Fees have been paid in full. Any such assignment shall be made pursuant to Section 27 of the Copyright Act 1987 (Malaysia)."}),n.jsx(o,{style:Yt.subsectionTitle,children:"5.5 Company's Rights"}),n.jsx(o,{style:Yt.text,children:"The Company reserves the right to use Footage for promotional purposes, portfolio display, award submissions, showreels, and case studies, provided such use does not disclose the Client's confidential information."}),n.jsx(o,{style:Yt.subsectionTitle,children:"5.6 Company Background IP"}),n.jsx(o,{style:Yt.text,children:"All pre-existing materials, templates, graphics libraries, software tools, and methodologies owned by the Company remain the Company's exclusive property and are licensed, not assigned, to the Client solely for use within the Deliverables."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"6. EQUIPMENT"}),n.jsx(o,{style:Yt.subsectionTitle,children:"6.1 Company Equipment"}),n.jsx(o,{style:Yt.text,children:"Equipment provided by the Company remains the Company's property at all times. The Client shall not move, adjust, or interfere with Equipment without the Company's consent. The Client shall be liable for any damage to or loss of Equipment caused by the Client, its employees, agents, or invitees, excluding fair wear and tear."}),n.jsx(o,{style:Yt.subsectionTitle,children:"6.2 Client Equipment"}),n.jsx(o,{style:Yt.text,children:"Any equipment supplied by the Client shall be at the Client's sole risk. The Company accepts no liability for damage to or loss of Client-supplied equipment except where caused by the Company's gross negligence or wilful misconduct."})]})]}),n.jsxs(i,{style:Yt.column,children:[n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"7. CANCELLATION AND POSTPONEMENT"}),n.jsx(o,{style:Yt.subsectionTitle,children:"7.1 Cancellation by Client"}),n.jsx(o,{style:Yt.text,children:"If the Client cancels the Agreement, the following cancellation fees apply based on notice prior to the Event date: More than 30 days' notice: 25% of total Fees plus costs incurred; 15 to 30 days' notice: 50% of total Fees plus costs incurred; 5 to 14 days' notice: 75% of total Fees plus costs incurred; Less than 5 days' notice: 100% of total Fees plus costs incurred."}),n.jsx(o,{style:Yt.subsectionTitle,children:"7.2 Postponement"}),n.jsx(o,{style:Yt.text,children:"If the Event is postponed, the Company shall use reasonable endeavours to accommodate the new date, subject to availability. The Client shall pay any additional costs for rebooking crew and equipment. If the rescheduled date is more than 60 days from the original date, the cancellation fees in Clause 7.1 shall apply."}),n.jsx(o,{style:Yt.subsectionTitle,children:"7.3 Cancellation by Company"}),n.jsx(o,{style:Yt.text,children:"The Company may cancel the Agreement with immediate effect if the Client fails to pay any amount due or breaches any material term. The Company shall not be liable for any loss resulting from such cancellation."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"8. FORCE MAJEURE"}),n.jsx(o,{style:Yt.text,children:"Neither Party shall be liable for any failure or delay in performance resulting from circumstances beyond its reasonable control, including: acts of God, natural disasters, pandemic, epidemic, war, terrorism, civil unrest, government action, strikes, failure of utilities or telecommunications, cancellation or postponement of the Event by organisers or governing bodies, extreme weather preventing safe working, travel restrictions, or visa denials affecting key personnel. If a force majeure event continues for more than 60 days, either Party may terminate the Agreement. Upon such termination, the Client shall pay for all Services performed and costs incurred to the date of termination."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"9. LIMITATION OF LIABILITY"}),n.jsx(o,{style:Yt.subsectionTitle,children:"9.1 Liability Cap"}),n.jsx(o,{style:Yt.text,children:"The Company's total liability under or in connection with this Agreement shall not exceed the total Fees paid or payable by the Client in the 12 months preceding the claim, or RM 500,000, whichever is greater."}),n.jsx(o,{style:Yt.subsectionTitle,children:"9.2 Exclusion of Consequential Loss"}),n.jsx(o,{style:Yt.text,children:"Neither Party shall be liable for any indirect, special, incidental, or consequential damages, including loss of profits, revenue, business opportunity, or data, whether or not foreseeable."}),n.jsx(o,{style:Yt.subsectionTitle,children:"9.3 Exceptions"}),n.jsx(o,{style:Yt.text,children:"Nothing in these Terms excludes or limits liability for: (a) fraud or wilful misconduct; (b) death or personal injury caused by negligence; or (c) any liability that cannot be limited under applicable law."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"10. CONFIDENTIALITY"}),n.jsx(o,{style:Yt.text,children:"Each Party shall keep confidential all confidential information of the other Party and shall not disclose such information except as necessary for the performance of the Agreement or as required by law. This obligation shall survive termination of the Agreement for a period of five (5) years."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"11. DATA PROTECTION"}),n.jsx(o,{style:Yt.text,children:"Each Party shall comply with its obligations under the Personal Data Protection Act 2010 (Malaysia) in connection with any personal data processed under this Agreement. Where personal data is transferred outside Malaysia, the transferring Party shall ensure compliance with applicable data protection requirements."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"12. INSURANCE"}),n.jsx(o,{style:Yt.text,children:"The Company maintains public liability insurance and equipment insurance appropriate for its operations. Certificates of insurance shall be provided upon request. The Client is responsible for maintaining its own insurance coverage for the Event, including event cancellation insurance where appropriate."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"13. INDEMNITY"}),n.jsx(o,{style:Yt.text,children:"The Client shall indemnify the Company against all losses, damages, costs, and liabilities arising from: (a) any breach of the Agreement by the Client; (b) any claim that Client-supplied materials infringe third-party rights; (c) any third-party claims arising from the Event; and (d) the Client's unauthorised use of Footage or Deliverables."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"14. TERMINATION"}),n.jsx(o,{style:Yt.text,children:"Either Party may terminate the Agreement with immediate effect if the other Party: (a) commits a material breach and fails to remedy it within 14 days of written notice; (b) becomes insolvent or bankrupt; or (c) ceases to carry on business. Upon termination, the Client shall pay for all Services performed and costs incurred, and all provisions relating to intellectual property, liability, and confidentiality shall survive."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"15. DISPUTE RESOLUTION"}),n.jsx(o,{style:Yt.text,children:"Any dispute arising from this Agreement shall first be referred to good faith negotiation between the Parties. If not resolved within 30 days, the dispute shall be finally determined by arbitration administered by the Asian International Arbitration Centre (AIAC) in Kuala Lumpur, Malaysia, in accordance with the AIAC Arbitration Rules. The arbitration shall be conducted in English by a single arbitrator."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"16. GOVERNING LAW"}),n.jsx(o,{style:Yt.text,children:"This Agreement shall be governed by and construed in accordance with the laws of Malaysia."})]}),n.jsxs(i,{style:Yt.section,children:[n.jsx(o,{style:Yt.sectionTitle,children:"17. GENERAL PROVISIONS"}),n.jsxs(o,{style:Yt.text,children:["17.1 Entire Agreement: These Terms, together with any quotation or statement of work, constitute the entire agreement between the Parties and supersede all prior agreements and understandings.","\n","17.2 Amendment: No amendment to these Terms shall be effective unless agreed in writing by both Parties.","\n","17.3 Assignment: The Client shall not assign or transfer any rights under this Agreement without the Company's prior written consent. The Company may subcontract its obligations with notice to the Client.","\n","17.4 Severability: If any provision of these Terms is held invalid or unenforceable, it shall be modified to the minimum extent necessary or severed, and the remaining provisions shall continue in full force.","\n","17.5 Waiver: No failure or delay in exercising any right shall operate as a waiver. A waiver shall only be effective if in writing.","\n","17.6 Notices: Notices shall be in writing and delivered by hand, registered post, or email to the addresses specified in the quotation or statement of work."]})]})]})]}),n.jsx(i,{style:Yt.footer,fixed:!0,children:n.jsxs(i,{style:Yt.footerContent,children:[n.jsxs(i,{style:Yt.footerLeft,children:[n.jsx(o,{style:Yt.footerLogo,children:"TELL"}),n.jsx(i,{style:Yt.footerDivider}),n.jsx(o,{style:Yt.footerText,children:t||"www.tell.so"})]}),n.jsxs(i,{style:Yt.footerRight,children:[n.jsx(o,{style:Yt.footerQuote,children:e}),n.jsx(o,{render:({pageNumber:e,totalPages:t})=>`Page ${e} of ${t}`,style:Yt.footerPageNum})]})]})})]})}function Xt(e,t=1){return`rgba(${parseInt(e.slice(1,3),16)}, ${parseInt(e.slice(3,5),16)}, ${parseInt(e.slice(5,7),16)}, ${t})`}function Zt({quote:e,currency:t,includeTerms:c=!1}){const u=He.getState().settings,{company:d,bankDetails:p,quoteDefaults:m,taxInfo:f,pdfOptions:h}=u,{client:g,project:y,sections:b,fees:x}=e,v=Mt(b,x||{}),w={primary:h?.primaryColor||"#143642",accent:h?.accentColor||"#0F8B8D",line:h?.lineColor||h?.primaryColor||"#143642",text:h?.textColor||"#374151",muted:h?.mutedColor||"#6B7280",background:h?.backgroundColor||"#FFFFFF"},k=Xt(w.line,.15),S=Xt(w.primary,.03),j=Xt(w.primary,.08),C=h?.baseFontSize||10,N=h?.fontFamily||"Helvetica",_=a.create({page:{backgroundColor:w.background,fontFamily:N,fontSize:C,color:w.text,paddingTop:30,paddingBottom:50,paddingHorizontal:35},headerBanner:{backgroundColor:w.primary,flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:14,paddingHorizontal:16,marginBottom:16,borderRadius:4},quotationTitle:{fontSize:14,fontFamily:`${N}-Bold`,color:"#FFFFFF",letterSpacing:2},headerDetails:{flexDirection:"row",alignItems:"center",gap:20},headerItem:{alignItems:"flex-end"},headerItemVenue:{alignItems:"flex-end",maxWidth:140},headerLabel:{fontSize:7,color:"#FFFFFF",opacity:.8,textTransform:"uppercase",marginBottom:2,textAlign:"right"},headerValue:{fontSize:9,fontFamily:`${N}-Bold`,color:"#FFFFFF",textAlign:"right"},twoColumn:{flexDirection:"row",marginBottom:16,gap:16},columnHalf:{flex:1,padding:12,backgroundColor:S,borderRadius:4},columnLabel:{fontSize:8,fontFamily:`${N}-Bold`,color:w.accent,textTransform:"uppercase",letterSpacing:.5,marginBottom:8},columnTitle:{fontSize:11,fontFamily:`${N}-Bold`,color:w.primary,marginBottom:4},columnText:{fontSize:9,color:w.text,lineHeight:1.5,marginBottom:1},descriptionRow:{flexDirection:"row",marginBottom:16,gap:16},descriptionBox:{flex:1,padding:12,borderWidth:1,borderTopColor:w.line,borderBottomColor:w.line,borderLeftColor:w.line,borderRightColor:w.line,borderRadius:4},descriptionLabel:{fontSize:8,fontFamily:`${N}-Bold`,color:w.primary,textTransform:"uppercase",marginBottom:6},descriptionText:{fontSize:9,color:w.text,lineHeight:1.5},sectionHeader:{backgroundColor:w.primary,paddingVertical:6,paddingHorizontal:10,marginTop:12,marginBottom:6,borderRadius:3},sectionHeaderText:{fontSize:9,fontFamily:`${N}-Bold`,color:"#FFFFFF",textTransform:"uppercase",letterSpacing:.5},tableHeader:{flexDirection:"row",backgroundColor:j,paddingVertical:5,paddingLeft:10,paddingRight:8,borderBottomWidth:1,borderBottomColor:w.line},tableHeaderCell:{fontSize:7,fontFamily:`${N}-Bold`,color:w.primary,textTransform:"uppercase"},tableRow:{flexDirection:"row",paddingVertical:4,paddingLeft:10,paddingRight:8,borderBottomWidth:.5,borderBottomColor:"#E5E7EB"},tableCell:{fontSize:8,color:w.text},tableCellRight:{fontSize:8,color:w.text,textAlign:"right"},colName:{width:"42%"},colQty:{width:"10%",textAlign:"center"},colDays:{width:"10%",textAlign:"center"},colRate:{width:"18%",textAlign:"right"},colTotal:{width:"20%",textAlign:"right"},subsectionHeader:{backgroundColor:k,paddingVertical:4,paddingHorizontal:8,marginTop:6,borderLeftWidth:2,borderLeftColor:w.line,borderTopWidth:0,borderBottomWidth:0,borderRightWidth:0},subsectionText:{fontSize:8,fontFamily:`${N}-Bold`,color:w.primary},bottomRow:{flexDirection:"row",marginTop:20,gap:12},termsColumn:{flex:1},termsBox:{padding:10,backgroundColor:S,borderRadius:4,marginBottom:8},termsLabel:{fontSize:8,fontFamily:`${N}-Bold`,color:w.primary,marginBottom:4},termsText:{fontSize:7,color:w.muted,lineHeight:1.5},totalsColumn:{width:180},totalsBox:{borderRadius:4,padding:12,borderWidth:1,borderTopColor:w.line,borderBottomColor:w.line,borderLeftColor:w.line,borderRightColor:w.line},totalsRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:3},totalsLabel:{fontSize:8,color:w.muted},totalsValue:{fontSize:8,color:w.text},totalsFinalRow:{flexDirection:"row",justifyContent:"space-between",borderTopWidth:1,borderTopColor:w.line,paddingTop:8,marginTop:8},totalsFinalLabel:{fontSize:11,fontFamily:`${N}-Bold`,color:w.primary},totalsFinalValue:{fontSize:12,fontFamily:`${N}-Bold`,color:w.primary},footer:{position:"absolute",bottom:18,left:35,right:35,borderTopWidth:.5,borderTopColor:"#E5E7EB",paddingTop:8,flexDirection:"row",justifyContent:"space-between"},footerText:{fontSize:7,color:w.muted},footerBold:{fontSize:7,fontFamily:`${N}-Bold`,color:w.primary},logo:{width:100,maxHeight:40,objectFit:"contain",marginBottom:6}}),E=e=>{if(!e)return"-";const t=new Date(e),n=t.getDate(),r=t.toLocaleDateString("en-GB",{month:"short"}),a=t.getFullYear();return`${n}${(e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}})(n)} ${r} ${a}`},L=new Date(e.createdAt||new Date),I=new Date(L);I.setDate(L.getDate()+(e.validityDays||m?.validityDays||30));const A=(e.sectionOrder||D).filter(e=>{const t=b?.[e];return!!t?.subsections&&Object.values(t.subsections).some(e=>e?.length>0)});return n.jsxs(s,{children:[n.jsxs(r,{size:"A4",style:_.page,children:[n.jsxs(i,{style:_.headerBanner,children:[n.jsx(o,{style:_.quotationTitle,children:"QUOTATION"}),n.jsxs(i,{style:_.headerDetails,children:[n.jsxs(i,{style:_.headerItem,children:[n.jsx(o,{style:_.headerLabel,children:"Quote No."}),n.jsx(o,{style:_.headerValue,children:e.quoteNumber})]}),n.jsxs(i,{style:_.headerItem,children:[n.jsx(o,{style:_.headerLabel,children:"Date"}),n.jsx(o,{style:_.headerValue,children:E(L)})]}),n.jsxs(i,{style:_.headerItem,children:[n.jsx(o,{style:_.headerLabel,children:"Valid Until"}),n.jsx(o,{style:_.headerValue,children:E(I)})]}),y?.venue&&n.jsxs(i,{style:_.headerItemVenue,children:[n.jsx(o,{style:_.headerLabel,children:"Venue"}),n.jsx(o,{style:_.headerValue,children:y.venue})]})]})]}),n.jsxs(i,{style:_.twoColumn,children:[n.jsxs(i,{style:_.columnHalf,children:[n.jsx(o,{style:_.columnLabel,children:"From"}),h?.showLogo&&d.logo&&n.jsx(l,{src:d.logo,style:_.logo}),n.jsx(o,{style:_.columnTitle,children:d.name}),h?.showCompanyAddress&&d.address&&n.jsx(o,{style:_.columnText,children:d.address}),d.city&&n.jsxs(o,{style:_.columnText,children:[d.city,", ",d.country]}),h?.showCompanyPhone&&d.phone&&n.jsx(o,{style:_.columnText,children:d.phone}),h?.showCompanyEmail&&d.email&&n.jsx(o,{style:_.columnText,children:d.email})]}),n.jsxs(i,{style:_.columnHalf,children:[n.jsx(o,{style:_.columnLabel,children:"To"}),n.jsx(o,{style:_.columnTitle,children:g?.company||"-"}),g?.contact&&n.jsx(o,{style:_.columnText,children:g.contact}),g?.email&&n.jsx(o,{style:_.columnText,children:g.email}),g?.phone&&n.jsx(o,{style:_.columnText,children:g.phone})]})]}),n.jsxs(i,{style:_.descriptionRow,children:[n.jsxs(i,{style:_.descriptionBox,children:[n.jsx(o,{style:_.descriptionLabel,children:"Project"}),n.jsx(o,{style:_.columnTitle,children:y?.title||"-"}),y?.type&&n.jsxs(o,{style:_.descriptionText,children:["Type: ",(e=>{if(!e)return null;const t=(u.projectTypes||[]).find(t=>t.id===e);return t?.label||e.replace(/_/g," ")})(y.type)]}),n.jsxs(o,{style:_.descriptionText,children:["Dates: ",(()=>{if(!y?.startDate)return"-";const e=E(y.startDate);return y?.endDate&&y.endDate!==y.startDate?`${e} - ${E(y.endDate)}`:e})()]}),y?.description&&n.jsx(o,{style:[_.descriptionText,{marginTop:4}],children:y.description})]}),n.jsxs(i,{style:_.descriptionBox,children:[n.jsx(o,{style:_.descriptionLabel,children:"Services Included"}),n.jsx(o,{style:_.descriptionText,children:A.map(t=>{const n=b[t];return e.sectionNames?.[t]||n.name||T[t]?.name}).join("  ")})]})]}),A.map(r=>{const a=b[r],s=e.sectionNames?.[r]||a.name||T[r]?.name;return n.jsxs(i,{wrap:!1,children:[n.jsx(i,{style:_.sectionHeader,children:n.jsx(o,{style:_.sectionHeaderText,children:s})}),n.jsxs(i,{style:_.tableHeader,children:[n.jsx(o,{style:[_.tableHeaderCell,_.colName],children:"Description"}),n.jsx(o,{style:[_.tableHeaderCell,_.colQty,{textAlign:"center"}],children:"Qty"}),n.jsx(o,{style:[_.tableHeaderCell,_.colDays,{textAlign:"center"}],children:"Days"}),n.jsx(o,{style:[_.tableHeaderCell,_.colRate,{textAlign:"right"}],children:"Rate"}),n.jsx(o,{style:[_.tableHeaderCell,_.colTotal,{textAlign:"right"}],children:"Total"})]}),Object.entries(a.subsections||{}).map(([e,r])=>{if(!r?.length)return null;const s=a.subsectionNames?.[e]||e;return n.jsxs(i,{children:[n.jsx(i,{style:_.subsectionHeader,children:n.jsx(o,{style:_.subsectionText,children:s})}),r.map((e,r)=>{const a=(e.charge||0)*(e.quantity||1)*(e.days||1);return n.jsxs(i,{style:_.tableRow,children:[n.jsx(o,{style:[_.tableCell,_.colName],children:e.name}),n.jsx(o,{style:[_.tableCell,_.colQty],children:e.quantity||1}),n.jsx(o,{style:[_.tableCell,_.colDays],children:e.days||1}),n.jsx(o,{style:[_.tableCellRight,_.colRate],children:U(e.charge||0,t)}),n.jsx(o,{style:[_.tableCellRight,_.colTotal],children:U(a,t)})]},e.id||r)})]},e)})]},r)}),n.jsxs(i,{style:_.bottomRow,children:[n.jsxs(i,{style:_.termsColumn,children:[m?.paymentTerms&&n.jsxs(i,{style:_.termsBox,children:[n.jsx(o,{style:_.termsLabel,children:"Payment Terms"}),n.jsx(o,{style:_.termsText,children:m.paymentTerms})]}),m?.termsAndConditions&&n.jsxs(i,{style:_.termsBox,children:[n.jsx(o,{style:_.termsLabel,children:"Terms & Conditions"}),n.jsx(o,{style:_.termsText,children:m.termsAndConditions})]}),h?.showBankDetails&&p?.bankName&&n.jsxs(i,{style:_.termsBox,children:[n.jsx(o,{style:_.termsLabel,children:"Bank Details"}),n.jsxs(o,{style:_.termsText,children:[p.bankName," | ",p.accountName," | ",p.accountNumber,p.swiftCode&&` | SWIFT: ${p.swiftCode}`]})]})]}),n.jsx(i,{style:_.totalsColumn,children:n.jsxs(i,{style:_.totalsBox,children:[(x?.managementFee>0||x?.commissionFee>0||x?.discount>0)&&n.jsxs(n.Fragment,{children:[n.jsxs(i,{style:_.totalsRow,children:[n.jsx(o,{style:_.totalsLabel,children:"Subtotal"}),n.jsx(o,{style:_.totalsValue,children:U(v.baseCharge,t)})]}),x?.managementFee>0&&n.jsxs(i,{style:_.totalsRow,children:[n.jsxs(o,{style:_.totalsLabel,children:["Management (",x.managementFee,"%)"]}),n.jsx(o,{style:_.totalsValue,children:U(v.managementAmount,t)})]}),x?.commissionFee>0&&n.jsxs(i,{style:_.totalsRow,children:[n.jsxs(o,{style:_.totalsLabel,children:["Commission (",x.commissionFee,"%)"]}),n.jsx(o,{style:_.totalsValue,children:U(v.commissionAmount,t)})]}),x?.discount>0&&n.jsxs(i,{style:_.totalsRow,children:[n.jsxs(o,{style:_.totalsLabel,children:["Discount (",x.discount,"%)"]}),n.jsxs(o,{style:_.totalsValue,children:["-",U(v.discountAmount,t)]})]})]}),n.jsxs(i,{style:_.totalsFinalRow,children:[n.jsx(o,{style:_.totalsFinalLabel,children:"TOTAL"}),n.jsx(o,{style:_.totalsFinalValue,children:U(v.totalCharge,t)})]})]})})]}),n.jsxs(i,{style:_.footer,fixed:!0,children:[n.jsxs(o,{style:_.footerText,children:[d.name," ",d.website&&`| ${d.website}`]}),n.jsx(o,{style:_.footerBold,children:e.quoteNumber})]})]}),c&&n.jsx(Jt,{quoteNumber:e.quoteNumber,companyWebsite:d?.website})]})}function en(){const{quote:e}=ft(),t=yt(),[r,a]=d.useState(!1),[i,o]=d.useState(!1),s=Mt(e.sections,e.fees),l=t=>U(t||0,e.currency),u=(s.totalCharge||0)-(s.totalCost||0),p=s.totalCharge>0?u/s.totalCharge*100:0;return n.jsxs("div",{className:"space-y-6 text-gray-100 p-2",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:async()=>{o(!0);try{const t=await c(n.jsx(Zt,{quote:e,currency:e.currency})).toBlob(),r=URL.createObjectURL(t);window.open(r,"_blank"),setTimeout(()=>URL.revokeObjectURL(r),5e3)}catch(r){t.error("Failed to generate preview")}finally{o(!1)}},disabled:i,className:"flex-1 btn-secondary py-3",children:i?n.jsxs("span",{className:"flex items-center justify-center gap-2",children:[n.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):n.jsxs("span",{className:"flex items-center justify-center gap-2",children:[n.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Preview"]})}),n.jsx("button",{onClick:async()=>{a(!0);try{const r=await c(n.jsx(Zt,{quote:e,currency:e.currency})).toBlob(),a=e.client?.company||"Client",i=e.project?.title||"Project",o=`${a} - ${i} - ${e.quoteDate||(new Date).toISOString().split("T")[0]} - Quote.pdf`,s=URL.createObjectURL(r),l=document.createElement("a");l.href=s,l.download=o,l.click(),URL.revokeObjectURL(s),t.success("PDF downloaded successfully")}catch(r){t.error("Failed to generate PDF")}finally{a(!1)}},disabled:r,className:"flex-1 btn-primary py-3 shadow-lg shadow-accent-primary/20",children:r?n.jsxs("span",{className:"flex items-center justify-center gap-2",children:[n.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):n.jsxs("span",{className:"flex items-center justify-center gap-2",children:[n.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download"]})})]}),n.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Customize PDF colors in Settings  Quote Templates"}),n.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl p-5 shadow-lg",children:[n.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4 border-b border-gray-700 pb-2",children:"Financial Summary"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Total Cost"}),n.jsx("p",{className:"text-lg font-mono text-gray-300",children:l(s.totalCost)})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Total Charge"}),n.jsx("p",{className:"text-xl font-bold font-mono text-white",children:l(s.totalCharge)})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Est. Profit"}),n.jsx("p",{className:"text-lg font-mono font-bold "+(u>=0?"text-emerald-400":"text-red-400"),children:l(u)})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Gross Margin"}),n.jsxs("p",{className:"text-lg font-mono font-bold "+(p>=30?"text-emerald-400":"text-amber-400"),children:[p.toFixed(1),"%"]})]})]}),n.jsxs("div",{className:"space-y-2 text-sm border-t border-gray-700 pt-4",children:[e.fees.managementFee>0&&n.jsxs("div",{className:"flex justify-between text-gray-400",children:[n.jsxs("span",{children:["Management Fee (",e.fees.managementFee,"%)"]}),n.jsx("span",{children:l(s.managementAmount)})]}),e.fees.commissionFee>0&&n.jsxs("div",{className:"flex justify-between text-gray-400",children:[n.jsxs("span",{children:["Commission (",e.fees.commissionFee,"%)"]}),n.jsx("span",{children:l(s.commissionAmount)})]}),e.fees.discount>0&&n.jsxs("div",{className:"flex justify-between text-red-400",children:[n.jsxs("span",{children:["Discount (",e.fees.discount,"%)"]}),n.jsxs("span",{children:["-",l(s.discountAmount)]})]})]})]}),n.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl p-4 shadow-lg",children:[n.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3 border-b border-gray-700 pb-2",children:"Section Breakdown"}),n.jsx("div",{className:"space-y-3",children:Object.values(e.sections).map(e=>{const t=Object.values(e.subsections).flat().reduce((e,t)=>e+t.cost*t.quantity*t.days,0),r=Object.values(e.subsections).flat().reduce((e,t)=>e+t.charge*t.quantity*t.days,0);return r>0||t>0?n.jsxs("div",{className:"flex items-center justify-between text-sm group",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:e.color}}),n.jsx("span",{className:"text-gray-300",children:e.name})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-gray-200",children:l(r)}),n.jsxs("p",{className:"text-[10px] text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity",children:["Margin: ",r>0?Math.round((r-t)/r*100):0,"%"]})]})]},e.id):null})})]})]})}function tn(){const{quote:e}=ft(),{settings:t}=He(),[r,a]=d.useState(!1),[i,o]=d.useState(!0),[s,l]=d.useState(!1),[c,u]=d.useState(null),{client:p,project:m,sections:f,fees:h}=e,g=Mt(f,h||{}),y=!!t.aiSettings?.anthropicKey,b=t.users?.find(t=>t.id===e.preparedBy),x=b?.name?.split(" ")[0]||"Team",v=p.contact?.split(" ")[0]||"there",w=m.startDate?m.endDate&&m.endDate!==m.startDate?`${m.startDate} to ${m.endDate}`:m.startDate:"TBC",k=()=>{const e=[];return Object.values(f||{}).forEach(t=>{if(t?.subsections){Object.values(t.subsections).some(e=>Array.isArray(e)&&e.length>0)&&t.name&&e.push(t.name.toLowerCase())}}),0===e.length?"all the kit and crew":1===e.length?e[0]:2===e.length?`${e[0]} and ${e[1]}`:`${e.slice(0,-1).join(", ")}, and ${e[e.length-1]}`},S=c||(()=>{const t=U(g.totalCharge,e.currency);return{subject:`Quote for ${m.title||"Project"}${"TBC"!==w?` | ${w}`:""}`,body:`Hi ${v},\n\nI've put together the quote for ${m.title||"the project"}${m.venue?` at ${m.venue}`:""}.\n\nAttached is our proposal covering ${k()}. Total comes to ${t}. Quote's valid for ${e.validityDays||30} days.\n\nHappy to jump on a call if you'd like to talk through any of it. Let me know if you have any questions.\n\nBest,\n${x}`}})(),{subject:j,body:C}=S;return n.jsxs("div",{className:"card mt-4",children:[n.jsxs("button",{onClick:()=>o(!i),className:"w-full flex items-center justify-between text-sm font-semibold text-gray-300 hover:text-white transition-colors",children:[n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx("svg",{className:"w-4 h-4 text-accent-primary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Quote Email"]}),n.jsx("svg",{className:"w-4 h-4 transition-transform "+(i?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&n.jsxs("div",{className:"mt-3 space-y-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("label",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Subject"}),n.jsx("button",{onClick:()=>(async e=>{await navigator.clipboard.writeText(e),a(!0),setTimeout(()=>a(!1),2e3)})(j),className:"text-[10px] text-gray-500 hover:text-accent-primary transition-colors",children:"Copy"})]}),n.jsx("div",{className:"bg-slate-800/50 rounded px-2 py-1.5 text-xs text-gray-300 font-mono",children:j})]}),n.jsxs("div",{children:[n.jsx("div",{className:"flex items-center justify-between mb-1",children:n.jsx("label",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Body"})}),n.jsx("div",{className:"bg-slate-800/50 rounded px-2 py-2 text-xs text-gray-300 whitespace-pre-wrap leading-relaxed max-h-48 overflow-y-auto",children:C})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:async()=>{if(y){l(!0);try{const n=U(g.totalCharge,e.currency),r=`Generate a client email to accompany a production services quote from Tell Productions Sdn Bhd.\n\n## Input Data\n\nCLIENT: ${p.company||"Client"}\nCONTACT: ${v}\nPROJECT: ${m.title||"Project"}\nTYPE: ${m.type||"Production"}\nVENUE: ${m.venue||"TBC"}\nDATES: ${w}\nQUOTE REFERENCE: ${e.quoteNumber}\nTOTAL: ${n}\nCURRENCY: ${e.currency}\nVALIDITY: ${e.validityDays||30} days\nSERVICES: ${k()}\nSENDER: ${x}\n\n## Writing Style\n\nWrite in Tom's voice: professional but casual, direct, efficient. Never stuffy.\n\nTone rules:\n- Use contractions naturally (I'm, we're, it's, we've)\n- Short paragraphs, 1-3 sentences each\n- No waffle or filler\n- Warm but not overly friendly\n- Confident without being pushy\n\n## Email Structure\n\nSubject line: Quote for [Project Title] | [Dates]\n\nBody:\n1. Opening (1 sentence) - Greeting and brief context\n2. The quote (2-3 sentences) - Reference attached quote, mention total and what it covers, note validity\n3. Next steps (1-2 sentences) - Clear call to action, offer to discuss\n4. Sign off: "Best, ${x}"\n\n## Rules\n\nAVOID:\n- Bullet points in the email\n- "Please find attached" (say "I've attached" or "Attached is")\n- "I hope this email finds you well"\n- "Don't hesitate to contact me" (say "Let me know if you have any questions")\n- Long paragraphs\n- Excessive thank-yous\n- Marketing language\n\n## Output Format\n\nReturn ONLY a JSON object:\n{"subject": "the email subject line", "body": "the email body"}\n\nKeep it under 120 words. No bullet points.`,a=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":t.aiSettings.anthropicKey,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:500,messages:[{role:"user",content:r}]})});if(!a.ok)throw new Error("API request failed");const i=await a.json(),o=(i.content[0]?.text||"").match(/\{[\s\S]*\}/);if(o){const e=JSON.parse(o[0]);u(e)}}catch(n){}finally{l(!1)}}},disabled:s||!y,title:y?"":"Add Anthropic API key in Settings",className:`flex-1 py-2 rounded text-xs font-medium transition-all flex items-center justify-center gap-2 ${y?"bg-purple-500/20 text-purple-400 border border-purple-500/30 hover:bg-purple-500/30":"bg-gray-700/50 text-gray-500 border border-gray-600/30 cursor-not-allowed"} disabled:opacity-50`,children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-3 h-3 border-2 border-purple-400 border-t-transparent rounded-full animate-spin"}),"Generating..."]}):n.jsxs(n.Fragment,{children:[n.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),c?"Regenerate":"Generate"]})}),n.jsx("button",{onClick:async()=>{const e=`Subject: ${j}\n\n${C}`;await navigator.clipboard.writeText(e),a(!0),setTimeout(()=>a(!1),2e3)},className:"flex-1 py-2 rounded text-xs font-medium transition-all flex items-center justify-center gap-2 "+(r?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-accent-primary/20 text-accent-primary border border-accent-primary/30 hover:bg-accent-primary/30"),children:r?n.jsxs(n.Fragment,{children:[n.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):n.jsxs(n.Fragment,{children:[n.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy"]})})]})]})]})}function nn(){return n.jsx("div",{className:"w-[320px] min-w-[320px] border-l border-dark-border bg-dark-bg overflow-y-auto h-[calc(100vh-60px)] sticky top-[60px]",children:n.jsxs("div",{className:"p-4",children:[n.jsx(en,{}),n.jsx(tn,{})]})})}function rn(){const{login:e,signup:t,error:r,clearError:a,isLoading:i,rateLimited:o,lockoutTimeRemaining:s,getRemainingAttempts:l,isSupabaseAuth:c}=it(),[u,p]=d.useState("login"),[m,f]=d.useState(""),[h,g]=d.useState(""),[y,b]=d.useState(""),[x,v]=d.useState(""),[w,k]=d.useState(!1),[S,j]=d.useState(0),C=c();d.useEffect(()=>{if(o&&s>0){j(s);const e=setInterval(()=>{j(t=>t<=1?(clearInterval(e),window.location.reload(),0):t-1)},1e3);return()=>clearInterval(e)}},[o,s]);const N=()=>{p("login"===u?"signup":"login"),k(!1),a()},_=!x||y===x,E=l(),L=E<=2&&E>0;return n.jsx("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center p-4",children:n.jsxs("div",{className:"w-full max-w-md",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("img",{src:"/tell-logo.svg",alt:"Tell Productions Logo",className:"h-10 mx-auto mb-4",role:"img"}),n.jsx("h1",{className:"text-xl font-bold text-white mb-2",children:"Internal Quote Tool"}),n.jsx("p",{className:"text-gray-500 text-sm",children:"login"===u?"Secure Access":"Request Access"})]}),n.jsxs("div",{className:"bg-dark-card border border-dark-border rounded-xl p-6 shadow-2xl",children:[w?n.jsxs("div",{className:"text-center py-4",children:[n.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx("svg",{className:"w-8 h-8 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),n.jsx("h2",{className:"text-lg font-semibold text-white mb-2",children:"Request Submitted"}),n.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Your access request has been submitted. An administrator will review and approve your account."}),n.jsx("p",{className:"text-gray-500 text-xs mb-6",children:"You will be able to sign in once your account is approved."}),n.jsx("button",{type:"button",onClick:()=>{k(!1),p("login"),f(""),g(""),b(""),v("")},className:"btn-primary px-6 py-2",children:"Back to Sign In"})]}):n.jsxs("form",{onSubmit:async n=>{if(n.preventDefault(),"signup"===u&&C){if(!(m&&h&&y&&x))return;if(y!==x)return;return void(await t(m,h,y)&&k(!0))}if(C){if(!h||!y)return;await e(h,y)}else{if(!y)return;await e(y)}},className:"space-y-5",noValidate:!0,children:[C&&"signup"===u&&n.jsxs("div",{children:[n.jsx("label",{htmlFor:"name",className:"label",children:"Full Name"}),n.jsx("input",{id:"name",name:"name",type:"text",value:m,onChange:e=>{f(e.target.value),r&&a()},placeholder:"Your full name",className:"input",autoFocus:!0,autoComplete:"name",disabled:o,required:!0})]}),C&&n.jsxs("div",{children:[n.jsx("label",{htmlFor:"email",className:"label",children:"Email Address"}),n.jsx("input",{id:"email",name:"email",type:"email",value:h,onChange:e=>{g(e.target.value),r&&a()},placeholder:"your.email@tellproductions.com",className:"input",autoFocus:"login"===u,autoComplete:"email",disabled:o,required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"label",children:C?"Password":"Access Password"}),n.jsx("input",{id:"password",name:"password",type:"password",value:y,onChange:e=>{b(e.target.value),r&&a()},placeholder:"signup"===u?"Create a password":C?"Enter your password":"Enter access password",className:C?"input":"input text-center text-lg tracking-widest",autoFocus:!C,autoComplete:"signup"===u?"new-password":"current-password",disabled:o,"aria-invalid":r?"true":"false","aria-describedby":r?"password-error":void 0,required:!0})]}),C&&"signup"===u&&n.jsxs("div",{children:[n.jsx("label",{htmlFor:"confirmPassword",className:"label",children:"Confirm Password"}),n.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:x,onChange:e=>{v(e.target.value),r&&a()},placeholder:"Confirm your password",className:"input "+(_?"":"border-red-500 focus:border-red-500 focus:ring-red-500/20"),autoComplete:"new-password",disabled:o,required:!0}),!_&&n.jsx("p",{className:"mt-1 text-xs text-red-400",children:"Passwords do not match"})]}),L&&!o&&n.jsxs("div",{className:"flex items-center gap-2 text-yellow-400 text-sm bg-yellow-500/10 border border-yellow-500/20 rounded-lg px-3 py-2",children:[n.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),n.jsxs("span",{children:[E," attempt",1!==E?"s":""," remaining"]})]}),o&&S>0&&n.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 border border-red-500/20 rounded-lg px-3 py-2",children:[n.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold",children:"Account temporarily locked"}),n.jsxs("div",{className:"text-xs",children:["Unlock in ",(T=S,`${Math.floor(T/60)}:${(T%60).toString().padStart(2,"0")}`)]})]})]}),r&&!o&&n.jsxs("div",{id:"password-error",role:"alert",className:"flex items-center gap-2 text-red-400 text-sm bg-red-500/10 border border-red-500/20 rounded-lg px-3 py-2",children:[n.jsx("svg",{className:"w-4 h-4 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),n.jsx("span",{children:r})]}),n.jsx("button",{type:"submit",disabled:i||o||("signup"===u?!(m&&h&&y&&x&&_):C&&!h||!y),className:"btn-primary w-full py-3 text-base disabled:opacity-50 disabled:cursor-not-allowed","aria-busy":i,children:i?n.jsxs("span",{className:"flex items-center justify-center gap-2",children:[n.jsxs("svg",{className:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n.jsx("span",{children:"signup"===u?"Submitting...":"Signing in..."}),n.jsx("span",{className:"sr-only",children:"Please wait"})]}):o?"Account Locked":"signup"===u?"Request Access":"Sign In"}),C&&n.jsx("div",{className:"flex items-center justify-between text-sm",children:"login"===u?n.jsxs(n.Fragment,{children:[n.jsx("button",{type:"button",onClick:()=>{alert("Password reset feature coming soon. Contact admin for assistance.")},className:"text-gray-500 hover:text-gray-400 transition-colors",children:"Forgot password?"}),n.jsx("button",{type:"button",onClick:N,className:"text-brand-teal hover:text-brand-teal-light transition-colors",children:"Request access"})]}):n.jsx("button",{type:"button",onClick:N,className:"text-brand-teal hover:text-brand-teal-light transition-colors w-full text-center",children:"Already have an account? Sign in"})})]}),!w&&n.jsx("div",{className:"mt-6 pt-6 border-t border-dark-border",children:n.jsxs("div",{className:"flex items-start gap-2 text-xs text-gray-500",children:[n.jsx("svg",{className:"w-4 h-4 mt-0.5 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-semibold text-gray-400 mb-1",children:"Security Features"}),n.jsxs("ul",{className:"space-y-0.5",children:[n.jsx("li",{children:" Session expires after 24 hours"}),n.jsx("li",{children:" 5 login attempts before lockout"}),n.jsx("li",{children:" 15-minute lockout period"}),C&&n.jsx("li",{children:" Encrypted authentication tokens"})]})]})]})})]}),n.jsx("p",{className:"text-center text-gray-600 text-xs mt-6",children:"Authorized personnel only  All activity is logged"})]})});var T}function an({size:e="md",text:t="Loading..."}){return n.jsxs("div",{className:"flex flex-col items-center justify-center p-8",role:"status","aria-live":"polite",children:[n.jsxs("svg",{className:`${{sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"}[e]} animate-spin text-accent-primary`,fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t&&n.jsx("p",{className:"mt-3 text-sm text-gray-400",children:t}),n.jsx("span",{className:"sr-only",children:t})]})}function on(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:r,onRegistered:a,onRegisteredSW:i,onRegisterError:o}=e,[s,l]=d.useState(!1),[c,u]=d.useState(!1),[p]=d.useState(()=>function(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:a,onRegisteredSW:i,onRegisterError:o}=e;let s,l,c;return l=async function(){if("serviceWorker"in navigator){if(s=await E(async()=>{const{Workbox:e}=await import("./workbox-window.prod.es5-CLYUWRvB.js");return{Workbox:e}},[]).then(({Workbox:e})=>new e("/sw.js",{scope:"/",type:"classic"})).catch(e=>{o?.(e)}),!s)return;c=()=>{s?.messageSkipWaiting()};{let e=!1;const t=()=>{e=!0,s?.addEventListener("controlling",e=>{e.isUpdate&&window.location.reload()}),n?.()};s.addEventListener("installed",n=>{void 0===n.isUpdate?void 0!==n.isExternal&&n.isExternal?t():!e&&r?.():n.isUpdate||r?.()}),s.addEventListener("waiting",t)}s.register({immediate:t}).then(e=>{i?i("/sw.js",e):a?.(e)}).catch(e=>{o?.(e)})}}(),async(e=!0)=>{await l,c?.()}}({immediate:t,onOfflineReady(){u(!0),r?.()},onNeedRefresh(){l(!0),n?.()},onRegistered:a,onRegisteredSW:i,onRegisterError:o}));return{needRefresh:[s,l],offlineReady:[c,u],updateServiceWorker:p}}const sn=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},ln=(...e)=>e.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim(),cn=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var un={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const dn=d.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:i,iconNode:o,...s},l)=>d.createElement("svg",{ref:l,...un,width:t,height:t,stroke:e,strokeWidth:r?24*Number(n)/Number(t):n,className:ln("lucide",a),...!i&&!cn(s)&&{"aria-hidden":"true"},...s},[...o.map(([e,t])=>d.createElement(e,t)),...Array.isArray(i)?i:[i]])),pn=(e,t)=>{const n=d.forwardRef(({className:n,...r},a)=>{return d.createElement(dn,{ref:a,iconNode:t,className:ln(`lucide-${i=sn(e),i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...r});var i});return n.displayName=sn(e),n},mn=pn("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),fn=pn("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),hn=pn("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),gn=pn("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),yn=pn("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function bn(){const[e,t]=d.useState(navigator.onLine),[r,a]=d.useState(!1),[i,o]=d.useState(!1),[s,l]=d.useState(null),{needRefresh:[c,u],updateServiceWorker:p}=on({onRegistered(e){},onRegisterError(e){}});d.useEffect(()=>{const e=()=>{t(!0),a(!1)},n=()=>{t(!1),a(!0)};return window.addEventListener("online",e),window.addEventListener("offline",n),navigator.onLine||a(!0),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}},[]),d.useEffect(()=>{const e=e=>{e.preventDefault(),l(e);const t=localStorage.getItem("pwa-install-dismissed");(!t||Date.now()-parseInt(t)>6048e5)&&o(!0)};return window.addEventListener("beforeinstallprompt",e),()=>{window.removeEventListener("beforeinstallprompt",e)}},[]);return n.jsxs(n.Fragment,{children:[r&&!e&&n.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-50 animate-slide-up",children:n.jsxs("div",{className:"bg-amber-500/90 backdrop-blur-sm text-white px-4 py-3 rounded-lg shadow-lg flex items-center gap-3",children:[n.jsx(hn,{className:"w-5 h-5 flex-shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-sm",children:"You're offline"}),n.jsx("p",{className:"text-xs text-amber-100",children:"Changes will sync when you reconnect"})]}),n.jsx("button",{onClick:()=>a(!1),className:"p-1 hover:bg-white/20 rounded",children:n.jsx(yn,{className:"w-4 h-4"})})]})}),e&&r&&n.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-50 animate-slide-up",children:n.jsxs("div",{className:"bg-emerald-500/90 backdrop-blur-sm text-white px-4 py-3 rounded-lg shadow-lg flex items-center gap-3",children:[n.jsx(gn,{className:"w-5 h-5 flex-shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-sm",children:"Back online"}),n.jsx("p",{className:"text-xs text-emerald-100",children:"Syncing your changes..."})]}),n.jsx("button",{onClick:()=>a(!1),className:"p-1 hover:bg-white/20 rounded",children:n.jsx(yn,{className:"w-4 h-4"})})]})}),c&&n.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-50 animate-slide-up",children:n.jsxs("div",{className:"bg-blue-500/90 backdrop-blur-sm text-white px-4 py-3 rounded-lg shadow-lg",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(fn,{className:"w-5 h-5 flex-shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-sm",children:"Update available"}),n.jsx("p",{className:"text-xs text-blue-100",children:"A new version is ready"})]})]}),n.jsxs("div",{className:"flex gap-2 mt-3",children:[n.jsx("button",{onClick:()=>p(!0),className:"flex-1 bg-white text-blue-600 px-3 py-1.5 rounded text-sm font-medium hover:bg-blue-50 transition-colors",children:"Update now"}),n.jsx("button",{onClick:()=>u(!1),className:"px-3 py-1.5 rounded text-sm hover:bg-white/20 transition-colors",children:"Later"})]})]})}),i&&s&&n.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-50 animate-slide-up",children:n.jsxs("div",{className:"bg-dark-card border border-dark-border text-white px-4 py-3 rounded-lg shadow-lg",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-brand-navy to-brand-teal rounded-lg flex items-center justify-center",children:n.jsx(mn,{className:"w-5 h-5"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-sm",children:"Install Tell Quote"}),n.jsx("p",{className:"text-xs text-gray-400",children:"Add to home screen for quick access"})]})]}),n.jsxs("div",{className:"flex gap-2 mt-3",children:[n.jsx("button",{onClick:async()=>{if(!s)return;s.prompt();const{outcome:e}=await s.userChoice;l(null),o(!1)},className:"flex-1 bg-brand-teal text-white px-3 py-1.5 rounded text-sm font-medium hover:bg-brand-teal/90 transition-colors",children:"Install"}),n.jsx("button",{onClick:()=>{localStorage.setItem("pwa-install-dismissed",Date.now().toString()),o(!1)},className:"px-3 py-1.5 rounded text-sm text-gray-400 hover:bg-dark-border transition-colors",children:"Not now"})]})]})}),!e&&n.jsxs("div",{className:"fixed top-0 left-0 right-0 z-40 bg-amber-500 text-white text-center py-1 text-xs font-medium",children:[n.jsx(hn,{className:"w-3 h-3 inline-block mr-1"}),"Offline Mode - Changes saved locally"]})]})}const xn=[{id:"all",label:"All Templates"},{id:"broadcast",label:"Broadcast"},{id:"streaming",label:"Streaming"},{id:"corporate",label:"Corporate Event"},{id:"sports",label:"Sports"},{id:"concert",label:"Concert/Live"},{id:"general",label:"General"}];function vn({isOpen:e,onClose:t,onSelectTemplate:r,onStartBlank:a}){const i=_t(e=>e.templates),o=_t(e=>e.deleteTemplate),[s,l]=d.useState("all"),[c,u]=d.useState(""),[p,m]=d.useState(null),f=d.useMemo(()=>{let e=i;if("all"!==s&&(e=e.filter(e=>e.category===s)),c.trim()){const t=c.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t))}return e.sort((e,t)=>t.usageCount!==e.usageCount?(t.usageCount||0)-(e.usageCount||0):new Date(t.createdAt)-new Date(e.createdAt))},[i,s,c]);if(!e)return null;return n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[n.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>t()}),n.jsxs("div",{className:"relative bg-dark-card border border-dark-border rounded-xl shadow-2xl w-full max-w-2xl max-h-[85vh] flex flex-col",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-dark-border",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-brand-teal to-brand-navy flex items-center justify-center",children:n.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-lg font-semibold text-white",children:"Choose a Template"}),n.jsxs("p",{className:"text-xs text-gray-400",children:[i.length," templates available"]})]})]}),n.jsx("button",{onClick:()=>t(),className:"p-2 hover:bg-white/5 rounded-lg transition-colors",children:n.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),n.jsxs("div",{className:"p-4 border-b border-dark-border space-y-3",children:[n.jsxs("div",{className:"relative",children:[n.jsx("svg",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),n.jsx("input",{type:"text",value:c,onChange:e=>u(e.target.value),placeholder:"Search templates...",className:"input pl-10"})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:xn.map(e=>n.jsx("button",{onClick:()=>l(e.id),className:"px-3 py-1.5 text-xs font-medium rounded-full transition-colors "+(s===e.id?"bg-brand-teal text-white":"bg-dark-bg text-gray-400 hover:bg-white/5 hover:text-white"),children:e.label},e.id))})]}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:0===f.length?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-800 flex items-center justify-center",children:n.jsx("svg",{className:"w-8 h-8 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),n.jsx("p",{className:"text-gray-400 mb-2",children:"No templates found"}),n.jsx("p",{className:"text-sm text-gray-500",children:0===i.length?"Create your first template by saving a quote":"Try adjusting your search or category filter"})]}):n.jsx("div",{className:"grid gap-3",children:f.map(e=>{return n.jsxs("div",{className:"group relative bg-dark-bg border border-dark-border rounded-lg p-4 hover:border-brand-teal/50 transition-all cursor-pointer",onClick:()=>r(e),children:[n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:"font-medium text-white truncate",children:e.name}),e.usageCount>0&&n.jsxs("span",{className:"px-1.5 py-0.5 text-[10px] bg-brand-teal/20 text-brand-teal rounded",children:["Used ",e.usageCount,"x"]})]}),e.description&&n.jsx("p",{className:"text-sm text-gray-400 line-clamp-1 mb-2",children:e.description}),n.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),(t=e.sections,t?Object.values(t).reduce((e,t)=>e+Object.values(t.subsections||{}).reduce((e,t)=>e+(t.items?.length||0),0),0):0)," items"]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.region," / ",e.currency]}),n.jsx("span",{className:"px-2 py-0.5 bg-gray-800 rounded text-gray-400 capitalize",children:e.category})]})]}),n.jsx("button",{onClick:t=>{t.stopPropagation(),m(e.id)},className:"opacity-0 group-hover:opacity-100 p-2 hover:bg-red-500/10 text-gray-500 hover:text-red-400 rounded-lg transition-all",title:"Delete template",children:n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),p===e.id&&n.jsxs("div",{className:"absolute inset-0 bg-dark-bg/95 rounded-lg flex items-center justify-center gap-3 p-4",children:[n.jsx("span",{className:"text-sm text-gray-300",children:"Delete this template?"}),n.jsx("button",{onClick:t=>{t.stopPropagation(),(async e=>{await o(e),m(null)})(e.id)},className:"px-3 py-1.5 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600",children:"Delete"}),n.jsx("button",{onClick:e=>{e.stopPropagation(),m(null)},className:"px-3 py-1.5 bg-gray-700 text-white text-sm rounded-lg hover:bg-gray-600",children:"Cancel"})]})]},e.id);var t})})}),n.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-dark-border bg-dark-bg/50",children:[n.jsxs("button",{onClick:a,className:"btn btn-ghost",children:[n.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Start Blank"]}),n.jsx("button",{onClick:()=>t(),className:"btn btn-ghost",children:"Cancel"})]})]})]})}const wn={SEA:["Malaysia","Singapore","Indonesia","Thailand","Vietnam","Philippines","Myanmar","Cambodia","Laos","Brunei"],Gulf:["Saudi Arabia","UAE","Qatar","Kuwait","Bahrain","Oman"],Levant:["Jordan","Lebanon","Syria","Palestine","Iraq"],"Central Asia":["Kazakhstan","Uzbekistan","Turkmenistan","Tajikistan","Kyrgyzstan"],Afghanistan:["Afghanistan"]},kn=[...wn.SEA,...wn.Gulf,...wn.Levant,...wn["Central Asia"],...wn.Afghanistan],Sn=e=>wn.SEA.includes(e)?"SEA":wn.Gulf.includes(e)?"Gulf":wn.Levant.includes(e)?"Levant":wn["Central Asia"].includes(e)?"Central Asia":wn.Afghanistan.includes(e)?"Afghanistan":"Other";function jn(e){return{id:e.id,title:e.title,clientId:e.client_id,client:e.client||{},region:e.region,country:e.country,status:e.status||"active",value:e.value,currency:e.currency||"USD",probability:e.probability||50,source:e.source||"",competitors:e.competitors||[],contacts:e.contacts||[],accountOwnerId:e.account_owner_id||null,brief:e.brief||"",notes:e.notes||"",nextAction:e.next_action||"",nextActionDate:e.next_action_date,expectedCloseDate:e.expected_close_date,convertedToQuoteId:e.converted_to_quote_id,createdAt:e.created_at,updatedAt:e.updated_at}}const Cn=u(L((e,t)=>({opportunities:[],loading:!1,error:null,realtimeSubscription:null,initialize:async()=>{if(V()){e({loading:!0,error:null});try{const{data:n,error:r}=await Q.from("opportunities").select("*").order("created_at",{ascending:!1});if(r)throw r;const a=(n||[]).map(jn);e({opportunities:a,loading:!1,error:null}),t().subscribeToRealtime()}catch(n){e({loading:!1,error:n.message})}}else e({loading:!1,error:"Supabase not configured"})},subscribeToRealtime:()=>{if(!V())return;const n=t().realtimeSubscription;n&&Q.removeChannel(n);const r=Q.channel("opportunities-realtime").on("postgres_changes",{event:"*",schema:"public",table:"opportunities"},t=>{const{eventType:n,new:r,old:a}=t;e(e=>{let t=[...e.opportunities];if("INSERT"===n){t.find(e=>e.id===r.id)||(t=[jn(r),...t])}else"UPDATE"===n?t=t.map(e=>e.id===r.id?jn(r):e):"DELETE"===n&&(t=t.filter(e=>e.id!==a.id));return{opportunities:t}})}).subscribe();e({realtimeSubscription:r})},unsubscribe:()=>{const n=t().realtimeSubscription;n&&(Q.removeChannel(n),e({realtimeSubscription:null}))},addOpportunity:async t=>{if(!V())return e({error:"Supabase not configured"}),null;try{const r={title:t.title||"",clientId:t.clientId||null,client:t.client||{},region:t.region||Sn(t.country),country:t.country||"",status:t.status||"active",value:t.value||0,currency:t.currency||"USD",probability:t.probability||50,source:t.source||"",competitors:t.competitors||[],contacts:t.contacts||[],accountOwnerId:t.accountOwnerId||null,brief:t.brief||"",notes:t.notes||"",nextAction:t.nextAction||"",nextActionDate:t.nextActionDate||null,expectedCloseDate:t.expectedCloseDate||null,convertedToQuoteId:null},{data:a,error:i}=await Q.from("opportunities").insert((n=r,{title:n.title,client_id:n.clientId||null,client:n.client||{},region:n.region,country:n.country,status:n.status,value:n.value,currency:n.currency,probability:n.probability,source:n.source,competitors:n.competitors,contacts:n.contacts,account_owner_id:n.accountOwnerId,brief:n.brief,notes:n.notes,next_action:n.nextAction,next_action_date:n.nextActionDate||null,expected_close_date:n.expectedCloseDate||null,converted_to_quote_id:n.convertedToQuoteId||null})).select().single();if(i)throw i;const o=jn(a);return e(e=>({opportunities:[o,...e.opportunities.filter(e=>e.id!==o.id)],error:null})),o}catch(r){return e({error:r.message}),null}var n},updateOpportunity:async(t,n)=>{if(V()){n.country&&!n.region&&(n.region=Sn(n.country));try{const r={};if(void 0!==n.title&&(r.title=n.title),void 0!==n.clientId&&(r.client_id=n.clientId),void 0!==n.client&&(r.client=n.client),void 0!==n.region&&(r.region=n.region),void 0!==n.country&&(r.country=n.country),void 0!==n.status&&(r.status=n.status),void 0!==n.value&&(r.value=n.value),void 0!==n.currency&&(r.currency=n.currency),void 0!==n.probability&&(r.probability=n.probability),void 0!==n.source&&(r.source=n.source),void 0!==n.competitors&&(r.competitors=n.competitors),void 0!==n.contacts&&(r.contacts=n.contacts),void 0!==n.accountOwnerId&&(r.account_owner_id=n.accountOwnerId),void 0!==n.brief&&(r.brief=n.brief),void 0!==n.notes&&(r.notes=n.notes),void 0!==n.nextAction&&(r.next_action=n.nextAction),void 0!==n.nextActionDate&&(r.next_action_date=n.nextActionDate),void 0!==n.expectedCloseDate&&(r.expected_close_date=n.expectedCloseDate),void 0!==n.convertedToQuoteId&&(r.converted_to_quote_id=n.convertedToQuoteId),Object.keys(r).length>0){const{error:a}=await Q.from("opportunities").update(r).eq("id",t);if(a)throw a;e(e=>({opportunities:e.opportunities.map(e=>e.id===t?{...e,...n,updatedAt:(new Date).toISOString()}:e),error:null}))}}catch(r){e({error:r.message})}}else e({error:"Supabase not configured"})},deleteOpportunity:async t=>{if(V())try{const{error:n}=await Q.from("opportunities").delete().eq("id",t);if(n)throw n;e(e=>({opportunities:e.opportunities.filter(e=>e.id!==t),error:null}))}catch(n){e({error:n.message})}else e({error:"Supabase not configured"})},getOpportunity:e=>t().opportunities.find(t=>t.id===e),getClientOpportunities:e=>t().opportunities.filter(t=>t.clientId===e),getOpportunitiesByCountry:e=>t().opportunities.filter(t=>t.country===e),getOpportunitiesByRegion:e=>t().opportunities.filter(t=>t.region===e),getOpportunitiesGroupedByCountry:()=>{const{opportunities:e}=t(),n={};return kn.forEach(e=>{n[e]=[]}),n.Other=[],e.forEach(e=>{const t=e.country||"Other";n[t]?n[t].push(e):n.Other.push(e)}),n},updateStatus:async(e,n)=>{await t().updateOpportunity(e,{status:n})},addContact:async(e,n)=>{const r=t().getOpportunity(e);if(!r)return;const a={id:crypto.randomUUID(),name:n.name||"",role:n.role||"",email:n.email||"",phone:n.phone||"",isPrimary:n.isPrimary||!1};let i=[...r.contacts||[]];a.isPrimary&&(i=i.map(e=>({...e,isPrimary:!1}))),i.push(a),await t().updateOpportunity(e,{contacts:i})},updateContact:async(e,n,r)=>{const a=t().getOpportunity(e);if(!a)return;let i=[...a.contacts||[]];r.isPrimary&&(i=i.map(e=>({...e,isPrimary:!1}))),i=i.map(e=>e.id===n?{...e,...r}:e),await t().updateOpportunity(e,{contacts:i})},deleteContact:async(e,n)=>{const r=t().getOpportunity(e);if(!r)return;const a=(r.contacts||[]).filter(e=>e.id!==n);await t().updateOpportunity(e,{contacts:a})},getPipelineStats:()=>{const{opportunities:e}=t(),n=e.filter(e=>"active"===e.status),r=n.reduce((e,t)=>e+(t.value||0),0),a=n.reduce((e,t)=>{const n=(t.probability||0)/100;return e+(t.value||0)*n},0),i={};n.forEach(e=>{const t=e.country||"Other";i[t]||(i[t]={count:0,value:0}),i[t].count++,i[t].value+=e.value||0});const o={};return n.forEach(e=>{const t=e.region||"Other";o[t]||(o[t]={count:0,value:0}),o[t].count++,o[t].value+=e.value||0}),{totalCount:n.length,totalValue:r,weightedValue:a,byCountry:i,byRegion:o,wonCount:e.filter(e=>"won"===e.status).length,lostCount:e.filter(e=>"lost"===e.status).length}},getUpcomingActions:()=>{const{opportunities:e}=t(),n=new Date,r=new Date(n.getTime()+6048e5);return e.filter(e=>{if("active"!==e.status||!e.nextActionDate)return!1;const t=new Date(e.nextActionDate);return t>=n&&t<=r}).sort((e,t)=>new Date(e.nextActionDate)-new Date(t.nextActionDate))},clearError:()=>{e({error:null})}}))),Nn="tell_deal_context",_n="tell_task_patterns",En={new_opportunity:[{id:"research_client",title:"Research client background",description:"Review their website, recent news, and social media presence",priority:"high"},{id:"identify_stakeholders",title:"Identify key stakeholders",description:"Find decision makers and influencers in the organization",priority:"high"},{id:"schedule_discovery",title:"Schedule discovery call",description:"Book initial meeting to understand requirements",priority:"high"}],discovery:[{id:"send_intro_email",title:"Send introduction email",description:"Brief company intro with relevant case studies",priority:"high"},{id:"prepare_questions",title:"Prepare discovery questions",description:"List questions about budget, timeline, requirements",priority:"medium"},{id:"check_competitors",title:"Research competitors bidding",description:"Identify who else might be pitching",priority:"medium"}],proposal:[{id:"draft_proposal",title:"Draft initial proposal",description:"Create proposal based on client requirements",priority:"high"},{id:"review_pricing",title:"Review pricing strategy",description:"Ensure competitive pricing with healthy margins",priority:"high"},{id:"internal_review",title:"Get internal review",description:"Have team review proposal before sending",priority:"medium"}],follow_up:[{id:"follow_up_call",title:"Follow-up call",description:"Check in on proposal status and address questions",priority:"high"},{id:"send_reminder",title:"Send gentle reminder",description:"Follow up on pending proposal",priority:"medium"},{id:"add_value",title:"Share relevant content",description:"Send case study or article relevant to their needs",priority:"low"}],negotiation:[{id:"prepare_alternatives",title:"Prepare alternative options",description:"Have backup pricing/scope options ready",priority:"high"},{id:"clarify_objections",title:"Address objections",description:"Document and respond to client concerns",priority:"high"},{id:"final_meeting",title:"Schedule decision meeting",description:"Book meeting to finalize terms",priority:"medium"}],at_risk:[{id:"executive_outreach",title:"Executive-level outreach",description:"Escalate to senior contact if available",priority:"high"},{id:"requalify",title:"Re-qualify opportunity",description:"Confirm deal is still viable and budget available",priority:"high"},{id:"offer_meeting",title:"Offer in-person meeting",description:"Suggest face-to-face to rebuild momentum",priority:"medium"}],closing:[{id:"confirm_timeline",title:"Confirm decision timeline",description:"Verify when client will make final decision",priority:"high"},{id:"remove_blockers",title:"Identify remaining blockers",description:"Ask what is needed to move forward",priority:"high"},{id:"prep_contract",title:"Prepare contract/agreement",description:"Have paperwork ready for quick close",priority:"medium"}]};function Ln(){try{const e=localStorage.getItem(Nn);return e?JSON.parse(e):{}}catch(e){return{}}}function Tn(e){try{localStorage.setItem(Nn,JSON.stringify(e))}catch(t){}}function Dn(){try{const e=localStorage.getItem(_n);return e?JSON.parse(e):{completedTasks:[],skippedTasks:[],effectiveness:{}}}catch(e){return{completedTasks:[],skippedTasks:[],effectiveness:{}}}}function In(e){try{localStorage.setItem(_n,JSON.stringify(e))}catch(t){}}const An=u(L((e,t)=>({contexts:Ln(),taskPatterns:Dn(),loading:!1,getContext:n=>{const r=t().contexts;if(!r[n]){const t={opportunityId:n,suggestedTasks:[],completedTasks:[],skippedTasks:[],milestones:[],lastInteraction:null,notes:[],createdAt:(new Date).toISOString()};return e({contexts:{...r,[n]:t}}),Tn({...r,[n]:t}),t}return r[n]},updateContext:(n,r)=>{const a=t().contexts,i={...a[n]||{opportunityId:n,createdAt:(new Date).toISOString()},...r,updatedAt:(new Date).toISOString()},o={...a,[n]:i};e({contexts:o}),Tn(o),t().syncContextToSupabase(n,i)},addSuggestedTask:(e,n)=>{const r=[...t().getContext(e).suggestedTasks,{...n,suggestedAt:(new Date).toISOString(),status:"pending"}];t().updateContext(e,{suggestedTasks:r})},completeTask:(e,n,r="completed")=>{const a=t().getContext(e),i=a.suggestedTasks.find(e=>e.id===n);if(i){const o=a.suggestedTasks.filter(e=>e.id!==n),s=[...a.completedTasks,{...i,completedAt:(new Date).toISOString(),outcome:r}];t().updateContext(e,{suggestedTasks:o,completedTasks:s}),t().trackTaskPattern(i.id,"completed",e)}},skipTask:(e,n,r="")=>{const a=t().getContext(e),i=a.suggestedTasks.find(e=>e.id===n);if(i){const o=a.suggestedTasks.filter(e=>e.id!==n),s=[...a.skippedTasks,{...i,skippedAt:(new Date).toISOString(),reason:r}];t().updateContext(e,{suggestedTasks:o,skippedTasks:s}),t().trackTaskPattern(i.id,"skipped",e)}},addMilestone:(e,n)=>{const r=[...t().getContext(e).milestones,{...n,timestamp:(new Date).toISOString()}];t().updateContext(e,{milestones:r,lastInteraction:(new Date).toISOString()})},trackTaskPattern:(n,r,a)=>{const i=t().taskPatterns,o=`${n}_${r}`,s={...i.effectiveness,[o]:(i.effectiveness[o]||0)+1},l={...i,effectiveness:s,["completed"===r?"completedTasks":"skippedTasks"]:[...i["completed"===r?"completedTasks":"skippedTasks"],{taskTemplateId:n,opportunityId:a,timestamp:(new Date).toISOString()}].slice(-100)};e({taskPatterns:l}),In(l),t().syncPatternsToSupabase(l)},getTaskEffectiveness:e=>{const n=t().taskPatterns,r=n.effectiveness[`${e}_completed`]||0,a=r+(n.effectiveness[`${e}_skipped`]||0);return 0===a?.5:r/a},getSmartTasks:(e,n=[],r=[])=>{if(!e)return[];const a=t().getContext(e.id),i=new Date,o=(()=>{if("won"===e.status||"lost"===e.status)return null;const t=r.filter(t=>t.opportunityId===e.id||t.client?.company===e.client?.company),a=t.some(e=>"sent"===e.status),o=t.some(e=>"draft"===e.status),s=new Date(e.createdAt||e.created_at),l=Math.floor((i-s)/864e5),c=n.filter(t=>t.opportunityId===e.id||t.clientId===e.clientId).sort((e,t)=>new Date(t.activityDate)-new Date(e.activityDate))[0],u=c?Math.floor((i-new Date(c.activityDate))/864e5):l,d=e.nextActionDate?new Date(e.nextActionDate):null,p=d&&d<i,m=e.expectedCloseDate?new Date(e.expectedCloseDate):null,f=m?Math.floor((m-i)/864e5):null;return p||u>14?"at_risk":null!==f&&f<=7&&f>=0?"closing":a?u>3?"follow_up":"negotiation":o?"proposal":l<=3&&!c?"new_opportunity":"discovery"})();if(!o)return[];const s=En[o]||[],l=new Set(a.suggestedTasks.filter(e=>{const t=new Date(e.suggestedAt);return Math.floor((i-t)/864e5)<7}).map(e=>e.id)),c=new Set(a.completedTasks.filter(e=>{const t=new Date(e.completedAt);return Math.floor((i-t)/864e5)<30}).map(e=>e.id));return s.filter(e=>!l.has(e.id)&&!c.has(e.id)).map(e=>{const n=t().getTaskEffectiveness(e.id)*("high"===e.priority?3:"medium"===e.priority?2:1);return{...e,score:n,stage:o}}).sort((e,t)=>t.score-e.score).slice(0,3)},clearContext:n=>{const r=t().contexts,{[n]:a,...i}=r;e({contexts:i}),Tn(i)},syncContextToSupabase:async(e,t)=>{if(V())try{const{error:n}=await Q.from("deal_contexts").upsert({opportunity_id:e,suggested_tasks:t.suggestedTasks||[],completed_tasks:t.completedTasks||[],skipped_tasks:t.skippedTasks||[],milestones:t.milestones||[],notes:t.notes||[],last_interaction:t.lastInteraction,updated_at:(new Date).toISOString()},{onConflict:"opportunity_id"})}catch(n){}},syncPatternsToSupabase:async e=>{if(V())try{const{data:t}=await Q.from("task_patterns").select("id").limit(1).single();t&&await Q.from("task_patterns").update({completed_tasks:e.completedTasks||[],skipped_tasks:e.skippedTasks||[],effectiveness:e.effectiveness||{},updated_at:(new Date).toISOString()}).eq("id",t.id)}catch(t){}},initialize:async()=>{if(e({loading:!0}),V())try{const{data:t,error:n}=await Q.from("deal_contexts").select("*");if(!n&&t){const n={};t.forEach(e=>{n[e.opportunity_id]={opportunityId:e.opportunity_id,suggestedTasks:e.suggested_tasks||[],completedTasks:e.completed_tasks||[],skippedTasks:e.skipped_tasks||[],milestones:e.milestones||[],notes:e.notes||[],lastInteraction:e.last_interaction,createdAt:e.created_at,updatedAt:e.updated_at}}),e({contexts:n}),Tn(n)}const{data:r,error:a}=await Q.from("task_patterns").select("*").limit(1).single();if(!a&&r){const t={completedTasks:r.completed_tasks||[],skippedTasks:r.skipped_tasks||[],effectiveness:r.effectiveness||{}};e({taskPatterns:t}),In(t)}}catch(t){}e({loading:!1})}})));An.subscribe(e=>e.contexts,e=>Tn(e));const Pn={MARKET_INSIGHT:"market_insight",PRICING_STRATEGY:"pricing_strategy",CLIENT_PREFERENCE:"client_preference",COMPETITOR_INTEL:"competitor_intel",PROCESS_TIP:"process_tip",REGIONAL_PATTERN:"regional_pattern"},On={RESEARCH:"research",STRATEGY:"strategy",LEADGEN:"leadgen",FINANCE:"finance"};function qn(e){return{id:e.id,type:e.fragment_type,title:e.title,content:e.content,source:e.source,confidence:e.confidence,appliedToAgents:e.applied_to_agents||[],verified:e.verified,needsReview:e.needs_review,createdAt:e.created_at,updatedAt:e.updated_at,lastUsedAt:e.last_used_at,tags:e.tags||[],impactScore:e.impact_score,usageCount:e.usage_count,region:e.region,dealType:e.deal_type,expiresAt:e.expires_at}}function zn(e){return{id:e.id,agentName:e.agent_name,learningType:e.learning_type,context:e.context,outcome:e.outcome,lesson:e.lesson,confidenceScore:e.confidence_score,usageCount:e.usage_count,impactScore:e.impact_score,createdAt:e.created_at,verified:e.verified,quoteId:e.quote_id,opportunityId:e.opportunity_id}}const Rn=u(L((e,t)=>({fragments:[],learnings:[],agentPrompts:{},loading:!1,error:null,initialize:async()=>{if(V()){e({loading:!0,error:null});try{const{data:t,error:n}=await Q.from("knowledge_fragments").select("*").order("created_at",{ascending:!1}),{data:r,error:a}=await Q.from("agent_learnings").select("*").order("created_at",{ascending:!1}),{data:i,error:o}=await Q.from("agent_prompts").select("*").eq("active",!0),s=(t||[]).map(qn),l=(r||[]).map(zn),c={};(i||[]).forEach(e=>{c[e.agent_name]={version:e.prompt_version,basePrompt:e.base_prompt,learnedContext:e.learned_context,performanceScore:e.performance_score}}),e({fragments:s,learnings:l,agentPrompts:c,loading:!1,error:null})}catch(t){e({loading:!1,error:t.message})}}else e({loading:!1,error:"Supabase not configured"})},addFragment:async t=>{if(!V())return e({error:"Supabase not configured"}),null;try{const n={type:t.type,title:t.title||"",content:t.content,source:t.source||"human_input",confidence:t.confidence||.7,appliedToAgents:t.appliedToAgents||Object.values(On),verified:t.verified||!1,needsReview:!1,tags:t.tags||[],region:t.region||null,dealType:t.dealType||null},{data:r,error:a}=await Q.from("knowledge_fragments").insert(function(e){return{fragment_type:e.type,title:e.title,content:e.content,source:e.source||"human_input",confidence:e.confidence||.5,applied_to_agents:e.appliedToAgents||[],verified:e.verified||!1,needs_review:e.needsReview||!1,tags:e.tags||[],impact_score:e.impactScore||0,usage_count:e.usageCount||0,region:e.region||null,deal_type:e.dealType||null,expires_at:e.expiresAt||null}}(n)).select().single();if(a)throw a;const i=qn(r);return e(e=>({fragments:[i,...e.fragments],error:null})),i}catch(n){return e({error:n.message}),null}},updateFragment:async(t,n)=>{if(V())try{const r={};void 0!==n.type&&(r.fragment_type=n.type),void 0!==n.title&&(r.title=n.title),void 0!==n.content&&(r.content=n.content),void 0!==n.confidence&&(r.confidence=n.confidence),void 0!==n.verified&&(r.verified=n.verified),void 0!==n.needsReview&&(r.needs_review=n.needsReview),void 0!==n.tags&&(r.tags=n.tags),void 0!==n.appliedToAgents&&(r.applied_to_agents=n.appliedToAgents),void 0!==n.region&&(r.region=n.region),void 0!==n.dealType&&(r.deal_type=n.dealType),r.updated_at=(new Date).toISOString();const{error:a}=await Q.from("knowledge_fragments").update(r).eq("id",t);if(a)throw a;e(e=>({fragments:e.fragments.map(e=>e.id===t?{...e,...n,updatedAt:r.updated_at}:e),error:null}))}catch(r){e({error:r.message})}else e({error:"Supabase not configured"})},verifyFragment:async e=>{await t().updateFragment(e,{verified:!0,needsReview:!1})},rejectFragment:async t=>{if(V())try{const{error:n}=await Q.from("knowledge_fragments").delete().eq("id",t);if(n)throw n;e(e=>({fragments:e.fragments.filter(e=>e.id!==t),error:null}))}catch(n){e({error:n.message})}},deleteFragment:async e=>{await t().rejectFragment(e)},addLearning:async t=>{if(!V())return e({error:"Supabase not configured"}),null;try{const{data:n,error:r}=await Q.from("agent_learnings").insert({agent_name:t.agentName,learning_type:t.learningType,context:t.context,outcome:t.outcome,lesson:t.lesson,confidence_score:t.confidenceScore||.5,verified:!1,quote_id:t.quoteId||null,opportunity_id:t.opportunityId||null}).select().single();if(r)throw r;const a=zn(n);return e(e=>({learnings:[a,...e.learnings],error:null})),a}catch(n){return e({error:n.message}),null}},verifyLearning:async t=>{if(V())try{const{error:n}=await Q.from("agent_learnings").update({verified:!0}).eq("id",t);if(n)throw n;e(e=>({learnings:e.learnings.map(e=>e.id===t?{...e,verified:!0}:e),error:null}))}catch(n){e({error:n.message})}},getRelevantKnowledge:(e={})=>{const{fragments:n}=t(),{region:r,dealType:a,tags:i=[],agentName:o}=e;return n.filter(e=>{if(!e.verified)return!1;if(o&&e.appliedToAgents.length>0&&!e.appliedToAgents.includes(o))return!1;if(r&&e.region&&e.region!==r)return!1;if(a&&e.dealType&&e.dealType!==a)return!1;if(i.length>0&&e.tags.length>0){if(!i.some(t=>e.tags.includes(t)))return!1}return!0}).sort((e,t)=>t.impactScore!==e.impactScore?t.impactScore-e.impactScore:t.confidence-e.confidence).slice(0,20)},getRelevantLearnings:(e={})=>{const{learnings:n}=t(),{region:r,dealType:a,agentName:i}=e;return n.filter(e=>{if(!e.verified||e.confidenceScore<.5)return!1;if(i&&e.agentName!==i)return!1;if(e.context){if(r&&e.context.country&&e.context.country!==r&&e.context.region!==r)return!1;if(a&&e.context.deal_type&&e.context.deal_type!==a)return!1}return!0}).sort((e,t)=>t.confidenceScore-e.confidenceScore).slice(0,10)},getPendingReview:()=>{const{fragments:e,learnings:n}=t(),r=e.filter(e=>!e.verified||e.needsReview),a=n.filter(e=>!e.verified);return{fragments:r,learnings:a,totalCount:r.length+a.length}},getStats:()=>{const{fragments:e,learnings:n}=t(),r=e.filter(e=>e.verified),a={},i={};return e.forEach(e=>{a[e.type]=(a[e.type]||0)+1,e.region&&(i[e.region]=(i[e.region]||0)+1)}),{totalFragments:e.length,verifiedFragments:r.length,pendingVerification:e.length-r.length,totalLearnings:n.length,verifiedLearnings:n.filter(e=>e.verified).length,byType:a,byRegion:i,avgConfidence:r.length>0?r.reduce((e,t)=>e+t.confidence,0)/r.length:0}},buildAgentPrompt:async(e,n={})=>{const{agentPrompts:r}=t(),a=r[e]?.basePrompt||"",i=t().getRelevantKnowledge({...n,agentName:e}),o=t().getRelevantLearnings({...n,agentName:e});let s=a;return i.length>0&&(s+="\n\nACCUMULATED KNOWLEDGE (verified by human):\n",s+=i.map(e=>`- ${e.content} [confidence: ${(100*e.confidence).toFixed(0)}%]`).join("\n")),o.length>0&&(s+="\n\nLEARNINGS FROM PAST DEALS:\n",s+=o.map(e=>`- ${e.lesson} [from: ${e.learningType}, confidence: ${(100*e.confidenceScore).toFixed(0)}%]`).join("\n")),n.currentTask&&(s+=`\n\nCURRENT TASK:\n${n.currentTask}`),s},clearError:()=>{e({error:null})}}))),Mn="available",Fn="on_job",Un="maintenance",Bn="sold",$n="retired",Qn="lost",Vn={[Mn]:{label:"Available",color:"text-green-400",bg:"bg-green-500/20"},[Fn]:{label:"On Job",color:"text-blue-400",bg:"bg-blue-500/20"},[Un]:{label:"Maintenance",color:"text-amber-400",bg:"bg-amber-500/20"},[Bn]:{label:"Sold",color:"text-gray-400",bg:"bg-gray-500/20"},[$n]:{label:"Retired",color:"text-gray-500",bg:"bg-gray-600/20"},[Qn]:{label:"Lost",color:"text-red-400",bg:"bg-red-500/20"}},Wn="excellent",Hn="good",Gn="fair",Kn="poor",Yn={[Wn]:{label:"Excellent",color:"text-green-400"},[Hn]:{label:"Good",color:"text-blue-400"},[Gn]:{label:"Fair",color:"text-amber-400"},[Kn]:{label:"Poor",color:"text-red-400"}},Jn=[{id:"camera",name:"Camera",color:"#3B82F6",icon:"video",prefix:"CAM"},{id:"lens",name:"Lens",color:"#8B5CF6",icon:"aperture",prefix:"LENS"},{id:"tripod",name:"Tripod",color:"#10B981",icon:"maximize",prefix:"TRI"},{id:"audio",name:"Audio",color:"#F59E0B",icon:"mic",prefix:"AUD"},{id:"comms",name:"Comms",color:"#EF4444",icon:"headphones",prefix:"COM"},{id:"graphics",name:"Graphics",color:"#EC4899",icon:"monitor",prefix:"GFX"},{id:"switching",name:"Switching",color:"#6366F1",icon:"grid",prefix:"SWT"},{id:"streaming",name:"Streaming",color:"#14B8A6",icon:"wifi",prefix:"STR"},{id:"cabling",name:"Cabling",color:"#6B7280",icon:"cable",prefix:"CBL"},{id:"power",name:"Power",color:"#84CC16",icon:"battery",prefix:"PWR"},{id:"lighting",name:"Lighting",color:"#FBBF24",icon:"sun",prefix:"LGT"},{id:"monitors",name:"Monitors",color:"#0EA5E9",icon:"tv",prefix:"MON"},{id:"storage",name:"Storage",color:"#78716C",icon:"package",prefix:"STG"},{id:"rigging",name:"Rigging",color:"#A3A3A3",icon:"tool",prefix:"RIG"},{id:"network",name:"Network",color:"#22D3EE",icon:"network",prefix:"NET"},{id:"other",name:"Other",color:"#9CA3AF",icon:"more-horizontal",prefix:"OTH"}],Xn=["KL Office","Kuwait Office","Bangkok Storage","On Location"];function Zn(e){return{id:e.id,kitId:e.kit_id,name:e.name,categoryId:e.category_id,categoryName:e.category_name,categoryColor:e.category_color,manufacturer:e.manufacturer,model:e.model,serialNumber:e.serial_number,purchaseDate:e.purchase_date,purchasePrice:e.purchase_price,purchaseCurrency:e.purchase_currency||"USD",currentValue:e.current_value,calculatedValue:e.calculated_value,depreciationRate:e.depreciation_rate,rateCardItemId:e.rate_card_item_id,dayRate:e.day_rate,weekRate:e.week_rate,monthRate:e.month_rate,rateCurrency:e.rate_currency||"USD",location:e.location,status:e.status||"available",condition:e.condition||"good",parentKitId:e.parent_kit_id,parentKitCode:e.parent_kit_code,parentName:e.parent_name,isPackage:e.is_package,childCount:e.child_count||0,quantity:e.quantity||1,quantityAvailable:e.quantity_available||e.quantity||1,specs:e.specs||{},technicalTags:e.technical_tags||[],operationalTags:e.operational_tags||[],jobTypeTags:e.job_type_tags||[],lastUsedDate:e.last_used_date,totalDaysUsed:e.total_days_used||0,totalRevenue:e.total_revenue||0,expectedLifespanMonths:e.expected_lifespan_months,ageMonths:e.age_months,daysSinceLastUse:e.days_since_last_use,replacementDueDate:e.replacement_due_date,insured:e.insured,insuranceValue:e.insurance_value,insurancePolicyRef:e.insurance_policy_ref,notes:e.notes,imageUrl:e.image_url,imagePath:e.image_path,manualUrl:e.manual_url,qrCode:e.qr_code,createdAt:e.created_at,updatedAt:e.updated_at}}function er(e){const t={};return void 0!==e.kitId&&(t.kit_id=e.kitId),void 0!==e.name&&(t.name=e.name),void 0!==e.categoryId&&(t.category_id=e.categoryId),void 0!==e.manufacturer&&(t.manufacturer=e.manufacturer),void 0!==e.model&&(t.model=e.model),void 0!==e.serialNumber&&(t.serial_number=e.serialNumber),void 0!==e.purchaseDate&&(t.purchase_date=e.purchaseDate),void 0!==e.purchasePrice&&(t.purchase_price=e.purchasePrice),void 0!==e.purchaseCurrency&&(t.purchase_currency=e.purchaseCurrency),void 0!==e.currentValue&&(t.current_value=e.currentValue),void 0!==e.depreciationRate&&(t.depreciation_rate=e.depreciationRate),void 0!==e.rateCardItemId&&(t.rate_card_item_id=e.rateCardItemId),void 0!==e.dayRate&&(t.day_rate=e.dayRate),void 0!==e.weekRate&&(t.week_rate=e.weekRate),void 0!==e.monthRate&&(t.month_rate=e.monthRate),void 0!==e.rateCurrency&&(t.rate_currency=e.rateCurrency),void 0!==e.location&&(t.location=e.location),void 0!==e.status&&(t.status=e.status),void 0!==e.condition&&(t.condition=e.condition),void 0!==e.parentKitId&&(t.parent_kit_id=e.parentKitId),void 0!==e.isPackage&&(t.is_package=e.isPackage),void 0!==e.quantity&&(t.quantity=e.quantity),void 0!==e.quantityAvailable&&(t.quantity_available=e.quantityAvailable),void 0!==e.specs&&(t.specs=e.specs),void 0!==e.technicalTags&&(t.technical_tags=e.technicalTags),void 0!==e.operationalTags&&(t.operational_tags=e.operationalTags),void 0!==e.jobTypeTags&&(t.job_type_tags=e.jobTypeTags),void 0!==e.lastUsedDate&&(t.last_used_date=e.lastUsedDate),void 0!==e.expectedLifespanMonths&&(t.expected_lifespan_months=e.expectedLifespanMonths),void 0!==e.insured&&(t.insured=e.insured),void 0!==e.insuranceValue&&(t.insurance_value=e.insuranceValue),void 0!==e.insurancePolicyRef&&(t.insurance_policy_ref=e.insurancePolicyRef),void 0!==e.notes&&(t.notes=e.notes),void 0!==e.imageUrl&&(t.image_url=e.imageUrl),void 0!==e.imagePath&&(t.image_path=e.imagePath),void 0!==e.manualUrl&&(t.manual_url=e.manualUrl),t}const tr=u(L((e,t)=>({items:[],categories:Jn,locations:Xn,bookings:[],loading:!1,error:null,filters:{search:"",category:null,status:null,location:null,parentOnly:!1},initialize:async()=>{if(V()){e({loading:!0,error:null});try{const{data:t,error:n}=await Q.from("kit_categories").select("*").order("sort_order");if(!n&&t&&t.length>0){const n=t.map(e=>({id:e.id,name:e.name,description:e.description,color:e.color,icon:e.icon,prefix:e.name.substring(0,3).toUpperCase()}));e({categories:n})}const{data:r,error:a}=await Q.from("kit_locations").select("name").order("name");!a&&r&&e({locations:r.map(e=>e.name)});const{data:i,error:o}=await Q.from("kit_items_extended").select("*").order("kit_id");if(o){const{data:t,error:n}=await Q.from("kit_items").select("*").order("kit_id");if(n)throw n;const r=(t||[]).map(Zn);e({items:r,loading:!1,error:null})}else{const t=(i||[]).map(Zn);e({items:t,loading:!1,error:null})}}catch(t){e({loading:!1,error:t.message})}}else e({loading:!1,error:"Supabase not configured"})},addItem:async t=>{if(!V())return e({error:"Supabase not configured"}),null;try{const n=er(t),{data:r,error:a}=await Q.from("kit_items").insert(n).select().single();if(a)throw a;const i=Zn(r);return e(e=>({items:[...e.items,i],error:null})),i}catch(n){return e({error:n.message}),null}},updateItem:async(t,n)=>{if(V())try{const r=er(n),{error:a}=await Q.from("kit_items").update(r).eq("id",t);if(a)throw a;e(e=>({items:e.items.map(e=>e.id===t?{...e,...n}:e),error:null}))}catch(r){e({error:r.message})}else e({error:"Supabase not configured"})},deleteItem:async t=>{if(V())try{const{error:n}=await Q.from("kit_items").delete().eq("id",t);if(n)throw n;e(e=>({items:e.items.filter(e=>e.id!==t),error:null}))}catch(n){e({error:n.message})}else e({error:"Supabase not configured"})},generateKitId:async e=>{const{items:n,categories:r}=t(),a=r.find(t=>t.name===e||t.id===e),i=a?.prefix||e.substring(0,3).toUpperCase(),o=n.filter(e=>e.kitId&&e.kitId.startsWith(i+"-")).map(e=>{const t=e.kitId.match(new RegExp(`${i}-(\\d+)`));return t?parseInt(t[1],10):0}),s=o.length>0?Math.max(...o)+1:1;return`${i}-${String(s).padStart(3,"0")}`},getChildren:e=>{const{items:n}=t();return n.filter(t=>t.parentKitId===e)},getPackages:()=>{const{items:e}=t();return e.filter(e=>e.isPackage||e.childCount>0)},getAvailable:()=>{const{items:e}=t();return e.filter(e=>e.status===Mn)},getByCategory:e=>{const{items:n}=t();return n.filter(t=>t.categoryId===e)},getByLocation:e=>{const{items:n}=t();return n.filter(t=>t.location===e)},getFilteredItems:()=>{const{items:e,filters:n}=t();let r=[...e];if(n.search){const e=n.search.toLowerCase();r=r.filter(t=>t.kitId?.toLowerCase().includes(e)||t.name?.toLowerCase().includes(e)||t.manufacturer?.toLowerCase().includes(e)||t.model?.toLowerCase().includes(e)||t.serialNumber?.toLowerCase().includes(e))}return n.category&&(r=r.filter(e=>e.categoryId===n.category||e.categoryName===n.category)),n.status&&(r=r.filter(e=>e.status===n.status)),n.location&&(r=r.filter(e=>e.location===n.location)),n.parentOnly&&(r=r.filter(e=>!e.parentKitId)),r},setFilters:t=>{e(e=>({filters:{...e.filters,...t}}))},clearFilters:()=>{e({filters:{search:"",category:null,status:null,location:null,parentOnly:!1}})},getStats:()=>{const{items:e}=t(),n=e.reduce((e,t)=>e+(t.currentValue||t.purchasePrice||0),0),r=e.reduce((e,t)=>e+(t.totalRevenue||0),0),a={},i={},o={};e.forEach(e=>{a[e.status]=(a[e.status]||0)+1,e.categoryName&&(i[e.categoryName]=(i[e.categoryName]||0)+1),e.location&&(o[e.location]=(o[e.location]||0)+1)});const s=e.filter(e=>"poor"===e.condition).length,l=e.filter(e=>e.daysSinceLastUse&&e.daysSinceLastUse>180).length;return{totalItems:e.length,totalValue:n,totalRevenue:r,byStatus:a,byCategory:i,byLocation:o,needsMaintenance:s,deadStock:l,availableCount:a[Mn]||0,onJobCount:a[Fn]||0}},clearError:()=>{e({error:null})},uploadImage:async(n,r)=>{if(!V())return e({error:"Supabase not configured"}),null;try{const{items:e}=t(),a=e.find(e=>e.id===n),i=a?.kitId||n,o=await async function(e,t){if(!Q)throw new Error("Supabase not configured");try{const n=e.name.split(".").pop(),r=`${t}-${Date.now()}.${n}`,{data:a,error:i}=await Q.storage.from(W).upload(r,e,{cacheControl:"3600",upsert:!1});if(i)throw i;const{data:{publicUrl:o}}=Q.storage.from(W).getPublicUrl(r);return{url:o,path:a.path}}catch(n){throw n}}(r,i);return o&&await t().updateItem(n,{imageUrl:o.url,imagePath:o.path}),o}catch(a){return e({error:a.message}),null}},removeImage:async n=>{if(V())try{const{items:e}=t(),r=e.find(e=>e.id===n);r?.imagePath&&await async function(e){if(Q&&e)try{const{error:t}=await Q.storage.from(W).remove([e]);if(t)throw t}catch(t){throw t}}(r.imagePath),await t().updateItem(n,{imageUrl:null,imagePath:null})}catch(r){e({error:r.message})}else e({error:"Supabase not configured"})},exportToCSV:(e={})=>{const{items:n,categories:r}=t(),{includeFinancial:a=!0,includeRates:i=!0}=e,o=["Kit ID","Name","Category","Manufacturer","Model","Serial Number","Status","Condition","Location","Quantity","Available"];a&&o.push("Purchase Date","Purchase Price","Currency","Current Value"),i&&o.push("Day Rate","Week Rate","Month Rate","Rate Currency"),o.push("Notes","Tags");let s=o.join(",")+"\n";n.forEach(e=>{const t=r.find(t=>t.id===e.categoryId),n=[...e.technicalTags||[],...e.operationalTags||[],...e.jobTypeTags||[]].join("; "),o=[e.kitId||"",`"${(e.name||"").replace(/"/g,'""')}"`,t?.name||e.categoryName||"",`"${(e.manufacturer||"").replace(/"/g,'""')}"`,`"${(e.model||"").replace(/"/g,'""')}"`,e.serialNumber||"",e.status||"available",e.condition||"good",e.location||"",e.quantity||1,e.quantityAvailable||e.quantity||1];a&&o.push(e.purchaseDate||"",e.purchasePrice||"",e.purchaseCurrency||"USD",e.currentValue||e.calculatedValue||""),i&&o.push(e.dayRate||"",e.weekRate||"",e.monthRate||"",e.rateCurrency||"USD"),o.push(`"${(e.notes||"").replace(/"/g,'""')}"`,`"${n}"`),s+=o.join(",")+"\n"});const l=new Blob([s],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c,u.download=`kit-list-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c)},exportPublicList:()=>{const{items:e,categories:n}=t();let r=["Code","Equipment","Category","Manufacturer","Model","Status","Availability","Day Rate","Week Rate"].join(",")+"\n";e.filter(e=>"available"===e.status||"on_job"===e.status).forEach(e=>{const t=n.find(t=>t.id===e.categoryId),a=[e.kitId||"",`"${(e.name||"").replace(/"/g,'""')}"`,t?.name||e.categoryName||"",e.manufacturer||"",e.model||"","available"===e.status?"Available":"In Use",e.quantityAvailable||0,e.dayRate?`$${e.dayRate}`:"POA",e.weekRate?`$${e.weekRate}`:"POA"];r+=a.join(",")+"\n"});const a=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=`tell-equipment-list-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)}}))),nr={OPERATIONS:"Operations",GRAPHICS:"Graphics",EQUIPMENT:"Equipment",COMMERCIAL:"Commercial"},rr={[nr.OPERATIONS]:{color:"bg-blue-500/10 text-blue-400 border-blue-500/30",icon:"",description:"Production workflows and operational procedures"},[nr.GRAPHICS]:{color:"bg-purple-500/10 text-purple-400 border-purple-500/30",icon:"",description:"Graphics, branding, and visual asset guidelines"},[nr.EQUIPMENT]:{color:"bg-green-500/10 text-green-400 border-green-500/30",icon:"",description:"Equipment handling, maintenance, and setup"},[nr.COMMERCIAL]:{color:"bg-orange-500/10 text-orange-400 border-orange-500/30",icon:"",description:"Sales, billing, and client management"}},ar=[{id:"ops-1",title:"Pre-Production Checklist",category:nr.OPERATIONS,description:"Complete checklist before any shoot day",checklist:[{id:"ops-1-1",text:"Confirm call times with all crew members",completed:!1},{id:"ops-1-2",text:"Review location access and parking details",completed:!1},{id:"ops-1-3",text:"Confirm catering and craft services",completed:!1},{id:"ops-1-4",text:"Verify transport arrangements",completed:!1},{id:"ops-1-5",text:"Check weather forecast and contingency plans",completed:!1},{id:"ops-1-6",text:"Distribute call sheets to all stakeholders",completed:!1},{id:"ops-1-7",text:"Confirm equipment delivery/pickup times",completed:!1},{id:"ops-1-8",text:"Brief production assistants on duties",completed:!1}],tags:["production","shoot","prep"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"ops-2",title:"Live Broadcast Setup",category:nr.OPERATIONS,description:"Setup checklist for live broadcast productions",checklist:[{id:"ops-2-1",text:"Test all communication channels (comms/IFB)",completed:!1},{id:"ops-2-2",text:"Verify uplink/streaming connection",completed:!1},{id:"ops-2-3",text:"Run full technical rehearsal",completed:!1},{id:"ops-2-4",text:"Test backup systems and failover",completed:!1},{id:"ops-2-5",text:"Confirm graphics and lower thirds",completed:!1},{id:"ops-2-6",text:"Brief talent on rundown and timings",completed:!1},{id:"ops-2-7",text:"Verify recording backup is running",completed:!1}],tags:["broadcast","live","technical"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"ops-3",title:"Post-Production Wrap",category:nr.OPERATIONS,description:"End of production day checklist",checklist:[{id:"ops-3-1",text:"Backup all media to multiple locations",completed:!1},{id:"ops-3-2",text:"Complete equipment return inventory",completed:!1},{id:"ops-3-3",text:"Submit crew timesheets and expenses",completed:!1},{id:"ops-3-4",text:"Send wrap report to production team",completed:!1},{id:"ops-3-5",text:"Update production schedule if needed",completed:!1},{id:"ops-3-6",text:"Clear and secure location",completed:!1}],tags:["wrap","post","admin"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"gfx-1",title:"Brand Package Delivery",category:nr.GRAPHICS,description:"Delivering graphics package to client",checklist:[{id:"gfx-1-1",text:"Export all graphics in required formats (PNG, MOV, etc.)",completed:!1},{id:"gfx-1-2",text:"Include all color profiles and specifications",completed:!1},{id:"gfx-1-3",text:"Provide font files with licensing information",completed:!1},{id:"gfx-1-4",text:"Create usage guidelines document",completed:!1},{id:"gfx-1-5",text:"Organize files in clear folder structure",completed:!1},{id:"gfx-1-6",text:"Generate preview/thumbnail images",completed:!1},{id:"gfx-1-7",text:"Send delivery confirmation to client",completed:!1}],tags:["graphics","branding","delivery"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"gfx-2",title:"Lower Thirds & Bug Setup",category:nr.GRAPHICS,description:"Preparing on-air graphics elements",checklist:[{id:"gfx-2-1",text:"Verify correct sponsor logos and placements",completed:!1},{id:"gfx-2-2",text:"Check all name spellings and titles",completed:!1},{id:"gfx-2-3",text:"Test graphics in broadcast system",completed:!1},{id:"gfx-2-4",text:"Verify safe zone compliance",completed:!1},{id:"gfx-2-5",text:"Prepare backup graphics package",completed:!1},{id:"gfx-2-6",text:"Brief graphics operator on triggers",completed:!1}],tags:["broadcast","graphics","on-air"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"gfx-3",title:"Social Media Asset Creation",category:nr.GRAPHICS,description:"Creating graphics for social platforms",checklist:[{id:"gfx-3-1",text:"Create assets in all required dimensions",completed:!1},{id:"gfx-3-2",text:"Optimize file sizes for web delivery",completed:!1},{id:"gfx-3-3",text:"Include alt text descriptions",completed:!1},{id:"gfx-3-4",text:"Verify brand color accuracy across displays",completed:!1},{id:"gfx-3-5",text:"Export animated versions if required",completed:!1},{id:"gfx-3-6",text:"Get client approval before publishing",completed:!1}],tags:["social","digital","content"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"eq-1",title:"Camera Prep & Check",category:nr.EQUIPMENT,description:"Pre-shoot camera preparation",checklist:[{id:"eq-1-1",text:"Clean sensor and lens elements",completed:!1},{id:"eq-1-2",text:"Format all media cards",completed:!1},{id:"eq-1-3",text:"Charge all batteries (min 4x per camera)",completed:!1},{id:"eq-1-4",text:"Update firmware if required",completed:!1},{id:"eq-1-5",text:"Set correct frame rate and codec",completed:!1},{id:"eq-1-6",text:"Calibrate white balance/color profiles",completed:!1},{id:"eq-1-7",text:"Test all lenses for focus accuracy",completed:!1},{id:"eq-1-8",text:"Pack backup camera body",completed:!1}],tags:["camera","prep","technical"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"eq-2",title:"Audio Kit Preparation",category:nr.EQUIPMENT,description:"Audio equipment checklist before shoot",checklist:[{id:"eq-2-1",text:"Test all wireless frequencies",completed:!1},{id:"eq-2-2",text:"Check and charge all transmitter batteries",completed:!1},{id:"eq-2-3",text:"Pack spare lavalier capsules",completed:!1},{id:"eq-2-4",text:"Test all XLR cables for faults",completed:!1},{id:"eq-2-5",text:"Verify mixer/recorder settings",completed:!1},{id:"eq-2-6",text:"Include windshields and dead cats",completed:!1},{id:"eq-2-7",text:"Pack headphones for monitoring",completed:!1}],tags:["audio","sound","technical"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"eq-3",title:"Equipment Return & Inventory",category:nr.EQUIPMENT,description:"Post-shoot equipment return process",checklist:[{id:"eq-3-1",text:"Inventory all returned items against packing list",completed:!1},{id:"eq-3-2",text:"Document any damage or issues",completed:!1},{id:"eq-3-3",text:"Clean all equipment before storage",completed:!1},{id:"eq-3-4",text:"Recharge all batteries for next use",completed:!1},{id:"eq-3-5",text:"Update equipment availability in system",completed:!1},{id:"eq-3-6",text:"Log maintenance needs for repairs",completed:!1},{id:"eq-3-7",text:"Store in designated locations",completed:!1}],tags:["inventory","return","maintenance"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"com-1",title:"New Client Onboarding",category:nr.COMMERCIAL,description:"Steps for onboarding new clients",checklist:[{id:"com-1-1",text:"Schedule discovery/kickoff meeting",completed:!1},{id:"com-1-2",text:"Collect company details and billing info",completed:!1},{id:"com-1-3",text:"Create client record in CRM",completed:!1},{id:"com-1-4",text:"Set up communication channels (Slack, etc.)",completed:!1},{id:"com-1-5",text:"Send welcome package with company info",completed:!1},{id:"com-1-6",text:"Assign account manager/primary contact",completed:!1},{id:"com-1-7",text:"Schedule follow-up check-in",completed:!1}],tags:["client","onboarding","sales"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"com-2",title:"Quote to Invoice Workflow",category:nr.COMMERCIAL,description:"Converting approved quotes to invoices",checklist:[{id:"com-2-1",text:"Verify all line items match final scope",completed:!1},{id:"com-2-2",text:"Confirm payment terms with client",completed:!1},{id:"com-2-3",text:"Generate invoice from approved quote",completed:!1},{id:"com-2-4",text:"Add correct billing address and PO number",completed:!1},{id:"com-2-5",text:"Review for accuracy before sending",completed:!1},{id:"com-2-6",text:"Send invoice with payment instructions",completed:!1},{id:"com-2-7",text:"Set payment reminder in system",completed:!1},{id:"com-2-8",text:"Mark opportunity as Won",completed:!1}],tags:["invoice","billing","finance"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"com-3",title:"Proposal Submission",category:nr.COMMERCIAL,description:"Submitting proposals to prospective clients",checklist:[{id:"com-3-1",text:"Review RFP/brief thoroughly",completed:!1},{id:"com-3-2",text:"Build detailed cost breakdown",completed:!1},{id:"com-3-3",text:"Include case studies and references",completed:!1},{id:"com-3-4",text:"Get internal approval on pricing",completed:!1},{id:"com-3-5",text:"Create professional PDF proposal",completed:!1},{id:"com-3-6",text:"Proofread all content",completed:!1},{id:"com-3-7",text:"Submit before deadline",completed:!1},{id:"com-3-8",text:"Schedule follow-up call with client",completed:!1}],tags:["proposal","sales","pitch"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},{id:"com-4",title:"Project Closeout",category:nr.COMMERCIAL,description:"Final steps after project completion",checklist:[{id:"com-4-1",text:"Send final deliverables to client",completed:!1},{id:"com-4-2",text:"Collect client feedback/testimonial",completed:!1},{id:"com-4-3",text:"Reconcile all expenses and costs",completed:!1},{id:"com-4-4",text:"Issue final invoice for remaining balance",completed:!1},{id:"com-4-5",text:"Update project records and lessons learned",completed:!1},{id:"com-4-6",text:"Archive project files",completed:!1},{id:"com-4-7",text:"Schedule future touchpoint with client",completed:!1}],tags:["closeout","project","admin"],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}],ir=u(L((e,t)=>({sops:[],isLoading:!1,error:null,initialize:async()=>{e({isLoading:!0});try{const{data:t,error:n}=await Q.from("sops").select("*").order("created_at",{ascending:!1});if(n)throw n;if(t&&t.length>0){const n=t.map(sr);e({sops:n,isLoading:!1})}else{const{data:t,error:n}=await Q.from("sops").insert(ar.map(or)).select();if(n)throw n;e({sops:t?t.map(sr):ar,isLoading:!1})}}catch(t){e({sops:ar,isLoading:!1})}},addSop:async t=>{const n={id:crypto.randomUUID(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),checklist:t.checklist||[],tags:t.tags||[],...t};e(e=>({sops:[n,...e.sops]}));try{const{error:e}=await Q.from("sops").insert(or(n));if(e)throw e}catch(r){}return n},updateSop:async(n,r)=>{const a={...r,updatedAt:(new Date).toISOString()};e(e=>({sops:e.sops.map(e=>e.id===n?{...e,...a}:e)}));try{const e=t().sops.find(e=>e.id===n);if(e){const{error:t}=await Q.from("sops").update(or({...e,...a})).eq("id",n);if(t)throw t}}catch(i){}},deleteSop:async t=>{e(e=>({sops:e.sops.filter(e=>e.id!==t)}));try{const{error:e}=await Q.from("sops").delete().eq("id",t);if(e)throw e}catch(n){}},toggleChecklistItem:async(e,n)=>{const r=t().sops.find(t=>t.id===e);if(!r)return;const a=r.checklist.map(e=>e.id===n?{...e,completed:!e.completed}:e);await t().updateSop(e,{checklist:a})},addChecklistItem:async(e,n)=>{const r=t().sops.find(t=>t.id===e);if(!r)return;const a={id:crypto.randomUUID(),text:n,completed:!1},i=[...r.checklist,a];return await t().updateSop(e,{checklist:i}),a},removeChecklistItem:async(e,n)=>{const r=t().sops.find(t=>t.id===e);if(!r)return;const a=r.checklist.filter(e=>e.id!==n);await t().updateSop(e,{checklist:a})},updateChecklistItemText:async(e,n,r)=>{const a=t().sops.find(t=>t.id===e);if(!a)return;const i=a.checklist.map(e=>e.id===n?{...e,text:r}:e);await t().updateSop(e,{checklist:i})},getByCategory:e=>t().sops.filter(t=>t.category===e),getCompletionPercentage:e=>{const n=t().sops.find(t=>t.id===e);if(!n||!n.checklist?.length)return 0;const r=n.checklist.filter(e=>e.completed).length;return Math.round(r/n.checklist.length*100)},resetChecklist:async e=>{const n=t().sops.find(t=>t.id===e);if(!n)return;const r=n.checklist.map(e=>({...e,completed:!1}));await t().updateSop(e,{checklist:r})},duplicateSop:async e=>{const n=t().sops.find(t=>t.id===e);if(!n)return;const r={...n,id:crypto.randomUUID(),title:`${n.title} (Copy)`,checklist:n.checklist.map(e=>({...e,id:crypto.randomUUID(),completed:!1})),photos:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};return await t().addSop(r)},updateSopPhotos:async(e,n)=>{await t().updateSop(e,{photos:n})}})));function or(e){return{id:e.id,title:e.title,category:e.category,description:e.description||"",checklist:e.checklist||[],tags:e.tags||[],photos:e.photos||[],created_at:e.createdAt,updated_at:e.updatedAt}}function sr(e){return{id:e.id,title:e.title,category:e.category,description:e.description||"",checklist:e.checklist||[],tags:e.tags||[],photos:e.photos||[],createdAt:e.created_at,updatedAt:e.updated_at}}const lr=d.lazy(()=>E(()=>import("./ClientsPage-C_z4UI-O.js"),__vite__mapDeps([0,1,2,3,4,5]))),cr=d.lazy(()=>E(()=>import("./ClientDetailPage-DhOinYsB.js"),__vite__mapDeps([6,1,2,3,4,5]))),ur=d.lazy(()=>E(()=>import("./OpportunitiesPage-DHeY6jbG.js"),__vite__mapDeps([7,1,2,3,8,5]))),dr=d.lazy(()=>E(()=>import("./OpportunityDetailPage-htXSsuKH.js"),__vite__mapDeps([9,1,2,3,5]))),pr=d.lazy(()=>E(()=>import("./RateCardPage-C1JHrsFC.js"),__vite__mapDeps([10,1,2,3,5]))),mr=d.lazy(()=>E(()=>import("./DashboardPage-Dk1q3QYi.js"),__vite__mapDeps([11,1,2,3,5]))),fr=d.lazy(()=>E(()=>import("./QuotesPage-BuOu4wRL.js"),__vite__mapDeps([12,1,2,3,5]))),hr=d.lazy(()=>E(()=>import("./SettingsPage-j9v9x1N5.js"),__vite__mapDeps([13,1,2,3,5]))),gr=d.lazy(()=>E(()=>import("./FSPage-BeF_ZTae.js"),__vite__mapDeps([14,1,2,3,8,5]))),yr=d.lazy(()=>E(()=>import("./CommercialTasksPage-DdFeVGxm.js"),__vite__mapDeps([15,1,2,3,5]))),br=d.lazy(()=>E(()=>import("./SOPPage-BdUPQnlc.js"),__vite__mapDeps([16,1,2,3,5]))),xr=d.lazy(()=>E(()=>import("./KnowledgePage-C4Ffy59k.js"),__vite__mapDeps([17,1,2,3,18,5]))),vr=d.lazy(()=>E(()=>import("./KitListPage-ycKmqhSB.js"),__vite__mapDeps([19,1,2,3,5])));function wr(){const{isAuthenticated:e}=it(),t=ft(e=>e.initialize),r=Ee(e=>e.initialize),a=ce(e=>e.initialize),i=He(e=>e.initialize),o=Cn(e=>e.initialize),s=ye(e=>e.initialize),l=_t(e=>e.initialize),c=An(e=>e.initialize),u=Rn(e=>e.initialize),p=tr(e=>e.initialize),m=ir(e=>e.initialize),f=ft(e=>e.resetQuote),h=ft(e=>e.loadQuoteData),[g,y]=d.useState("dashboard"),[b,x]=d.useState(null),[v,w]=d.useState(null),[k,S]=d.useState(!1),[j,C]=d.useState(!1),[N,_]=d.useState(null),E=ft(e=>e.quote),{confirmNavigateAway:L,markAsSaved:T}=function(e,t){const n=d.useRef(null),r=d.useCallback(()=>{if(!e)return!1;if(!n.current)return!1;const r={...t},a={...n.current};return delete r.updatedAt,delete a.updatedAt,JSON.stringify(r)!==JSON.stringify(a)},[t,e]),a=d.useCallback(()=>{e&&t&&(n.current={...t})},[t,e]),i=d.useCallback(e=>{r()?window.confirm("You have unsaved changes. Are you sure you want to leave?")&&(n.current=null,e()):e()},[r]);return d.useEffect(()=>{const e=e=>{if(r())return e.preventDefault(),e.returnValue="",""};return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)},[r]),{hasUnsavedChanges:r,confirmNavigateAway:i,markAsSaved:a}}("editor"===g,E),D=d.useCallback(e=>{x(e),y("client-detail")},[]),I=d.useCallback((e=null)=>{_(e),C(!0)},[]),A=d.useCallback(e=>{if(e){const t=Ee.getState().getClient(e);if(t){const e=t.contacts?.find(e=>e.isPrimary)||t.contacts?.[0];ft.getState().setClientDetails({clientId:t.id,company:t.company,contactId:e?.id||null,contact:e?.name||t.contact||"",email:e?.email||t.email||"",phone:e?.phone||t.phone||""})}}},[]),P=d.useCallback(e=>{f();const t={sections:e.sections||{},currency:e.currency||"USD",region:e.region||"SEA",managementFee:e.fees?.managementFee||0,commissionFee:e.fees?.commissionFee||0,discountPercent:e.fees?.discountPercent||0,...e.projectDefaults||{}};h(t),A(N),_t.getState().incrementUsageCount(e.id),C(!1),_(null),y("editor")},[f,h,A,N]),O=d.useCallback(()=>{f(),A(N),C(!1),_(null),y("editor")},[f,A,N]),q=d.useCallback(()=>{C(!1),_(null)},[]),z=d.useCallback(e=>{e&&e.sections&&h(e),y("editor")},[h]),R=d.useCallback(()=>{L(()=>y("clients"))},[L]),M=d.useCallback(()=>{L(()=>y("rate-card"))},[L]),F=d.useCallback(()=>{L(()=>y("dashboard"))},[L]),U=d.useCallback(()=>{L(()=>y("settings"))},[L]),B=d.useCallback(()=>{L(()=>y("quotes"))},[L]),$=d.useCallback(()=>{L(()=>y("fs"))},[L]),Q=d.useCallback(()=>{L(()=>y("opportunities"))},[L]),V=d.useCallback(()=>{L(()=>y("tasks"))},[L]),W=d.useCallback(()=>{L(()=>y("sop"))},[L]),H=d.useCallback(()=>{L(()=>y("knowledge"))},[L]);d.useCallback(()=>{L(()=>y("kit"))},[L]);const G=d.useCallback(e=>{w(e),y("opportunity-detail")},[]),K=d.useCallback(e=>{f(),e.client&&ft.getState().setClientDetails({clientId:e.clientId||e.client.clientId||null,company:e.client.company||"",contactId:e.client.contactId||null,contact:e.client.contact||"",email:e.client.email||"",phone:e.client.phone||"",address:e.client.address||""}),e.project&&ft.getState().setProjectDetails({...e.project,opportunityId:e.opportunityId}),e.currency&&ft.getState().setCurrency(e.currency),e.region&&ft.getState().setRegion(e.region);const t=ft.getState();t.loadQuoteData({...t.quote,quoteDate:(new Date).toISOString().split("T")[0]}),y("editor")},[f]),Y=d.useCallback(()=>{S(e=>!e)},[]);d.useEffect(()=>{"editor"===g&&E.quoteNumber&&T()},[g,E.quoteNumber,T]);const J=He(e=>e.settings);if(d.useEffect(()=>{"light"===(J.theme||"dark")?(document.documentElement.classList.add("light"),document.documentElement.classList.remove("dark")):(document.documentElement.classList.add("dark"),document.documentElement.classList.remove("light"))},[J.theme]),d.useEffect(()=>{e&&(t(),r(),a(),i(),o(),s(),l(),c(),u(),p(),m())},[e,t,r,a,i,o,s,l,c,u,p,m]),!e)return n.jsx(rn,{});return n.jsxs("div",{className:"min-h-screen flex flex-col "+("light"===J.theme?"bg-light-bg":"bg-dark-bg"),children:[n.jsx(bn,{}),n.jsx(It,{view:g,onGoToClients:R,onGoToRateCard:M,onGoToDashboard:F,onGoToQuotes:B,onGoToSettings:U,onGoToFS:$,onGoToOpportunities:Q,onGoToTasks:V,onGoToSOP:W,onGoToKnowledge:H,selectedClientId:b}),(()=>{switch(g){case"clients":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading clients..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(lr,{onSelectClient:D})})});case"client-detail":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading client details..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(cr,{clientId:b,onBackToDashboard:F,onEditQuote:z,onNewQuote:I,onSelectOpportunity:G})})});case"opportunities":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading opportunities..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(ur,{onSelectOpportunity:G})})});case"opportunity-detail":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading opportunity..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(dr,{opportunityId:v,onBack:Q,onConvertToQuote:K})})});case"rate-card":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading rate card..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(pr,{})})});case"dashboard":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading dashboard..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(mr,{onViewQuote:z,onNewQuote:I,onGoToOpportunities:Q,onGoToKnowledge:H})})});case"quotes":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading quotes..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(fr,{onEditQuote:z,onNewQuote:I})})});case"settings":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading settings..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(hr,{})})});case"tasks":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading tasks..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(yr,{})})});case"sop":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading SOPs..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(br,{})})});case"knowledge":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading Knowledge Base..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(xr,{})})});case"kit":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading Kit List..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(vr,{})})});case"fs":return n.jsx(d.Suspense,{fallback:n.jsx(an,{text:"Loading..."}),children:n.jsx("main",{id:"main-content",tabIndex:"-1",children:n.jsx(gr,{onExit:F})})});default:return n.jsxs("main",{id:"main-content",className:"flex-1 flex flex-col lg:flex-row max-w-[1920px] mx-auto w-full",tabIndex:"-1",children:[n.jsx("button",{onClick:Y,className:"lg:hidden fixed bottom-4 right-4 z-50 btn-primary rounded-full p-4 shadow-xl","aria-label":k?"Show editor":"Show preview",children:k?n.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}):n.jsxs("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),n.jsx("div",{className:(k?"hidden lg:flex":"flex")+" flex-1",children:n.jsx($t,{onGoToSettings:U})}),n.jsx("div",{className:(k?"flex":"hidden lg:flex")+" w-full lg:w-[320px] lg:min-w-[320px]",children:n.jsx(nn,{})})]})}})(),n.jsx(vn,{isOpen:j,onClose:q,onSelectTemplate:P,onStartBlank:O})]})}class kr extends p.Component{constructor(e){super(e),t(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()}),this.state={hasError:!1,error:null,errorInfo:null,copied:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?n.jsx("div",{className:"min-h-screen bg-dark-bg flex items-center justify-center p-4",children:n.jsxs("div",{className:"max-w-2xl w-full bg-dark-card border border-red-500/30 rounded-xl p-8 shadow-2xl",children:[n.jsx("div",{className:"flex items-center justify-center mb-6",children:n.jsx("div",{className:"w-16 h-16 rounded-full bg-red-500/20 flex items-center justify-center",children:n.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),n.jsx("h1",{className:"text-2xl font-bold text-gray-100 text-center mb-2",children:"Something went wrong"}),n.jsx("p",{className:"text-gray-400 text-center mb-6",children:"The application encountered an unexpected error. Your work has been auto-saved."}),n.jsxs("details",{className:"mb-6 bg-dark-bg rounded-lg border border-dark-border",children:[n.jsx("summary",{className:"px-4 py-3 cursor-pointer text-sm text-gray-400 hover:text-gray-300 select-none",children:"Show error details"}),n.jsx("div",{className:"px-4 pb-4 pt-2",children:n.jsxs("div",{className:"font-mono text-xs text-red-400 bg-red-500/5 p-4 rounded border border-red-500/20 overflow-auto max-h-64",children:[this.state.error&&this.state.error.toString(),n.jsx("br",{}),n.jsx("br",{}),this.state.errorInfo&&this.state.errorInfo.componentStack]})})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[n.jsxs("button",{onClick:this.handleReset,className:"flex-1 btn-primary py-3 flex items-center justify-center gap-2",children:[n.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reload Application"]}),n.jsxs("button",{onClick:()=>{const e=`Error: ${this.state.error}\n\nStack: ${this.state.errorInfo?.componentStack}`;navigator.clipboard.writeText(e),this.setState({copied:!0}),setTimeout(()=>this.setState({copied:!1}),2e3)},className:"flex-1 btn-ghost py-3 flex items-center justify-center gap-2 "+(this.state.copied?"text-green-400":""),children:[this.state.copied?n.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):n.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),this.state.copied?"Copied!":"Copy Error Details"]})]}),n.jsx("p",{className:"text-xs text-gray-600 text-center mt-6",children:"If this problem persists, please contact support with the error details."})]})}):this.props.children}}N.createRoot(document.getElementById("root")).render(n.jsx(d.StrictMode,{children:n.jsx(kr,{children:n.jsx(bt,{children:n.jsx(wr,{})})})}));export{ge as A,Zt as C,Jn as D,A as F,Vn as K,wn as R,nr as S,E as _,ft as a,He as b,ye as c,Mt as d,F as e,U as f,it as g,Cn as h,kn as i,Sn as j,An as k,ce as l,yt as m,Rn as n,z as o,V as p,ir as q,rr as r,Q as s,L as t,Ee as u,Pn as v,tr as w,Yn as x};
